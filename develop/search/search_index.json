{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Home","text":"<p>Find security vulnerabilities, compliance issues, and infrastructure misconfigurations early in the development cycle of your infrastructure-as-code with KICS by Checkmarx.</p> <p>KICS stands for Keeping Infrastructure as Code Secure, it is open source and is a must-have for any cloud native project.</p> Version 1.6.10 <p>2023.02.13<p> Contribute!"},{"location":"#supported_platforms","title":"Supported Platforms","text":"<p>KICS scans and detects issues in following Infrastructure as Code solutions:</p> <p>Support of other solutions, such as Chef, and of additional cloud providers are on the roadmap.</p>"},{"location":"#getting_started","title":"Getting Started","text":"<p>Setting up and using KICS is super-easy.</p> <ul> <li>First, see how to install and get KICS running.</li> <li>Then explore KICS output results format and quickly fix the issues detected.</li> </ul> <p>Interested in more advanced stuff?</p> <ul> <li>Deep dive into KICS queries.</li> <li>Understand how you to integrate KICS in your favorite CI/CD pipelines.</li> </ul>"},{"location":"#how_it_works","title":"How it Works","text":"<p>What makes KICS really powerful and popular is its built-in extensibility. This extensibility is achieved by:</p> <ul> <li>Fully customizable and adjustable heuristics rules, called queries. These can be easily edited, extended and added.</li> <li>Robust but yet simple architecture, which allows quick addition of support for new Infrastructure as Code solutions.</li> </ul>"},{"location":"#contribution","title":"Contribution","text":"<p>KICS is a true community project. It's built as an open source project from day one and anyone can find his own way to contribute to the project. Check out how, within just minutes, you can start making a difference, by sharing your expertise with a community of thousands of security experts and software developers.</p> <ul> <li>How can I help?!</li> <li>Take me to the repo on GitHub!</li> </ul>"},{"location":"#about_the_project","title":"About the Project","text":"<p>The KICS project is powered by Checkmarx, global leader of Application Security Testing. Read more about Infrastructure as Code, Infrastructure as Code Testing and Checkmarx.</p> <p>KICS will always stay an open source and free project for the benefit of global software industry community. We believe that when Software is Everywhere, Security is Everything.</p> <p>Now, Software = Security.</p> <p>Looking for more info? Explore KICS project in details:</p> <ul> <li>Roadmap</li> <li>Project plans</li> <li>Issues</li> </ul> <p>Join the GitHub discussions. Or contact KICS core team at kics@checkmarx.com</p>"},{"location":"BADGE/","title":"Badge","text":""},{"location":"BADGE/#creating_a_badge","title":"Creating a badge","text":"<p>To create a badge and update it the user should run KICS in their CI.</p> <p>This can be done differently for each integration we have.</p> <p>Let's assume a manual CLI process using docker:</p> <pre><code>#!/usr/bin/env bash\necho \"running KICS in the current dir and writing results.json\"\ndocker run -t -v $PWD:/path checkmarx/kics:latest scan -p /path -o \"/path/\"\n</code></pre> <p>This will generate a results.json file under <code>path</code>. Parse the <code>results.json</code> and request a badge to img.shields.io.</p> <p>For this example, let's assume HIGH and MEDIUM results are bad:</p> <pre><code>#!/usr/bin/env bash\nHIGH=$(jq '.severity_counters.HIGH' results.json)\nMEDIUM=$(jq '.severity_counters.MEDIUM' results.json)\nLOW=$(jq '.severity_counters.LOW' results.json)\nINFO=$(jq '.severity_counters.INFO' results.json)\n\nMESSAGE=\"passing\"\nCOLOR=\"green\"\nif (( $HIGH &gt; 0 )) || (( $MEDIUM &gt; 0)); then\n    MESSAGE=\"failing\"\n    COLOR=\"red\"\nfi\n\ncurl -sL \"https://img.shields.io/badge/KICS-${MESSAGE}-${COLOR}.svg\" &gt; kics-status.svg\n</code></pre> <p>An example SVG produced:</p> <p></p> <p>If you have github pages configured under <code>gh-pages</code> branch configured you can commit and push the badge to it and reference on your README.md, e.g:</p> <p><code>![KICS](https://raw.githubusercontent.com/Checkmarx/kics/gh-pages/kics-status.svg)</code></p>"},{"location":"CONTRIBUTING/","title":"Contribution","text":""},{"location":"CONTRIBUTING/#contribution","title":"Contribution","text":"<p>We would like to THANK YOU for considering contributing to KICS!</p> <p>KICS is a true community project. It's built as an open source from day one, and anyone can find his own way to contribute to the project.</p> <p>Within just minutes, you can start making a difference, by sharing your expertise with a community of thousands of security experts and software developers.</p>"},{"location":"CONTRIBUTING/#community_meetings","title":"Community Meetings","text":"<p>You're welcome to join our monthly community meetings</p>"},{"location":"CONTRIBUTING/#contribution_options","title":"Contribution Options","text":"<p>Good news! You don't have to contribute code. There are plenty of ways you can contribute to KICS project:</p> <ul> <li>Reporting new bugs or issues</li> <li>Help triaging issues</li> <li>Improving and translating the documentation</li> <li>Volunteering to maintain the project</li> </ul>"},{"location":"CONTRIBUTING/#code_of_conduct","title":"Code of Conduct","text":"<p>By participating and contributing to the project, you agree to uphold our Code of Conduct.</p>"},{"location":"CONTRIBUTING/#get_started","title":"Get Started!","text":"<p>Follow the instructions below to setup local KICS development environment and push your changes.</p> <ol> <li>Fork the <code>kics</code> repo on GitHub.</li> <li>Download and install Go 1.16 or higher from https://golang.org/dl/.</li> <li>Clone your fork locally:    <code>shell    git clone https://github.com/Checkmarx/kics.git</code></li> <li>Create a branch for local development. Use succinct but descriptive name (prefix with feature/issue#-descriptive-name&gt; or hotfix/issue#-descriptive-name):    <code>sh    git checkout -b &lt;name-of-your-issue&gt;</code></li> <li>Make your changes locally.</li> <li>Validate your changes to reassure they meet project quality and contribution standards:    <code>sh    golint .</code> <code>sh    go mod vendor</code> <code>sh    go test -mod=vendor -v ./...</code></li> <li>Commit your changes and push your branch to GitHub:    <code>sh    git add .</code>    We recommend following conventional commits messages <code>sh    git commit -m \"feat(CLI): add new flag --blabla\"</code> <code>sh    git push --set-upstream origin &lt;name-of-your-issue&gt;</code></li> <li>Submit a pull request on GitHub website.</li> </ol>"},{"location":"CONTRIBUTING/#how_to_contribute","title":"How to Contribute","text":"<p>Contributions are made to this repo via Issues and Pull Requests (PRs).  A few general guidelines that cover both:</p> <ul> <li>Search for existing issues and pull requests before creating your own to avoid duplicates.</li> <li>PRs will only be accepted if associated with an issue (enhancement or bug) that has been submitted and reviewed/labeled as accepted.</li> <li>We will work hard to make sure issues that are raised are handled in a timely manner.</li> </ul>"},{"location":"CONTRIBUTING/#issues","title":"Issues","text":"<p>Issues should be used to report problems with the solution / source code, request a new feature, or to discuss potential changes before a PR is created. When you create a new Issue, a template will be loaded that will guide you through collecting and providing the information we need to investigate.</p> <p>If you find an Issue that addresses the problem you're having, please add your own reproduction information to the existing issue rather than creating a new one. Adding a reaction can also help by indicating to our maintainers that a particular problem is affecting more than just the reporter.</p>"},{"location":"CONTRIBUTING/#pull_requests","title":"Pull Requests","text":"<p>Pull Requests (PRs) are always welcome and can be a quick way to get your fix or improvement slated for the next release. In general, PRs should:</p> <ul> <li>Only fix/add the functionality in question or address code style issues, not both.</li> <li>Ensure all necessary details are provided and adhered to.</li> <li>Add unit or integration tests for fixed or changed functionality (if a test suite already exists) or specify steps taken to ensure changes were tested and functionality works as expected.</li> <li>Address a single concern in the least number of changed lines as possible.</li> <li>Include documentation in the repo or Provide additional comments in Markdown comments that should be pulled/reflected in GitHub Wiki for the given project.</li> <li>Be accompanied by a complete Pull Request template (loaded automatically when a PR is created).</li> </ul> <p>For changes that address core functionality or would require breaking changes (e.g. a major release), please open an Issue to discuss your proposal first.</p>"},{"location":"CONTRIBUTING/#pull_request_guidelines","title":"Pull Request Guidelines","text":"<p>Before you submit a pull request, please reassure that it meets these guidelines:</p> <ol> <li>All validations and tests passed locally.</li> <li>The pull request includes tests.</li> <li>The relevant docs are updated, whether you're pushing new functionality or updating a query.</li> <li>The pull request title should follow conventional commit messages:</li> </ol> <p><code>&lt;type&gt;(&lt;scope&gt;): &lt;subject&gt;</code> where <code>(&lt;scope&gt;)</code> is optional</p> <pre><code>feat - A new feature (example scopes: engine, parser, flags, query)\nfix - A bug fix\ndocs - Documentation only changes, (example scopes: catalog, guides, platforms, architecture)\ntest - Adding missing tests or correcting existing tests (example scopes: unit, e2e)\nci - Changes to our CI configuration files and scripts (example scopes: ghactions, linters)\nchore - Other changes that don't modify src or test files\nbuild - Changes that affect the build system or external dependencies (example scope: makefile)\nstyle - Changes that do not affect the meaning of the code (white-space, formatting, missing semi-colons, etc)\nrefactor - A code change that neither fixes a bug nor adds a feature\nperf - A code change that improves performance\nrevert - Reverts a previous commit\n</code></pre> <p>e.g: <code>build(makefile): enhance make clean task</code></p>"},{"location":"CONTRIBUTING/#templates","title":"Templates","text":"<p>The following templates will be used when creating a new issue:</p> <ul> <li>Enhancement/Feature Request Template</li> <li>New (Approved) Feature Template</li> <li>Query Template</li> <li>Bug Report Template</li> </ul>"},{"location":"CONTRIBUTING/#resources","title":"Resources","text":"<ul> <li>How to Contribute to Open Source</li> <li>Using Pull Requests</li> <li>GitHub Help</li> </ul> <p>Join the GitHub discussions. Or contact KICS core team at kics@checkmarx.com</p> <p>And become one of our top contributors!</p>"},{"location":"CONTRIBUTING/#top_contributors","title":"Top Contributors","text":"<p>Special thanks to  Lior Kaplan from Kaplan Open Source Consulting for his assistance in creating KICS. </p> <p>The people listed below had made a huge contribution to KICS.</p> <ul> <li>Ruben Silva</li> <li>Rafaela Soares</li> <li>Jo\u00e3o Martins</li> <li>Joel Carvalho</li> <li>Pedro Mimoso</li> <li>Nuno Ara\u00fajo</li> <li>F\u00e1bio Gon\u00e7alves</li> <li>Mariana Carvalho</li> <li>Jorge Cruz</li> <li>Jo\u00e3o Oliveira</li> <li>Diogo Lemos</li> <li>Alex Roichman</li> <li>Adar Weidman</li> <li>Eli Trop</li> <li>Joel Sousa</li> <li>S\u00f3nia Ant\u00e3o</li> <li>Catarina Ara\u00fajo</li> <li>Pedro Pereira</li> <li>Samuel Ferreira</li> </ul>"},{"location":"CONTRIBUTING/#core_team","title":"Core Team","text":"<ul> <li>Rui Gomes</li> <li>Rog\u00e9rio Peixoto</li> <li>Jo\u00e3o Reigota</li> <li>Felipe Avelar</li> <li>Nuno Oliveira</li> <li>Mark Mishaev</li> <li>Igor Markov</li> <li>Ori Bendet</li> <li>Erez Yalon</li> </ul> <p>Thank you all!</p>"},{"location":"about/","title":"About","text":""},{"location":"about/#about_checkmarx","title":"About Checkmarx","text":"<p>Checkmarx is the global leader in software security solutions for modern enterprise software development. Checkmarx delivers the industry\u2019s most comprehensive Software Security Platform that unifies with DevOps and provides static and interactive application security testing, software composition analysis and developer AppSec awareness and training programs to reduce and remediate risk from software vulnerabilities. Checkmarx is trusted by more than 40 percent of the Fortune 100 and half of the Fortune 50, including leading organizations such as SAP, Samsung and Salesforce.com.</p> <p></p> <p>Contact KICS core team at kics@checkmarx.com or join the GitHub discussions.</p>"},{"location":"about/#infrastructure_as_code","title":"Infrastructure as Code","text":"<p>Infrastructure as Code (IaC) is the creation, provisioning and configuration of software-defined compute (SDC), network and storage infrastructure through machine-readable definition files, rather than physical hardware configuration or interactive configuration tools.</p> <p>IaC automates the manual tasks usually associated with computing infrastructure configuration and implementation. By doing this, you can:</p> <ul> <li>Speed up configuration and implementation of new computing infrastructure</li> <li>Reduce the cost and resource needed to scale and manage large infrastructure</li> <li>Eliminate the inconsistencies that inevitably occur when multiple individuals manually configure new equipment or applications.</li> </ul> <p>The core concepts of Infrastructure as Code are:</p> <ul> <li>Defined in code</li> <li>Stored in a repository</li> <li>Declarative or Imperative</li> <li>Idempotence and Consistency</li> <li>Push or Pull</li> </ul> <p>Main Benefits of Infrastructure as Code:</p> <ul> <li>Fully automated deployment</li> <li>Consistent environments</li> <li>Repeatable process</li> <li>Reusable components (\"DRY\")</li> <li>Documented Architecture</li> </ul>"},{"location":"about/#infrastructure_as_code_testing","title":"Infrastructure as Code Testing","text":"<p>Infrastructure as Code testing examines configuration definitions and scripts used to instantiate infrastructure to ensure the resulting resources are secure.</p> <p>IaC security testing tools must be able to consume configuration files and scripts in relevant formats, apply tests to ensure conformance with common configuration hardening standards (i.e., Center for Internet Security Benchmarks and many others), identify security issues associated with specific operational environments, identify embedded secrets, and perform other tests supporting organization-specific standards and compliance requirements. Optionally, tools can automatically remediate errors (e.g., changing read/write permissions on storage resources). This capability specifically examines IaC testing in the context of the development process, however tools may also support examination of deployed production instances and responding to issues identified in those systems.</p>"},{"location":"architecture/","title":"Architecture","text":""},{"location":"architecture/#overview","title":"Overview","text":"<p>KICS is 100% open source is written in Golang using Open Policy Agent (OPA).</p> <p>Golang speed, simplicity and reliability made it the perfect choice for writing KICS, while Rego as a query language, was a native choice to implement security queries.</p> <p>So far have written 1000+ ready-to-use queries that cover a wide range of vulnerabilities checks for AWS, GCP, Azure and other cloud providers.</p>"},{"location":"architecture/#high_level_architecture","title":"High Level Architecture","text":"<p>KICS has a pluggable architecture with extensible pipeline of parsing IaC languages, which allows an easy integration of new IaC languages and queries.</p> <p>At a very high level, KICS is composed of the following main components: a command line interface, parser, queries execution engine,  IaC providers,  security queries, and results writer.</p> <ul> <li>Command Line Interface =&gt; Provides CLI input to KICS.</li> <li>Parser =&gt; responsible for parsing input IaC files (terraform and others)</li> <li>IaC Providers =&gt; Converts IaC language into normalized JSON</li> <li>Queries Execution Engine =&gt; applies REGO queries against normalized JSON</li> <li>Security Queries =&gt; pre-built REGO queries for each security and misconfiguration</li> <li>Writer =&gt; Writes results into JSON format</li> </ul> <p> </p>"},{"location":"architecture/#execution_flow","title":"Execution Flow","text":"<p>The sequence diagram below depicts interaction of the main KICS components:  </p>"},{"location":"architecture/#concurrent_scans","title":"Concurrent Scans","text":"<p>KICS creates multiple services, each containing a unique parser. All the services will then concurrently generate a payload and run queries on it according to its containing parser. When a vulnerability is found, it is saved inside the Storage which is shared amongst all the services.</p> <ul> <li>Paths =&gt; create services based on types of IaC files.</li> <li>Service =&gt; contains a unique parser and shares other resources with other services</li> <li>Start Scan =&gt; Services will concurrently create payloads based on its parser, inspect for vulnerabilities and save them on the shared storage</li> <li>Results =&gt; when all services have finished their execution all the results will be gathered from the storage</li> </ul>"},{"location":"bom/","title":"Bill of Materials","text":""},{"location":"bom/#terraform_bill_of_materials","title":"[Terraform] Bill Of Materials","text":"<p>This feature uses Rego queries to extract a list of used Terraform resources along with its metadata in the scanned IaC.</p> <p>Find the existing queries under: assets/queries/terraform/aws_bom</p> <p>BoM queries extracts metadata about the resources and organizes it in the following structure:</p> <pre><code>billOfMaterialsRequiredFields := map[string]bool{\n    \"acl\":                    false,\n    \"policy\":                 false,\n    \"resource_accessibility\": true,\n    \"resource_category\":      true,\n    \"resource_encryption\":    true,\n    \"resource_engine\":        false,\n    \"resource_name\":          true,\n    \"resource_type\":          true,\n    \"resource_vendor\":        true,\n}\n</code></pre> <p>Observe more detailed information about it in the table below.</p> Field Possible Values Required Resources Type acl private, public-read, public-read-write, aws-exec-read, authenticated-read, bucket-owner-read, bucket-owner-full-control,  log-delivery-write No <code>aws_s3_bucket</code> string policy policy content (in case <code>resource_accessibility</code> equals hasPolicy) No <code>aws_efs_file_system</code>, <code>aws_s3_bucket</code>, <code>aws_sns_topic</code>, <code>aws_sqs_queue</code>, <code>aws_dynamodb_table</code> JSON marshalled resource_accessibility public, private, hasPolicy or unknown for  <code>aws_ebs_volume</code>, <code>aws_efs_file_system</code>, <code>aws_mq_broker</code>, <code>aws_msk_cluster</code>, <code>aws_s3_bucket</code>, <code>aws_sns_topic</code>, <code>aws_sqs_queue</code>, <code>aws_db_instance</code>,  <code>aws_rds_cluster_instance</code>, <code>aws_kinesis_stream</code>, and <code>aws_dynamodb_table</code>  at least one security group associated with the elasticache is unrestricted, all security groups associated with the elasticache are restricted or unknown for <code>aws_elasticache_cluster</code> Yes all string resource_category In Memory Data Structure for <code>aws_elasticache_cluster</code>  Messaging for <code>aws_sns_topic</code>  Queues for <code>aws_mq_broker</code> and <code>aws_sqs_queue</code>  Storage for <code>aws_ebs_volume</code>, <code>aws_efs_file_system</code>, <code>aws_s3_bucket</code>, <code>aws_db_instance</code>,  <code>aws_rds_cluster_instance</code>, and <code>aws_dynamodb_table</code>   Streaming for <code>aws_msk_cluster</code> and <code>aws_kinesis_stream</code> Yes all string resource_encryption encrypted,  unencrypted,  unknown Yes all string resource_engine memcached, redis or unknown for <code>aws_elasticache_cluster</code>  ActiveMQ or RabbitMQ for <code>aws_mq_broker</code>  parameter in API action CreateDBInstance or unknown for  <code>aws_db_instance</code>, and  <code>aws_rds_cluster_instance</code> No <code>aws_elasticache_cluster</code>,  <code>aws_mq_broker</code>, <code>aws_db_instance</code>, <code>aws_rds_cluster_instance</code> string resource_name anything (if the name is defined), unknown (if the name is not defined) Yes all string resource_type aws_ebs_volume for <code>aws_ebs_volume</code>, aws_efs_file_system for <code>aws_efs_file_system</code>, aws_elasticache_cluster for <code>aws_elasticache_cluster</code>, aws_mq_broker for <code>aws_mq_broker</code>, aws_msk_cluster for <code>aws_msk_cluster</code>, aws_s3_bucket for <code>aws_s3_bucket</code>, aws_sns_topic for <code>aws_sns_topic</code>, aws_sqs_queue for <code>aws_sqs_queue</code>  aws_db_instance for <code>aws_db_instance</code>, aws_rds_cluster_instance for <code>aws_rds_cluster_instance</code>, aws_dynamodb_table for <code>aws_dynamodb_table</code>,  aws_kinesis_stream for <code>aws_kinesis_stream</code> Yes all string resource_vendor AWS Yes all string"},{"location":"bom/#bom_query_example","title":"BoM query example","text":"<pre><code>CxPolicy[result] {\n    bucket_resource := input.document[i].resource.aws_s3_bucket[name]\n\n    info := get_accessibility(bucket_resource, name)\n\n    bom_output = {\n        \"resource_type\": \"aws_s3_bucket\",\n        \"resource_name\": get_bucket_name(bucket_resource),\n        \"resource_accessibility\": info.accessibility,\n        \"resource_encryption\": common_lib.get_encryption_if_exists(bucket_resource),\n        \"resource_vendor\": \"AWS\",\n        \"resource_category\": \"Storage\",\n        \"acl\": get_bucket_acl(bucket_resource),\n    }\n\n    final_bom_output = common_lib.get_bom_output(bom_output, info.policy)\n\n    result := {\n        \"documentId\": input.document[i].id,\n        \"searchKey\": sprintf(\"aws_s3_bucket[%s]\", [name]),\n        \"issueType\": \"BillOfMaterials\",\n        \"keyExpectedValue\": \"\",\n        \"keyActualValue\": \"\",\n        \"searchLine\": common_lib.build_search_line([\"resource\", \"aws_s3_bucket\", name], []),\n        \"value\": json.marshal(final_bom_output),\n    }\n}\n</code></pre>"},{"location":"bom/#results","title":"Results","text":"<p>Results will be found in the JSON output and placed separately under <code>bill_of_materials</code> key:</p> <pre><code>{\n    // etc...\n    \"bill_of_materials\": [\n        {\n            \"query_name\": \"BOM - AWS S3 Buckets\",\n            \"query_id\": \"2d16c3fb-35ba-4ec0-b4e4-06ee3cbd4045\",\n            \"query_url\": \"https://kics.io\",\n            \"severity\": \"TRACE\",\n            \"platform\": \"Terraform\",\n            \"cloud_provider\": \"AWS\",\n            \"category\": \"Bill Of Materials\",\n            \"description\": \"A list of S3 resources found. Amazon Simple Storage Service (Amazon S3) is an object storage service that offers industry-leading scalability, data availability, security, and performance.\",\n            \"description_id\": \"0bdf2341\",\n            \"files\": [\n                {\n                    \"file_name\": \"assets\\\\queries\\\\terraform\\\\aws_bom\\\\s3_bucket\\\\test\\\\positive8.tf\",\n                    \"similarity_id\": \"aaf7959a055b67a35369c2b02aad327f28e85cca02e2daff3d3e40e2b460f36a\",\n                    \"line\": 1,\n                    \"issue_type\": \"BillOfMaterials\",\n                    \"search_key\": \"aws_s3_bucket[positive8]\",\n                    \"search_line\": 0,\n                    \"search_value\": \"\",\n                    \"expected_value\": \"\",\n                    \"actual_value\": \"\",\n                    \"value\": \"{\\\"acl\\\":\\\"public-read\\\",\\\"policy\\\":{\\\"Id\\\":\\\"MYBUCKETPOLICY\\\",\\\"Statement\\\":[{\\\"Action\\\":\\\"s3:GetObject\\\",\\\"Condition\\\":{\\\"IpAddress\\\":{\\\"aws:SourceIp\\\":\\\"8.8.8.8/32\\\"}},\\\"Effect\\\":\\\"Allow\\\",\\\"Principal\\\":{\\\"AWS\\\":[\\\"arn:aws:iam::123456789012:root\\\",\\\"arn:aws:iam::555555555555:root\\\"]},\\\"Resource\\\":\\\"arn:aws:s3:::my_tf_test_bucket/*\\\",\\\"Sid\\\":\\\"IPAllow\\\"}],\\\"Version\\\":\\\"2012-10-17\\\"},\\\"resource_accessibility\\\":\\\"hasPolicy\\\",\\\"resource_category\\\":\\\"Storage\\\",\\\"resource_encryption\\\":\\\"encrypted\\\",\\\"resource_name\\\":\\\"my-tf-test-bucket\\\",\\\"resource_type\\\":\\\"aws_s3_bucket\\\",\\\"resource_vendor\\\":\\\"AWS\\\"}\"\n                }\n            ]\n        }\n    ]\n}\n</code></pre> <p>To enable bill-of-materials in the results use the <code>--bom</code> flag.</p> <p>NOTE Bill of Materials queries should always have: - <code>severity: \"TRACE\"</code> - <code>category: \"Bill Of Materials\"</code> - <code>issue_type: \"BillOfMaterials\"</code></p>"},{"location":"bom/#cloudformation_bill_of_materials","title":"[CloudFormation] Bill Of Materials","text":"<p>This feature uses Rego queries to extract a list of used CloudFormation resources along with its metadata in the scanned IaC.</p> <p>Find the existing queries under: assets/queries/cloudFormation/aws_bom</p> <p>BoM queries extracts metadata about the resources and organizes it in the following structure:</p> <pre><code>billOfMaterialsRequiredFields := map[string]bool{\n    \"acl\":                    false,\n    \"policy\":                 false,\n    \"resource_accessibility\": true,\n    \"resource_category\":      true,\n    \"resource_encryption\":    true,\n    \"resource_engine\":        false,\n    \"resource_name\":          true,\n    \"resource_type\":          true,\n    \"resource_vendor\":        true,\n}\n</code></pre> <p>Observe more detailed information about it in the table below.</p> Field Possible Values Required Resources Type acl Private, PublicRead, PublicReadWrite, AuthenticatedRead, LogDeliveryWrite, BucketOwnerRead, BucketOwnerFullControl, AwsExecRead No <code>AWS::S3::Bucket</code> string policy policy content (in case <code>resource_accessibility</code> equals hasPolicy) No <code>AWS::EFS::FileSystem</code>, <code>AWS::S3::Bucket</code>, <code>AWS::SNS::Topic</code>, <code>AWS::SQS::Queue</code>, <code>AWS::DynamoDB::Table</code> JSON marshalled resource_accessibility public, private, hasPolicy or unknown for <code>AWS::EC2::Volume</code>,<code>AWS::EFS::FileSystem</code>,<code>AWS::AmazonMQ::Broker</code>,<code>AWS::MSK::Cluster</code>,<code>AWS::S3::Bucket</code>, <code>AWS::SNS::Topic</code>,<code>AWS::SQS::Queue</code>,<code>AWS::RDS::DBInstance</code>, <code>AWS::Kinesis::Stream</code>, <code>AWS::DynamoDB::Table</code>,  and <code>AWS::Cassandra::Table</code>  at least one security group associated with the elasticache is unrestricted, all security groups associated with the elasticache are restricted or unknown for <code>AWS::ElastiCache::CacheCluster</code> Yes all string resource_category In Memory Data Structure for <code>AWS::ElastiCache::CacheCluster</code>  Messaging for <code>AWS::SNS::Topic</code>  Queues for <code>AWS::AmazonMQ::Broker</code> and <code>AWS::SQS::Queue</code>  Storage for <code>AWS::EC2::Volume</code>, <code>AWS::EFS::FileSystem</code>, <code>AWS::S3::Bucket</code>, <code>AWS::RDS::DBInstance</code>, <code>AWS::DynamoDB::Table</code>, <code>AWS::Cassandra::Table</code>, and <code>AWS::Kinesis::Stream</code>  Streaming for <code>AWS::MSK::Cluster</code> Yes all string resource_encryption encrypted,  unencrypted,  unknown Yes all string resource_engine memcached, redis or unknown for <code>AWS::ElastiCache::CacheCluster</code>  ACTIVEMQ or RABBITMQ for <code>AWS::AmazonMQ::Broker</code>  aurora, aurora-mysql, aurora-postgresql, mariadb, mysql, oracle-ee, oracle-ee-cdb, oracle-se2, oracle-se2-cdb, postgres, sqlserver-ee, sqlserver-se, sqlserver-ex, sqlserver-web or unknown for <code>AWS::RDS::DBInstance</code> No <code>AWS::ElastiCache::CacheCluster</code>,  <code>AWS::AmazonMQ::Broker</code>, <code>AWS::RDS::DBInstance</code> string resource_name anything (if the name is defined), unknown (if the name is not defined) Yes all string resource_type AWS::EC2::Volume for <code>AWS::EC2::Volume</code>, AWS::EFS::FileSystem for <code>AWS::EFS::FileSystem</code>, AWS::ElastiCache::CacheCluster for <code>AWS::ElastiCache::CacheCluster</code>, AWS::AmazonMQ::Broker for <code>AWS::AmazonMQ::Broker</code>, AWS::MSK::Cluster for <code>AWS::MSK::Cluster</code>, AWS::S3::Bucket for <code>AWS::S3::Bucket</code>, AWS::SNS::Topic for <code>AWS::SNS::Topic</code>, AWS::SQS::Queue for <code>AWS::SQS::Queue</code>, AWS::RDS::DBInstance for <code>AWS::RDS::DBInstance</code>, AWS::DynamoDB::Table for <code>AWS::DynamoDB::Table</code>, AWS::Kinesis::Stream for <code>AWS::Kinesis::Stream</code>,  AWS::Cassandra::Table for <code>AWS::Cassandra::Table</code> Yes all string resource_vendor AWS Yes all string"},{"location":"bom/#bom_query_example_1","title":"BoM query example","text":"<pre><code>CxPolicy[result] {\n    document := input.document\n    bucket_resource := document[i].Resources[name]\n    bucket_resource.Type == \"AWS::S3::Bucket\"\n\n    info := get_resource_accessibility(bucket_resource, name)\n\n    bom_output = {\n        \"resource_type\": \"AWS::S3::Bucket\",\n        \"resource_name\": get_bucket_name(bucket_resource),\n        \"resource_accessibility\": info.accessibility,\n        \"resource_encryption\": cf_lib.get_encryption(bucket_resource),\n        \"resource_vendor\": \"AWS\",\n        \"resource_category\": \"Storage\",\n        \"acl\": get_bucket_acl(bucket_resource),\n    }\n\n    final_bom_output := common_lib.get_bom_output(bom_output, info.policy)\n\n    result := {\n        \"documentId\": input.document[i].id,\n        \"searchKey\": sprintf(\"Resources.%s\", [name]),\n        \"issueType\": \"BillOfMaterials\",\n        \"keyExpectedValue\": \"\",\n        \"keyActualValue\": \"\",\n        \"searchLine\": common_lib.build_search_line([\"Resources\", name], []),\n        \"value\": json.marshal(final_bom_output),\n    }\n}\n</code></pre>"},{"location":"bom/#results_1","title":"Results","text":"<p>Results will be found in the JSON output and placed separately under <code>bill_of_materials</code> key:</p> <pre><code>{ \n    // etc...\n    \"bill_of_materials\": [\n        {\n            \"query_name\": \"BOM - AWS S3 Buckets\",\n            \"query_id\": \"b5d6a2e0-8f15-4664-bd5b-68ec5c9bab83\",\n            \"query_url\": \"https://kics.io\",\n            \"severity\": \"TRACE\",\n            \"platform\": \"CloudFormation\",\n            \"cloud_provider\": \"AWS\",\n            \"category\": \"Bill Of Materials\",\n            \"description\": \"A list of S3 resources found. Amazon Simple Storage Service (Amazon S3) is an object storage service that offers industry-leading scalability, data availability, security, and performance.\",\n            \"description_id\": \"a46851fb\",\n            \"files\": [\n                {\n                    \"file_name\": \"positive2.json\",\n                    \"similarity_id\": \"a307e0f377932f42880de350fc69f83084aa8451a2e1e2a37cc97fc4eae7cf94\",\n                    \"line\": 5,\n                    \"issue_type\": \"BillOfMaterials\",\n                    \"search_key\": \"Resources.JenkinsArtifacts03\",\n                    \"search_line\": 0,\n                    \"search_value\": \"\",\n                    \"expected_value\": \"\",\n                    \"actual_value\": \"\",\n                    \"value\": \"{\\\"acl\\\":\\\"BucketOwnerFullControl\\\",\\\"resource_accessibility\\\":\\\"unknown\\\",\\\"resource_category\\\":\\\"Storage\\\",\\\"resource_encryption\\\":\\\"unencrypted\\\",\\\"resource_name\\\":\\\"jenkins-artifacts\\\",\\\"resource_type\\\":\\\"AWS::S3::Bucket\\\",\\\"resource_vendor\\\":\\\"AWS\\\"}\"\n                },\n                {\n                    \"file_name\": \"positive1.yaml\",\n                    \"similarity_id\": \"24a0036d2e94676f33c505c5cfd6686ef414072a14e576b08283e9a77596f7eb\",\n                    \"line\": 4,\n                    \"issue_type\": \"BillOfMaterials\",\n                    \"search_key\": \"Resources.MyBucket\",\n                    \"search_line\": 0,\n                    \"search_value\": \"\",\n                    \"expected_value\": \"\",\n                    \"actual_value\": \"\",\n                    \"value\": \"{\\\"acl\\\":\\\"BucketOwnerFullControl\\\",\\\"policy\\\":{\\\"Statement\\\":[{\\\"Action\\\":[\\\"s3:GetObject\\\"],\\\"Condition\\\":{\\\"StringLike\\\":{\\\"aws:Referer\\\":[\\\"http://www.example.com/*\\\",\\\"http://example.net/*\\\"]}},\\\"Effect\\\":\\\"Allow\\\",\\\"Principal\\\":\\\"*\\\",\\\"Resource\\\":[\\\"\\\",{\\\"playbooks\\\":[\\\"arn:aws:s3:::\\\",\\\"DOC-EXAMPLE-BUCKET\\\",\\\"/*\\\"]}]}],\\\"Version\\\":\\\"2012-10-17\\\"},\\\"resource_accessibility\\\":\\\"hasPolicy\\\",\\\"resource_category\\\":\\\"Storage\\\",\\\"resource_encryption\\\":\\\"encrypted\\\",\\\"resource_name\\\":\\\"jenkins-artifacts\\\",\\\"resource_type\\\":\\\"AWS::S3::Bucket\\\",\\\"resource_vendor\\\":\\\"AWS\\\"}\"\n                }\n            ]\n        }\n    ]\n}\n</code></pre>"},{"location":"certifications-cis/","title":"CIS Certifications","text":""},{"location":"certifications-cis/#about_cis","title":"About CIS","text":"<p>CIS is an independent, nonprofit organization with a mission to create confidence in the connected world.</p>"},{"location":"certifications-cis/#what_are_the_cis_benchmarks","title":"What are the CIS Benchmarks","text":"<p>CIS Benchmarks are best practices for the secure configuration of a target system. Available for more than 100 CIS Benchmarks across 25+ vendor product families, CIS Benchmarks are developed through a unique consensus-based process comprised of cybersecurity professionals and subject matter experts around the world. CIS Benchmarks are the only consensus-based, best-practice security configuration guides both developed and accepted by government, business, industry, and academia.</p>"},{"location":"certifications-cis/#kics_awarded_certifications","title":"KICS Awarded Certifications","text":"<p>KICS (from the version 1.4.4 to the latest) has been awarded the following certifications:  </p> <ul> <li>CIS Amazon Web Services Foundations Benchmark v1.4.0, Level 1  </li> <li>CIS Amazon Web Services Foundations Benchmark v1.4.0, Level 2  </li> </ul> <p>KICS (from the version 1.6.0 to the latest) has been awarded the following certifications:  </p> <ul> <li>CIS Kubernetes Benchmark v1.6.1, Level 1 - Master Node  </li> <li>CIS Kubernetes Benchmark v1.6.1, Level 1 - Worker Node  </li> <li>CIS Kubernetes Benchmark v1.6.1, Level 2 - Master Node  </li> <li>CIS Kubernetes Benchmark v1.6.1, Level 2 - Worker Node  </li> </ul>"},{"location":"certifications-cis/#what_are_the_level_1_level_2_certifications","title":"What are the Level 1, Level 2 certifications?","text":"<p>Most CIS Benchmarks include multiple configuration profiles. A profile definition describes the configurations assigned to benchmark recommendations.  The Level 1 profile is considered a base recommendation that can be implemented fairly promptly and is designed to not have an extensive performance impact. The intent of the Level 1 profile benchmark is to lower the attack surface of your organization while keeping machines usable and not hindering business functionality.  The Level 2 profile is considered to be \"defense in depth\" and is intended for environments where security is paramount. The recommendations associated with the Level 2 profile can have an adverse effect on your organization if not implemented appropriately or without due care.</p>"},{"location":"certifications-cis/#additional_info","title":"Additional Info","text":"<ul> <li>https://www.cisecurity.org/cis-benchmarks/cis-benchmarks-faq/</li> <li>https://www.cisecurity.org/partner/checkmarx/</li> </ul>"},{"location":"certifications/","title":"Certifications","text":""},{"location":"certifications/#certifications_overview","title":"Certifications Overview","text":"<p>Here you can find the list of certifications which were awarded to KICS</p> <p>KICS Certifications</p> <ul> <li>CIS Amazon Web Services Foundations Benchmark - Level 1</li> <li>CIS Amazon Web Services Foundations Benchmark - Level 2</li> <li>CIS Kubernetes Benchmark v1.6.1 - Level 1 - Master Node</li> <li>CIS Kubernetes Benchmark v1.6.1 - Level 1 - Worker Node</li> <li>CIS Kubernetes Benchmark v1.6.1 - Level 2 - Master Node</li> <li>CIS Kubernetes Benchmark v1.6.1 - Level 2 - Worker Node</li> <li>More soon...</li> </ul>"},{"location":"changes/","title":"Changes in v1.3.0","text":""},{"location":"changes/#breaking_changes","title":"Breaking Changes","text":"<ul> <li>KICS does not execute scan as default anymore</li> <li>Semantic exit code added based on scan results</li> </ul>"},{"location":"changes/#new_flags","title":"New Flags","text":"flag Description <code>timeout</code> number of seconds the query has to execute before being canceled (default 60) <code>profiling</code> enables performance profiler that prints resource consumption metrics in the logs during the execution (CPU, MEM) <code>fail-on</code> which kind of results should return an exit code different from 0 accepts: high, medium, low and info example: \"high,low\" (default [high,medium,low,info]) <code>ignore-on-exit</code> defines which kind of non-zero exits code should be ignored accepts: all, results, errors, none example: if 'results' is set, only engine errors will make KICS exit code different"},{"location":"changes/#updated_flags","title":"Updated Flags","text":"flag shorthand Description Change <code>path</code> <code>-p</code> paths or directories to scan <code>path</code> flag now accepts multiple values"},{"location":"changes/#kics_engine","title":"KICS Engine","text":""},{"location":"changes/#timeout_queries","title":"Timeout Queries","text":"<p>Query execution timeout is now parametrized, the flag <code>timeout</code> will override the default value (60 seconds)</p>"},{"location":"changes/#multiple_paths","title":"Multiple paths","text":"<p>KICS can now scan multiple paths (WARNING: For multiple paths, kics.config will not be loaded automatically, configuration flag must be explicitly used to load any configuration file.)</p>"},{"location":"changes/#concurrent_scans","title":"Concurrent Scans","text":"<p>For performance improvements, KICS will now run scans concurrently by parser.</p>"},{"location":"changes/#analyzer","title":"Analyzer","text":"<p>KICS will now do a pre-scan analysis to determine which type of queries and parsers to load. The analyzer will also exclude non Infrastructure as Code files. (WARNING: Using the <code>type</code> flag will disable the analyzer)</p>"},{"location":"changes1_6/","title":"Changes in v1.6.0","text":""},{"location":"changes1_6/#breaking_changes","title":"Breaking Changes","text":""},{"location":"changes1_6/#processing_gitignore_paths_assumed_for_kics_scan_exclusion","title":"Processing .gitignore \u2013 paths assumed for KICS scan exclusion","text":"<p>From v1.6, KICS will read .gitignore file in the root of the project to exclude from the scan the paths therein.</p> <p>How does this impact your scans?</p> <ul> <li>You will only be affected by this change in case you use KICS locally on your develop environment.<ul> <li>Notice that if you are using KICS on top of a repository (e.g., as part of a CI/CD pipeline) those paths already do not exist, so there will be no effect for those scenarios.</li> </ul> </li> <li>You\u2019ll notice an apparent loss of results: results identified in files under the .gitignore paths will no more be identified.</li> </ul> <p></p>"},{"location":"changes1_6/#consistency_between_scan_with_and_without_the_-t_flag","title":"Consistency between scan with and without the -t flag","text":"<p>-t or --type flag is used to instruct KICS to scan only files of specific technologies. </p> <p>Before v1.6, KICS with -t flag would scan the project and, in case there are no files of the specified technologies, it will terminate with a message \u201cNo files were scanned\u201d and no other output. </p> <p>From v1.6, KICS will keep its behavior consistent whether -t flag is used or not. Meaning: it will always output results file, even if it is an \u201cempty\u201d results report is created due to no files being scanned, as shown in the image below. </p> <p>How does this impact your scans? </p> <ul> <li>You will only be affected by this change in case you use KICS with flag -t/--type AND there are no files of the specified \u201ctype\u201d in the scanned project.</li> <li>If you rely on the message \u201cNo files were scanned\u201d for some post-scan action, this change will also affect you, because that message disappears now.</li> </ul> <p></p>"},{"location":"changes1_6/#masking_secrets_hide_secrets_from_results_when_kics_finds_them","title":"Masking Secrets \u2013 Hide secrets from results when KICS finds them","text":"<p>From v1.6, KICS will mask/hide identified secrets out of results reports, in order to avoid exposing them to undesirable report readers. </p> <p>How does this impact your scans?</p> <ul> <li>This is not likely to impact you in any way.</li> <li>Notice that results of secrets and passwords will appear in a slightly different, but more secure, fashion (see below an example of an HTML report)</li> </ul>"},{"location":"changes1_6/#deprecations_during_16x_so_far","title":"Deprecations during 1.6.x (so far)","text":"<p>During KICS 1.6.x versions we intend to deprecate some of our flags and keep using their default values.  They are the following: </p> <ul> <li>--minimal-ui</li> <li>--no-progress</li> <li>--preview-lines</li> <li>--no-color</li> </ul>"},{"location":"code-of-conduct/","title":"Contributor Covenant Code of Conduct","text":""},{"location":"code-of-conduct/#our_pledge","title":"Our Pledge","text":"<p>We as members, contributors, and leaders pledge to make participation in our community a harassment-free experience for everyone, regardless of age, body size, visible or invisible disability, ethnicity, sex characteristics, gender identity and expression, level of experience, education, socio-economic status, nationality, personal appearance, race, religion, or sexual identity and orientation.</p> <p>We pledge to act and interact in ways that contribute to an open, welcoming, diverse, inclusive, and healthy community.</p>"},{"location":"code-of-conduct/#our_standards","title":"Our Standards","text":"<p>Examples of behavior that contributes to a positive environment for our community include:</p> <ul> <li>Demonstrating empathy and kindness toward other people</li> <li>Being respectful of differing opinions, viewpoints, and experiences</li> <li>Giving and gracefully accepting constructive feedback</li> <li>Accepting responsibility and apologizing to those affected by our mistakes,   and learning from the experience</li> <li>Focusing on what is best not just for us as individuals, but for the   overall community</li> </ul> <p>Examples of unacceptable behavior include:</p> <ul> <li>The use of sexualized language or imagery, and sexual attention or   advances of any kind</li> <li>Trolling, insulting or derogatory comments, and personal or political attacks</li> <li>Public or private harassment</li> <li>Publishing others' private information, such as a physical or email   address, without their explicit permission</li> <li>Other conduct which could reasonably be considered inappropriate in a   professional setting</li> </ul>"},{"location":"code-of-conduct/#enforcement_responsibilities","title":"Enforcement Responsibilities","text":"<p>Community leaders are responsible for clarifying and enforcing our standards of acceptable behavior and will take appropriate and fair corrective action in response to any behavior that they deem inappropriate, threatening, offensive, or harmful.</p> <p>Community leaders have the right and responsibility to remove, edit, or reject comments, commits, code, wiki edits, issues, and other contributions that are not aligned to this Code of Conduct, and will communicate reasons for moderation decisions when appropriate.</p>"},{"location":"code-of-conduct/#scope","title":"Scope","text":"<p>This Code of Conduct applies within all community spaces, and also applies when an individual is officially representing the community in public spaces. Examples of representing our community include using an official e-mail address, posting via an official social media account, or acting as an appointed representative at an online or offline event.</p>"},{"location":"code-of-conduct/#enforcement","title":"Enforcement","text":"<p>Instances of abusive, harassing, or otherwise unacceptable behavior may be reported to the community leaders responsible for enforcement at kics@checkmarx.com. All complaints will be reviewed and investigated promptly and fairly.</p> <p>All community leaders are obligated to respect the privacy and security of the reporter of any incident.</p>"},{"location":"code-of-conduct/#enforcement_guidelines","title":"Enforcement Guidelines","text":"<p>Community leaders will follow these Community Impact Guidelines in determining the consequences for any action they deem in violation of this Code of Conduct:</p>"},{"location":"code-of-conduct/#1_correction","title":"1. Correction","text":"<p>Community Impact: Use of inappropriate language or other behavior deemed unprofessional or unwelcome in the community.</p> <p>Consequence: A private, written warning from community leaders, providing clarity around the nature of the violation and an explanation of why the behavior was inappropriate. A public apology may be requested.</p>"},{"location":"code-of-conduct/#2_warning","title":"2. Warning","text":"<p>Community Impact: A violation through a single incident or series of actions.</p> <p>Consequence: A warning with consequences for continued behavior. No interaction with the people involved, including unsolicited interaction with those enforcing the Code of Conduct, for a specified period of time. This includes avoiding interactions in community spaces as well as external channels like social media. Violating these terms may lead to a temporary or permanent ban.</p>"},{"location":"code-of-conduct/#3_temporary_ban","title":"3. Temporary Ban","text":"<p>Community Impact: A serious violation of community standards, including sustained inappropriate behavior.</p> <p>Consequence: A temporary ban from any sort of interaction or public communication with the community for a specified period of time. No public or private interaction with the people involved, including unsolicited interaction with those enforcing the Code of Conduct, is allowed during this period. Violating these terms may lead to a permanent ban.</p>"},{"location":"code-of-conduct/#4_permanent_ban","title":"4. Permanent Ban","text":"<p>Community Impact: Demonstrating a pattern of violation of community standards, including sustained inappropriate behavior,  harassment of an individual, or aggression toward or disparagement of classes of individuals.</p> <p>Consequence: A permanent ban from any sort of public interaction within the community.</p>"},{"location":"code-of-conduct/#attribution","title":"Attribution","text":"<p>This Code of Conduct is adapted from the Contributor Covenant, version 2.0, available at https://www.contributor-covenant.org/version/2/0/code_of_conduct.html.</p> <p>Community Impact Guidelines were inspired by  Mozilla's code of conduct enforcement ladder.</p> <p>For answers to common questions about this code of conduct, see the FAQ at https://www.contributor-covenant.org/faq. Translations are available  at https://www.contributor-covenant.org/translations.</p>"},{"location":"commands/","title":"KICS CLI","text":"<p>KICS is a command line tool, and should be used in a terminal. The next section describes the usage, the same help content is displayed when kics is provided with the <code>--help</code> flag.</p>"},{"location":"commands/#kics_command","title":"KICS Command","text":"<p>KICS has the following commands available:</p> <pre><code>Keeping Infrastructure as Code Secure\n\nUsage:\n  kics [command]\n\nAvailable Commands:\n  generate-id    Generates uuid for query\n  help           Help about any command\n  list-platforms List supported platforms\n  remediate      Auto remediates the project\n  scan           Executes a scan analysis\n  version        Displays the current version\n\nFlags:\n      --ci                  display only log messages to CLI output (mutually exclusive with silent)\n  -h, --help                help for kics\n  -f, --log-format string   determines log format (pretty,json) (default \"pretty\")\n      --log-level string    determines log level (TRACE,DEBUG,INFO,WARN,ERROR,FATAL) (default \"INFO\")\n      --log-path string     path to generate log file (info.log)\n      --no-color            disable CLI color output\n      --profiling string    enables performance profiler that prints resource consumption metrics in the logs during the execution (CPU, MEM)\n  -s, --silent              silence stdout messages (mutually exclusive with verbose and ci)\n  -v, --verbose             write logs to stdout too (mutually exclusive with silent)\n\nUse \"kics [command] --help\" for more information about a command.\n</code></pre>"},{"location":"commands/#scan_command_options","title":"Scan Command Options","text":"<pre><code>Executes a scan analysis\n\nUsage:\n  kics scan [flags]\n\nFlags:\n  -m, --bom                           include bill of materials (BoM) in results output\n      --cloud-provider strings        list of cloud providers to scan (alicloud, aws, azure, gcp)\n      --config string                 path to configuration file\n      --disable-full-descriptions     disable request for full descriptions and use default vulnerability descriptions\n      --disable-secrets               disable secrets scanning\n      --exclude-categories strings    exclude categories by providing its name\n                                      cannot be provided with query inclusion flags\n                                      can be provided multiple times or as a comma separated string\n                                      example: 'Access control,Best practices'\n      --exclude-gitignore             disables the exclusion of paths specified within .gitignore file                                \n  -e, --exclude-paths strings         exclude paths from scan\n                                      supports glob and can be provided multiple times or as a quoted comma separated string\n                                      example: './shouldNotScan/*,somefile.txt'\n      --exclude-queries strings       exclude queries by providing the query ID\n                                      cannot be provided with query inclusion flags\n                                      can be provided multiple times or as a comma separated string\n                                      example: 'e69890e6-fce5-461d-98ad-cb98318dfc96,4728cd65-a20c-49da-8b31-9c08b423e4db'\n  -x, --exclude-results strings       exclude results by providing the similarity ID of a result\n                                      can be provided multiple times or as a comma separated string\n                                      example: 'fec62a97d569662093dbb9739360942f...,31263s5696620s93dbb973d9360942fc2a...'\n      --exclude-severities strings    exclude results by providing the severity of a result\n                                      can be provided multiple times or as a comma separated string\n                                      example: 'info,low'\n                                      possible values: 'high, medium, low, info, trace'\n      --fail-on strings               which kind of results should return an exit code different from 0\n                                      accepts: high, medium, low and info\n                                      example: \"high,low\" (default [high,medium,low,info])\n  -h, --help                          help for scan\n      --ignore-on-exit string         defines which kind of non-zero exits code should be ignored\n                                      accepts: all, results, errors, none\n                                      example: if 'results' is set, only engine errors will make KICS exit code different from 0 (default \"none\")\n  -i, --include-queries strings       include queries by providing the query ID\n                                      cannot be provided with query exclusion flags\n                                      can be provided multiple times or as a comma separated string\n                                      example: 'e69890e6-fce5-461d-98ad-cb98318dfc96,4728cd65-a20c-49da-8b31-9c08b423e4db'\n      --input-data string             path to query input data files\n  -b, --libraries-path string         path to directory with libraries (default \"./assets/libraries\")\n      --minimal-ui                    simplified version of CLI output\n      --no-progress                   hides the progress bar\n      --output-name string            name used on report creations (default \"results\")\n  -o, --output-path string            directory path to store reports\n  -p, --path strings                  paths or directories to scan\n                                      example: \"./somepath,somefile.txt\"\n      --payload-lines                 adds line information inside the payload when printing the payload file\n  -d, --payload-path string           path to store internal representation JSON file\n      --preview-lines int             number of lines to be display in CLI results (min: 1, max: 30) (default 3)\n  -q, --queries-path strings          paths to directory with queries (default [./assets/queries])\n      --report-formats strings        formats in which the results will be exported (all, asff, codeclimate, csv, cyclonedx, glsast, html, json, junit, pdf, sarif, sonarqube) (default [json])\n  -r, --secrets-regexes-path string   path to secrets regex rules configuration file\n      --timeout int                   number of seconds the query has to execute before being canceled (default 60)\n  -t, --type strings                  case insensitive list of platform types to scan\n                                      (Ansible, AzureResourceManager, Buildah, CloudFormation, Crossplane, DockerCompose, Dockerfile, GRPC, GoogleDeploymentManager, Knative, Kubernetes, OpenAPI, Pulumi, ServerLessFW, Terraform)\n\nGlobal Flags:\n      --ci                  display only log messages to CLI output (mutually exclusive with silent)\n  -f, --log-format string   determines log format (pretty,json) (default \"pretty\")\n      --log-level string    determines log level (TRACE,DEBUG,INFO,WARN,ERROR,FATAL) (default \"INFO\")\n      --log-path string     path to generate log file (info.log)\n      --no-color            disable CLI color output\n      --profiling string    enables performance profiler that prints resource consumption metrics in the logs during the execution (CPU, MEM)\n  -s, --silent              silence stdout messages (mutually exclusive with verbose and ci)\n  -v, --verbose             write logs to stdout too (mutually exclusive with silent)\n</code></pre>"},{"location":"commands/#auto_remediate_command_options","title":"Auto Remediate Command Options","text":"<pre><code>Auto remediates the project\n\nUsage:\n  kics remediate [flags]\n\nFlags:\n  -h, --help                  help for remediate\n      --include-ids strings   which remediation (similarity ids) should be remediated \n                              example \"f6b7acac2d541d8c15c88d2be51b0e6abd576750b71c580f2e3a9346f7ed0e67,6af5fc5d7c0ad0077348a090f7c09949369d24d5608bbdbd14376a15de62afd1\" (default [all])\n      --results string        points to the JSON results file with remediation\n</code></pre> <p>The other commands have no further options.</p>"},{"location":"commands/#exclude_paths","title":"Exclude Paths","text":"<p>By default, KICS excludes paths specified in the .gitignore file in the root of the repository. To disable this behavior, use flag <code>--exclude-gitignore</code>.</p>"},{"location":"commands/#library_flag_usage","title":"Library Flag Usage","text":"<p>As mentioned above, the library flag (<code>-b</code> or <code>--libraries-path</code>) refers to the directory with libraries. The functions need to be grouped by platform and the library file name should follow the format: <code>&lt;platform&gt;.rego</code> to be loaded by KICS. It doesn't matter your directory structure. In other words, for example, if you want to indicate a directory that contains a library for your terraform queries, you should group your functions (used in your terraform queries) in a file named <code>terraform.rego</code> wherever you want.</p> <p>This will merge the custom libraries found on the flag's path with KICS's default libraries. Note that any functions declared in a custom library with the same signature as an existing function in the default libraries will cause the default library function to be overwritten by the custom definition provided.</p>"},{"location":"commands/#profiling","title":"Profiling","text":"<p>With the <code>--profiling</code> flag KICS will print resource consumption information in the logs.</p> <p>You can only enable one profiler at a time, CPU or MEM.</p> <p>\ud83d\udcdd Please note that execution time may be impacted by enabling performance profiler due to sampling</p>"},{"location":"commands/#disable_crash_report","title":"Disable Crash Report","text":"<p>You can disable KICS crash report to sentry.io with <code>DISABLE_CRASH_REPORT</code> environment variable set to <code>0</code> or <code>false</code> e.g:</p> <pre><code>DISABLE_CRASH_REPORT=0 ./bin/kics version\n# 'KICS crash report disabled' message should appear in the logs\n</code></pre>"},{"location":"community/","title":"Community","text":""},{"location":"community/#community_meetings","title":"Community Meetings","text":"<p>Our community meetings are held virtually on the first Thursday of every month at 15:00 UTC(+0) by Zoom.</p> <p>Upcoming meetings: - March 2nd, 2023 - April 6th, 2023</p> <p>You're welcome to join us.</p> <p>If want to see summary of previous meetings, have questions about them or want to add a topic to the agenda, you can join our community thread.</p>"},{"location":"community/#hacktoberfest","title":"Hacktoberfest","text":"<p>\"Hacktoberfest is a month-long celebration of open source projects, their maintainers, and the entire community of contributors. Each October, open source maintainers give new contributors extra attention as they guide developers through their first pull requests on GitHub.\"</p> <ul> <li>Open Issues for the event</li> </ul>"},{"location":"community/#contribution","title":"Contribution","text":"<p>KICS is a true community project. It's built as an open source from day one, and anyone can find his own way to contribute to the project. Check out how, within just minutes, you can start making a difference, by sharing your expertise with a community of thousands of security experts and software developers.</p>"},{"location":"community/#meet_us_at_conferences","title":"Meet us at conferences","text":"<ul> <li>AWS re:Invent 2021: AWS On Air (video)</li> <li>OWASP Bristol &amp; Suffolk Chapter - Meetup (video)</li> <li>OWASP Canberra Chapter - Meetup</li> <li>InfoSec City - Singapore 2021</li> <li>DevSecOps Singapore 2021</li> <li>Blackhat Europe 2021</li> <li>HashiTalks IL 2021 (video)</li> <li>Yalla DevOps 2021 (video)</li> <li>Geektime Code 2021</li> <li>DevSecCon24 2021 (video)</li> <li>GISEC Global 2021</li> <li>Blackhat ASIA 2021 (video)</li> </ul>"},{"location":"configuration-file/","title":"Configuration","text":""},{"location":"configuration-file/#configuration_file","title":"Configuration File","text":"<p>KICS allow you to provide all configurations either as command line arguments or as code. You can see all possible configurations in the CLI. You can disable scanning in certain parts of file using inline comments. More can be found in Running KICS section.</p> <p>KICS supports JSON, TOML, YAML, and HCL formats for the configuration files, and it is able to infer the formats without the need of file extension.</p> <p>\ud83d\udcdd \u00a0 flags that can receive multiple values can be either provided as a comma separated string or an array as in the example above</p>"},{"location":"configuration-file/#examples","title":"Examples","text":""},{"location":"configuration-file/#json","title":"JSON","text":"<pre><code>{\n  \"path\": \"assets/iac_samples\",\n  \"verbose\": true,\n  \"log-file\": true,\n  \"type\": \"Dockerfile,Kubernetes\",\n  \"queries-path\": \"assets/queries\",\n  \"exclude-paths\": [\n     \"foo/\",\n     \"bar/\",\n  ],\n  \"output-path\": \"results\"\n}\n</code></pre>"},{"location":"configuration-file/#yaml","title":"YAML","text":"<p>The same example now in YAML format passing <code>type</code> as an array of strings:</p> <pre><code>path: assets/iac_samples\nverbose: true\nlog-file: true\ntype:\n  - Dockerfile\n  - Kubernetes\nqueries-path: \"assets/queries\"\nexclude-paths:\n  - \"foo/\"\n  - \"bar/\"\noutput-path: \"results\"\n</code></pre>"},{"location":"configuration-file/#toml","title":"TOML","text":"<pre><code>path = \"assets/iac_samples\"\nverbose = true\nlog-file = true\ntype = \"Dockerfile,Kubernetes\"\nqueries-path = \"assets/queries\"\nexclude-paths = [ \"foo/\", \"bar/\" ]\noutput-path = \"results\"\n</code></pre>"},{"location":"configuration-file/#hcl","title":"HCL","text":"<pre><code>\"path\" = \"assets/iac_samples\"\n\"verbose\" = true\n\"log-file\" = true\n\"type\" = \"Dockerfile,Kubernetes\"\n\"queries-path\" = \"assets/queries\"\n\"exclude-paths\" = [\"foo/\", \"bar/\"]\n\"output-path\" = \"results\"\n</code></pre>"},{"location":"configuration-file/#how_to_use","title":"How to Use","text":"<p>You can enclose all your configurations in a file and use it in two different ways.</p>"},{"location":"configuration-file/#command_argument_file","title":"Command Argument File","text":"<ol> <li>Create a file with any name/any extension. For the sake of example, let's call it <code>kics-config.json</code></li> <li>Add the necessary configurations as shown in the templates section in any of the supported formats.</li> <li>Pass the configuration file as argument:</li> </ol> <pre><code>docker run -t -v {\u200b\u200b\u200b\u200bpath_to_kics_config}\u200b\u200b\u200b\u200b:/kics -v {path_to_host_folder_to_scan}:/path checkmarx/kics scan -p /path --config /kics/kics-config.json\n</code></pre>"},{"location":"configuration-file/#configuration_as_code","title":"Configuration as Code","text":"<ol> <li>Create a file named <code>kics.config</code> and place it in the root of your project repository.</li> <li>Add the necessary configurations as shown in the templates section in any of the supported formats.</li> <li>Invoke KICS without arguments (KICS will search for the specific file in the root)</li> </ol> <pre><code>docker run -t -v {path_to_host_folder_to_scan}:/path checkmarx/kics scan -p /path\n</code></pre> <p>Note: If more than one path is given, KICS will warn that <code>--config</code> must be used to explicit decide.</p>"},{"location":"configuration-file/#environment_variables","title":"Environment variables","text":"<p>KICS also accepts environment variables to fill flags values. To use it you just need to have the flag with a <code>KICS_</code> prefix. For example:</p> <ul> <li>To use path flag as environment variable, you should have <code>KICS_PATH</code> on your environment;</li> <li>To use multiple names variables, like <code>--output-path</code>, you should use it with <code>KICS_</code> and each word separated by <code>_</code>, e.g.: <code>KICS_OUTPUT_PATH</code></li> </ul>"},{"location":"configuration-file/#flags_precedence","title":"Flags precedence","text":"<p>KICS will use the following precende to fill flags:</p> <ul> <li>CLI flags</li> <li>Environment variables</li> <li>Configuration file</li> </ul>"},{"location":"creating-queries/","title":"Creating Queries","text":""},{"location":"creating-queries/#create_a_new_query","title":"Create a new Query","text":"<p>The queries are written in Rego and our internal parser transforms every IaC file that supports into a universal JSON format. This way anyone can start working on a query by picking up a small sample of the vulnerability that the query should target, and convert this sample, which can be a .tf or .yaml file, to our JSON structure JSON. To convert the sample you can run the following command:</p> <pre><code>go run ./cmd/console/main.go scan -p \"pathToTestData\" -d \"pathToGenerateJson\"\n</code></pre> <p>So for example, if we wanted to transform a .tf file in ./code/test we could type:</p> <pre><code>go run ./cmd/console/main.go scan -p  \"./src/test\" -d \"src/test/input.json\"\n</code></pre> <p>Example of input.json</p> <pre><code>{\n    \"document\": [\n        {\n            \"resource\": {\n                \"aws_cloudtrail\": {\n                    \"positive1\": {\n                        \"name\": \"npositive_1\",\n                        \"s3_bucket_name\": \"bucketlog_1\"\n                    }\n                }\n            },\n            \"id\": \"02926636-f2c1-46c3-93cc-c7dc2a79791f\",\n            \"file\": \"/assets/queries/terraform/aws/cloudtrail_multi_region_disabled/test/positive1.tf\"\n        },\n        {\n            \"resource\": {\n                \"aws_cloudtrail\": {\n                    \"positive2\": {\n                        \"name\": \"npositive_2\",\n                        \"s3_bucket_name\": \"bucketlog_2\",\n                        \"is_multi_region_trail\": false\n                    }\n                }\n            },\n            \"id\": \"4b27da84-4d38-4422-b2b5-fa85029dad2a\",\n            \"file\": \"assets/queries/terraform/aws/cloudtrail_multi_region_disabled/test/positive2.tf\"\n        }\n    ]\n}\n</code></pre> <p>After having the .json that will be our Rego input, we can begin to write queries. To test and debug there are two ways:</p> <ul> <li>Using Rego playground</li> <li>Install Open Policy Agent extension in VS Code and create a simple folder with a .rego file for the query and a input.json for the sample to test against</li> </ul>"},{"location":"creating-queries/#query_development_tutorial","title":"Query Development Tutorial","text":"<p>In the first instance, take a look at the query composition: - query.rego: Includes the policy and defines the result. The policy builds the pattern that breaks the security of the infrastructure code, which the query is looking for. The result defines the specific data used to present the vulnerability in the infrastructure code. - metadata.json: Each query has a metadata.json companion file with all the relevant information about the vulnerability, including the severity, category and its description; - test: Folder that contains at least one negative and positive case and a JSON file with data about the expected results.</p> <pre><code>- &lt;technology&gt;\n    |- &lt;provider&gt;\n    |   |- &lt;queryfolder&gt;\n    |   |   |- test\n    |   |   |   |- positive1&lt;.ext&gt;\n    |   |   |   |- positive2&lt;.ext&gt;\n    |   |   |   |- negative1&lt;.ext&gt;\n    |   |   |   |- negative2&lt;.ext&gt;\n    |   |   |   |- positive_expected_result.json\n    |   |   |- metadata.json\n    |   |   |- query.rego\n</code></pre> <p>Now, focus on the content of each file:</p> <p>\ud83d\udc68\u200d\ud83d\udcbb REGO File</p> <p>As a first step, it is important to be familiar with the libraries available (check them in <code>assets/libraries</code>) and the JSON structure (Rego input). Also, we need to study all the possible cases related to the vulnerability we want to verify before starting the implementation.</p> <p>For example, if we want to verify if the AWS CloudTrail has MultiRegion disabled in a Terraform sample, we need to focus on the attribute <code>is_multi_region_trail</code> of the resource <code>aws_cloudtrail</code>. Since this attribute is optional and false by default, we have two cases: (1) <code>is_multi_region_trail</code> is undefined and (2) <code>is_multi_region_trail</code> is set to false. Observe the following implementation as an example and check the Guidelines below.</p> <p>:rotating_light: Make sure you use <code>package Cx</code>. If you give another name, the query will not load. :rotating_light:</p> <pre><code>package Cx\n\nCxPolicy[result] {\n    cloudtrail := input.document[i].resource.aws_cloudtrail[name]\n    object.get(cloudtrail, \"is_multi_region_trail\", \"undefined\") == \"undefined\"\n\n    result := {\n        \"documentId\": input.document[i].id,\n        \"searchKey\": sprintf(\"aws_cloudtrail[%s]\", [name]),\n        \"issueType\": \"MissingAttribute\",\n        \"keyExpectedValue\": \"CloudTrail Multi Region should be defined\",\n        \"keyActualValue\": \"CloudTrail Multi Region is undefined\",\n    }\n}\n\nCxPolicy[result] {\n    cloudtrail := input.document[i].resource.aws_cloudtrail[name]\n    cloudtrail.is_multi_region_trail == false\n\n    result := {\n        \"documentId\": input.document[i].id,\n        \"searchKey\": sprintf(\"aws_cloudtrail[%s].is_multi_region_trail\", [name]),\n        \"issueType\": \"IncorrectValue\",\n        \"keyExpectedValue\": \"CloudTrail Multi Region should be set to true\",\n        \"keyActualValue\": \"CloudTrail Multi Region is set to false\",\n    }\n}\n</code></pre> <p>To test the query in the Rego playground, perform the following steps: 1. Enable Coverage (highlights which statements were evaluated); 2. In the input, paste the payload (explained above); 3. In the playground, paste and/or write the policies. Check if the statements are painted green; 4. Click on Evaluate; 5. In the output, check if the results are as expected.</p> <p></p> <p>\ud83d\udc68\u200d\ud83d\udcbb Metadata File</p> <p>Observe the following metadata.json example and check the Guidelines below for more detailed information.</p> <pre><code>{\n  \"id\": \"8173d5eb-96b5-4aa6-a71b-ecfa153c123d\",\n  \"queryName\": \"CloudTrail Multi Region Disabled\",\n  \"severity\": \"MEDIUM\",\n  \"category\": \"Observability\",\n  \"descriptionText\": \"CloudTrail should have 'is_multi_region_trail' and 'include_global_service_events' enabled\",\n  \"descriptionUrl\": \"https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudtrail#is_multi_region_trail\",\n  \"platform\": \"Terraform\",\n  \"descriptionID\": \"feb82a62\",\n  \"cloudProvider\": \"aws\"\n}\n</code></pre> <p>\ud83d\udc68\u200d\ud83d\udcbb Data File</p> <p>This file contains a map, with string keys, which will have default values for keys that can be overwritten as described on allowing users to overwrite query data section and using custom input data section of Running KICS</p> <p>\ud83d\udc68\u200d\ud83d\udcbb Test Folder</p> <p>Keep in mind that all the positive and negative files should contain only one breaking point case. This way, the results are more clear. As a best practice, the test folder should contain all the extensions available by the platform.</p> <p>Each positive case should present a breaking point of the vulnerability. Continuing with the example, we should display two positive files: one without the <code>is_multi_region_trail</code> defined (positive1.tf) and another with the <code>is_multi_region_trail</code> set to false (positive2.tf).</p> <p>positive1.tf</p> <pre><code>resource \"aws_cloudtrail\" \"positive1\" {\n  name                          = \"npositive_1\"\n  s3_bucket_name                = \"bucketlog_1\"\n}\n</code></pre> <p>positive2.tf</p> <pre><code>resource \"aws_cloudtrail\" \"positive2\" {\n  name                          = \"npositive_2\"\n  s3_bucket_name                = \"bucketlog_2\"\n  is_multi_region_trail         = false\n}\n</code></pre> <p>Each negative case should present the remediation/best practice (a sample with the <code>is_multi_region_trail</code> set to true).</p> <p>negative1.tf</p> <pre><code>resource \"aws_cloudtrail\" \"negative1\" {\n  name                          = \"negative\"\n  s3_bucket_name                = \"bucketlog\"\n  is_multi_region_trail         = true\n}\n</code></pre> <p>The positive expected result should present where the positive(s) file(s) break(s) the vulnerability (in line 2 (positive1.tf) and line 4 (positive2.tf)).</p> <pre><code>[\n  {\n    \"queryName\": \"CloudTrail Multi Region Disabled\",\n    \"severity\": \"MEDIUM\",\n    \"line\": 2,\n    \"fileName\": \"positive1.tf\"\n  },\n  {\n    \"queryName\": \"CloudTrail Multi Region Disabled\",\n    \"severity\": \"MEDIUM\",\n    \"line\": 4,\n    \"fileName\": \"positive2.tf\"\n  }\n]\n</code></pre>"},{"location":"creating-queries/#testing","title":"Testing","text":"<p>For a query to be considered complete, it must be compliant with at least one positive and one negative test case. To run the unit tests you can run this command:</p> <pre><code>make test\n</code></pre> <p>Check if the new test was added correctly and if all tests are passing locally. If succeeds, a Pull Request can now be created.</p>"},{"location":"creating-queries/#guidelines","title":"Guidelines","text":"<p>Filling metadata.json:</p> <ul> <li><code>id</code> should be filled with a UUID. You can use the built-in command to generate this:</li> </ul> <pre><code>go run ./cmd/console/main.go generate-id\n</code></pre> <ul> <li><code>queryName</code> describes the name of the vulnerability</li> <li><code>severity</code> can be filled with <code>HIGH</code>, <code>MEDIUM</code>, <code>LOW</code> or <code>INFO</code></li> <li><code>category</code> pick one of the following:<ul> <li>Access Control</li> <li>Availability</li> <li>Backup</li> <li>Best Practices</li> <li>Build Process</li> <li>Encryption</li> <li>Insecure Configurations</li> <li>Insecure Defaults</li> <li>Networking and Firewall</li> <li>Observability</li> <li>Resource Management</li> <li>Secret Management</li> <li>Supply-Chain</li> </ul> </li> <li><code>descriptionText</code> should explain with detail the vulnerability and if possible provide a way to remediate</li> <li><code>descriptionUrl</code> points to the official documentation about the resource being targeted</li> <li><code>platform</code> query target platform (e.g. Terraform, Kubernetes, etc.)</li> <li><code>descriptionID</code> should be filled with the first eight characters of the <code>go run ./cmd/console/main.go generate-id</code> output</li> <li><code>cloudProvider</code> should specify the target cloud provider, when necessary (e.g. AWS, AZURE, GCP, etc.)</li> <li><code>aggregation</code> [optional] should be used when more than one query is implemented in the same query.rego file. Indicates how many queries are implemented</li> <li><code>override</code> [optional] should only be used when a <code>metadata.json</code> is shared between queries from different platforms or different specification versions like for example OpenAPI 2.0 (Swagger) and OpenAPI 3.0. This field defines an object that each field is mapped to a given <code>overrideKey</code> that should be provided from the query execution result (covered in the next section), if an <code>overrideKey</code> is provided, this will generate a new query that inherits the root level metadata values and only rewrites the fields defined inside this object.</li> </ul> <p>If the query.rego file implements more than one query, the metadata.json should indicate how many are implemented (through <code>aggregation</code>). That can be necessary due to two cases: 1. It implements more than one query in the same query.rego for the same platform</p> <pre><code>{\n  \"id\": \"0ac9abbc-6d7a-41cf-af23-2e57ddb3dbfc\",\n  \"queryName\": \"Sensitive Port Is Exposed To Entire Network\",\n  \"severity\": \"HIGH\",\n  \"category\": \"Networking and Firewall\",\n  \"descriptionText\": \"A sensitive port, such as port 23 or port 110, is open for the whole network in either TCP or UDP protocol\",\n  \"descriptionUrl\": \"https://docs.ansible.com/ansible/latest/collections/azure/azcollection/azure_rm_securitygroup_module.html#parameter-rules\",\n  \"platform\": \"Ansible\",\n  \"descriptionID\": \"33745204\",\n  \"cloudProvider\": \"azure\",\n  \"aggregation\": 62\n}\n</code></pre> <ol> <li>It implements the same query for different platforms in the same query.rego, the metadata bellow defines the query metadata for both OpenAPI 2.0 and 3.0 in the same file:</li> </ol> <pre><code>{\n  \"id\": \"332cf2ad-380d-4b90-b436-46f8e635cf38\",\n  \"queryName\": \"Invalid Contact URL (v3)\",\n  \"severity\": \"INFO\",\n  \"category\": \"Best Practices\",\n  \"descriptionText\": \"Contact Object URL should be a valid URL\",\n  \"descriptionUrl\": \"https://swagger.io/specification/#contact-object\",\n  \"platform\": \"OpenAPI\",\n  \"override\": {\n    \"2.0\": {\n      \"id\": \"c7000383-16d0-4509-8cd3-585e5ea2e2f2\",\n      \"queryName\": \"Invalid Contact URL (v2)\",\n      \"descriptionUrl\": \"https://swagger.io/specification/v2/#contactObject\"\n    }\n  },\n  \"aggregation\": 2,\n  \"descriptionID\": \"f3097573\"\n}\n</code></pre> <p>Filling query.rego:</p> <ul> <li><code>documentId</code> id of the sample where the vulnerability occurs</li> <li> <p><code>searchKey</code> uses Levenshtein distance to go through the original document. It should \u201cinclude\u201d as much information as possible so that the result is as accurate as possible. </p> <p>Note the following special chars: - '='    -&gt; value - '.'    -&gt; break line - '{{ }}' -&gt; ignore special chars - '[ ]'   -&gt; same line</p> <p>As an example, take a look at the following sample:</p> <p></p> <p>If we want to point to the field 'Name' set as 'My.bucket' of 'tags', the searchKey should be set to <code>resource[positive].tags.Name={{My.bucket}}</code></p> </li> <li> <p><code>issueType</code> pick one of the following:</p> <ul> <li>IncorrectValue</li> <li>MissingAttribute</li> <li>RedundantAttribute</li> </ul> </li> <li><code>keyExpectedValue</code> should explain the expected value</li> <li><code>keyActualValue</code>   should explain the actual value detected</li> <li><code>overrideKey</code> [optional] should be used when the query can be applied to more than one platform (for now, it is used for both OpenAPI 3.0 and Swagger)</li> </ul> <p>For example, the query <code>Invalid Contact URL</code> can be implemented in both OpenAPI 3.0 and Swagger since both versions share the same properties:</p> <pre><code>package Cx\n\nimport data.generic.openapi as openapi_lib\n\nCxPolicy[result] {\n    doc := input.document[i]\n    version := openapi_lib.check_openapi(doc)\n    version != \"undefined\"\n\n    not openapi_lib.is_valid_url(doc.info.contact.url)\n\n    result := {\n        \"documentId\": doc.id,\n        \"searchKey\": \"info.contact.url\",\n        \"issueType\": \"IncorrectValue\",\n        \"keyExpectedValue\": \"info.contact.url has a valid URL\",\n        \"keyActualValue\": \"info.contact.url has an invalid URL\",\n        \"overrideKey\": version,\n    }\n}\n</code></pre> <ul> <li><code>searchValue</code> [optional] should be used when the query returns more than one result for the same line</li> <li><code>searchLine</code> [optional] path where the breaking point occurs in the sample</li> </ul> <p>For example, the query Sensitive Port Is Exposed To Entire Network can return more than one result in the same line (the ingress covers a range of ports). To avoid it, the searchValue should be used.</p> <pre><code>package Cx\n\nimport data.generic.terraform as terraLib\nimport data.generic.common as commonLib\n\nCxPolicy[result] {\n    resource := input.document[i].resource.aws_security_group[name]\n\n    portContent := commonLib.tcpPortsMap[port]\n    portNumber = port\n    portName = portContent\n    protocol := terraLib.getProtocolList(resource.ingress.protocol)[_]\n\n    endswith(resource.ingress.cidr_blocks[_], \"/0\")\n    terraLib.containsPort(resource.ingress, portNumber)\n    isTCPorUDP(protocol)\n\n    result := {\n        \"documentId\": input.document[i].id,\n        \"searchKey\": sprintf(\"aws_security_group[%s].ingress\", [name]),\n        \"searchValue\": sprintf(\"%s,%d\", [protocol, portNumber]),\n        \"issueType\": \"IncorrectValue\",\n        \"keyExpectedValue\": sprintf(\"%s (%s:%d) should not be allowed\", [portName, protocol, portNumber]),\n        \"keyActualValue\": sprintf(\"%s (%s:%d) is allowed\", [portName, protocol, portNumber]),\n    }\n}\n\nisTCPorUDP(\"TCP\") = true\nisTCPorUDP(\"UDP\") = true\n</code></pre>"},{"location":"creating-queries/#search_line","title":"Search Line","text":"<p>To improve the KICS line detection mechanism, <code>searchLine</code> was introduced.</p> <p>SearchLine uses json path to get the correct line information from the payload (which can be seen with the flag <code>payload-lines</code>).</p> <p>Original Content:</p> <pre><code>father:\n  name: son\n</code></pre> <p>Payload With Line Information:</p> <pre><code>{\n    \"_kics_lines\": {\n        \"_kics__default\": {\n            \"_kics_line\": 0\n        },\n        \"_kics_father\": {\n            \"_kics_line\": 2\n        }\n    },\n    \"father\": {\n        \"_kics_lines\": {\n            \"_kics__default\": {\n                \"_kics_line\": 2\n            },\n            \"_kics_name\": {\n                \"_kics_line\": 3\n            }\n        },\n        \"name\": \"son\"\n    }\n},\n</code></pre> <p>Usage:</p> <pre><code>import data.generic.common as commonLib\n\nresult := {\n        \"documentId\": doc.id,\n        \"searchKey\": \"father.son\",\n        \"issueType\": \"IncorrectValue\",\n        \"searchLine\": commonLib.build_search_line([\"father\", \"son\"], []),\n    }\n</code></pre> <p>Function <code>build_search_line(path, obj)</code>:</p> <p>The function <code>build_search_line</code> is a helper that builds the searchLine for the engine to create and use the json path. It take two arguments:</p> <ul> <li> <p>path: An array containing the path elements (keys and indexes) to the desired key line.. (ex: [\"father\", \"son\"]; [\"father\", 1, \"son\"]; [\"father\", \"son\", 0])</p> </li> <li> <p>obj: For queries that use the function <code>walk</code> in rego, where the caller is given a path that should be placed in the <code>path</code> argument of <code>build_search_line</code>, the remaining path not present should be placed in obj. Obj can also be used in other queries that don't make use of the function <code>walk</code>, otherwise it should be passed empty. (ex: [\"son\"],[\"son\", 0])</p> </li> </ul> <p>Examples:</p> <pre><code>    build_search_line([\"father\"], [\"son\"])\n</code></pre> <pre><code>    build_search_line([\"father\", \"son\"], [])\n</code></pre> <pre><code>    build_search_line([\"father\", \"son\"], [\"grandson\", 1])\n</code></pre> <pre><code>    [path, value] := walk(x)\n    son := value.son\n    son == false\n    build_search_line(path, [\"son\"])\n</code></pre>"},{"location":"creating-queries/#allowing_users_to_overwrite_query_data","title":"Allowing users to overwrite query data","text":"<p>Starting on v1.3.5, KICS started to support custom data overwriting on queries. This can be useful if users want to provide their own dataset or if users have different datasets for multiple environments. This can be supported easily following some steps:</p> <ol> <li>Create a <code>data.json</code> file on the same level as <code>query.rego</code>;</li> <li>Define ALL keys that can be overwritten with their default value;</li> <li>On <code>query.rego</code> file, use <code>data.&lt;key_on_data_json_file&gt;</code> to access the value of this key;</li> </ol> <p>With these simple steps, users will be able to overwrite the keys they want, elsewhere will use the default value.</p>"},{"location":"creating-queries/#query_dependencies","title":"Query Dependencies","text":"<p>If you want to use the functions defined in your own library, you should use the flag <code>-b</code> to indicate the directory where the libraries are placed. The functions need to be grouped by platform and the library name should follow the following format: <code>&lt;platform&gt;.rego</code>. It doesn't matter your directory structure. In other words, for example, if you want to indicate a directory that contains a library for your terraform queries, you should group your functions (used in your terraform queries) in a file named <code>terraform.rego</code> wherever you want.</p>"},{"location":"dockerhub/","title":"Dockerhub","text":""},{"location":"dockerhub/#documentation","title":"Documentation","text":"<p>Visit us</p> <p>https://docs.kics.io</p>"},{"location":"dockerhub/#git_repo","title":"Git Repo","text":"<p>https://github.com/Checkmarx/kics</p>"},{"location":"dockerhub/#command","title":"Command","text":"<p>To scan a directory/file on your host you have to mount it as a volume to the container and specify the path on the container filesystem with the <code>-p</code> KICS parameter (see the full list of CLI options below)</p> <p>NOTE: from v1.3.0 KICS does not execute <code>scan</code> command by default anymore.</p> <pre><code>docker pull checkmarx/kics:latest\n</code></pre> <p>Scan a directory</p> <pre><code>docker run -t -v {path_to_host_folder_to_scan}:/path checkmarx/kics:latest scan -p /path -o \"/path/\"\n</code></pre> <p>Scan a single file</p> <pre><code>docker run -t -v {path_to_host_folder}:/path checkmarx/kics:latest scan -p /path/{filename}.{extention} -o \"/path/\"\n</code></pre> <p>This will generate a <code>results.json</code> file, for both examples, under <code>path</code>.</p> <p>\u2139\ufe0f UBI Based Images</p> <p>When using UBI8 based image, the KICS process will run under the <code>kics</code> user and <code>kics</code> group with default UID=1000 and GID=1000, when using bind mount to share host files with the container, the UID and GID can be overriden to match current user with the <code>-u</code> flag that overrides the username:group or UID:GID. e.g:</p> <pre><code>docker run -it -u $UID:$GID -v $PWD:/path checkmarx/kics:ubi8 scan -p /path/assets/queries/dockerfile -o /path -v\n</code></pre> <p>Another option is rebuilding the dockerfile providing build arguments e.g: <code>--build-arg UID=999 --build-arg GID=999 --build-arg KUSER=myuser --build-arg KUSER=mygroup</code></p>"},{"location":"dockerhub/#cli_options","title":"CLI Options","text":"<p>Usage:</p> <pre><code>Executes a kics analysis\n\nUsage:\n  kics [command]\n\nAvailable Commands:\n  generate-id    Generates uuid for query\n  help           Help about any command\n  list-platforms List supported platforms\n  remediate      Auto remediates the project\n  scan           Executes a scan analysis\n  version        Displays the current version\n</code></pre> <pre><code>Auto remediates the project\n\nUsage:\n  kics remediate [flags]\n\nFlags:\n  -h, --help                  help for remediate\n      --include-ids strings   which remediation (similarity ids) should be remediated \n                              example \"f6b7acac2d541d8c15c88d2be51b0e6abd576750b71c580f2e3a9346f7ed0e67,6af5fc5d7c0ad0077348a090f7c09949369d24d5608bbdbd14376a15de62afd1\" (default [all])\n      --results string        points to the JSON results file with remediation\n</code></pre> <pre><code>Executes a scan analysis\n\nUsage:\n  kics scan [flags]\n\nFlags:\n  -m, --bom                           include bill of materials (BoM) in results output\n      --cloud-provider strings        list of cloud providers to scan (alicloud, aws, azure, gcp)\n      --config string                 path to configuration file\n      --disable-full-descriptions     disable request for full descriptions and use default vulnerability descriptions\n      --disable-secrets               disable secrets scanning\n      --exclude-categories strings    exclude categories by providing its name\n                                      cannot be provided with query inclusion flags\n                                      can be provided multiple times or as a comma separated string\n                                      example: 'Access control,Best practices'\n      --exclude-gitignore             disables the exclusion of paths specified within .gitignore file\n  -e, --exclude-paths strings         exclude paths from scan\n                                      supports glob and can be provided multiple times or as a quoted comma separated string\n                                      example: './shouldNotScan/*,somefile.txt'\n      --exclude-queries strings       exclude queries by providing the query ID\n                                      cannot be provided with query inclusion flags\n                                      can be provided multiple times or as a comma separated string\n                                      example: 'e69890e6-fce5-461d-98ad-cb98318dfc96,4728cd65-a20c-49da-8b31-9c08b423e4db'\n  -x, --exclude-results strings       exclude results by providing the similarity ID of a result\n                                      can be provided multiple times or as a comma separated string\n                                      example: 'fec62a97d569662093dbb9739360942f...,31263s5696620s93dbb973d9360942fc2a...'\n      --exclude-severities strings    exclude results by providing the severity of a result\n                                      can be provided multiple times or as a comma separated string\n                                      example: 'info,low'\n      --fail-on strings               which kind of results should return an exit code different from 0\n                                      accepts: high, medium, low and info\n                                      example: \"high,low\" (default [high,medium,low,info])\n  -h, --help                          help for scan\n      --ignore-on-exit string         defines which kind of non-zero exits code should be ignored\n                                      accepts: all, results, errors, none\n                                      example: if 'results' is set, only engine errors will make KICS exit code different from 0 (default \"none\")\n  -i, --include-queries strings       include queries by providing the query ID\n                                      cannot be provided with query exclusion flags\n                                      can be provided multiple times or as a comma separated string\n                                      example: 'e69890e6-fce5-461d-98ad-cb98318dfc96,4728cd65-a20c-49da-8b31-9c08b423e4db'\n      --input-data string             path to query input data files\n  -b, --libraries-path string         path to directory with libraries (default \"./assets/libraries\")\n      --minimal-ui                    simplified version of CLI output\n      --no-progress                   hides the progress bar\n      --output-name string            name used on report creations (default \"results\")\n  -o, --output-path string            directory path to store reports\n  -p, --path strings                  paths or directories to scan\n                                      example: \"./somepath,somefile.txt\"\n      --payload-lines                 adds line information inside the payload when printing the payload file\n  -d, --payload-path string           path to store internal representation JSON file\n      --preview-lines int             number of lines to be display in CLI results (min: 1, max: 30) (default 3)\n  -q, --queries-path strings          paths to directory with queries (default [./assets/queries])\n      --report-formats strings        formats in which the results will be exported (all, asff, codeclimate, csv, cyclonedx, glsast, html, json, junit, pdf, sarif, sonarqube) (default [json])\n  -r, --secrets-regexes-path string   path to secrets regex rules configuration file\n      --timeout int                   number of seconds the query has to execute before being canceled (default 60)\n  -t, --type strings                  case insensitive list of platform types to scan\n                                      (Ansible, AzureResourceManager, Buildah, CloudFormation, Crossplane, DockerCompose, Dockerfile, GRPC, GoogleDeploymentManager, Knative, Kubernetes, OpenAPI, Pulumi, ServerLessFW, Terraform)\n</code></pre> <pre><code>Global Flags:\n      --ci                  display only log messages to CLI output (mutually exclusive with silent)\n  -f, --log-format string   determines log format (pretty,json) (default \"pretty\")\n      --log-level string    determines log level (TRACE,DEBUG,INFO,WARN,ERROR,FATAL) (default \"INFO\")\n      --log-path string     path to generate log file (info.log)\n      --no-color            disable CLI color output\n      --profiling string    enables performance profiler that prints resource consumption metrics in the logs during the execution (CPU, MEM)\n  -s, --silent              silence stdout messages (mutually exclusive with verbose and ci)\n  -v, --verbose             write logs to stdout too (mutually exclusive with silent)\n</code></pre>"},{"location":"documentation/","title":"Installation","text":""},{"location":"documentation/#installation","title":"Installation","text":"<p>There are multiple ways to get KICS up and running:</p>"},{"location":"documentation/#docker","title":"Docker","text":"<p>KICS is available as a Docker image and can be used as follows:</p> <p>To scan a directory/file on your host you have to mount it as a volume to the container and specify the path on the container filesystem with the -p KICS parameter (see Scan Command Options section below)</p> <pre><code>docker pull checkmarx/kics:latest\ndocker run -t -v \"{path_to_host_folder_to_scan}\":/path checkmarx/kics scan -p /path -o \"/path/\"\n</code></pre> <p>You can see the list of available tags in dockerhub</p> <p>\u2139\ufe0f UBI Based Images</p> <p>When using UBI8 based image, the KICS process will run under the <code>kics</code> user and <code>kics</code> group with default UID=1000 and GID=1000, when using bind mount to share host files with the container, the UID and GID can be overriden to match current user with the <code>-u</code> flag that overrides the username:group or UID:GID. e.g:</p> <pre><code>docker run -it -u $UID:$GID -v $PWD:/path checkmarx/kics:ubi8 scan -p /path/assets/queries/dockerfile -o /path -v\n</code></pre> <p>Another option is rebuilding the dockerfile providing build arguments e.g: <code>--build-arg UID=999 --build-arg GID=999 --build-arg KUSER=myuser --build-arg KUSER=mygroup</code></p>"},{"location":"documentation/#build_from_sources","title":"Build from Sources","text":"<ol> <li>Download and install Go 1.16 or higher from https://golang.org/dl/.</li> <li>Clone the repository:     <code>sh     git clone https://github.com/Checkmarx/kics.git</code></li> <li> <p>Build the binaries:     <code>sh     cd kics     go mod vendor     make build</code></p> <p>or </p> <p><code>sh cd kics go mod vendor LINUX/MAC: go build -o ./bin/kics cmd/console/main.go WINDOWS: go build -o ./bin/kics.exe cmd/console/main.go (make sure to create the bin folder)</code> 4. Kick a scan! <code>sh ./bin/kics scan -p '&lt;path-of-your-project-to-scan&gt;' --report-formats json -o ./results</code></p> </li> </ol>"},{"location":"documentation/#deprecated_homebrew","title":"[Deprecated] Homebrew","text":"<p>KICS is available on Checkmarx homebrew-tap only for versions until 1.5.1. It can be used as follows:</p> <pre><code>brew install Checkmarx/tap/kics\n</code></pre> <p>To use KICS default queries add the KICS_QUERIES_PATH environmental variable to your shell profile, e.g:</p> <pre><code>echo 'export KICS_QUERIES_PATH=/usr/local/opt/kics/share/kics/assets/queries' &gt;&gt; ~/.zshrc\n</code></pre>"},{"location":"documentation/#custom_queries","title":"Custom Queries","text":"<p>You can provide your own path to the queries directory with <code>-q</code> CLI option (see CLI Options section below), otherwise the default directory will be used The default ./assets/queries is built-in in the image. You can use this to provide a path to your own custom queries. Check create a new query guide to learn how to define your own queries.</p>"},{"location":"documentation/#password_and_secrets","title":"Password and Secrets","text":"<p>Since the Password and Secrets mechanism uses generic regexes, we advise you to tweak the rules of the secret to your context. Please, see the Password and Secrets documentation to know how you can use your own rules.</p> <p>Note: KICS does not execute scan by default as of version 1.3.0.</p> <p>Note: KICS deprecated the availability of binaries in the GitHub releases assets as of version 1.5.2, it is advised to update all systems (pipelines, integrations, etc.) to use the KICS Docker Images.</p>"},{"location":"documentation/#next_steps","title":"Next Steps","text":"<ul> <li>Understand how to configure KICS so you can have a better KICS experience.</li> <li>Explore KICS commands to see what you can do with KICS.</li> <li>Explore supported platforms to see which files you can scan with KICS.</li> <li>Explore the queries internals for better understanding how KICS works.</li> <li>Create a new query to learn how to create your own custom queries.</li> <li>Explore the output results format and quickly fix the issues detected.</li> <li>Contribute if you want to go the extra mile.</li> </ul>"},{"location":"environment_variables_list/","title":"Environment variables list","text":""},{"location":"environment_variables_list/#environment_variables_list","title":"Environment Variables List","text":"<p>This document lists all the environment variables that can be used in KICS grouped by their purpose.</p>"},{"location":"environment_variables_list/#environment_variables_to_fill_flags_values","title":"Environment Variables to fill flags values","text":"<ul> <li><code>KICS_&lt;target_flag&gt;</code></li> </ul>"},{"location":"environment_variables_list/#terraformer_aws","title":"Terraformer AWS","text":"<ul> <li><code>AWS_ACCESS_KEY_ID</code></li> <li><code>AWS_SECRET_ACCESS_KEY</code></li> <li><code>AWS_SESSION_TOKEN</code></li> </ul>"},{"location":"environment_variables_list/#terraformer_azure","title":"Terraformer AZURE","text":"<ul> <li><code>ARM_SUBSCRIPTION_ID</code></li> <li><code>ARM_CLIENT_ID</code></li> <li><code>ARM_CLIENT_CERTIFICATE_PATH</code></li> <li><code>ARM_CLIENT_CERTIFICATE_PASSWORD</code></li> <li><code>ARM_TENANT_ID</code></li> </ul>"},{"location":"environment_variables_list/#terraformer_gcp","title":"Terraformer GCP","text":"<ul> <li><code>GOOGLE_APPLICATION_CREDENTIALS</code></li> </ul>"},{"location":"environment_variables_list/#asff_report","title":"ASFF report","text":"<ul> <li><code>AWS_ACCOUNT_ID</code></li> <li><code>AWS_REGION</code></li> </ul>"},{"location":"environment_variables_list/#decrypt_ansible_vaults_on_the_fly","title":"Decrypt Ansible Vaults on the fly","text":"<ul> <li><code>ANSIBLE_VAULT_PASSWORD_FILE</code></li> </ul>"},{"location":"environment_variables_list/#proxy_configurations","title":"Proxy configurations","text":"<ul> <li><code>HTTP_PROXY</code></li> <li><code>HTTPS_PROXY</code></li> <li><code>NO_PROXY</code></li> </ul>"},{"location":"environment_variables_list/#disable_crash_report","title":"Disable Crash Report","text":"<ul> <li><code>DISABLE_CRASH_REPORT</code></li> </ul>"},{"location":"flags/","title":"Flags","text":""},{"location":"flags/#flags","title":"Flags","text":"<p>KICS scan flags are defined on <code>kics-flags.json</code> and <code>scan-flags.json</code>, that can be found on <code>console/assets</code> directory.</p> <p>The structure of a flag on JSON definition should use the following structure:</p> <pre><code>{\n    \"flagName\": {\n        \"flagType\": \"&lt;multiStr|str|bool|int&gt;The type of the flag\",\n        \"shorthandFlag\": \"&lt;optional&gt;Shorthand for the flag, MUST be one character only\",\n        \"defaultValue\": \"The default value of the flag, MUST be string or null\",\n        \"usage\": \"Usage description of the flag, can use variables, which is described bellow\"\n    }\n}\n</code></pre> <p>Example of a valid <code>flags.json</code> file:</p> <pre><code>{\n    \"no-progress\": {\n        \"flagType\": \"bool\",\n        \"shorthandFlag\": \"\",\n        \"defaultValue\": \"false\",\n        \"usage\": \"hides the progress bar\"\n    },\n    \"output-path\": {\n        \"flagType\": \"str\",\n        \"shorthandFlag\": \"o\",\n        \"defaultValue\": \"\",\n        \"usage\": \"directory path to store reports\"\n    },\n    \"type\": {\n        \"flagType\": \"multiStr\",\n        \"shorthandFlag\": \"t\",\n        \"defaultValue\": \"\",\n        \"usage\": \"case insensitive list of platform types to scan\\n(${supportedPlatforms})\"\n    }\n}\n</code></pre>"},{"location":"flags/#hidden_and_deprecated_flags","title":"Hidden and Deprecated Flags","text":"<p>To mark a flag as hidden use the following configuration:</p> <pre><code>{\n  \"disable-cis-descriptions\": {\n    \"flagType\": \"bool\",\n    \"shorthandFlag\": \"\",\n    \"defaultValue\": \"false\",\n    \"usage\": \"disable request for full descriptions and use default vulnerability descriptions\",\n    \"hidden\": true\n  }\n}\n</code></pre> <p>If you also want to display a flag deprecation warning you can define it like this:</p> <pre><code>{\n  \"disable-cis-descriptions\": {\n    \"flagType\": \"bool\",\n    \"shorthandFlag\": \"\",\n    \"defaultValue\": \"false\",\n    \"usage\": \"disable request for full descriptions and use default vulnerability descriptions\",\n    \"hidden\": true,\n    \"deprecated\": true,\n    \"deprecatedInfo\": \"use --disable-full-descriptions instead\"\n  }\n}\n</code></pre>"},{"location":"flags/#flag_types","title":"Flag types","text":"<p>As described above you should describe which type is the flag, currently there is 4 flags types: - str: Represents a string type; - int: Represents an integer type; - bool: Represents a boolean type; - multiStr: Represents a string slice type, this receives multiple strings comma-separated;</p> <p>This type is used to cast <code>defaultValue</code> field and to determine which map it will be saved.</p>"},{"location":"flags/#accessing_and_setting_flags","title":"Accessing and setting flags","text":"<p>If you want to access flag, you should use get functions and the name of the flag. Currently there are 4 get functions: - <code>getStrFlag(flagName)</code>: Returns a string value of requested flag; - <code>getIntFlag(flagName)</code>: Returns a integer value of requested flag; - <code>getBoolFlag(flagName)</code>: Returns a boolean value of requested flag; - <code>getMultiStrFlag(flagName)</code>: Returns a slice of strings of requested flag;</p> <p>You can also set a flag value, using set functions. Currently there are 2 set functions: - <code>setStrFlag(flagName)</code>: Sets a flag with string value; - <code>setMultiStrFlag(flagName)</code>: Sets a flag with slice of strings value;</p>"},{"location":"flags/#usage_variables","title":"Usage variables","text":"<p>Usage field has a special function that replace variables found in this field, using the syntax <code>${variable}</code>. If a variable is listed when evaluating usage, it will replace it with this text. Currently there are 3 variables supported: - <code>sliceInstructions</code>: A constant with instructions for slice flags; - <code>supportedPlatforms</code>: The result of <code>ListSupportedPlatforms</code> function converted to string, which gets all KICS supported platforms; - <code>supportedProviders</code>: The result of <code>ListSupportedCloudProviders</code> function converted to string, which gets all KICS supported providers;</p> <p>You can add variables by modifying <code>variables</code> map on <code>evalUsage</code> function of flags.go file.</p>"},{"location":"getting-started/","title":"Getting Started","text":""},{"location":"getting-started/#scan_a_directory","title":"Scan a directory","text":"<pre><code>docker run -t -v {path_to_host_folder_to_scan}:/path checkmarx/kics:latest scan -p /path -o \"/path/\"\n</code></pre>"},{"location":"getting-started/#scan_a_single_file","title":"Scan a single file","text":"<pre><code>docker run -t -v {path_to_host_folder}:/path checkmarx/kics:latest scan -p /path/{filename}.{extension} -o \"/path/\"\n</code></pre>"},{"location":"getting-started/#scan_example","title":"Scan Example","text":""},{"location":"integrations/","title":"Overview","text":""},{"location":"integrations/#integrations_overview","title":"Integrations Overview","text":""},{"location":"integrations/#plugins","title":"Plugins","text":"<p>You can integrate KICS with your favorite CI/CD pipelines. We provide plugins for some CI/CD tools. For some others we provide a tutorial on how the integration can be done.</p> <p>Integrate KICS with:</p> <ul> <li>Azure Pipelines</li> <li>Bamboo</li> <li>Bitbucket Pipelines</li> <li>CircleCI</li> <li>Codefresh</li> <li>Github Actions</li> <li>GitLab CI</li> <li>Jenkins</li> <li>TeamCity</li> <li>Travis</li> <li>Pre-commit hooks</li> <li>Terraform Cloud</li> <li>Terraformer</li> <li>AWS CodeBuild</li> <li>KICS Auto Scanning Extension for Visual Studio Code</li> <li>More soon...</li> </ul> <p>The pipelines examples can be found in our GitHub Repository</p>"},{"location":"integrations/#megalinter","title":"MegaLinter","text":"<p>KICS is natively embedded in MegaLinter, a 100% Open-Source tool for CI/CD workflows that analyzes consistency and quality of:</p> <ul> <li>48 languages</li> <li>22 formats</li> <li>20 tooling formats</li> <li>excessive copy-pastes and spelling mistakes</li> </ul> <p>It also generates various reports, and can apply formatting and auto-fixes, to ensure all your projects sources are clean, whatever IDE/toolbox are used by their developers.</p> <p>To install MegaLinter in your repository, just run the following command</p> <p><code>npx mega-linter-runner --install</code></p>"},{"location":"integrations_auto_scanning_visual_studio/","title":"KICS Auto Scanning Extension for Visual Studio Code","text":"<p>Checkmarx\u2019s KICS Auto Scanning extension for VS Code initiates KICS scans directly from their VS Code console. The scan runs automatically whenever an infrastructure file of a supported type is saved, either manually or by auto-save. The scan runs only on the file that is open in the editor.</p> <p>The results are shown in the VS Code console, making it easy to remediate the vulnerabilities that are detected.</p> <p>\ud83d\udcdd KICS (Keeping Infrastructure as Code Secure) is a free, open source solution developed by Checkmarx and the open source community for static code analysis of IaC. KICS automatically parses common IaC files to detect insecure configurations that could expose your applications, data, or services to attack. KICS finds security vulnerabilities, compliance issues, and infrastructure misconfigurations in the following IaC solutions: Terraform, Kubernetes, Docker, AWS CloudFormation, Ansible, and Helm. See KICS - Open Source Solution</p> <p>\u2757\ufe0fThis is a free tool provided by Checkmarx for all VS Code users, and does not require the user to submit credentials for a Checkmarx AST account. This feature is bundled together with the Checkmarx extension, which is used by authenticated AST users to import scan results into their VS Code IDE.  </p> <p>The plugin is available on marketplace. In addition, the code can be accessed here.</p>"},{"location":"integrations_auto_scanning_visual_studio/#main_features","title":"Main Features","text":"<p>Free tool, no Checkmarx account required</p> <p>Run scans directly from your IDE</p> <p>Scans are triggered automatically whenever a file is saved</p>"},{"location":"integrations_auto_scanning_visual_studio/#prerequisites","title":"Prerequisites","text":"<p>You must have Docker installed and running in your environment</p>"},{"location":"integrations_auto_scanning_visual_studio/#installing_the_kics_auto_scanning_extension","title":"Installing the KICS Auto Scanning Extension","text":"<p>To install the extension from marketplace:</p> <ol> <li>Open Visual Studio Code.</li> <li>In the main navigation, click on the Extensions icon.</li> <li>Search for the Checkmarx plugin, then click Install for the plugin.</li> </ol> <p></p> <p>The Checkmarx extension is installed and the Checkmarx icon appears in the left-side navigation panel.</p> <p></p>"},{"location":"integrations_auto_scanning_visual_studio/#configuring_the_extension","title":"Configuring the Extension","text":"<p>The extension is activated automatically upon installation and no configuration is required. </p> <p>\u2757\ufe0fIt is not necessary to configure the Checkmarx AST Authentication settings in order to use the KICS Auto Scanning feature.</p> <p>If you would like to customize the scan settings, you can use the following procedure:</p> <ol> <li> <p>In the VS Code console, go to Settings &gt; Extensions &gt; Checkmarx &gt; Checkmarx KICS Auto Scanning. </p> </li> <li> <p>By default the extension is configured to run a KICS scan whenever an infrastructure file of a supported type that is open in your editor is saved. If you would like to disable automatic scanning, deselect the Activate KICS Auto Scanning checkbox.  NOTE In this case, you will still be able to trigger scans manually from the command palette, as described below.</p> </li> <li> <p>If you would like to customize the scan parameters, enter the desire flags in the Additional Parameters field. For a list of available options, see Scan Command Options.</p> </li> </ol>"},{"location":"integrations_auto_scanning_visual_studio/#triggering_a_scan_manually","title":"Triggering a Scan Manually","text":"<p>You can trigger a scan manually for the file that is open in your editor by opening the command palette and entering  Checkmarx-ast: Run kics realtime scan ( you can enter search text and select the command).</p>"},{"location":"integrations_auto_scanning_visual_studio/#viewing_kics_results","title":"Viewing KICS Results","text":""},{"location":"integrations_auto_scanning_visual_studio/#viewing_the_results_summary","title":"Viewing the Results Summary","text":"<p>When a scan is completed, a summary of the number of vulnerabilities identified by severity level is shown in the OUTPUT section of the VS Code console. </p> <p>Example of results summary:</p> <pre><code>1: CxINFO - 2:04:47 PM]Results summary:\n2:                     Total Results\": 141,\n3:                     \"HIGH\": 10,\n4:                     \"INFO\": 4,\n5:                     \"LOW\": 62,\n6:                     \"MEDIUM\": 65\n</code></pre>"},{"location":"integrations_auto_scanning_visual_studio/#viewing_kics_vulnerability_details","title":"Viewing KICS Vulnerability Details","text":"<p>Detailed information about the vulnerabilities that were detected is shown in the file editor window. The vulnerable code is highlighted according the severity level of the vulnerability, as follows:</p> <ul> <li>High - red</li> <li>Medium - orange</li> <li>Info - green</li> <li>Low - blue</li> </ul> <p>Hover over the vulnerable code to show a tooltip with detailed info about the vulnerability. </p> <p></p>"},{"location":"integrations_auto_scanning_visual_studio/#youtube_demo","title":"YouTube Demo","text":"<p>https://youtu.be/sFD-9CQXfs0</p>"},{"location":"integrations_aws_codebuild/","title":"Running KICS on AWS CodeBuild","text":"<p>You can integrate KICS into your AWS CodeBuild workflows.</p> <p>This provides you the ability to run KICS scans to find vulnerabilities and misconfiguration checks to your infrastructure as code (IaC).</p>"},{"location":"integrations_aws_codebuild/#example_setup_with_github","title":"Example setup with GitHub","text":"<p>Enable AWS CodeBuild to access your personal profile or GitHub organization.</p> <p>Create a <code>buildspec.yml</code> file on the root of your repository, for example:</p> <pre><code>version: 0.2\n\nphases:\n    build:\n        commands:\n            - echo Starting Kics scan\n            - docker run -v $PWD:/path checkmarx/kics scan --no-progress --ignore-on-exit all -p /path -o /path --report-formats junit --output-name kics-report\nreports:\n    kics-report:\n        files:\n            - junit-kics-report.xml\n</code></pre> <p>After running the pipeline, you can see the logs and the reports section:</p> <p></p> <p>Go to report section to see reports:</p> <p></p> <p>Select the desired report to see the test cases:</p> <p></p>"},{"location":"integrations_azurepipelines/","title":"Azure DevOps","text":""},{"location":"integrations_azurepipelines/#integrate_kics_with_azure_pipelines","title":"Integrate KICS with Azure Pipelines","text":"<p>You can integrate KICS into your Azure Pipelines CI/CD.</p> <p>This provides you the ability to run KICS scans in your Azure DevOps repositories and streamline vulnerabilities and misconfiguration checks to your infrastructure as code (IaC).</p> <pre><code>#\n# Example using JSON format\n#\ntrigger:\n  - master\npool:\n  vmImage: \"ubuntu-latest\"\ncontainer: checkmarx/kics:debian\nsteps:\n  # running in CI mode, exporting results to a JSON file and printing the results in stdout\n  # KICS should fail the pipeline if results are found\n  - script: |\n      /app/bin/kics scan --ci -p ${PWD} -o ${PWD}\n      cat results.json\n</code></pre>"},{"location":"integrations_azurepipelines/#example_results","title":"Example Results","text":"<p>When your pipeline executes, it will run this job. If KICS finds any issues, it will fail the build.</p>"},{"location":"integrations_azurepipelines/#pipeline_failure","title":"Pipeline Failure","text":""},{"location":"integrations_azurepipelines/#pipeline_success","title":"Pipeline Success","text":""},{"location":"integrations_azurepipelines/#view_sarif_report_in_azure_devops_pipelines","title":"View SARIF report in Azure DevOps pipelines","text":"<p>It's also possible to view KICS results by publishing the SARIF report as a build artifact and installing the SARIF Azure DevOps Extension</p> <ol> <li>Search for the SARIF Azure DevOps Extension in the extensions marketplace.</li> <li>Install and give permissions to the plugin.</li> <li>Create a pipeline to scan IaC with KICS, configure the results output in the SARIF format, and publish it as a build artifact with artifact named as <code>CodeAnalysisLogs</code>:</li> </ol> <pre><code>#\n# Example using SARIF viewer:\n# https://marketplace.visualstudio.com/items?itemName=sariftools.sarif-viewer-build-tab\n#\ntrigger:\n  - master\npool:\n  vmImage: \"ubuntu-latest\"\ncontainer: checkmarx/kics:debian\nsteps:\n  # run in CI mode, do not fail the pipeline on results found and export the report in both json and SARIF format.\n  - script: |\n      /app/bin/kics scan --ci -p ${PWD} -o ${PWD} --report-formats json,sarif --ignore-on-exit results\n      cat results.json\n  # scan results should be visible in the SARIF viewer tab of the build.\n  - task: PublishBuildArtifacts@1\n    inputs:\n      pathToPublish: $(System.DefaultWorkingDirectory)/results.sarif\n      artifactName: CodeAnalysisLogs\n</code></pre>"},{"location":"integrations_azurepipelines/#build_status","title":"Build status","text":""},{"location":"integrations_azurepipelines/#sarif_report_inside_azure_pipelines","title":"SARIF report inside Azure Pipelines","text":""},{"location":"integrations_bamboo/","title":"Running KICS in Bamboo","text":"<p>You can easily integrate KICS into Bamboo. The example below demonstrates how you can run KICS in a build plan linked to a GitHub repository.</p> <p>After you create a project with a build plan linked to a Github repository, you need to create a task to run KICS. The script body should contain <code>docker run -v ${PWD}:/path checkmarx/kics:latest scan -p /path -o /path/results --ci --ignore-on-exit results</code>.</p> <p></p> <p>For example, to turn on this task every time a commit is merged in the Github repository, you need to create a plan branch that enables that.</p> <p></p> <p>The build will run every time a commit is merged in the Github repository.</p> <p></p>"},{"location":"integrations_bitbucketpipelines/","title":"Bitbucket Pipelines","text":""},{"location":"integrations_bitbucketpipelines/#integrate_kics_with_bitbucket_pipelines","title":"Integrate KICS with Bitbucket Pipelines","text":"<p>You can integrate KICS into Bitbucket Pipelines CI/CD.</p> <p>This provides you the ability to run KICS scans in your Bitbucket repositories and streamline vulnerabilities and misconfiguration checks to your infrastructure as code (IaC).</p>"},{"location":"integrations_bitbucketpipelines/#example_configuration","title":"Example configuration","text":"<pre><code>image: checkmarx/kics:latest\n\npipelines:\n    default:\n        - step:\n              name: \"Cx KICS\"\n              script:\n                  - kics scan --ignore-on-exit results -p ${PWD} -o ${PWD}\n              artifacts:\n                  - results.json\n</code></pre>"},{"location":"integrations_circleci/","title":"Running KICS in CircleCI","text":"<p>You can integrate KICS into your CircleCI workflows.</p> <p>This document provides you with an example on how to run KICS scans in a pipeline.</p>"},{"location":"integrations_circleci/#example_setup_with_github","title":"Example setup with GitHub:","text":"<p>Enable CircleCI to access your personal profile or GitHub organization.</p> <p>Create a <code>.circleci</code> directory in your project's root and place a <code>config.yaml</code> inside:</p> <pre><code>version: 2.1\njobs:\n  kics:\n    docker:\n      - image: checkmarx/kics:latest\n    steps:\n      - checkout\n      - run:\n          name: Run KICS\n          command: |\n            /app/bin/kics scan -p ${PWD} -o ${PWD} --ci\n      - store_artifacts:\n          path: ${PWD}/results.json\n\nworkflows:\n  version: 2\n  build:\n    jobs:\n      # etc...\n      - kics\n\n</code></pre> <p>After running a pipeline, you will be able to see \"Run KICS\" step inside workflow's details:</p> <p></p> <p>Go to the artifacts tab to inspect the results:</p> <p></p> <p>Results will be displayed in plain text:</p> <p></p>"},{"location":"integrations_codefresh/","title":"Integrate KICS with Codefresh","text":"<p>Find security vulnerabilities, compliance issues, and infrastructure misconfigurations early in the development cycle of your infrastructure-as-code with KICS Codefresh step by Checkmarx.</p> <p>You can find the KICS Codefresh step here.</p> <p>Please, be aware that the KICS Codefresh step can require MEDIUM instances.</p>"},{"location":"integrations_codefresh/#arguments","title":"ARGUMENTS","text":"Variable Example Value Description Type Required Default PROJECT_PATH terraform/main.tf,Dockerfile paths to a file or directories to scan, comma separated list string Yes N/A IGNORE_ON_EXIT results defines which kind of non-zero exits code should be ignored (all, results, errors, none) string No N/A FAIL_ON high,medium which kind of results should return an exit code different from 0 string No high,medium,low,info TIME_OUT 75 number of seconds the query has to execute before being canceled string No 60 PROFILING CPU enables performance profiler that prints resource consumption metrics in the logs during the execution (CPU, MEM) string No N/A TYPES Ansible,Terraform case insensitive list of platform types to scan (Ansible, AzureResourceManager, CloudFormation, Dockerfile, Docker Compose, GRPC, GoogleDeploymentManager, Kubernetes, OpenAPI, Terraform) string No All EXCLUDE_PATHS ./shouldNotScan/*,somefile.txt exclude paths from scan string No N/A EXCLUDE_QUERIES e69890e6-fce5-461d-98ad-cb98318dfc96,4728cd65-a20c-49da-8b31-9c08b423e4db exclude queries by providing the query ID; cannot be provided with query inclusion flags string No N/A EXCLUDE_CATEGORIES Access control,Best practices exclude categories by providing its name; cannot be provided with query inclusion flags string No N/A EXCLUDE_SEVERETIES info,low exclude results by providing the severity of a result string No N/A EXCLUDE_RESULTS d4a1fa80-d9d8-450f-87c2-e1f6669c41f8 exclude results by providing the similarity ID of a result string No N/A INCLUDE_QUERIES a227ec01-f97a-4084-91a4-47b350c1db54 include queries by providing the query ID; cannot be provided with query exclusion flags string No N/A OUTPUT_FORMATS json,sarif formats in which the results will be exported (all, asff, csv, cyclonedx, glsast, html, json, junit, pdf, sarif, sonarqube) string No json OUTPUT_PATH myResults/ directory path to store reports string No N/A PAYLOAD_PATH /tmp/mypayload.json path to store internal representation JSON file string No N/A QUERIES_PATH query \"example\": \"/tmp/mypayload.json\" string No ./assets/queries downloaded with the binaries VERBOSE true write logs to stdout too (mutually exclusive with silent) boolean No false BOM true include bill of materials (BoM) in results output; boolean No false DISABLE_FULL_DESCRIPTIONS true disable request for full descriptions and use default vulnerability descriptions boolean No false DISABLE_SECRETS true disable secrets  scanning boolean No false SECRETS_REGEXES_PATH ./mydir/secrets-config.json path to secrets regex rules configuration file string No N/A LIBRARIES_PATH ./myLibsDir path to directory with libraries string No N/A"},{"location":"integrations_codefresh/#examples","title":"EXAMPLES","text":""},{"location":"integrations_codefresh/#running_kics","title":"RUNNING KICS","text":"<pre><code>steps:\n    clone:\n      title: Clone a project\n      type: git-clone\n      repo: 'rafaela-soares/query'\n      git: github\n    run_kics:\n          title: Scanning IaC files\n          type: checkmarx/kics\n          arguments:\n              PROJECT_PATH: ./query\n</code></pre>"},{"location":"integrations_codefresh/#running_kics_and_saving_kics_reports","title":"RUNNING KICS AND SAVING KICS REPORTS","text":"<p>\ud83d\udea8 Be aware that you should set <code>IGNORE_ON_EXIT: results</code> to be able to avoid the KICS exit code and run the step that saves the report.</p>"},{"location":"integrations_codefresh/#github_repository","title":"GITHUB REPOSITORY","text":"<pre><code>steps:\n    clone:\n      title: Clone a project\n      type: git-clone\n      repo: 'rafaela-soares/query'\n      git: github\n    run_kics:\n          title: Scanning IaC files\n          type: checkmarx/kics\n          arguments:\n              PROJECT_PATH: ./query\n              QUERIES_PATH: ./query/alb_listening_on_http\n              OUTPUT_PATH: /codefresh/volume/query/reports\n              OUTPUT_FORMATS: all\n              VERBOSE: true\n              EXCLUDE_PATHS: ./query/alb_listening_on_http/test/negative.yaml\n              TYPES: Ansible\n              LOG_LEVEL: DEBUG\n              PAYLOAD_PATH: /codefresh/volume/query/payload.json\n              IGNORE_ON_EXIT: results\n    save_reports_and_payload:\n          title: Saving KICS payload and KICS reports\n          type: git-commit\n        arguments:\n              repo: 'rafaela-soares/query'\n              git: github\n              working_directory: '/codefresh/volume/query'\n              commit_message: saved payload and reports\n              git_user_name: git-user-name\n              git_user_email: git-user@email.com\n              allow_empty: false\n              add:\n                - payload.json\n                - ./reports\n</code></pre>"},{"location":"integrations_codefresh/#s3_bucket","title":"S3 BUCKET","text":"<pre><code>steps:\n    clone:\n      title: Clone a project\n      type: git-clone\n      repo: 'rafaela-soares/query'\n      git: github\n    run_kics:\n          title: Scanning IaC files\n          type: checkmarx/kics\n          arguments:\n              PROJECT_PATH: ./query\n              QUERIES_PATH: ./query/alb_listening_on_http\n              OUTPUT_PATH: /codefresh/volume/query/reports\n              OUTPUT_FORMATS: all\n              VERBOSE: true\n              EXCLUDE_PATHS: ./query/alb_listening_on_http/test/negative.yaml\n              TYPES: Ansible\n              LOG_LEVEL: DEBUG\n              IGNORE_ON_EXIT: results\n    save_reports_in_s3_bucket:\n             title: Saving KICS reports\n             image: 'amazon/aws-cli'\n             working_directory: '/codefresh/volume/query'\n             commands:\n                 - mkdir ~/.aws\n                 - touch ~/.aws/config\n                 - chmod 600 ~/.aws/config\n                 - echo \"[default]\" &gt; ~/.aws/config\n                 - echo \"aws_access_key_id=${AWS_ACCESS_KEY_ID}\" &gt;&gt; ~/.aws/config\n                 - echo \"aws_secret_access_key=${AWS_SECRET_ACCESS_KEY}\" &gt;&gt; ~/.aws/config\n                 - echo \"aws_session_token=${AWS_SESSION_TOKEN}\" &gt;&gt; ~/.aws/config\n                 - echo \"region=${AWS_REGION}\" &gt;&gt; ~/.aws/config\n                 - aws s3 cp ./reports s3://${{BUCKET_NAME}}/ --recursive\n</code></pre>"},{"location":"integrations_ghactions/","title":"Github Actions","text":""},{"location":"integrations_ghactions/#integration_with_github_actions","title":"Integration with Github Actions","text":"<p>You can integrate KICS into your Github Actions CI/CD pipelines with a specific KICS Github Action.</p> <p>This provides you the ability to run KICS scans in your Github repositories and streamline vulnerabilities and misconfiguration checks to your infrastructure as code (IaC).</p>"},{"location":"integrations_ghactions/#important_note","title":"Important note","text":"<p>If you use a version from v1.2 to v1.5 of the kics-github-action it means you will be scanning your IaC files with KICS version 1.5.15. In order to use KICS version 1.6.x to scan your files, you should use the v1.6 of the kics-github-action.</p>"},{"location":"integrations_ghactions/#tutorial","title":"Tutorial","text":"<ol> <li> <p>Edit the workflow file you want to integrate KICS in</p> </li> <li> <p>Either search Github Marketplace or use the template below:</p> </li> </ol> <pre><code>- name: KICS Github Action\n  uses: Checkmarx/kics-github-action@v1.6\n  with:\n    # path to file or directory to scan\n    path:\n    # file path to store result in json format\n    output_path: # optional\n    # file path to store source internal representation in JSON format\n    payload_path: # optional\n    # path to directory with queries (default \"./assets/queries\")\n    queries: # optional\n    # verbose scan\n    verbose: # optional\n</code></pre> <p>Refer to kics-github-action repository for a full list of parameters</p>"},{"location":"integrations_ghactions/#github_actions_integration_with_sarif","title":"GitHub Actions integration with SARIF","text":"<p>KICS has an option to generate results on SARIF format, which can be integrated with many CI tools, including GitHub Actions.</p> <p>The following workflow shows how to integrate KICS with GitHub Actions:</p> <pre><code>steps:\n  - uses: actions/checkout@v2\n  - name: Mkdir results-dir\n    # make sure results dir is created\n    run: mkdir -p results-dir\n  - name: run kics Scan\n    uses: Checkmarx/kics-github-action@v1.6\n    with:\n      path: 'terraform'\n      output_path: results-dir\n  - name: Upload SARIF file\n    uses: github/codeql-action/upload-sarif@v1\n    with:\n      sarif_file: results-dir/results.sarif\n</code></pre> <p>The results list can be found on security tab of your GitHub project and should look like the following image:</p> <p></p> <p>An entry should describe the error and in which line it occurred:</p> <p></p>"},{"location":"integrations_ghactions/#default_report_usage_example","title":"Default report Usage example","text":"<pre><code>    # Steps represent a sequence of tasks that will be executed as part of the job\n    steps:\n    # Checks-out your repository under $GITHUB_WORKSPACE, so your job can access it\n    - uses: actions/checkout@v2\n    - name: Mkdir results-dir\n      # make sure results dir is created\n      run: mkdir -p results-dir\n    # Scan Iac with kics\n    - name: run kics Scan\n      uses: checkmarx/kics-github-action@latest\n      with:\n        path: 'terraform'\n        output_path: results-dir\n    # Display the results in json format\n    - name: display kics results\n      run: |\n        cat results-dir/results.json\n      # optionally parse the results with jq\n      # jq '.total_counter' results-dir/results.json\n      # jq '.queries_total' results-dir/results.json\n</code></pre> <p>Here you can see it in action:</p> <p></p>"},{"location":"integrations_ghactions/#workflow_failures","title":"Workflow failures","text":"<p>By default KICS will fail your workflow on any results found.</p>"},{"location":"integrations_ghactions/#fail_by_severity_usage_example","title":"Fail by severity usage example","text":"<p>If you want your pipeline just to fail on HIGH, MEDIUM severity results and KICS engine execution errors:</p> <pre><code>    steps:\n    - uses: actions/checkout@v2\n    - name: Mkdir results-dir\n      # make sure results dir is created\n      run: mkdir -p results-dir\n    - name: run kics Scan\n      uses: checkmarx/kics-github-action@latest\n      with:\n        path: 'terraform,my-other-sub-folder/Dockerfile'\n        fail_on: high,medium\n        output_path: results-dir\n    - name: display kics results\n      run: |\n        cat results-dir/results.json\n</code></pre>"},{"location":"integrations_ghactions/#dont_fail_on_results","title":"Don't fail on results","text":"<p>If you want KICS to ignore the results and return exit status code 0 unless a KICS engine error happens:</p> <pre><code>    steps:\n    - uses: actions/checkout@v2\n    - name: Mkdir results-dir\n      # make sure results dir is created\n      run: mkdir -p results-dir\n    - name: run kics Scan\n      uses: checkmarx/kics-github-action@latest\n      with:\n        path: 'terraform'\n        ignore_on_exit: results\n        output_path: results-dir\n    - name: display kics results\n      run: |\n        cat results-dir/results.json\n</code></pre>"},{"location":"integrations_ghactions/#profiling_kics","title":"Profiling KICS","text":"<p>You can only enable one profiler at a time, CPU or MEM.</p> <p>\ud83d\udcdd \u00a0 Please note that execution time may be impacted by enabling performance profiler due to sampling</p> <pre><code>    steps:\n    - uses: actions/checkout@v2\n    - name: Mkdir results-dir\n      # make sure results dir is created\n      run: mkdir -p results-dir\n    - name: run kics Scan\n      uses: checkmarx/kics-github-action@latest\n      with:\n        path: 'terraform'\n        profiling: MEM\n        output_path: results-dir\n    - name: display kics results\n      run: |\n        cat results-dir/results.json\n</code></pre>"},{"location":"integrations_ghactions/#uploading_sarif_report","title":"Uploading SARIF report","text":"<pre><code>name: scan with KICS and upload SARIF\n\non:\n  pull_request:\n    branches: [master]\n\njobs:\n  kics-job:\n    runs-on: ubuntu-latest\n    name: kics-github-action\n    steps:\n      - name: Checkout repo\n        uses: actions/checkout@v2\n      - name: Mkdir results-dir\n        # make sure results dir is created\n        run: mkdir -p results-dir\n      - name: Run KICS Scan with SARIF result\n        uses: checkmarx/kics-github-action@latest\n        with:\n          path: 'terraform'\n          # when provided with a directory on output_path\n          # it will generate the specified reports file named 'results.{extension}'\n          # in this example it will generate:\n          # - results-dir/results.json\n          # - results-dir/results.sarif\n          output_path: results-dir\n          platform_type: terraform\n          output_formats: 'json,sarif'\n          exclude_paths: \"terraform/gcp/big_data.tf,terraform/azure\"\n          # seek query id in it's metadata.json\n          exclude_queries: 0437633b-daa6-4bbc-8526-c0d2443b946e\n      - name: Show results\n        run: |\n          cat results-dir/results.sarif\n          cat results-dir/results.json\n      - name: Upload SARIF file\n        uses: github/codeql-action/upload-sarif@v1\n        with:\n          sarif_file: results-dir/results.sarif\n</code></pre>"},{"location":"integrations_ghactions/#using_configuration_file","title":"Using configuration file","text":"<p>Check configuration file reference for more options.</p> <pre><code>name: scan with KICS using config file\n\non:\n  pull_request:\n    branches: [master]\n\njobs:\n  kics-job:\n    runs-on: ubuntu-latest\n    name: kics-github-action\n    steps:\n      - name: Checkout repo\n        uses: actions/checkout@v2\n      - name: Mkdir results-dir\n        # make sure results dir is created\n        run: mkdir -p results-dir\n      - name: Create config file\n        # creating a heredoc config file\n        run: |\n          cat &lt;&lt;EOF &gt;&gt;kics.config\n          {\n            \"exclude-categories\": \"Encryption\",\n            \"exclude-paths\": \"terraform/gcp/big_data.tf,terraform/gcp/gcs.tf\",\n            \"log-file\": true,\n            \"minimal-ui\": false,\n            \"no-color\": false,\n            \"no-progress\": true,\n            \"output-path\": \"./results-dir\",\n            \"payload-path\": \"file path to store source internal representation in JSON format\",\n            \"preview-lines\": 5,\n            \"report-formats\": \"json,sarif\",\n            \"type\": \"terraform\",\n            \"verbose\": true\n          }\n          EOF\n      - name: Run KICS Scan using config\n        uses: checkmarx/kics-github-action@latest\n        with:\n          path: 'terraform'\n          config_path: ./kics.config\n      - name: Upload SARIF file\n        uses: github/codeql-action/upload-sarif@v1\n        with:\n          sarif_file: results-dir/results.sarif\n</code></pre>"},{"location":"integrations_ghactions/#resources","title":"Resources","text":"<ul> <li>KICS GitHub Action in Github Marketplace.</li> <li>KICS Github Action Project Repository.</li> <li>Github Actions in Github Documentation</li> </ul>"},{"location":"integrations_gitlabci/","title":"Gitlab CI","text":""},{"location":"integrations_gitlabci/#integrate_kics_with_gitlab_ci","title":"Integrate KICS with GitLab CI","text":"<p>You can integrate KICS into your GitLab CI/CD pipelines.</p> <p>This provides you the ability to run KICS scans in your GitLab repositories and streamline vulnerabilities and misconfiguration checks to your infrastructure as code (IaC).</p>"},{"location":"integrations_gitlabci/#full_example","title":"Full Example","text":"<pre><code>image:\n    name: checkmarx/kics:latest\n    entrypoint: [\"\"]\n\nstages:\n    - kics\n\nkics-scan:\n    stage: kics\n    script:\n        - kics scan --no-progress -p ${PWD} -o ${PWD} --report-formats json --output-name kics-results\n    artifacts:\n        name: kics-results.json\n        paths:\n            - kics-results.json\n        when: always\n</code></pre>"},{"location":"integrations_gitlabci/#example_results","title":"Example Results","text":"<p>When your pipeline executes, it will run this job. If KICS finds any issues, it will fail the build.</p>"},{"location":"integrations_gitlabci/#pipeline_failure","title":"Pipeline Failure","text":""},{"location":"integrations_gitlabci/#pipeline_success","title":"Pipeline Success","text":""},{"location":"integrations_gitlabci/#download_artifact","title":"Download Artifact","text":""},{"location":"integrations_gitlabci/#using_gitlab_sast_reports","title":"Using GitLab SAST Reports","text":"<pre><code>image:\n    name: checkmarx/kics:latest\n    entrypoint: [\"\"]\n\nstages:\n    - kics\n\nkics-scan:\n    stage: kics\n    script:\n        - kics scan -p ${PWD} --ignore-on-exit all --report-formats glsast -o ${PWD} --output-name kics-results\n    artifacts:\n        reports:\n            sast: gl-sast-kics-results.json\n        when: always\n</code></pre>"},{"location":"integrations_gitlabci/#example_results_1","title":"Example results","text":""},{"location":"integrations_gitlabci/#pipeline_sast_report_integration","title":"Pipeline SAST report integration","text":"<p>\ud83d\udcdd \u00a0 This feature requires Gitlab Ultimate.</p> <p></p> <p></p> <p></p> <p></p>"},{"location":"integrations_gitlabci/#code_quality_integration","title":"Code Quality integration","text":"<p>It is possible to get code quality report with Kics scan, see the example:</p> <pre><code>image:\n    name: checkmarx/kics:latest\n    entrypoint: [\"\"]\n\nstages:\n    - test\n\ncode_quality:\n    stage: test\n    script:\n        - kics scan --no-progress -p ${PWD} -o ${PWD} --report-formats codeclimate --output-name codeclimate-result\n    artifacts:\n        paths:\n            - codeclimate-result.json\n        reports:\n            codequality: codeclimate-result.json\n</code></pre>"},{"location":"integrations_gitlabci/#code_quality_report","title":"Code Quality Report","text":""},{"location":"integrations_jenkins/","title":"Running KICS in Jenkins","text":"<p>You can integrate KICS into your Jenkins CI/CD pipelines.</p> <p>This provides you the ability to run KICS scans as a stage in your pipeline.</p>"},{"location":"integrations_jenkins/#declarative_pipelines","title":"Declarative pipelines:","text":"<p>Create a new pipeline by clicking on New Item on the left menu bar, then fill in the name of your pipeline and select the option \"pipeline\":</p> <p></p> <p>Paste one of the pipeline examples below:</p> <p></p> <p>Save and run your pipeline.</p> <p></p> <p>Click on the build number to download the reports stored as artifacts.</p> <p></p>"},{"location":"integrations_jenkins/#using_docker","title":"Using Docker","text":"<p>The following pipeline uses the KICS docker image to scan a project and publishes the HTML report in Jenkins.</p> <p>Plugins required:</p> <ul> <li>HTML Publisher Plugin</li> <li>Docker Plugin</li> <li>Docker Pipeline Plugin</li> </ul> <pre><code>pipeline {\n    agent {\n        docker {\n            image 'ubuntu:latest'\n        }\n    }\n    options {\n        timeout(time: 30, unit: 'MINUTES')\n        buildDiscarder(logRotator(numToKeepStr: '30', artifactNumToKeepStr: '30'))\n        disableConcurrentBuilds()\n    }\n    stages {\n        stage('Checkout Code') {\n          steps {\n              git branch: 'master', url: 'https://github.com/GoogleCloudPlatform/terraform-google-examples'\n              stash includes: '**/*', name: 'source'\n          }\n        }\n        stage('KICS scan') {\n            steps {\n                script {\n                    docker.image('checkmarx/kics:latest').inside(\"--entrypoint=''\") {\n                      unstash 'source'\n                      sh('/app/bin/kics scan -p \\'\\$(pwd)\\' --ci --report-formats html -o \\'\\$(pwd)\\' --ignore-on-exit results')\n                      archiveArtifacts(artifacts: 'results.html', fingerprint: true)\n                      publishHTML([allowMissing: true, alwaysLinkToLastBuild: true, keepAll: true, reportDir: '.', reportFiles: 'results.html', reportName: 'KICS Results', reportTitles: ''])\n                    }\n                }\n            }\n        }\n    }\n}\n</code></pre> <p>The report will be published in pure HTML by default, if you want to enable your browser to load css and javascript embedded in the report.html you'll have to configure a custom Content-Security-Policy HTTP header.</p> \ud83d\udcdd \u00a0 WARNING Only disable Jenkins security features if you know what you're doing <p></p> <p>Go to Manage Jenkins &gt; Script Console</p> <p>Paste the following script and run:</p> <pre><code>System.setProperty(\"hudson.model.DirectoryBrowserSupport.CSP\", \"sandbox allow-scripts; default-src *; style-src * http://* 'unsafe-inline' 'unsafe-eval'; script-src 'self' http://* 'unsafe-inline' 'unsafe-eval'\");\n</code></pre> <p>Jenkins will exhibit the following warning:</p> <pre><code>The default Content-Security-Policy is currently overridden using the hudson.model.DirectoryBrowserSupport.CSP system property, which is a potential security issue when browsing untrusted files. As an alternative, you can set up a resource root URL that Jenkins will use to serve some static files without adding Content-Security-Policy headers.\n</code></pre>"},{"location":"integrations_jenkins/#using_kics_with_junit_plugin","title":"Using KICS with JUnit plugin","text":"<p>First of all you need to check if the JUnit plugin is installed:</p> <p></p> <p>If it is not installed, you can install it by clicking on Plugins on the left menu bar, then click on Install Plugin and select JUnit.</p> <p>After that, you can add the following line to your pipeline script:</p> <pre><code>    junit testResults: 'results/junit-results.xml', skipPublishingChecks: true\n</code></pre> <p>The skipPublishingChecks option is important, otherwise the JUnit plugin will try to publish the results to GitHub in Jenkins. If you want to do this, you should check the JUnit plugin documentation for more information.</p> <p>If you are using our example script, it will look like the following:</p> <pre><code>pipeline {\n  agent any\n  stages {\n    stage('Checkout Code') {\n      steps {\n        git(branch: 'master', url: 'https://github.com/GoogleCloudPlatform/terraform-google-examples')\n      }\n    }\n\n    stage('KICS scan') {\n      steps {\n        sh \"mkdir -p results\"\n        sh(script: '/usr/bin/kics scan --ci --no-color -p ${WORKSPACE} --output-path results --ignore-on-exit results --report-formats \"json,sarif,html\"')\n        junit testResults: 'results/junit-results.xml', skipPublishingChecks: true\n        archiveArtifacts(artifacts: 'results/*.html,results/*.sarif,results/*.json', fingerprint: true)\n      }\n    }\n  }\n}\n</code></pre> <p>This will publish the JUnit results in Jenkins as you can see in the next images:</p> <p></p> <p></p> <p></p>"},{"location":"integrations_kuberneter/","title":"Kuberneter","text":"<p>From version 1.6, KICS calls the Kubernetes API to scan resources deployed in the runtime K8s\u00a0cluster. The runtime information of the resources is obtained by providing the K8s credentials as environment variables and a kuberneter path to KICS, via <code>-p</code> flag. The scan happens immediately after this information is obtained. In the end, results are shown as for any other KICS scan.</p>"},{"location":"integrations_kuberneter/#configure_k8s_credentials","title":"Configure K8s Credentials","text":"<p>For KICS to get the runtime information of your resources, you need to provide your K8s Credentials as environment variables.</p>"},{"location":"integrations_kuberneter/#using_config_file","title":"Using Config File","text":"<p>MacOS and Linux:</p> <pre><code>export K8S_CONFIG_FILE=\"&lt;K8S_CONFIG_FILE&gt;\"\n</code></pre> <p>Windows:</p> <pre><code>SET K8S_CONFIG_FILE=&lt;K8S_CONFIG_FILE&gt;\n</code></pre> <p>Powershell:</p> <pre><code>$Env:K8S_CONFIG_FILE=\"&lt;K8S_CONFIG_FILE&gt;\"\n</code></pre>"},{"location":"integrations_kuberneter/#using_service_account_token","title":"Using Service Account Token","text":"<p>Note that your Service Account Token should have list permissions for the chosen resources. Additionally to that, note that <code>K8S_CA_DATA</code> and <code>K8S_SA_TOKEN_DATA</code> should be base64 encoded.</p> <p>MacOS and Linux:</p> <pre><code>export K8S_HOST=\"&lt;K8S_HOST&gt;\"\nexport K8S_CA_FILE=\"&lt;K8S_CA_FILE&gt;\" or export K8S_CA_DATA=\"K8S_CA_DATA\"\nexport K8S_SA_TOKEN_FILE=\"K8S_SA_TOKEN_FILE&gt;\" or export K8S_SA_TOKEN_DATA=\"K8S_SA_TOKEN_DATA\"\n</code></pre> <p>Windows:</p> <pre><code>SET K8S_HOST=&lt;K8S_HOST&gt;\nSET K8S_CA_FILE=&lt;K8S_CA_FILE&gt; or SET K8S_CA_DATA=&lt;K8S_CA_DATA&gt;\nSET K8S_SA_TOKEN_FILE=&lt;K8S_SA_TOKEN_FILE&gt; or SET K8S_SA_TOKEN_DATA=&lt;K8S_SA_TOKEN_DATA&gt;\n</code></pre> <p>Powershell:</p> <pre><code>$Env:K8S_HOST=\"&lt;K8S_HOST&gt;\"\n$Env:K8S_CA_FILE=\"&lt;K8S_CA_FILE&gt;\" or $Env:K8S_CA_DATA=\"&lt;K8S_CA_DATA&gt;\"\n$Env:K8S_CA_FILE=\"&lt;K8S_SA_TOKEN_FILE&gt;\" or $Env:K8S_CA_DATA=\"&lt;K8S_SA_TOKEN_DATA&gt;\"\n</code></pre>"},{"location":"integrations_kuberneter/#using_certificate","title":"Using Certificate","text":"<p>Note that your \"certificate user\" should have list permissions for the chosen resources. Additionally to that, note that <code>K8S_CA_DATA</code>, <code>K8S_CERT_DATA</code>, and <code>K8S_KEY_DATA</code> should be base64 encoded.</p> <p>MacOS and Linux:</p> <pre><code>export K8S_HOST=\"&lt;K8S_HOST&gt;\"\nexport K8S_CA_FILE=\"&lt;K8S_CA_FILE&gt;\" or export K8S_CA_DATA=\"K8S_CA_DATA\"\nexport K8S_CERT_FILE=\"&lt;K8S_CERT_FILE&gt;\" or export K8S_CERT_DATA=\"K8S_CERT_DATA\"\nexport K8S_KEY_FILE=\"&lt;K8S_KEY_FILE&gt;\" or export K8S_KEY_DATA=\"K8S_KEY_DATA\"\n</code></pre> <p>Windows:</p> <pre><code>SET K8S_HOST=&lt;K8S_HOST&gt;\nSET K8S_CA_FILE=&lt;K8S_CA_FILE&gt; or SET K8S_CA_DATA=&lt;K8S_CA_DATA&gt;\nSET K8S_CERT_FILE=&lt;K8S_CERT_FILE&gt; or SET K8S_CERT_DATA=&lt;K8S_CERT_DATA&gt;\nSET K8S_KEY_FILE=&lt;K8S_KEY_FILE&gt; or SET K8S_KEY_DATA=&lt;K8S_KEY_DATA&gt;\n</code></pre> <p>Powershell:</p> <pre><code>$Env:K8S_HOST=\"&lt;K8S_HOST&gt;\"\n$Env:K8S_CA_FILE=\"&lt;K8S_CA_FILE&gt;\" or $Env:K8S_CA_DATA=\"&lt;K8S_CA_DATA&gt;\"\n$Env:K8S_CERT_FILE=\"&lt;K8S_CERT_FILE&gt;\" or $Env:K8S_CERT_DATA=\"&lt;K8S_CERT_DATA&gt;\"\n$Env:K8S_KEY_FILE=\"&lt;K8S_KEY_FILE&gt;\" or $Env:K8S_KEY_DATA=\"&lt;K8S_KEY_DATA&gt;\"\n</code></pre>"},{"location":"integrations_kuberneter/#kics_kuberneter_path_syntax","title":"KICS Kuberneter Path Syntax","text":"<pre><code>kuberneter::{namespaces}:{apiVersions}:{kinds}\n</code></pre> <p>To import all the namespaces, apiVersions, or kinds, please use: <code>*</code>. For example, <code>kuberneter::*:*:*</code>.</p> <p>To specify the namespaces, apiVersions, or kinds, please use: separator <code>+</code>. For example,<code>kuberneter::*:apps/v1+v1:ServiceAccount</code>.</p> <p>The API Versions and their respective kinds (both case sensitive) are listed below:</p> API Versions Kinds apps/v1 DaemonSet Deployment ReplicaSet StatefulSet core/v1 LimitRange Pod PersistentVolume PersistentVolumeClaim ReplicationController ResourceQuota Secret ServiceAccount Service batch/v1 CronJob Job networking.k8s.io/v1 IngressClass Ingress NetworkPolicy policy/v1 PodDisruptionBudget rbac.authorization.k8s.io/v1 ClusterRoleBinding ClusterRole RoleBinding Role apps/v1beta1 Deployment StatefulSet apps/v1beta2 DaemonSet Deployment ReplicaSet StatefulSet batch/v1beta1 CronJob networking.k8s.io/v1beta1 IngressClass Ingress policy/v1beta1 PodDisruptionBudget PodSecurityPolicy rbac.authorization.k8s.io/v1alpha1 ClusterRoleBinding ClusterRole RoleBinding Role rbac.authorization.k8s.io/v1beta1 ClusterRoleBinding ClusterRole RoleBinding Role"},{"location":"integrations_kuberneter/#running_kics_to_scan_runtime_k8s_cluster","title":"Running KICS to scan runtime K8s cluster","text":"<p>When running KICS using a kuberneter path, the resources are imported using the credentials set as environment variables in Kubernetes format to the current working directory in a new folder named <code>kics-extract-kuberneter</code> following the above-described structure. KICS will then run a scan on these local files.</p> <p>If the flag <code>-o, --output-path</code> is passed, the folder <code>kics-extract-kuberneter</code> will be generated in the reports directory instead.</p>"},{"location":"integrations_kuberneter/#imported_resources_tree_structure","title":"Imported Resources tree structure:","text":"<pre><code> \u25be kics-extract-kuberneter/\n    \u25be {apiGroup}/\n        \u25be {apiVersion}/\n            \u25be {kind}.yaml\n</code></pre>"},{"location":"integrations_kuberneter/#run_kics_to_scan_runtime_k8s_cluster_with_docker","title":"Run KICS to scan runtime K8s cluster with Docker","text":"<p>To run KICS Kuberneter with Docker, you can simply pass the K8s Credentials that were set as environment variables to the docker run command and use the kuberneter path syntax</p> <p>Examples:</p>"},{"location":"integrations_kuberneter/#using_config_file_1","title":"Using Config File","text":"<pre><code>docker run -v &lt;credentials_path&gt;:/credentials -v ${PWD}:/path/ -e K8S_CONFIG_FILE=/credentials/&lt;config-file-name&gt; checkmarx/kics:latest scan -p \"kuberneter::*:*:*\" -v --no-progress -o /path/results\n</code></pre>"},{"location":"integrations_kuberneter/#using_service_account_token_1","title":"Using Service Account Token","text":"<pre><code>docker run -v ${PWD}:/path/ -e K8S_HOST -e K8S_CA_DATA -e K8S_SA_TOKEN_DATA kuberneter scan -p \"kuberneter::*:*:*\" -v --no-progress -o /path/results\n</code></pre>"},{"location":"integrations_kuberneter/#using_certificate_1","title":"Using Certificate","text":"<pre><code>docker run -v ${PWD}:/path/ -e K8S_HOST -e K8S_CA_DATA -e K8S_SA_TOKEN_DATA kuberneter scan -p \"kuberneter::*:*:*\" -v --no-progress -o /path/results\n</code></pre>"},{"location":"integrations_kuberneter/#using_certificate_2","title":"Using Certificate","text":"<pre><code>docker run -v ${PWD}:/path/ -e K8S_HOST -e K8S_CA_DATA -e K8S_CERT_DATA -e K8S_KEY_DATA checkmarx/kics:latest scan -p \"kuberneter::*:*:*\" -v --no-progress -o /path/results\n</code></pre>"},{"location":"integrations_pre_commit/","title":"Running Kics with pre-commmit","text":"<p>To use <code>kics</code> with pre-commit add the following hook to your local repo's <code>.pre-commit-config.yaml</code> file.</p> <pre><code>- repo: https://github.com/Checkmarx/kics\n  rev: \"\" # change to correct tag or sha\n  hooks:\n      - id: kics-scan\n</code></pre>"},{"location":"integrations_pre_commit/#how_to_pass_extra_arguments","title":"How to pass extra arguments","text":"<p>You can provide arguments to <code>kics</code> by providing the pre-commit <code>args</code> property. The following example will print the <code>kics scan</code> output, but will not block regardless of success/failure.</p> <pre><code>repos:\n    - repo: https://github.com/Checkmarx/kics\n      rev: \"\" # change to correct tag or sha\n      hooks:\n          - id: kics-scan\n            verbose: true\n            args: [--ignore-on-exit, \"all\"]\n</code></pre>"},{"location":"integrations_pre_commit/#create_your_own_local_pre-commit_hook","title":"Create your own local pre-commit hook","text":"<p>You can create your own local pre-commit hook using the docker_image language. This is a more lightweight way to configure <code>kics</code> as a pre-commit hook.</p> <pre><code>repos:\n    - repo: local\n      hooks:\n          - id: kics-scan-local\n            name: Kics scan\n            language: docker_image\n            entry: checkmarx/kics scan -p /src --no-progress\n            verbose: true\n</code></pre>"},{"location":"integrations_teamcity/","title":"Running KICS in TeamCity","text":"<p>You can integrate KICS into TeamCity pipelines easily by Kotlin DSL and KICS docker image.</p> <p>This provide you the ability to run KICS scans as a stage of your pipeline.</p> <p>Just make sure that the TeamCity agent has Docker configured to run containers.</p> <p>Checkout Getting Started with Kotlin DSL and modify you <code>.teamcity/settings.kts</code> as the example:</p> <pre><code>import jetbrains.buildServer.configs.kotlin.v2019_2.*\nimport jetbrains.buildServer.configs.kotlin.v2019_2.buildSteps.script\nversion = \"2021.1\"\n\nproject {\n    description = \"KICS TeamCity integration test\"\n    buildType(Build)\n}\n\nobject Build: BuildType({\n    name = \"KICS TeamCity integration test\"\n    vcs {\n        root(DslContext.settingsRoot)\n    }\n\n    steps {\n        script {\n            scriptContent = \"\"\"\n                #!/bin/bash\n                docker run -v ${'$'}PWD:/path checkmarx/kics:latest scan -p /path -o /path --no-progress --ignore-on-exit results\n            \"\"\".trimIndent()\n        }\n    }\n})\n</code></pre> <p>With versioned settings enabled, after pushing the changes to the repository you'll be able to see the build progress, logs and success status.</p> <p></p> <p></p>"},{"location":"integrations_terraformer/","title":"Running KICS with Terraformer","text":"<p>From version 1.5, KICS integrates with Terraformer to scan resources deployed in the Cloud. The runtime information of the resources is obtained by providing a Terraformer path to KICS, via <code>-p</code> flag. The scan happens immediately after this information is obtained. In the end, results are shown as for any other KICS scan.</p> <p>Cloud providers supported: - AWS - AZURE - GCP</p>"},{"location":"integrations_terraformer/#configure_aws_credentials","title":"Configure AWS Credentials","text":"<p>For KICS to get the runtime information of your resources you need to provide AWS account Credentials as environment variables. Please note the AWS account provided should have read permissions to list service resources.</p> <p>Setting AWS credentials as environment variables</p> <p>MacOS and Linux:</p> <pre><code>export AWS_ACCESS_KEY_ID=\"&lt;AWS_ACCESS_KEY_ID&gt;\"\nexport AWS_SECRET_ACCESS_KEY=\"&lt;AWS_SECRET_ACCESS_KEY&gt;\"\nexport AWS_SESSION_TOKEN=\"&lt;AWS_SESSION_TOKEN&gt;\"\n</code></pre> <p>Windows:</p> <pre><code>SET AWS_ACCESS_KEY_ID=&lt;AWS_ACCESS_KEY_ID&gt;\nSET AWS_SECRET_ACCESS_KEY=&lt;AWS_SECRET_ACCESS_KEY&gt;\nSET AWS_SESSION_TOKEN=&lt;AWS_SESSION_TOKEN&gt;\n</code></pre> <p>Powershell:</p> <pre><code>$Env:AWS_ACCESS_KEY_ID=\"&lt;AWS_ACCESS_KEY_ID&gt;\"\n$Env:AWS_SECRET_ACCESS_KEY=\"&lt;AWS_SECRET_ACCESS_KEY&gt;\"\n$Env:AWS_SESSION_TOKEN=\"&lt;AWS_SESSION_TOKEN&gt;\"\n</code></pre>"},{"location":"integrations_terraformer/#configure_azure_credentials","title":"Configure AZURE Credentials","text":"<p>KICS provides two possibilities to use Terraformer with AZURE. Each one requires AZURE account credentials that you need to set as environment variables.</p>"},{"location":"integrations_terraformer/#using_service_principal_with_client_certificate","title":"Using Service Principal with Client Certificate","text":"<p>MacOS and Linux:</p> <pre><code>export ARM_SUBSCRIPTION_ID=\"&lt;ARM_SUBSCRIPTION_ID&gt;\"\nexport ARM_CLIENT_ID=\"&lt;ARM_CLIENT_ID&gt;\"\nexport ARM_CLIENT_CERTIFICATE_PATH=\"&lt;ARM_CLIENT_CERTIFICATE_PATH&gt;\"\nexport ARM_CLIENT_CERTIFICATE_PASSWORD=\"&lt;ARM_CLIENT_CERTIFICATE_PASSWORD&gt;\"\nexport ARM_TENANT_ID=\"&lt;ARM_TENANT_ID&gt;\"\n</code></pre> <p>Windows:</p> <pre><code>SET ARM_SUBSCRIPTION_ID=&lt;ARM_SUBSCRIPTION_ID&gt;\nSET ARM_CLIENT_ID=\"&lt;ARM_CLIENT_ID&gt;\"\nSET ARM_CLIENT_CERTIFICATE_PATH=\"&lt;ARM_CLIENT_CERTIFICATE_PATH&gt;\"\nSET ARM_CLIENT_CERTIFICATE_PASSWORD=\"&lt;ARM_CLIENT_CERTIFICATE_PASSWORD&gt;\"\nSET ARM_TENANT_ID=\"&lt;ARM_TENANT_ID&gt;\"\n</code></pre> <p>Powershell:</p> <pre><code>$Env:ARM_SUBSCRIPTION_ID=\"&lt;ARM_SUBSCRIPTION_ID&gt;\"\n$Env:ARM_CLIENT_ID=\"&lt;ARM_CLIENT_ID&gt;\"\n$Env:ARM_CLIENT_CERTIFICATE_PATH=\"&lt;ARM_CLIENT_CERTIFICATE_PATH&gt;\"\n$Env:ARM_CLIENT_CERTIFICATE_PASSWORD=\"&lt;ARM_CLIENT_CERTIFICATE_PASSWORD&gt;\"\n$Env:ARM_TENANT_ID=\"&lt;ARM_TENANT_ID&gt;\"\n</code></pre>"},{"location":"integrations_terraformer/#service_principal_with_client_secret","title":"Service Principal with Client Secret","text":"<p>MacOS and Linux:</p> <pre><code>export ARM_SUBSCRIPTION_ID=\"&lt;ARM_SUBSCRIPTION_ID&gt;\"\nexport ARM_CLIENT_ID=\"&lt;ARM_CLIENT_ID&gt;\"\nexport ARM_CLIENT_SECRET=\"&lt;ARM_CLIENT_SECRET&gt;\"\nexport ARM_TENANT_ID=\"&lt;ARM_TENANT_ID&gt;\"\n</code></pre> <p>Windows:</p> <pre><code>SET ARM_SUBSCRIPTION_ID=&lt;ARM_SUBSCRIPTION_ID&gt;\nSET ARM_CLIENT_ID=\"&lt;ARM_CLIENT_ID&gt;\"\nSET ARM_CLIENT_SECRET=\"&lt;ARM_CLIENT_SECRET&gt;\"\nSET ARM_TENANT_ID=\"&lt;ARM_TENANT_ID&gt;\"\n</code></pre> <p>Powershell:</p> <pre><code>$Env:ARM_SUBSCRIPTION_ID=\"&lt;ARM_SUBSCRIPTION_ID&gt;\"\n$Env:ARM_CLIENT_ID=\"&lt;ARM_CLIENT_ID&gt;\"\n$Env:ARM_CLIENT_SECRET=\"&lt;ARM_CLIENT_SECRET&gt;\"\n$Env:ARM_TENANT_ID=\"&lt;ARM_TENANT_ID&gt;\"\n</code></pre>"},{"location":"integrations_terraformer/#kics_terraformer_path_syntax","title":"KICS Terraformer Path Syntax","text":""},{"location":"integrations_terraformer/#aws","title":"AWS","text":"<pre><code>terraformer::{CloudProvider}:{Resources}:{Regions}\n</code></pre>"},{"location":"integrations_terraformer/#azure","title":"AZURE","text":"<pre><code>terraformer::{CloudProvider}:{Resources}\n</code></pre>"},{"location":"integrations_terraformer/#gcp","title":"GCP","text":"<pre><code>terraformer::{CloudProvider}:{Resources}:{Regions}:{Projects}\n</code></pre> <p>CloudProvider: The name of the Cloud Provider to import from.</p> <p>Possible values: - <code>aws</code> - <code>azure</code> - <code>gcp</code></p> <p>Resources: A slash-separated list of the resources intended to be imported and scanned. You can find a complete list of possible values in the links below: - aws - azure - gcp</p> <p>To import all resources please use: <code>*</code></p> <p>Regions: A slash-separated list of the regions to import from. It is only required for AWS and GCP.</p> <p>Projects: A slash-separated list of the projects ids to import from. It is only required for GCP.</p>"},{"location":"integrations_terraformer/#running_kics_with_terraformer_1","title":"Running KICS with Terraformer","text":"<p>When Running KICS using a terraformer path, resources are imported using the credentials set as environment variables in terraform format to the current working directory in a new folder named <code>kics-extract-terraformer</code> following the above-described structure. KICS will then run a scan on these local files.</p> <p>If the flag <code>-o, --output-path</code> is passed the folder <code>kics-extract-terraformer</code> will be generated in the reports directory instead.</p>"},{"location":"integrations_terraformer/#imported_resources_tree_structure","title":"Imported Resources tree structure:","text":"<pre><code> \u25be kics-extract-terraformer/\n    \u25be {region}/\n        \u25be {resource}/\n            provider.tf\n            {resource}.tf\n            terraform.tfstate\n            variables.tf\n</code></pre>"},{"location":"integrations_terraformer/#aws_run_kics_terraformer_integration_with_docker","title":"[AWS] Run KICS Terraformer integration with Docker","text":"<p>To run KICS Terraformer integration with Docker simply pass the AWS Credentials that were set as environment variables to the <code>docker run</code> command and use the terraformer path syntax</p> <p>Examples:</p> <pre><code>docker run -e AWS_SECRET_ACCESS_KEY -e AWS_ACCESS_KEY_ID -e AWS_SESSION_TOKEN checkmarx/kics:latest scan -p \"terraformer::aws:vpc:eu-west-2\" -v --no-progress\n</code></pre> <pre><code>docker run -e AWS_SECRET_ACCESS_KEY -e AWS_ACCESS_KEY_ID -e AWS_SESSION_TOKEN -v ${PWD}:/path/ checkmarx/kics:latest scan -p \"terraformer::aws:vpc:eu-west-2\" -v --no-progress -o /path/results\n</code></pre> <p></p>"},{"location":"integrations_terraformer/#azure_run_kics_terraformer_integration_with_docker","title":"[AZURE] Run KICS Terraformer integration with Docker","text":"<p>To run KICS Terraformer integration with Docker simply pass the AZURE Credentials that were set as environment variables to the docker run command and use the terraformer path syntax. Choose one of the following options:</p>"},{"location":"integrations_terraformer/#using_service_principal_with_client_certificate_1","title":"Using Service Principal with Client Certificate","text":"<p>Note that you should fill the <code>&lt;certificate_path&gt;</code> with the path that points to the directory where your certificate is located, and the <code>&lt;certificate-name&gt;</code> should point to the certificate name located in <code>&lt;certificate_path&gt;</code>.</p> <pre><code>docker run -v &lt;certificate_path&gt;:/certificate -e ARM_CLIENT_CERTIFICATE_PATH=/certificate/&lt;certificate_name&gt;.pfx -e ARM_CLIENT_CERTIFICATE_PASSWORD -e ARM_TENANT_ID -e ARM_CLIENT_ID -e ARM_SUBSCRIPTION_ID checkmarx/kics:latest scan -p \"terraformer::azure:storage_account\" -v --no-progress\n</code></pre> <pre><code>docker run -v &lt;certificate_path&gt;:/certificate -v ${PWD}:/path/ -e ARM_CLIENT_CERTIFICATE_PATH=/certificate/&lt;certificate_name&gt;.pfx -e ARM_CLIENT_CERTIFICATE_PASSWORD -e ARM_TENANT_ID -e ARM_CLIENT_ID -e ARM_SUBSCRIPTION_ID checkmarx/kics:latest scan -p \"terraformer::azure:storage_account\" -v --no-progress -o /path/results\n</code></pre> <p></p>"},{"location":"integrations_terraformer/#service_principal_with_client_secret_1","title":"Service Principal with Client Secret","text":"<pre><code>docker run -e ARM_SUBSCRIPTION_ID -e ARM_CLIENT_ID -e ARM_CLIENT_SECRET -e ARM_TENANT_ID checkmarx/kics:latest scan -p \"terraformer::azure:storage_account\" -v --no-progress\n</code></pre> <pre><code>docker run -e ARM_SUBSCRIPTION_ID -e ARM_CLIENT_ID -e ARM_CLIENT_SECRET -e ARM_TENANT_ID -v ${PWD}:/path/ checkmarx/kics:latest scan -p \"terraformer::azure:storage_account\" -v --no-progress -o /path/results\n</code></pre>"},{"location":"integrations_terraformer/#gcp_run_kics_terraformer_integration_with_docker","title":"[GCP] Run KICS Terraformer integration with Docker","text":"<p>To run KICS Terraformer integration with Docker, pass the path that points to the JSON file that contains your service account key as an environment variable (GOOGLE_APPLICATION_CREDENTIALS) to the docker run command and use the terraformer path syntax. Note that your project should have a region defined, and your account should have read permissions to list resources.</p> <p>Also note that you should fill the <code>&lt;credentials_path&gt;</code> with the path that points to the directory where your service account key file is located, and the <code>&lt;credentials-file-name&gt;</code> should point to the service account key file name located in <code>&lt;credentials_path&gt;</code>.</p> <pre><code> docker run -v &lt;credentials_path&gt;:/credentials -e GOOGLE_APPLICATION_CREDENTIALS=/credentials/&lt;credentials-file-name&gt; checkmarx/kics:latest scan -p \"terraformer::gcp:gcs:us-east4:project\" -v --no-progress --log-level=DEBUG\n</code></pre> <pre><code> docker run -v &lt;credentials_path&gt;:/credentials -v ${PWD}:/path/ -e GOOGLE_APPLICATION_CREDENTIALS=/credentials/&lt;credentials-file-name&gt; checkmarx/kics:latest scan -p \"terraformer::gcp:gcs:us-east4:project\" -v --no-progress --log-level=DEBUG -o /path/results\n</code></pre> <p></p>"},{"location":"integrations_terraformer/#notes","title":"NOTES","text":"<ul> <li>If environment credentials are incorrect a timeout may occur.</li> <li>If the resource to import doesn't exist in the region specified a {resource}.tf file will not be created.</li> <li>You can find the Terraform output in <code>terraformer-output.txt</code> inside <code>kics-extract-terraformer</code> folder.</li> </ul>"},{"location":"integrations_tfcloud/","title":"Terraform Cloud","text":""},{"location":"integrations_tfcloud/#integrate_kics_with_terraform_cloud","title":"Integrate KICS with Terraform Cloud","text":"<p>You can integrate KICS into Terraform Cloud as a Task Event Hook.</p> <p>This provides you the ability to run a KICS scan on the plan in the pre-apply stage.</p>"},{"location":"integrations_tfcloud/#configuring_kics_as_a_task_event_hook","title":"Configuring KICS as a Task Event Hook","text":"<p>To Configure Task Event Hook go to:</p> <p>Organization Settings -&gt; Integrations -&gt; Task Event Hook -&gt; Create Event Hook</p> <p></p> <p>Set the name you wish for the Task Event Hook</p> <p>In the Hook endpoint URL place:</p> <pre><code>https://kics.io/tfc/event?failOn=low\n</code></pre> <p>And Create event hook.</p> <p>Note: You can choose which kind of severity you wish for KICS to fail on by passing <code>failOn</code> as query parameter in the URL. KICS will fail on any result found with that severity and above.</p> <p>Available Severities are:  - high  - medium  - low  - info</p> <p>Query parameter <code>failOn</code> is required and cannot be empty.</p>"},{"location":"integrations_tfcloud/#adding_kics_event_hook_to_workspace","title":"Adding KICS Event Hook to Workspace","text":"<p>To add KICS Event Hook as a Task to your Workspace go to:</p> <p>Workspace Settings -&gt; Tasks -&gt; Available Event Hooks and Choose KICS Event Hook you just created</p> <p></p> <p>Choose the Enforcement Level and press Create</p> <p>And now every time a new plan is started KICS will scan this plan for Vulnerabilities and missconfigurations</p>"},{"location":"integrations_tfcloud/#example_results","title":"Example Results","text":"<p>Task Failed </p> <p>To see KICS Scan report press <code>Details</code> to download the html report and see all vulnerabilities found by KICS</p> <p>Please keep in mind the report link is only active for 15 minutes</p> <p>Task Passed </p>"},{"location":"integrations_travisci/","title":"Running KICS in TravisCI","text":"<p>You can integrate KICS into your Travis CI/CD pipelines.</p> <p>This provides you the ability to run KICS scans in your repositories and streamline vulnerabilities and misconfiguration checks to your infrastructure as code (IaC).</p>"},{"location":"integrations_travisci/#example_configuration_using_docker","title":"Example configuration using docker","text":"<pre><code>services:\n    - docker\n\nbefore_install:\n    - docker pull checkmarx/kics:latest\n\nscript:\n    - docker run -v ${PWD}/path checkmarx/kics:latest scan -p /path -o ${PWD} --ci --ignore-on-exit results\n</code></pre>"},{"location":"kics_auto_remediation/","title":"KICS AUTO REMEDIATION","text":"<p>With this new feature, KICS provides auto remediation for simple replacements and simple additions in a single line.</p> <p>Note that this feature will be only available for Terraform, for now.</p> <p> </p>"},{"location":"kics_auto_remediation/#how_kics_ar_works","title":"HOW KICS AR WORKS?","text":"<ol> <li>As a first step, you will need to scan your project/file and generate a JSON report.</li> </ol> <p>Example: <code>docker run -v /home/cosmicgirl/:/path/ kics scan -p /path/sample.tf -i \"41a38329-d81b-4be4-aef4-55b2615d3282,a9dfec39-a740-4105-bbd6-721ba163c053,2bb13841-7575-439e-8e0a-cccd9ede2fa8\" --no-progress -o /path/results --report-formats json</code></p> <p>If KICS makes available a remediation for a result, the result will have the fields <code>remediation</code> and <code>remediation_type</code> defined. As an example, please see:   <p> </p> </p> <ol> <li>If your JSON report has any result with remediation, you will need to run the new KICS command: remediate. </li> </ol> <p>If you want KICS to remediate all the reported issues, you can run </p> <p><code>docker run -v /home/cosmicgirl/:/path/ kics remediate --results /path/results/results.json -v</code>.</p> <p>If you want to specify which remediation KICS should fix, you can use the flag <code>--include-ids</code>. In this flag, you should point the <code>similarity_id</code> of the result. For example: </p> <p><code>docker run -v /home/cosmicgirl/:/path/ kics remediate --results /path/results/results.json --include-ids \"f282fa13cf5e4ffd4bbb0ee2059f8d0240edcd2ca54b3bb71633145d961de5ce\" -v</code></p>"},{"location":"performance/","title":"Performance","text":""},{"location":"performance/#kics_accuracy_benchmark","title":"KICS Accuracy Benchmark","text":"<p>The values below were obtained after scanning 150 open source projects with KICS (1.2.x) covering the supported IaC technologies (c.f., Terraform, Ansible, Kubernetes, Docker, AWS Cloudformation).</p> IaC Technology Query Accuracy1 Query Coverage2 Scanned IaC files\u200b Number of Results\u200b Average Scan Time\u200b (s) Average Project Size (MB) Terraform\u200b 99.7%\u200b 46% 1176\u200b 709 6.6 33.4\u200b Docker\u200b 98.8%\u200b\u200b 68%\u200b 1017\u200b 5109 11 0.7 Kubernetes\u200b 99.3%\u200b\u200b 88.7%\u200b 6089\u200b 21753 7 90 CloudFormation\u200b 95%\u200b 73%\u200b 1769\u200b 5343 10.2 4.8 Ansible \u200b 100% \u200b 54%\u200b 3367\u200b 1320 23.3 4.1 <p>1 Query Accuracy = TP results / results</p> <p>2 Query Coverage = Query with results / Queries</p> <p></p>"},{"location":"performance/#global_measures","title":"Global Measures","text":"Measure Value Average Accuracy 98.6% Total Number of Results 34234 Average Query Coverage 66.4% Total Scanned IaC Files 13418 Average Scan Time (s) 11.2 Average Project Size (MB) 26.6"},{"location":"performance/#kics_profiling","title":"KICS Profiling","text":"<p>Running Kics with <code>--profiling</code> flag will log the CPU/MEM metrics used for:</p> <ul> <li>Getting Queries</li> <li>Parsing Files</li> <li>Scanning Vulnerabilities</li> <li>Generating Reports</li> </ul> <p>Keep in mind that profiling will periodically stop KICS to retrieve the wanted metrics, meaning KICS execution time will increase substantially.</p>"},{"location":"performance/#cpu_profiling","title":"CPU Profiling","text":"<p>Flag: <code>--profiling CPU</code></p> <pre><code>9:43AM INF Scanning with Keeping Infrastructure as Code Secure dev\n9:43AM INF Total CPU usage for get_queries: 6.56s &lt;-\n9:43AM INF Inspector initialized, number of queries=1385\n9:43AM INF Total CPU usage for get_sources: 200.00ms &lt;-\n9:43AM INF Total CPU usage for inspect: 15.43s &lt;-\n9:43AM INF Results saved to file results/results.json fileName=results.json\n9:43AM INF Results saved to file results/results.sarif fileName=results.sarif\n9:43AM INF Results saved to file results/results.html fileName=results.html\n9:43AM INF Total CPU usage for generate_report: 290.00ms &lt;-\n9:43AM INF Files scanned: 221\n9:43AM INF Parsed files: 221\n9:43AM INF Queries loaded: 1385\n9:43AM INF Queries failed to execute: 0\n9:43AM INF Inspector stopped\n9:43AM INF Scan duration: 21.1476197s\n</code></pre>"},{"location":"performance/#mem_profiling","title":"MEM Profiling","text":"<p>Flag: <code>--profiling MEM</code></p> <pre><code>9:43AM INF Scanning with Keeping Infrastructure as Code Secure dev\n9:43AM INF Total MEM usage for get_queries: 237.96MB &lt;-\n9:43AM INF Inspector initialized, number of queries=1385\n9:43AM INF Total MEM usage for get_sources: 280.53MB &lt;-\n9:43AM INF Total MEM usage for inspect: 335.44MB &lt;-\n9:43AM INF Results saved to file results/results.json fileName=results.json\n9:43AM INF Results saved to file results/results.sarif fileName=results.sarif\n9:43AM INF Results saved to file results/results.html fileName=results.html\n9:43AM INF Total MEM usage for generate_report: 333.38MB &lt;-\n9:43AM INF Files scanned: 221\n9:43AM INF Parsed files: 221\n9:43AM INF Queries loaded: 1385\n9:43AM INF Queries failed to execute: 0\n9:43AM INF Inspector stopped\n9:43AM INF Scan duration: 21.1476197s\n</code></pre>"},{"location":"platforms/","title":"Technologies","text":"<p>KICS support scanning multiple technologies, in the next sections you will find more details about each technology.</p>"},{"location":"platforms/#ansible","title":"Ansible","text":"<p>KICS supports scanning Ansible files with <code>.yaml</code> extension.</p> <p>KICS can decrypt Ansible Vault files on the fly. For that, you need to define the environment variable <code>ANSIBLE_VAULT_PASSWORD_FILE</code>.</p>"},{"location":"platforms/#azure_resource_manager","title":"Azure Resource Manager","text":"<p>KICS supports scanning Azure Resource Manager (ARM) templates with <code>.json</code> extension. To build ARM JSON templates from Bicep code check the official ARM documentation and here to understand the differences between ARM JSON templates and Bicep.</p>"},{"location":"platforms/#cdk","title":"CDK","text":"<p>AWS Cloud Development Kit is a software development framework for defining cloud infrastructure in code and provisioning it through AWS CloudFormation.</p> <p>It has all the advantages of using AWS CloudFormation.</p> <p>KICS currently support scanning AWS Cloudformation templates. In this guide, we will describe how to scan a simple CDK defined infrastructure following the Working With the AWS CDK in Go documentation.</p> <p>Make sure all prerequisites are met.</p>"},{"location":"platforms/#create_a_project","title":"Create a project","text":"<ol> <li>Create a new CDK project using the CLI. e.g:</li> </ol> <pre><code>mkdir test-cdk\ncd test-cdk\ncdk init app --language go\n</code></pre> <ol> <li>Download dependencies</li> </ol> <pre><code>go mod download\n</code></pre> <ol> <li>Synthetize CloudFormation template</li> </ol> <pre><code>cdk synth &gt; cfn-stack.yaml\n</code></pre> <ol> <li>Execute KICS against the template and check the results. Note that KICS will recognized it as CloudFormation (for queries purpose).</li> </ol> <pre><code>docker run -t -v $PWD/cfn-stack.yaml:/path/cfn-stack.yaml -it checkmarx/kics:latest scan -p /path/cfn-stack.yaml\n</code></pre>"},{"location":"platforms/#cloudformation","title":"CloudFormation","text":"<p>KICS supports scanning CloudFormation templates with <code>.json</code> or <code>.yaml</code> extension.</p>"},{"location":"platforms/#crossplane","title":"Crossplane","text":"<p>KICS supports scanning Crossplane manifests with <code>.yaml</code> extension.</p>"},{"location":"platforms/#azure_blueprints","title":"Azure Blueprints","text":"<p>KICS supports scanning Azure Blueprints files, including Azure Blueprints Policy Assignment Artifacts, Azure Blueprints Role Assignment Artifacts, and Azure Blueprints Template Artifacts with <code>.json</code> extension.</p> <p>Note that KICS recognizes this technology as Azure Resource Manager (for queries purpose).</p>"},{"location":"platforms/#docker","title":"Docker","text":"<p>KICS supports scanning Docker files named <code>Dockerfile</code> or with <code>.dockerfile</code> extension.</p>"},{"location":"platforms/#docker_compose","title":"Docker Compose","text":"<p>KICS supports scanning DockerCompose files with <code>.yaml</code> extension.</p>"},{"location":"platforms/#grpc","title":"gRPC","text":"<p>KICS supports scanning gRPC files with <code>.proto</code> extension.</p>"},{"location":"platforms/#helm","title":"Helm","text":"<p>KICS supports scanning Helm by rendering charts and running Kubernetes queries against the rendered manifest.</p> <p>The charts file structure must be as explained by Helm: https://helm.sh/docs/topics/charts/#the-chart-file-structure.</p> <p>Results are displayed against original Helm files:</p> <pre><code>Service With External Load Balance, Severity: MEDIUM, Results: 1\nDescription: Service has an external load balancer, which may cause accessibility from other networks and the Internet\nPlatform: Kubernetes\n\n        [1]: /charts/nginx-ingress/templates/controller-service.yaml:20\n\n                019:     release: {{ template \"nginx-ingress.releaseLabel\" . }}\n                020:   name: {{ template \"nginx-ingress.controller.fullname\" . }}\n                021: spec:\n\n</code></pre>"},{"location":"platforms/#knative","title":"Knative","text":"<p>KICS supports scanning Knative manifests with <code>.yaml</code> extension. Due to the possibility of the definition of the PodSpec and PodTemplate in Knative files, Kubernetes Security Queries are also loaded once the presence of the Knative files is detected.</p>"},{"location":"platforms/#kubernetes","title":"Kubernetes","text":"<p>KICS supports scanning Kubernetes manifests with <code>.yaml</code> extension.</p>"},{"location":"platforms/#openapi","title":"OpenAPI","text":"<p>KICS supports scanning Swagger 2.0 and OpenAPI 3.0 specs with <code>.json</code> and <code>.yaml</code> extension.</p>"},{"location":"platforms/#pulumi","title":"Pulumi","text":"<p>KICS supports scanning Pulumi manifests with <code>.yaml</code> extension.</p>"},{"location":"platforms/#serverlessfw","title":"ServerlessFW","text":"<p>KICS supports scanning Serverless manifests with <code>.yml</code> extension. Due to the possibility of the definition of the CloudFormation template,  inside <code>Serverless.yml</code>, CloudFormation Security Queries are also loaded once the presence of the ServerlessFW files is detected.</p>"},{"location":"platforms/#google_deployment_manager","title":"Google Deployment Manager","text":"<p>KICS supports scanning Google Deployment Manager files with <code>.yaml</code> extension.</p>"},{"location":"platforms/#sam","title":"SAM","text":"<p>KICS supports AWS Serverless Application Model (AWS SAM) files with <code>.yaml</code> extension. Note that KICS recognizes this technology as CloudFormation (for queries purpose).</p>"},{"location":"platforms/#terraform","title":"Terraform","text":"<p>KICS supports scanning Terraform's HCL files with <code>.tf</code> extension and input variables using <code>terraform.tfvars</code> or files with <code>.auto.tfvars</code> extension that are in same directory of <code>.tf</code> files.</p>"},{"location":"platforms/#terraform_plan","title":"Terraform Plan","text":"<p>KICS supports scanning terraform plans given in JSON. The <code>planned_values</code> will be extracted, built in a way that KICS can understand, and scanned as a normal terraform file.</p> <p>Results will point to the plan file.</p> <p>To get terraform plan in JSON format simply run the command:</p> <pre><code>terraform show -json plan-sample.tfplan &gt; plan-sample.tfplan.json\n</code></pre>"},{"location":"platforms/#terraform_modules","title":"Terraform Modules","text":"<p>KICS supports some official modules for AWS that can be found on Terraform registry, you can see the supported modules list in the libraries folder common.json file. This means KICS can find issues in verified modules listed on this json.</p> <p>Currently, KICS does not support unofficial or custom modules.</p>"},{"location":"platforms/#cloud_development_kit_for_terraform_cdktf","title":"Cloud Development Kit for Terraform (CDKTF)","text":"<p>KICS supports scanning CDKTF output JSON. It recognizes it through the fields <code>metadata</code>, <code>stackName</code>, and <code>terraform</code>.</p> <p>To get your CDKTF output JSON, run the following command inside the directory that contains your app:</p> <pre><code>cdktf synth\n</code></pre> <p>You can also run the command <code>cdktf synth --json</code> to display it in the terminal.</p>"},{"location":"platforms/#limitations","title":"Limitations","text":""},{"location":"platforms/#ansible_1","title":"Ansible","text":"<p>At the moment, KICS does not support a robust approach to identifying Ansible samples. The identification of these samples is done through exclusion. When a YAML sample is not a CloudFormation, Google Deployment Manager, Helm, Kubernetes or OpenAPI sample, KICS recognize it as Ansible.</p> <p>Thus, KICS recognize other YAML samples (that are not Ansible) as Ansible, e.g. GitHub Actions samples. However, you can ignore these samples by writing <code>#kics-scan ignore</code> on the top of the file. For more details, please read this documentation.</p>"},{"location":"platforms/#terraform_1","title":"Terraform","text":"<p>Although KICS support variables and interpolations, KICS does not support functions and enviroment variables. In case of variables used as function parameters, it will parse as wrapped expression, so the following function call:</p> <pre><code>resource \"aws_launch_configuration\" \"example\" {\n  image_id      = data.aws_ami.ubuntu.id\n  instance_type = \"${concat(list(\"${var.name}\", \"${var.other_name}\"), var.node_tags)}\"\n  spot_price    = var.price\n  user_data_base64 = \"${var.data}==\"\n}\n</code></pre> <p>Considering <code>var.data = \"a123B\"</code> and <code>var.price = 1.023</code>, it would be parsed like the following example:</p> <pre><code>resource \"aws_launch_configuration\" \"example\" {\n  image_id      = data.aws_ami.ubuntu.id\n  instance_type = \"${concat(list(\"${var.name}\", \"${var.other_name}\"), var.node_tags)}\"\n  spot_price    = 1.023\n  user_data_base64 = \"a123B==\"\n}\n</code></pre>"},{"location":"queries/","title":"General Info","text":""},{"location":"queries/#query_categories","title":"Query Categories","text":"<p>You can find a list of queries, and their associated categories here: https://docs.kics.io/latest/queries/all-queries/</p> <p>The category list is:</p> <ul> <li>Access Control</li> <li>Availability</li> <li>Backup</li> <li>Best Practices</li> <li>Build Process</li> <li>Encryption</li> <li>Insecure Configurations</li> <li>Insecure Defaults</li> <li>Networking and Firewall</li> <li>Observability</li> <li>Resource Management</li> <li>Secret Management</li> <li>Structure and Semantics</li> <li>Supply-Chain</li> </ul>"},{"location":"queries/#queries","title":"Queries","text":"<p>KICS queries are written in OPA (Rego).</p> <pre><code>CxPolicy [ result ] {\n   resource := input.document[i].resource.aws_s3_bucket[name]\n   role = \"public-read\"\n   resource.acl == role\n\n   result := {\n        \"documentId\":       input.document[i].id,\n        \"searchKey\":        sprintf(\"aws_s3_bucket[%s].acl\", [name]),\n        \"issueType\":        \"IncorrectValue\",\n        \"keyExpectedValue\": sprintf(\"aws_s3_bucket[%s].acl is private\", [name]),\n        \"keyActualValue\":   sprintf(\"aws_s3_bucket[%s].acl is %s\", [name, role])\n    }\n}\n</code></pre>"},{"location":"queries/#anatomy","title":"Anatomy","text":"<p>The anatomy of a query is straightforward. It builds up a policy and defines the result.</p> <p>The policy builds the pattern that breaks the security of the infrastructure code and which the query is looking for.</p> <p>The result defines the specific data used to present the vulnerability in the infrastructure code.</p>"},{"location":"queries/#metadata","title":"Metadata","text":"<p>Each query has a metadata.json companion file with all the relevant information about the vulnerability, including the severity, category and its description.</p> <p>For example, the JSON code above is the metadata corresponding to the query in the beginning of this document.</p> <pre><code>{\n  \"id\": \"5738faf3-3fe6-4614-a93d-f0003242d4f9\",\n  \"queryName\": \"All Users Group Gets Read Access\",\n  \"severity\": \"HIGH\",\n  \"category\": \"Identity and Access Management\",\n  \"descriptionText\": \"It's not recommended to allow read access for all user groups.\",\n  \"descriptionUrl\": \"https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#acl\",\n  \"platform\": \"Terraform\"\n}\n</code></pre>"},{"location":"queries/#organization","title":"Organization","text":"<p>Filesystem-wise, KICS queries are organized per IaC technology or tool (e.g., terraform, k8s, dockerfile, etc.) and grouped under provider (e.g., aws, gcp, azure, etc.) when applicable.</p> <p>Per each query created, it is mandatory the creation of test cases with, at least, one negative and positive case and a JSON file with data about the expected results, as shown below:</p> <pre><code>[\n  {\n    \"queryName\": \"All Users Group Gets Read Access\",\n    \"severity\": \"HIGH\",\n    \"line\": 3\n  }\n]\n</code></pre> <p>Summarizing, the following is the expected file tree for a query:</p> <pre><code>- &lt;technology&gt;\n    |- &lt;provider&gt;\n    |   |- &lt;queryfolder&gt;\n    |   |   |- test\n    |   |   |   |- positive&lt;.ext&gt;\n    |   |   |   |- negative&lt;.ext&gt;\n    |   |   |   |- positive_expected_result.json\n    |   |   |- metadata.json\n    |   |   |- query.rego\n</code></pre> <p>Also, a query can contains multiples positive and negative files, but all cases files names must start with negative or positive and each positive file must be referenced on <code>positive_expected_result.json</code>, as shown below:</p> <pre><code>[\n  {\n    \"queryName\": \"ELB Sensitive Port Is Exposed To Entire Network\",\n    \"severity\": \"HIGH\",\n    \"line\": 37,\n    \"fileName\": \"positive1.yaml\"\n  },\n  {\n    \"queryName\": \"ELB Sensitive Port Is Exposed To Entire Network\",\n    \"severity\": \"HIGH\",\n    \"line\": 22,\n    \"fileName\": \"positive2.yaml\"\n  }\n]\n</code></pre> <p>And the file tree should be as follows:</p> <pre><code>- &lt;technology&gt;\n    |- &lt;provider&gt;\n    |   |- &lt;queryfolder&gt;\n    |   |   |- test\n    |   |   |   |- positive1&lt;.ext&gt;\n    |   |   |   |- positive2&lt;.ext&gt;\n    |   |   |   |- negative1&lt;.ext&gt;\n    |   |   |   |- negative2&lt;.ext&gt;\n    |   |   |   |- positive_expected_result.json\n    |   |   |- metadata.json\n    |   |   |- query.rego\n</code></pre>"},{"location":"queries/#query_dependencies","title":"Query Dependencies","text":"<p>If you want to use the functions defined in your own library, you should use the flag <code>-b</code> to indicate the directory where the libraries are placed. The functions need to be grouped by platform and the library name should follow the following format: <code>&lt;platform&gt;.rego</code>. It doesn't matter your directory structure. In other words, for example, if you want to indicate a directory that contains a library for your terraform queries, you should group your functions (used in your terraform queries) in a file named <code>terraform.rego</code> wherever you want.</p>"},{"location":"release_checklist/","title":"Release Checklist","text":"<ol> <li>Check for any <code>update-queries-docs</code> pull requests open, review and merge if any</li> <li>Prepare release (run prepare-release action)</li> <li>Use prepare release pull request (<code>docs: preparing for release</code>) to bump UBI8 image version label in the Dockerfile.ubi8 and index.md</li> <li>Review and merge prepare-release pull-request</li> <li>Create and push a new version git tag<ul> <li>Be sure you configure commit signature verification</li> <li>In the master branch, run <code>git tag &lt;tag_version&gt;</code> and <code>git push -u origin &lt;tag_version&gt;</code></li> </ul> </li> <li>Test pre-release manually on each platform</li> <li>In Tags, create the release for the target version. Do not forget to select \"Create a discussion for this release\" and check if it was created.</li> <li>Check if <code>update-docs-release</code>, <code>update-infra-version</code>, and <code>release-docker-image</code> workflow completed with success</li> <li>Check if the image is published in dockerhub / update hub documentation if changed</li> <li>Push image to Red Hat</li> <li>Update integrations tag:<ul> <li>git checkout integrations</li> <li>git checkout -b ${new_branch}</li> <li>git merge ${latest_tag} // update internal/constants/constants.go version to latest</li> <li>git push -u origin HEAD // create PR and merge ${new_branch} with integrations branch !! Warning !! Make sure that branch is being merged with integrations and not master</li> <li>git checkout integrations</li> <li>git tag ${latest_tag}-integrations</li> <li>git push origin ${latest_tag}-integrations NOTE: make sure that <code>pkg/terraformer</code> only has <code>terraformer_alt.go</code> without build tags</li> </ul> </li> </ol>"},{"location":"releases/","title":"Releases","text":""},{"location":"releases/#releases","title":"Releases","text":"<p>For our release versions we follow the SemVer specification, meaning that we structure our versions into a MAJOR.MINOR.PATCH semantic.</p> <p>Our current release process is structured in the following way:</p> <ul> <li>PATCH versions for minor backwards compatible bug fixes and new small features. This should have a bi-weekly cadence.</li> <li>MINOR versions will include functionality that is backwards compatible. This should have a monthly cadence.</li> <li>MAJOR versions for major functionality that it's added or changes that are not backwards compatible.</li> </ul> <p>Every release is packed with:</p> <ul> <li>Docker image uploaded to DockerHub</li> </ul> <p>If waiting for a new release it's not enough, we also provide nightly builds that include the latest changes.</p> <p>You can find our releases here.</p>"},{"location":"releases/#docker_images","title":"Docker Images","text":"<p>KICS docker images are pushed to DockerHub</p> <p>List of images digests:</p> <ul> <li>Release versions</li> <li>Nightly images</li> </ul>"},{"location":"results/","title":"Results","text":"<p>To export in JSON format in current directory, you can use the following command:</p> <pre><code>./kics scan -p &lt;path-of-your-project-to-scan&gt; -o ./\n</code></pre> <p>To generate in other formats you can use the following command:</p> <pre><code>./kics scan -p &lt;path-of-your-project-to-scan&gt; --report-formats &lt;formats-wanted&gt; -o ./\n</code></pre> <p>KICS also can export multiple format in a single scan, to do this the flags output-path and report-formats should be combined, where the output-path will be the directory containing all report files and report-formats all extensions wanted, like following example:</p> <pre><code>./kics scan -p &lt;path-of-your-project-to-scan&gt; -o ./output --report-formats \"all\"\n</code></pre> <p>The last command will execute the scan and save all types reports on output folder with results name.</p> <p>You can also change the default name by using the following command:</p> <pre><code>./kics scan -p &lt;path-of-your-project-to-scan&gt; -o ./output --report-formats \"glsast,html,pdf\" --output-name kics-result\n</code></pre> <p>This will generate an HTML and Gitlab SAST reports on output folder, with <code>kics-result</code> and <code>gl-sast-kics-result</code> names.</p>"},{"location":"results/#descriptions","title":"Descriptions","text":"<p>After the scanning process is done, If an internet connection is available, KICS will try to fetch CIS Proprietary vulnerability descriptions from a HTTP endpoint, this can be disabled with <code>--disable-cis-descriptions</code>. If used in offline mode or no internet connection is available, KICS should use the default descriptions.</p> <p>In case of using KICS behind a corporate proxy, proxy configurations can be set with environment variables such as <code>HTTP_PROXY</code>, <code>HTTPS_PROXY</code>, <code>NO_PROXY</code></p>"},{"location":"results/#json","title":"JSON","text":"<p>The JSON report is the default report to be generate, if no arg is passed to <code>report-formats</code> flag, also you can explicitly use it with <code>--report-formats \"json\"</code>. JSON reports are sorted by severity (from high to info) and should looks like as following:</p> <pre><code>{\n    \"files_scanned\": 2,\n    \"files_parsed\": 2,\n    \"files_failed_to_scan\": 0,\n    \"queries_total\": 253,\n    \"queries_failed_to_execute\": 0,\n    \"queries_failed_to_compute_similarity_id\": 0,\n    \"queries\": [\n        {\n            \"query_name\": \"Container Allow Privilege Escalation Is True\",\n            \"query_id\": \"c878abb4-cca5-4724-92b9-289be68bd47c\",\n            \"severity\": \"MEDIUM\",\n            \"platform\": \"Terraform\",\n            \"files\": [\n                {\n                    \"file_name\": \"assets/queries/terraform/kubernetes/container_allow_privilege_escalation_is_true/test/positive.tf\",\n                    \"similarity_id\": \"063ed2389809f5f01ff420b63634700a9545c5e5130a6506568f925cdb0f8e13\",\n                    \"line\": 11,\n                    \"issue_type\": \"IncorrectValue\",\n                    \"search_key\": \"kubernetes_pod[test3].spec.container.allow_privilege_escalation\",\n                    \"search_value\": \"\",\n                    \"expected_value\": \"Attribute 'allow_privilege_escalation' is undefined or false\",\n                    \"actual_value\": \"Attribute 'allow_privilege_escalation' is true\",\n                    \"value\": null\n                }\n            ]\n        }\n    ],\n    \"scan_id\": \"console\",\n    \"severity_counters\": {\n        \"HIGH\": 0,\n        \"INFO\": 0,\n        \"LOW\": 0,\n        \"MEDIUM\": 1\n    },\n    \"total_counter\": 1\n}\n</code></pre>"},{"location":"results/#sarif","title":"SARIF","text":"<p>You can export sarif report by using <code>--report-formats \"sarif\"</code>. SARIF reports are sorted by severity (from high to info), following SARIF v2.1.0 standard and looks like:</p> <pre><code>{\n    \"$schema\": \"https://raw.githubusercontent.com/oasis-tcs/sarif-spec/master/Schemata/sarif-schema-2.1.0.json\",\n    \"version\": \"2.1.0\",\n    \"runs\": [\n        {\n            \"tool\": {\n                \"driver\": {\n                    \"name\": \"KICS\",\n                    \"version\": \"1.2.0\",\n                    \"fullName\": \"Keeping Infrastructure as Code Secure\",\n                    \"informationUri\": \"https://www.kics.io/\",\n                    \"rules\": [\n                        {\n                            \"id\": \"c878abb4-cca5-4724-92b9-289be68bd47c\",\n                            \"name\": \"Container Allow Privilege Escalation Is True\",\n                            \"shortDescription\": {\n                                \"text\": \"Container Allow Privilege Escalation Is True\"\n                            },\n                            \"fullDescription\": {\n                                \"text\": \"Admission of privileged containers should be minimized\"\n                            },\n                            \"defaultConfiguration\": {\n                                \"level\": \"warning\"\n                            },\n                            \"helpUri\": \"https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/pod#allow_privilege_escalation\",\n                            \"relationships\": [\n                                {\n                                    \"target\": {\n                                        \"id\": \"CAT001\",\n                                        \"index\": 5,\n                                        \"toolComponent\": {\n                                            \"name\": \"Categories\",\n                                            \"guid\": \"58cdcc6f-fe41-4724-bfb3-131a93df4c3f\",\n                                            \"index\": 0\n                                        }\n                                    }\n                                }\n                            ]\n                        }\n                    ]\n                }\n            },\n            \"results\": [\n                {\n                    \"ruleId\": \"c878abb4-cca5-4724-92b9-289be68bd47c\",\n                    \"ruleIndex\": 0,\n                    \"kind\": \"fail\",\n                    \"message\": {\n                        \"text\": \"Attribute 'allow_privilege_escalation' is true\"\n                    },\n                    \"locations\": [\n                        {\n                            \"physicalLocation\": {\n                                \"artifactLocation\": {\n                                    \"uri\": \"assets/queries/terraform/kubernetes/container_allow_privilege_escalation_is_true/test/positive.tf\"\n                                },\n                                \"region\": {\n                                    \"startLine\": 11\n                                }\n                            }\n                        }\n                    ]\n                }\n            ],\n            \"taxonomies\": [\n                {\n                    \"guid\": \"58cdcc6f-fe41-4724-bfb3-131a93df4c3f\",\n                    \"name\": \"Categories\",\n                    \"fullDescription\": {\n                        \"text\": \"This taxonomy contains the types an issue can assume\"\n                    },\n                    \"shortDescription\": {\n                        \"text\": \"Vulnerabilities categories\"\n                    },\n                    \"taxa\": [\n                        {\n                            \"id\": \"CAT000\",\n                            \"name\": \"Undefined Category\",\n                            \"shortDescription\": {\n                                \"text\": \"Category is not defined\"\n                            },\n                            \"fullDescription\": {\n                                \"text\": \"Category is not defined\"\n                            }\n                        },\n                        {\n                            \"id\": \"CAT010\",\n                            \"name\": \"Observability\",\n                            \"shortDescription\": {\n                                \"text\": \"Logging and Monitoring\"\n                            },\n                            \"fullDescription\": {\n                                \"text\": \"Logging and Monitoring\"\n                            }\n                        },\n                        {\n                            \"id\": \"CAT011\",\n                            \"name\": \"Resource Management\",\n                            \"shortDescription\": {\n                                \"text\": \"Resource and privilege limit configuration\"\n                            },\n                            \"fullDescription\": {\n                                \"text\": \"Resource and privilege limit configuration\"\n                            }\n                        },\n                        {\n                            \"id\": \"CAT012\",\n                            \"name\": \"Secret Management\",\n                            \"shortDescription\": {\n                                \"text\": \"Secret and Key management\"\n                            },\n                            \"fullDescription\": {\n                                \"text\": \"Secret and Key management\"\n                            }\n                        },\n                        {\n                            \"id\": \"CAT013\",\n                            \"name\": \"Supply-Chain\",\n                            \"shortDescription\": {\n                                \"text\": \"Dependency version management\"\n                            },\n                            \"fullDescription\": {\n                                \"text\": \"Dependency version management\"\n                            }\n                        },\n                        {\n                            \"id\": \"CAT001\",\n                            \"name\": \"Access Control\",\n                            \"shortDescription\": {\n                                \"text\": \"Service permission and identity management\"\n                            },\n                            \"fullDescription\": {\n                                \"text\": \"Service permission and identity management\"\n                            }\n                        },\n                        {\n                            \"id\": \"CAT004\",\n                            \"name\": \"Best Practices\",\n                            \"shortDescription\": {\n                                \"text\": \"Metadata management\"\n                            },\n                            \"fullDescription\": {\n                                \"text\": \"Metadata management\"\n                            }\n                        },\n                        {\n                            \"id\": \"CAT005\",\n                            \"name\": \"Build Process\",\n                            \"shortDescription\": {\n                                \"text\": \"Insecure configurations when building/deploying Docker images\"\n                            },\n                            \"fullDescription\": {\n                                \"text\": \"Insecure configurations when building/deploying Docker images\"\n                            }\n                        },\n                        {\n                            \"id\": \"CAT007\",\n                            \"name\": \"Insecure Configurations\",\n                            \"shortDescription\": {\n                                \"text\": \"Configurations which expose the application unnecessarily\"\n                            },\n                            \"fullDescription\": {\n                                \"text\": \"Configurations which expose the application unnecessarily\"\n                            }\n                        },\n                        {\n                            \"id\": \"CAT009\",\n                            \"name\": \"Networking and Firewall\",\n                            \"shortDescription\": {\n                                \"text\": \"Network port exposure and firewall configuration\"\n                            },\n                            \"fullDescription\": {\n                                \"text\": \"Network port exposure and firewall configuration\"\n                            }\n                        },\n                        {\n                            \"id\": \"CAT002\",\n                            \"name\": \"Availability\",\n                            \"shortDescription\": {\n                                \"text\": \"Reliability and Scalability\"\n                            },\n                            \"fullDescription\": {\n                                \"text\": \"Reliability and Scalability\"\n                            }\n                        },\n                        {\n                            \"id\": \"CAT003\",\n                            \"name\": \"Backup\",\n                            \"shortDescription\": {\n                                \"text\": \"Survivability and Recovery\"\n                            },\n                            \"fullDescription\": {\n                                \"text\": \"Survivability and Recovery\"\n                            }\n                        },\n                        {\n                            \"id\": \"CAT006\",\n                            \"name\": \"Encryption\",\n                            \"shortDescription\": {\n                                \"text\": \"Data Security and Encryption configuration\"\n                            },\n                            \"fullDescription\": {\n                                \"text\": \"Data Security and Encryption configuration\"\n                            }\n                        },\n                        {\n                            \"id\": \"CAT008\",\n                            \"name\": \"Insecure Defaults\",\n                            \"shortDescription\": {\n                                \"text\": \"Configurations that are insecure by default\"\n                            },\n                            \"fullDescription\": {\n                                \"text\": \"Configurations that are insecure by default\"\n                            }\n                        }\n                    ]\n                }\n            ]\n        }\n    ]\n}\n</code></pre>"},{"location":"results/#gitlab_sast","title":"Gitlab SAST","text":"<p>You can export html report by using <code>--report-formats \"glsast\"</code>. Gitlab SAST reports are sorted by severity (from high to info), following Gitlab SAST Report scheme, also, the generated file will have a prefix <code>gl-sast-</code> as recommendend by Gitlab docs and looks like:</p> <pre><code>{\n    \"schema\": \"https://gitlab.com/gitlab-org/security-products/security-report-schemas/-/raw/v14.1.0/dist/sast-report-format.json\",\n    \"version\": \"14.1.0\",\n    \"scan\": {\n        \"start_time\": \"2021-05-26T17:22:13\",\n        \"end_time\": \"2021-05-26T17:22:13\",\n        \"status\": \"success\",\n        \"type\": \"sast\",\n        \"scanner\": {\n            \"id\": \"keeping-infrastructure-as-code-secure\",\n            \"name\": \"Keeping Infrastructure as Code Secure\",\n            \"url\": \"https://www.kics.io/\",\n            \"version\": \"development\",\n            \"vendor\": {\n                \"name\": \"Checkmarx\"\n            }\n        }\n    },\n    \"vulnerabilities\": [\n        {\n            \"id\": \"32e763ac363dfee1ea972d951fb3de00f5f7a8d3f9f57b93e55e2d51957794a6\",\n            \"category\": \"sast\",\n            \"severity\": \"High\",\n            \"cve\": \"32e763ac363dfee1ea972d951fb3de00f5f7a8d3f9f57b93e55e2d51957794a6\",\n            \"scanner\": {\n                \"id\": \"keeping_infrastructure_as_code_secure\",\n                \"name\": \"Keeping Infrastructure as Code Secure\"\n            },\n            \"name\": \"Container Is Privileged\",\n            \"message\": \"Do not allow container to be privileged.\",\n            \"links\": [\n                {\n                    \"url\": \"https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/pod#privileged\"\n                }\n            ],\n            \"location\": {\n                \"file\": \"assets/queries/terraform/kubernetes/container_is_privileged/test/positive.tf\",\n                \"start_line\": 8,\n                \"end_line\": 8\n            },\n            \"identifiers\": [\n                {\n                    \"type\": \"kics\",\n                    \"name\": \"Keeping Infrastructure as Code Secure\",\n                    \"url\": \"https://docs.kics.io/latest/queries/terraform-queries\",\n                    \"value\": \"87065ef8-de9b-40d8-9753-f4a4303e27a4\"\n                }\n            ]\n        },\n        {\n            \"id\": \"32e763ac363dfee1ea972d951fb3de00f5f7a8d3f9f57b93e55e2d51957794a6\",\n            \"category\": \"sast\",\n            \"severity\": \"High\",\n            \"cve\": \"32e763ac363dfee1ea972d951fb3de00f5f7a8d3f9f57b93e55e2d51957794a6\",\n            \"scanner\": {\n                \"id\": \"keeping_infrastructure_as_code_secure\",\n                \"name\": \"Keeping Infrastructure as Code Secure\"\n            },\n            \"name\": \"Container Is Privileged\",\n            \"message\": \"Do not allow container to be privileged.\",\n            \"links\": [\n                {\n                    \"url\": \"https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/pod#privileged\"\n                }\n            ],\n            \"location\": {\n                \"file\": \"assets/queries/terraform/kubernetes/container_is_privileged/test/positive.tf\",\n                \"start_line\": 8,\n                \"end_line\": 8\n            },\n            \"identifiers\": [\n                {\n                    \"type\": \"kics\",\n                    \"name\": \"Keeping Infrastructure as Code Secure\",\n                    \"url\": \"https://docs.kics.io/latest/queries/terraform-queries\",\n                    \"value\": \"87065ef8-de9b-40d8-9753-f4a4303e27a4\"\n                }\n            ]\n        },\n        {\n            \"id\": \"3d4f14f3ac2ebc0d2cb1710eec4f61fae359fe78ab244cb716485cb6c90846f6\",\n            \"category\": \"sast\",\n            \"severity\": \"High\",\n            \"cve\": \"3d4f14f3ac2ebc0d2cb1710eec4f61fae359fe78ab244cb716485cb6c90846f6\",\n            \"scanner\": {\n                \"id\": \"keeping_infrastructure_as_code_secure\",\n                \"name\": \"Keeping Infrastructure as Code Secure\"\n            },\n            \"name\": \"Container Is Privileged\",\n            \"message\": \"Do not allow container to be privileged.\",\n            \"links\": [\n                {\n                    \"url\": \"https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/pod#privileged\"\n                }\n            ],\n            \"location\": {\n                \"file\": \"assets/queries/terraform/kubernetes/container_is_privileged/test/positive.tf\",\n                \"start_line\": 108,\n                \"end_line\": 108\n            },\n            \"identifiers\": [\n                {\n                    \"type\": \"kics\",\n                    \"name\": \"Keeping Infrastructure as Code Secure\",\n                    \"url\": \"https://docs.kics.io/latest/queries/terraform-queries\",\n                    \"value\": \"87065ef8-de9b-40d8-9753-f4a4303e27a4\"\n                }\n            ]\n        }\n    ]\n}\n</code></pre>"},{"location":"results/#junit","title":"JUnit","text":"<p>You can export JUnit report by using <code>--report-formats \"junit\"</code>. JUnit reports follow JUnit XML specification by junit-team, also, the generated file will have a prefix <code>junit-</code> and looks like:</p> <pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;testsuites name=\"KICS vdevelopment\" time=\"11.5808455s\" failures=\"25\"&gt;\n    &lt;testsuite name=\"[Terraform]\" failures=\"11\" tests=\"11\"&gt;\n        &lt;testcase name=\"[Authentication Without MFA]: Users should authenticate with MFA (Multi-factor Authentication)\"&gt;\n            &lt;failure type=\"Authentication Without MFA\" message=\"A problem was found on &amp;#39;assets/queries/terraform/aws/iam_policy_grants_full_permissions/test/positive.tf&amp;#39; file in line 20, The attributes &amp;#39;policy.Statement.Condition&amp;#39;, &amp;#39;policy.Statement.Condition.BoolIfExists&amp;#39;, and &amp;#39;policy.Statement.Condition.BoolIfExists.aws:MultiFactorAuthPresent&amp;#39; are defined and not null, but The attribute(s) &amp;#39;policy.Statement.Condition&amp;#39; or/and &amp;#39;policy.Statement.Condition.BoolIfExists&amp;#39; or/and &amp;#39;policy.Statement.Condition.BoolIfExists.aws:MultiFactorAuthPresent&amp;#39; is/are undefined or null.\"&gt;&lt;/failure&gt;\n            &lt;failure type=\"Authentication Without MFA\" message=\"A problem was found on &amp;#39;assets/queries/terraform/aws/iam_user_policy_without_mfa/test/negative.tf&amp;#39; file in line 43, The attributes &amp;#39;policy.Statement.Condition&amp;#39;, &amp;#39;policy.Statement.Condition.BoolIfExists&amp;#39;, and &amp;#39;policy.Statement.Condition.BoolIfExists.aws:MultiFactorAuthPresent&amp;#39; are defined and not null, but The attribute(s) &amp;#39;policy.Statement.Condition&amp;#39; or/and &amp;#39;policy.Statement.Condition.BoolIfExists&amp;#39; or/and &amp;#39;policy.Statement.Condition.BoolIfExists.aws:MultiFactorAuthPresent&amp;#39; is/are undefined or null.\"&gt;&lt;/failure&gt;\n            &lt;failure type=\"Authentication Without MFA\" message=\"A problem was found on &amp;#39;assets/queries/terraform/aws/authentication_without_mfa/test/positive2.tf&amp;#39; file in line 19, The attributes &amp;#39;policy.Statement.Condition&amp;#39;, &amp;#39;policy.Statement.Condition.BoolIfExists&amp;#39;, and &amp;#39;policy.Statement.Condition.BoolIfExists.aws:MultiFactorAuthPresent&amp;#39; are defined and not null, but The attribute(s) &amp;#39;policy.Statement.Condition&amp;#39; or/and &amp;#39;policy.Statement.Condition.BoolIfExists&amp;#39; or/and &amp;#39;policy.Statement.Condition.BoolIfExists.aws:MultiFactorAuthPresent&amp;#39; is/are undefined or null.\"&gt;&lt;/failure&gt;\n            &lt;failure type=\"Authentication Without MFA\" message=\"A problem was found on &amp;#39;assets/queries/terraform/aws/root_account_has_active_access_keys/test/negative.tf&amp;#39; file in line 16, The attributes &amp;#39;policy.Statement.Condition&amp;#39;, &amp;#39;policy.Statement.Condition.BoolIfExists&amp;#39;, and &amp;#39;policy.Statement.Condition.BoolIfExists.aws:MultiFactorAuthPresent&amp;#39; are defined and not null, but The attribute(s) &amp;#39;policy.Statement.Condition&amp;#39; or/and &amp;#39;policy.Statement.Condition.BoolIfExists&amp;#39; or/and &amp;#39;policy.Statement.Condition.BoolIfExists.aws:MultiFactorAuthPresent&amp;#39; is/are undefined or null.\"&gt;&lt;/failure&gt;\n            &lt;failure type=\"Authentication Without MFA\" message=\"A problem was found on &amp;#39;assets/queries/terraform/aws/iam_user_policy_without_mfa/test/negative.tf&amp;#39; file in line 18, &amp;#39;policy.Statement.Principal.AWS&amp;#39; contains &amp;#39;:mfa/&amp;#39; or &amp;#39;policy.Statement.Condition.BoolIfExists.aws:MultiFactorAuthPresent&amp;#39; is set to true, but &amp;#39;policy.Statement.Principal.AWS&amp;#39; doesn&amp;#39;t contain &amp;#39;:mfa/&amp;#39; or &amp;#39;policy.Statement.Condition.BoolIfExists.aws:MultiFactorAuthPresent&amp;#39; is set to false.\"&gt;&lt;/failure&gt;\n            &lt;failure type=\"Authentication Without MFA\" message=\"A problem was found on &amp;#39;assets/queries/terraform/aws/iam_policies_attached_to_user/test/positive2.tf&amp;#39; file in line 20, The attributes &amp;#39;policy.Statement.Condition&amp;#39;, &amp;#39;policy.Statement.Condition.BoolIfExists&amp;#39;, and &amp;#39;policy.Statement.Condition.BoolIfExists.aws:MultiFactorAuthPresent&amp;#39; are defined and not null, but The attribute(s) &amp;#39;policy.Statement.Condition&amp;#39; or/and &amp;#39;policy.Statement.Condition.BoolIfExists&amp;#39; or/and &amp;#39;policy.Statement.Condition.BoolIfExists.aws:MultiFactorAuthPresent&amp;#39; is/are undefined or null.\"&gt;&lt;/failure&gt;\n            &lt;failure type=\"Authentication Without MFA\" message=\"A problem was found on &amp;#39;assets/queries/terraform/aws/iam_policy_grants_full_permissions/test/negative.tf&amp;#39; file in line 20, The attributes &amp;#39;policy.Statement.Condition&amp;#39;, &amp;#39;policy.Statement.Condition.BoolIfExists&amp;#39;, and &amp;#39;policy.Statement.Condition.BoolIfExists.aws:MultiFactorAuthPresent&amp;#39; are defined and not null, but The attribute(s) &amp;#39;policy.Statement.Condition&amp;#39; or/and &amp;#39;policy.Statement.Condition.BoolIfExists&amp;#39; or/and &amp;#39;policy.Statement.Condition.BoolIfExists.aws:MultiFactorAuthPresent&amp;#39; is/are undefined or null.\"&gt;&lt;/failure&gt;\n            &lt;failure type=\"Authentication Without MFA\" message=\"A problem was found on &amp;#39;assets/queries/terraform/aws/iam_user_policy_without_mfa/test/positive.tf&amp;#39; file in line 18, The attributes &amp;#39;policy.Statement.Condition&amp;#39;, &amp;#39;policy.Statement.Condition.BoolIfExists&amp;#39;, and &amp;#39;policy.Statement.Condition.BoolIfExists.aws:MultiFactorAuthPresent&amp;#39; are defined and not null, but The attribute(s) &amp;#39;policy.Statement.Condition&amp;#39; or/and &amp;#39;policy.Statement.Condition.BoolIfExists&amp;#39; or/and &amp;#39;policy.Statement.Condition.BoolIfExists.aws:MultiFactorAuthPresent&amp;#39; is/are undefined or null.\"&gt;&lt;/failure&gt;\n            &lt;failure type=\"Authentication Without MFA\" message=\"A problem was found on &amp;#39;assets/queries/terraform/aws/root_account_has_active_access_keys/test/positive1.tf&amp;#39; file in line 16, The attributes &amp;#39;policy.Statement.Condition&amp;#39;, &amp;#39;policy.Statement.Condition.BoolIfExists&amp;#39;, and &amp;#39;policy.Statement.Condition.BoolIfExists.aws:MultiFactorAuthPresent&amp;#39; are defined and not null, but The attribute(s) &amp;#39;policy.Statement.Condition&amp;#39; or/and &amp;#39;policy.Statement.Condition.BoolIfExists&amp;#39; or/and &amp;#39;policy.Statement.Condition.BoolIfExists.aws:MultiFactorAuthPresent&amp;#39; is/are undefined or null.\"&gt;&lt;/failure&gt;\n            &lt;failure type=\"Authentication Without MFA\" message=\"A problem was found on &amp;#39;assets/queries/terraform/aws/root_account_has_active_access_keys/test/positive2.tf&amp;#39; file in line 16, The attributes &amp;#39;policy.Statement.Condition&amp;#39;, &amp;#39;policy.Statement.Condition.BoolIfExists&amp;#39;, and &amp;#39;policy.Statement.Condition.BoolIfExists.aws:MultiFactorAuthPresent&amp;#39; are defined and not null, but The attribute(s) &amp;#39;policy.Statement.Condition&amp;#39; or/and &amp;#39;policy.Statement.Condition.BoolIfExists&amp;#39; or/and &amp;#39;policy.Statement.Condition.BoolIfExists.aws:MultiFactorAuthPresent&amp;#39; is/are undefined or null.\"&gt;&lt;/failure&gt;\n            &lt;failure type=\"Authentication Without MFA\" message=\"A problem was found on &amp;#39;assets/queries/terraform/aws/authentication_without_mfa/test/positive1.tf&amp;#39; file in line 23, &amp;#39;policy.Statement.Principal.AWS&amp;#39; contains &amp;#39;:mfa/&amp;#39; or &amp;#39;policy.Statement.Condition.BoolIfExists.aws:MultiFactorAuthPresent&amp;#39; is set to true, but &amp;#39;policy.Statement.Principal.AWS&amp;#39; doesn&amp;#39;t contain &amp;#39;:mfa/&amp;#39; or &amp;#39;policy.Statement.Condition.BoolIfExists.aws:MultiFactorAuthPresent&amp;#39; is set to false.\"&gt;&lt;/failure&gt;\n        &lt;/testcase&gt;\n    &lt;/testsuite&gt;\n    &lt;testsuite name=\"[CloudFormation]\" failures=\"14\" tests=\"14\"&gt;\n        &lt;testcase name=\"[CloudWatch Metrics Disabled]: Checks if CloudWatch Metrics is Enabled\"&gt;\n            &lt;failure type=\"CloudWatch Metrics Disabled\" message=\"A problem was found on &amp;#39;assets/queries/cloudFormation/cloudwatch_metrics_disabled/test/positive4.json&amp;#39; file in line 5, Resources.Prod.Properties.MethodSettings should be defined, but Resources.Prod.Properties.MethodSettings is undefined.\"&gt;&lt;/failure&gt;\n            &lt;failure type=\"CloudWatch Metrics Disabled\" message=\"A problem was found on &amp;#39;assets/queries/cloudFormation/api_gateway_deployment_without_access_log_setting/test/positive6.json&amp;#39; file in line 13, Resources.GreetingApiProdStage2.Properties.MethodSettings[0].MetricsEnabled should be set to true, but Resources.GreetingApiProdStage2.Properties.MethodSettings[0].MetricsEnabled is undefined.\"&gt;&lt;/failure&gt;\n            &lt;failure type=\"CloudWatch Metrics Disabled\" message=\"A problem was found on &amp;#39;assets/queries/cloudFormation/api_gateway_deployment_without_access_log_setting/test/negative1.yaml&amp;#39; file in line 12, Resources.GreetingApiProdStage.Properties.MethodSettings[0].MetricsEnabled should be set to true, but Resources.GreetingApiProdStage.Properties.MethodSettings[0].MetricsEnabled is undefined.\"&gt;&lt;/failure&gt;\n            &lt;failure type=\"CloudWatch Metrics Disabled\" message=\"A problem was found on &amp;#39;assets/queries/cloudFormation/api_gateway_deployment_without_access_log_setting/test/positive2.yaml&amp;#39; file in line 12, Resources.GreetingApiProdStage1.Properties.MethodSettings[0].MetricsEnabled should be set to true, but Resources.GreetingApiProdStage1.Properties.MethodSettings[0].MetricsEnabled is undefined.\"&gt;&lt;/failure&gt;\n            &lt;failure type=\"CloudWatch Metrics Disabled\" message=\"A problem was found on &amp;#39;assets/queries/cloudFormation/cloudwatch_metrics_disabled/test/positive1.yaml&amp;#39; file in line 18, Resources.Prod.Properties.MethodSettings[0].MetricsEnabled should be set to true, but Resources.Prod.Properties.MethodSettings[0].MetricsEnabled is set to false.\"&gt;&lt;/failure&gt;\n            &lt;failure type=\"CloudWatch Metrics Disabled\" message=\"A problem was found on &amp;#39;assets/queries/cloudFormation/cloudwatch_metrics_disabled/test/positive3.yaml&amp;#39; file in line 6, Resources.Prod.Properties.MethodSettings should be defined, but Resources.Prod.Properties.MethodSettings is undefined.\"&gt;&lt;/failure&gt;\n            &lt;failure type=\"CloudWatch Metrics Disabled\" message=\"A problem was found on &amp;#39;assets/queries/cloudFormation/cloudwatch_metrics_disabled/test/positive2.json&amp;#39; file in line 25, Resources.Prod.Properties.MethodSettings[0].MetricsEnabled should be set to true, but Resources.Prod.Properties.MethodSettings[0].MetricsEnabled is undefined.\"&gt;&lt;/failure&gt;\n            &lt;failure type=\"CloudWatch Metrics Disabled\" message=\"A problem was found on &amp;#39;assets/queries/cloudFormation/cloudwatch_metrics_disabled/test/positive1.yaml&amp;#39; file in line 20, Resources.Prod.Properties.MethodSettings[1].MetricsEnabled should be set to true, but Resources.Prod.Properties.MethodSettings[1].MetricsEnabled is undefined.\"&gt;&lt;/failure&gt;\n            &lt;failure type=\"CloudWatch Metrics Disabled\" message=\"A problem was found on &amp;#39;assets/queries/cloudFormation/api_gateway_deployment_without_access_log_setting/test/negative2.json&amp;#39; file in line 17, Resources.GreetingApiProdStage.Properties.MethodSettings[0].MetricsEnabled should be set to true, but Resources.GreetingApiProdStage.Properties.MethodSettings[0].MetricsEnabled is undefined.\"&gt;&lt;/failure&gt;\n            &lt;failure type=\"CloudWatch Metrics Disabled\" message=\"A problem was found on &amp;#39;assets/queries/cloudFormation/api_gateway_deployment_without_access_log_setting/test/positive4.json&amp;#39; file in line 35, Resources.GreetingApiProdStage.Properties.MethodSettings[0].MetricsEnabled should be set to true, but Resources.GreetingApiProdStage.Properties.MethodSettings[0].MetricsEnabled is undefined.\"&gt;&lt;/failure&gt;\n            &lt;failure type=\"CloudWatch Metrics Disabled\" message=\"A problem was found on &amp;#39;assets/queries/cloudFormation/api_gateway_deployment_without_access_log_setting/test/positive5.json&amp;#39; file in line 16, Resources.GreetingApiProdStage1.Properties.MethodSettings[0].MetricsEnabled should be set to true, but Resources.GreetingApiProdStage1.Properties.MethodSettings[0].MetricsEnabled is undefined.\"&gt;&lt;/failure&gt;\n            &lt;failure type=\"CloudWatch Metrics Disabled\" message=\"A problem was found on &amp;#39;assets/queries/cloudFormation/api_gateway_deployment_without_access_log_setting/test/positive1.yaml&amp;#39; file in line 12, Resources.GreetingApiProdStage.Properties.MethodSettings[0].MetricsEnabled should be set to true, but Resources.GreetingApiProdStage.Properties.MethodSettings[0].MetricsEnabled is undefined.\"&gt;&lt;/failure&gt;\n            &lt;failure type=\"CloudWatch Metrics Disabled\" message=\"A problem was found on &amp;#39;assets/queries/cloudFormation/api_gateway_deployment_without_access_log_setting/test/positive3.yaml&amp;#39; file in line 12, Resources.GreetingApiProdStage2.Properties.MethodSettings[0].MetricsEnabled should be set to true, but Resources.GreetingApiProdStage2.Properties.MethodSettings[0].MetricsEnabled is undefined.\"&gt;&lt;/failure&gt;\n            &lt;failure type=\"CloudWatch Metrics Disabled\" message=\"A problem was found on &amp;#39;assets/queries/cloudFormation/cloudwatch_metrics_disabled/test/positive2.json&amp;#39; file in line 32, Resources.Prod.Properties.MethodSettings[1].MetricsEnabled should be set to true, but Resources.Prod.Properties.MethodSettings[1].MetricsEnabled is set to false.\"&gt;&lt;/failure&gt;\n        &lt;/testcase&gt;\n    &lt;/testsuite&gt;\n&lt;/testsuites&gt;\n</code></pre> <p>Also, you can check our Jenkins integration section to check how to integrate this report with Jenkins JUnit plugin.</p>"},{"location":"results/#sonarqube","title":"SonarQube","text":"<p>You can export sonarqube report by using <code>--report-formats \"sonarqube\"</code>. SonarQube reports, follow SonarQube Import Format, also, the generated file will have a prefix <code>sonarqube-</code> and looks like:</p> <pre><code>{\n    \"issues\": [\n        {\n            \"engineId\": \"KICS 1.4.7\",\n            \"ruleId\": \"0afa6ab8-a047-48cf-be07-93a2f8c34cf7\",\n            \"severity\": \"MAJOR\",\n            \"type\": \"VULNERABILITY\",\n            \"primaryLocation\": {\n                \"message\": \"All Application Load Balancers (ALB) must be protected with Web Application Firewall (WAF) service\",\n                \"filePath\": \"assets/queries/terraform/aws/alb_deletion_protection_disabled/test/negative2.tf\",\n                \"textRange\": {\n                    \"startLine\": 1\n                }\n            },\n            \"secondaryLocations\": [\n                {\n                    \"message\": \"All Application Load Balancers (ALB) must be protected with Web Application Firewall (WAF) service\",\n                    \"filePath\": \"assets/queries/terraform/aws/alb_deletion_protection_disabled/test/positive4.tf\",\n                    \"textRange\": {\n                        \"startLine\": 1\n                    }\n                },\n                {\n                    \"message\": \"All Application Load Balancers (ALB) must be protected with Web Application Firewall (WAF) service\",\n                    \"filePath\": \"assets/queries/terraform/aws/alb_deletion_protection_disabled/test/negative1.tf\",\n                    \"textRange\": {\n                        \"startLine\": 1\n                    }\n                },\n                {\n                    \"message\": \"All Application Load Balancers (ALB) must be protected with Web Application Firewall (WAF) service\",\n                    \"filePath\": \"assets/queries/terraform/aws/alb_deletion_protection_disabled/test/positive1.tf\",\n                    \"textRange\": {\n                        \"startLine\": 1\n                    }\n                },\n                {\n                    \"message\": \"All Application Load Balancers (ALB) must be protected with Web Application Firewall (WAF) service\",\n                    \"filePath\": \"assets/queries/terraform/aws/alb_deletion_protection_disabled/test/positive2.tf\",\n                    \"textRange\": {\n                        \"startLine\": 1\n                    }\n                },\n                {\n                    \"message\": \"All Application Load Balancers (ALB) must be protected with Web Application Firewall (WAF) service\",\n                    \"filePath\": \"assets/queries/terraform/aws/alb_deletion_protection_disabled/test/positive3.tf\",\n                    \"textRange\": {\n                        \"startLine\": 1\n                    }\n                }\n            ]\n        },\n        {\n            \"engineId\": \"KICS development\",\n            \"ruleId\": \"6e3fd2ed-5c83-4c68-9679-7700d224d379\",\n            \"severity\": \"MAJOR\",\n            \"type\": \"CODE_SMELL\",\n            \"primaryLocation\": {\n                \"message\": \"It's considered a best practice when using Application Load Balancers to drop invalid header fields\",\n                \"filePath\": \"assets/queries/terraform/aws/alb_deletion_protection_disabled/test/positive5.tf\",\n                \"textRange\": {\n                    \"startLine\": 1\n                }\n            },\n            \"secondaryLocations\": [\n                {\n                    \"message\": \"It's considered a best practice when using Application Load Balancers to drop invalid header fields\",\n                    \"filePath\": \"assets/queries/terraform/aws/alb_deletion_protection_disabled/test/positive6.tf\",\n                    \"textRange\": {\n                        \"startLine\": 1\n                    }\n                },\n                {\n                    \"message\": \"It's considered a best practice when using Application Load Balancers to drop invalid header fields\",\n                    \"filePath\": \"assets/queries/terraform/aws/alb_deletion_protection_disabled/test/negative3.tf\",\n                    \"textRange\": {\n                        \"startLine\": 1\n                    }\n                }\n            ]\n        },\n        {\n            \"engineId\": \"KICS development\",\n            \"ruleId\": \"afecd1f1-6378-4f7e-bb3b-60c35801fdd4\",\n            \"severity\": \"MINOR\",\n            \"type\": \"CODE_SMELL\",\n            \"primaryLocation\": {\n                \"message\": \"Application Load Balancer should have deletion protection enabled\",\n                \"filePath\": \"assets/queries/terraform/aws/alb_deletion_protection_disabled/test/positive2.tf\",\n                \"textRange\": {\n                    \"startLine\": 1\n                }\n            },\n            \"secondaryLocations\": [\n                {\n                    \"message\": \"Application Load Balancer should have deletion protection enabled\",\n                    \"filePath\": \"assets/queries/terraform/aws/alb_deletion_protection_disabled/test/positive1.tf\",\n                    \"textRange\": {\n                        \"startLine\": 7\n                    }\n                },\n                {\n                    \"message\": \"Application Load Balancer should have deletion protection enabled\",\n                    \"filePath\": \"assets/queries/terraform/aws/alb_deletion_protection_disabled/test/positive6.tf\",\n                    \"textRange\": {\n                        \"startLine\": 1\n                    }\n                },\n                {\n                    \"message\": \"Application Load Balancer should have deletion protection enabled\",\n                    \"filePath\": \"assets/queries/terraform/aws/alb_deletion_protection_disabled/test/positive5.tf\",\n                    \"textRange\": {\n                        \"startLine\": 9\n                    }\n                },\n                {\n                    \"message\": \"Application Load Balancer should have deletion protection enabled\",\n                    \"filePath\": \"assets/queries/terraform/aws/alb_deletion_protection_disabled/test/positive4.tf\",\n                    \"textRange\": {\n                        \"startLine\": 1\n                    }\n                },\n                {\n                    \"message\": \"Application Load Balancer should have deletion protection enabled\",\n                    \"filePath\": \"assets/queries/terraform/aws/alb_deletion_protection_disabled/test/positive3.tf\",\n                    \"textRange\": {\n                        \"startLine\": 7\n                    }\n                }\n            ]\n        }\n    ]\n}\n</code></pre>"},{"location":"results/#html","title":"HTML","text":"<p>You can export html report by using <code>--report-formats \"html\"</code>. HTML reports are sorted by severity (from high to info), the results will have query information, a list of files which vulnerability was found and a code snippet where the problem was detected as you can see in following example:</p> <p></p>"},{"location":"results/#pdf","title":"PDF","text":"<p>You can export a pdf report by using <code>--report-formats \"pdf\"</code>. PDF reports are sorted by severity (from high to info), the results will have query information and a list of files alongside the line where the result was found.</p> <p></p>"},{"location":"results/#cyclonedx","title":"CycloneDX","text":"<p>Now, the CycloneDX report is only available in XML format since the vulnerability schema extension is not currently available in JSON. The guidelines used to build the CycloneDX report were the bom schema 1.3 and vulnerability schema 1.0.</p> <p>You can export CycloneDX report by using <code>--report-formats \"cyclonedx\"</code>. The generated report file will have a prefix <code>cyclonedx-</code> and looks like the following example:</p> <pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;bom xmlns=\"http://cyclonedx.org/schema/bom/1.3\" serialNumber=\"urn:uuid:9f9c80f3-5795-476d-974f-85e6cf1daa65\" xmlns:v=\"http://cyclonedx.org/schema/ext/vulnerability/1.0\" version=\"1\"&gt;\n    &lt;metadata&gt;\n        &lt;timestamp&gt;2021-12-03T15:39:49Z&lt;/timestamp&gt;\n        &lt;tools&gt;\n            &lt;tool&gt;\n                &lt;vendor&gt;Checkmarx&lt;/vendor&gt;\n                &lt;name&gt;KICS&lt;/name&gt;\n                &lt;version&gt;development&lt;/version&gt;\n            &lt;/tool&gt;\n        &lt;/tools&gt;\n    &lt;/metadata&gt;\n    &lt;components&gt;\n        &lt;component type=\"file\" bom-ref=\"pkg:generic/assets/queries/terraform/aws/guardduty_detector_disabled/test/negative.tf@0.0.0-68b4caecf5d5\"&gt;\n            &lt;name&gt;assets/queries/terraform/aws/guardduty_detector_disabled/test/negative.tf&lt;/name&gt;\n            &lt;version&gt;0.0.0-68b4caecf5d5&lt;/version&gt;\n            &lt;hashes&gt;\n                &lt;hash alg=\"SHA-256\"&gt;68b4caecf5d5130426a8b8f0222cdd7f31232b5c99a5bf0daf19099e26e2ec29&lt;/hash&gt;\n            &lt;/hashes&gt;\n            &lt;purl&gt;pkg:generic/assets/queries/terraform/aws/guardduty_detector_disabled/test/negative.tf@0.0.0-68b4caecf5d5&lt;/purl&gt;\n            &lt;v:vulnerabilities&gt;\n                &lt;v:vulnerability ref=\"pkg:generic/assets/queries/terraform/aws/guardduty_detector_disabled/test/negative.tf@0.0.0-68b4caecf5d5e38a8e0a-b88b-4902-b3fe-b0fcb17d5c10\"&gt;\n                    &lt;v:id&gt;e38a8e0a-b88b-4902-b3fe-b0fcb17d5c10&lt;/v:id&gt;\n                    &lt;v:source&gt;\n                        &lt;name&gt;KICS&lt;/name&gt;\n                        &lt;url&gt;https://kics.io/&lt;/url&gt;\n                    &lt;/v:source&gt;\n                    &lt;v:ratings&gt;\n                        &lt;v:rating&gt;\n                            &lt;v:severity&gt;None&lt;/v:severity&gt;\n                            &lt;v:method&gt;Other&lt;/v:method&gt;\n                        &lt;/v:rating&gt;\n                    &lt;/v:ratings&gt;\n                    &lt;v:description&gt;[Terraform].[Resource Not Using Tags]: AWS services resource tags are an essential part of managing components&lt;/v:description&gt;\n                    &lt;v:recommendations&gt;\n                        &lt;v:recommendation&gt;\n                            &lt;Recommendation&gt;In line 1, a result was found. &amp;#39;aws_guardduty_detector[{{negative1}}].tags is undefined or null&amp;#39;, but &amp;#39;aws_guardduty_detector[{{negative1}}].tags is defined and not null&amp;#39;&lt;/Recommendation&gt;\n                        &lt;/v:recommendation&gt;\n                    &lt;/v:recommendations&gt;\n                &lt;/v:vulnerability&gt;\n            &lt;/v:vulnerabilities&gt;\n        &lt;/component&gt;\n    &lt;/components&gt;\n&lt;/bom&gt;\n</code></pre>"},{"location":"results/#asff","title":"ASFF","text":"<p>You can export ASFF (AWS Security Finding Format) report by using <code>--report-formats \"asff\"</code>. The generated report file will have a prefix <code>asff-</code>.</p> <p>For default, the ASFF report uses a default AWS account ID (\"AWS_ACCOUNT_ID\") and a default AWS region (\"AWS_REGION\"). To set these values, you need to define AWS_ACCOUNT_ID and AWS_REGION in your environment variables.</p> <pre><code>[\n    {\n        \"AwsAccountId\": \"AWS_ACCOUNT_ID\",\n        \"Compliance\": {\n            \"Status\": \"FAILED\"\n        },\n        \"CreatedAt\": \"2022-01-14T13:50:30Z\",\n        \"Description\": \"CloudTrail Log Files should have validation enabled\",\n        \"GeneratorId\": \"4d8681a2-3d30-4c89-8070-08acd142748e\",\n        \"Id\": \"AWS_REGION/AWS_ACCOUNT_ID/1dc18f740a5c4173264949fb366d3c3871d7d457c4db91f6d73a76caa9873000\",\n        \"ProductArn\": \"arn:aws:securityhub:AWS_REGION:AWS_ACCOUNT_ID:product/AWS_ACCOUNT_ID/default\",\n        \"Remediation\": {\n            \"Recommendation\": {\n                \"Text\": \"In line 2 of file assets\\\\queries\\\\ansible\\\\aws\\\\cloudtrail_log_file_validation_disabled\\\\test\\\\positive.yaml, a result was found. cloudtrail.enable_log_file_validation and cloudtrail.log_file_validation_enabled are undefined, but cloudtrail.enable_log_file_validation or cloudtrail.log_file_validation_enabled is defined\"\n            }\n        },\n        \"Resources\": [\n            {\n                \"Id\": \"4d8681a2-3d30-4c89-8070-08acd142748e\",\n                \"Type\": \"Other\"\n            }\n        ],\n        \"SchemaVersion\": \"2018-10-08\",\n        \"Severity\": {\n            \"Original\": \"LOW\",\n            \"Label\": \"LOW\"\n        },\n        \"Title\": \"CloudTrail Log File Validation Disabled\",\n        \"Types\": [\n            \"Software and Configuration Checks/Vulnerabilities/KICS\"\n        ],\n        \"UpdatedAt\": \"2022-01-14T13:50:30Z\"\n    }\n]\n</code></pre>"},{"location":"results/#csv","title":"CSV","text":"<p>You can export CSV report by using <code>--report-formats \"csv\"</code>.</p> <p>CSV reports follow the CSV structure.</p> query_name query_id query_uri severity platform cloud_provider category description_id description cis_description_id cis_description_title cis_description_text file_name similarity_id line issue_type search_key search_line search_value expected_value actual_value EC2 Sensitive Port Is Publicly Exposed 494b03d3-bf40-4464-8524-7c56ad0700ed https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ec2-security-group.html HIGH CloudFormation AWS Networking and Firewall 680b7e89 The EC2 instance has a sensitive port connection exposed to the entire network ../../assets/queries/cloudFormation/aws/security_groups_with_unrestricted_access_to_ssh/test/positive2.json 9730156b201b5098479a7b624d01931303a2f27c3991c7a786aeb2c10912894a 27 IncorrectValue Resources.InstanceSecurityGroup.SecurityGroupIngress 0 TCP,22 SSH (TCP:22) should not be allowed in EC2 security group for instance Ec2Instance SSH (TCP:22) is allowed in EC2 security group for instance Ec2Instance EC2 Sensitive Port Is Publicly Exposed 494b03d3-bf40-4464-8524-7c56ad0700ed https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ec2-security-group.html HIGH CloudFormation AWS Networking and Firewall 680b7e89 The EC2 instance has a sensitive port connection exposed to the entire network ../../assets/queries/cloudFormation/aws/security_groups_with_unrestricted_access_to_ssh/test/positive1.yaml a93a3f7320a60045c04cd950500a1c3cff5bc9a4aae7f1e0cde73033386e1242 15 IncorrectValue Resources.InstanceSecurityGroup.SecurityGroupIngress 0 TCP,22 SSH (TCP:22) should not be allowed in EC2 security group for instance Ec2Instance SSH (TCP:22) is allowed in EC2 security group for instance Ec2Instance Security Group With Unrestricted Access To SSH 6e856af2-62d7-4ba2-adc1-73b62cef9cc1 https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ec2-security-group.html HIGH CloudFormation AWS Networking and Firewall d515d6dc Security Groups allows all traffic for SSH (port:22) ../../assets/queries/cloudFormation/aws/security_groups_with_unrestricted_access_to_ssh/test/positive1.yaml ca8ec85623eed6a5cb3d3b8c1b69d145778e28517d2adf5fb856a57f9870c430 15 IncorrectValue Resources.InstanceSecurityGroup.Properties.SecurityGroupIngress 0 None of the Resources.InstanceSecurityGroup.Properties.SecurityGroupIngress has port 22 One of the Resources.InstanceSecurityGroup.Properties.SecurityGroupIngress has port 22"},{"location":"results/#code_climate","title":"Code Climate","text":"<p>You can export code climate report by using <code>--report-formats \"codeclimate\"</code>. The generated report file will have a prefix <code>codeclimate-</code>.</p> <p>Code climate report follow the Code Climate Spec.</p> <pre><code>[\n    {\n        \"type\": \"issue\",\n        \"check_name\": \"Disk Encryption Disabled\",\n        \"description\": \"VM disks for critical VMs must be encrypted with Customer Supplied Encryption Keys (CSEK) or with Customer-managed encryption keys (CMEK), which means the attribute 'diskEncryptionKey' must be defined and its sub attributes 'rawKey' or 'kmsKeyName' must also be defined\",\n        \"categories\": [\"Security\"],\n        \"location\": {\n            \"path\": \"positive1.yaml\",\n            \"lines\": {\n                \"begin\": 8\n            }\n        },\n        \"severity\": \"major\",\n        \"fingerprint\": \"93b3ba78cf3f7aba06e480f40b10c754cb923118abb13e37106e56106406415f\"\n    },\n    {\n        \"type\": \"issue\",\n        \"check_name\": \"IP Forwarding Enabled\",\n        \"description\": \"Instances must not have IP forwarding enabled, which means the attribute 'canIpForward' must not be true\",\n        \"categories\": [\"Security\"],\n        \"location\": {\n            \"path\": \"positive1.yaml\",\n            \"lines\": {\n                \"begin\": 16\n            }\n        },\n        \"severity\": \"major\",\n        \"fingerprint\": \"ac9b7b7b621eeeaa28d50f5cb6a047dd53df706624b509bcc7db775e53de6db5\"\n    },\n    {\n        \"type\": \"issue\",\n        \"check_name\": \"Project-wide SSH Keys Are Enabled In VM Instances\",\n        \"description\": \"VM Instance should block project-wide SSH keys\",\n        \"categories\": [\"Security\"],\n        \"location\": {\n            \"path\": \"positive1.yaml\",\n            \"lines\": {\n                \"begin\": 4\n            }\n        },\n        \"severity\": \"major\",\n        \"fingerprint\": \"e84dabdbe179ec9bbe4fb5c0abe8fe8a0f8a3b679a8eef6cfc98d7e5403600ab\"\n    },\n    {\n        \"type\": \"issue\",\n        \"check_name\": \"Shielded VM Disabled\",\n        \"description\": \"Compute instances must be launched with Shielded VM enabled, which means the attribute 'shieldedInstanceConfig' must be defined and its sub attributes 'enableSecureBoot', 'enableVtpm' and 'enableIntegrityMonitoring' must be set to true\",\n        \"categories\": [\"Security\"],\n        \"location\": {\n            \"path\": \"positive1.yaml\",\n            \"lines\": {\n                \"begin\": 4\n            }\n        },\n        \"severity\": \"major\",\n        \"fingerprint\": \"1b9d4118a9e39702e46ce204115ae11fc9146c3cb0923a2fb232cabe1e8e103c\"\n    }\n]\n</code></pre>"},{"location":"results/#cli_report","title":"CLI Report","text":"<p>KICS displays the results in CLI. For detailed information, you can use <code>-v --log-level DEBUG</code>.</p> <p></p>"},{"location":"results/#exit_status_code","title":"Exit Status Code","text":""},{"location":"results/#results_status_code","title":"Results Status Code","text":"Code Description <code>0</code> No Results were Found <code>50</code> Found any <code>HIGH</code> Results <code>40</code> Found any <code>MEDIUM</code> Results <code>30</code> Found any <code>LOW</code> Results <code>20</code> Found any <code>INFO</code> Results"},{"location":"results/#error_status_code","title":"Error Status Code","text":"Code Description <code>126</code> Engine Error <code>130</code> Signal-Interrupt"},{"location":"roadmap/","title":"Roadmap","text":""},{"location":"roadmap/#kics_roadmap","title":"KICS Roadmap","text":"<p>These are our upcoming features:</p> <ul> <li>Add new BoM resources:<ul> <li>AWS Aurora </li> <li>AWS DynamoDB </li> <li>AWS RDS </li> </ul> </li> <li>BoM for Serverless Framework</li> <li>Support Windows Containers</li> </ul> <p>Have an idea? Join the GitHub discussions or contact KICS core team at kics@checkmarx.com</p>"},{"location":"roadmap/#completed_features","title":"Completed Features","text":"Release Feature September 2022 v1.6.0 Support new technologies: Pulumi, Serverless Framework, Crossplane and Knative v1.6.0 Kuberneter (dynamic gathering and scan of Kubernetes cluster data through Kubernetes API) April 2022 v1.5.6 Support REST API to execute KICS scan v1.5.6 Support REST API to get KICS scan results v1.5.6 Support Cloudformation BOM March 2022 v1.5.5 Kubelet Configuration Support v1.5.5 Display how many lines of IaC were parsed/scanned (in LOGS) v1.5.5 Docker compose analyzer support v1.5.4 Gitlab KICS added Features - Analyse Merge Requests v1.5.3 Support multi-staged Docker queries February 2022 v1.5.2 Terraformer integration with AZURE v1.5.2 Terraformer integration with GCP v1.5.2 Multiple paths for queries v1.5.1 Cloud Development Kit for Terraform support January 2022 v1.5.0 Terraformer integration with AWS v1.5.0 AWS Serverless Application Model support v1.5.0 ASFF report December 2021 v1.4.9 Google Deployment Manager support v1.4.9 gRPC support v1.4.9 CycloneDX SBOM report v1.4.9 JUnit report November 2021 v1.4.8 Pre-commit hooks integration v1.4.8 SonarQube report v1.4.7 Parsers ignore comment by line v1.4.7 MegaLinter integration October 2021 v1.4.6 Terraform Cloud integration v1.4.5 Azure Blueprints support v1.4.5 Bill-of-Material for cloud-resources generation (--bom option) v1.4.5 Terraform plan support September 2021 v1.4.4 Terraform verified modules support v1.4.3 Passwords and Secrets mechanism v1.4.3 --disable-secrets and --secrets-regexes-path option v1.4.3 TravisCI integration example v1.4.2 --exclude-severities and --libraries-path option August 2021 v1.4.1 Ignore/disable/enable feature on commented files v1.4.0 Azure Resource Manager support v1.4.0 Terraform functions v1.4.0 CIS descriptions July 2021 v1.3.5 --input-data option v1.3.5 Improved documentation June 2021 v1.3.3 PDF report v1.3.2 Gitlab SAST report v1.3.2 Improved HTML report (path, platform, start/end times) May 2021 v1.3.0 Improved performance (sample filtering and parallel scans) v1.3.0 Improved Logs (CPU, RAM outputs) v1.3.0 Jenkinsfile documentation and examples v1.3.0 CircleCI integration example April 2021 v1.2.4 Added Open API 3.0 support v1.2.4 Distribution platforms: Homebrew v1.2.2 Terraform - Parameters files support March 2021 v1.2.1 Helm support v1.2.1 Reporting - add HTML format v1.2.0 Documentation - Queries catalog v1.2.0 Reporting - add SARIF format v1.2.0 Improved CLI outputs (progess, coloring, logo) v1.2.0 Engineering and performance improvements February 2021 v1.1.4 CI/CD improved documentation v1.1.3 Mac support v1.1.3 Hard-coded secret keys detection January 2021 v1.1.1 Adding more queries and extending coverage v1.1.1 Adding more CI/CD integrations v1.1.1 Engineering and performance improvements December 2020 v1.1.0 K8S support v1.1.0 Docker support v1.1.0 Ansible support v1.1.0 AWS CloudFormation support November 2020 v1.0.0 First version of KICS engine v1.0.0 Terraform support, 50 queries v1.0.0 Delivery: CLI &amp; Docker"},{"location":"running-kics/","title":"Running KICS","text":""},{"location":"running-kics/#supported_resources","title":"Supported Resources","text":"<p>KICS makes use of the go-getter package in order to scan files or directories from various sources.</p> <p>KICS is able to perform scans on these types of paths:</p> <ul> <li>Local Files</li> <li>Archived Files</li> <li>S3</li> <li>Git</li> <li>GSC</li> </ul> <p>Files and directories that are not local will be placed in a temporarily folder during KICS execution.</p>"},{"location":"running-kics/#local_files","title":"Local Files","text":"<pre><code>docker run -t -v {\u200b\u200b\u200b\u200bpath_to_scan}\u200b\u200b\u200b\u200b:/path checkmarx/kics scan -p /path\n</code></pre>"},{"location":"running-kics/#archived_files","title":"Archived Files","text":"<p>Available archive formats:</p> <ul> <li><code>tar.gz</code> and <code>tgz</code></li> <li><code>tar.bz2</code> and <code>tbz2</code></li> <li><code>tar.xz</code> and <code>txz</code></li> <li><code>zip</code></li> <li><code>gz</code></li> <li><code>bz2</code></li> <li><code>xz</code></li> </ul> <pre><code>docker run -t -v {\u200b\u200b\u200b\u200bpath_to_scan_zip}\u200b\u200b\u200b\u200b:/path checkmarx/kics scan -p /path\n</code></pre> <p>More information can be seen here</p>"},{"location":"running-kics/#s3","title":"S3","text":"<p>S3 Bucket path syntax:</p> <pre><code>s3::{S3 Bucket URL}?{query parameters}\n</code></pre>"},{"location":"running-kics/#query_parameters","title":"Query Parameters:","text":"<ul> <li><code>aws_access_key_id</code> - AWS access key.</li> <li><code>aws_access_key_secret</code> - AWS access key secret.</li> <li><code>aws_access_token</code> - AWS access token if this is being used.</li> <li><code>aws_profile</code> - Use this profile from local ~/.aws/ config. Takes - priority over the other three.</li> </ul> <pre><code>docker run -t -v ~/.aws:/path checkmarx/kics scan -p \"s3::https://s3.amazonaws.com/bucket/foo?aws_profile=/path/.aws/profile\"\n</code></pre> <p>More information can be seen here</p>"},{"location":"running-kics/#git","title":"Git","text":"<pre><code>docker run -t checkmarx/kics scan -p \"git::https://github.com/Checkmarx/kics\"\n</code></pre>"},{"location":"running-kics/#ssh","title":"SSH","text":"<pre><code>docker run -t checkmarx/kics scan -p \"git::git@github.com:Checkmarx/kics.git\"\n</code></pre> <p>Please make sure you have SSH private key configured with your github account</p> <p>More information can be seen here</p>"},{"location":"running-kics/#gsc","title":"GSC","text":"<pre><code>docker run -t checkmarx/kics scan -p \"gcs::https://www.googleapis.com/storage/v1/bucket\"\n</code></pre> <p>Please make sure you have set GSC authentication credentials to your application code by environment variables</p> <p>More information can be seen here</p>"},{"location":"running-kics/#using_custom_input_data","title":"Using custom input data","text":"<p>Since from v1.3.5, KICS supports using custom input data to replace data on queries that have this feature supported. To see if a query supports overwriting, check if the query's folder contains a <code>data.json</code> file, this file will contain all keys that can be overwritten. To overwrite the key, you need to create files following the pattern <code>&lt;query_id&gt;.json</code>, each file representing one query and passing folder path containing these files to the flag <code>input-data</code>, this will get all files from this folder and replace all keys on queries found.</p> <p>NOTE: Keys that are not overwritten will use the default value proposed by <code>data.json</code> file of targeted query.</p> <p>For example, on <code>queries/common/passwords_and_secrets_in_infrastructure_code/</code> contains the following <code>data.json</code>:</p> <pre><code>{\n  \"defaultPasswords\": [\n    \"!@\",\n    \"root\",\n    \"wubao\",\n    ...\n  ],\n  \"blackList\": [\n    \"RESOURCE\",\n    \"GROUP\",\n    \"SUBNET\",\n    ...\n  ]\n}\n\n</code></pre> <p>This means there are two keys, <code>defaultPasswords</code> and <code>blackList</code>, that can be overwritten. On the query, you can search them on <code>query.rego</code> file with: <code>data.defaultPasswords</code> and <code>data.blackList</code>, to understand how it is used by the query.</p> <p>To overwrite <code>defaultPasswords</code>, you can create a file <code>f996f3cb-00fc-480c-8973-8ab04d44a8cc.json</code> on a folder <code>custom-input</code>, for example, as following:</p> <pre><code>{\n    \"defaultPasswords\": [\"myCustomValue1\", \"myCustomValue2\", \"myCustomValue3\"]\n}\n</code></pre> <p>Then you can execute KICS normally adding <code>--input-data ./custom-input/</code>, if <code>custom-input</code> folder is in current path, and it will replace the key <code>defaultPasswords</code> on <code>passwords_and_secrets_in_infrastructure_code</code> query with the custom value you defined.</p> <p>NOTE: The value which will replace the default value, MUST be the same type as the default key (e.g. <code>defaultPasswords</code> must be an array of strings)</p>"},{"location":"running-kics/#using_commands_on_scanned_files_as_comments","title":"Using commands on scanned files as comments","text":"<p>KICS scan supports some special commands in the comments. To use this feature you need to create a comment that starts with <code>kics-scan</code> and wanted command with values (if necessary).</p> <p>For example, if you want to ignore a tf file when running a scan, you can start your file as following:</p> <pre><code># kics-scan ignore\n# rest of the file...\n</code></pre> <p>If you need to start with a header comment, you can add another line below with the <code>kics-scan</code> command you want, but <code>kics-scan</code> will not works if there is any valid line above it, as you can see on the following example:</p> <pre><code># Some comment\n# This works\n# kics-scan ignore\nresource \"google_storage_bucket\" \"example\" {\n  # This does not works\n  # kics-scan ignore\n  name          = \"image-store.com\"\n  location      = \"EU\"\n  force_destroy = true\n}\n# This also not works, since there is valid script before this comment\n# kics-scan ignore\n</code></pre> <p>KICS currently supports five commands:</p> <ul> <li>Must be in file's start:<ul> <li><code>ignore</code>: Will ignore file when running a scan;</li> <li><code>enable=&lt;query_id&gt;,&lt;query_id&gt;</code>: Will get results on this file only for listed queries;</li> <li><code>disable=&lt;query_id&gt;,&lt;query_id&gt;</code>: Will ignore results on this file for listed queries;</li> </ul> </li> <li>Can be used in all file extension:<ul> <li><code>ignore-line</code>: Will ignore the line beneath the comment on the results</li> <li><code>ignore-block</code>: Will ignore the block and all its key-value pairs on the results</li> </ul> </li> </ul> <p>The order of prescendence in above commands are:</p> <ol> <li>ignore</li> <li>ignore-block</li> <li>ignore-line</li> <li>enable</li> <li>disable</li> </ol> <p>For example:</p> <pre><code># kics-scan disable=0afa6ab8-a047-48cf-be07-93a2f8c34cf7\n# kics-scan\n</code></pre> <p>In this case, this file will be ignored by KICS, instead of ignoring results for query with id 0afa6ab8-a047-48cf-be07-93a2f8c34cf7.</p> <p><code>kics-scan ignore-line</code> example:</p> <pre><code>1: resource \"google_storage_bucket\" \"example\" {\n2:  # kics-scan ignore-line\n3:  name          = \"image-store.com\"\n4:  location      = \"EU\"\n5:  force_destroy = true\n6: }\n</code></pre> <p>Results that point to lines 2 and 3 will be ignored.</p> <p><code>kics-scan ignore-block</code> example:</p> <pre><code>1: # kics-scan ignore-block\n2: resource \"google_storage_bucket\" \"example\" {\n3:  name          = \"image-store.com\"\n4:  location      = \"EU\"\n5:  force_destroy = true\n6: }\n</code></pre> <p>Results that point from line 1 to 6 will be ignored.</p> <p>For Dockerfile <code>ignore-block</code> is only usable when the whole <code>FROM</code> block should be ignored.</p> <pre><code>1: # kics-scan ignore-block\n2: FROM kics\n3: USER Checkmarx\n4:\n5: FROM kics:2.0\n6: USER Checkmarx\n</code></pre> <p>in this case only lines from 1 to 3 will be ignored.</p> <p><code>ignore-line</code> will ignore all lines of a multi-line command in Docker.</p> <p>NOTE: For YAML when trying to ignore the whole resource this file should start with <code>---</code> and then the KICS comment command as you can see on the following example:</p> <pre><code>1: ---\n2: # kics-scan ignore-block\n3: apiVersion: v1\n4: kind: Pod\n5: metadata:\n6:  name: memory-demo-1\n7:  namespace: mem-example\n</code></pre> <p>This feature is supported by all extensions that supports comments. Currently, KICS supports this feature for:</p> <ul> <li>Dockerfile;</li> <li>HCL (Terraform);</li> <li>YAML;</li> </ul>"},{"location":"secrets/","title":"Passwords And Secrets","text":""},{"location":"secrets/#password_and_secrets","title":"Password and Secrets","text":"<p>Being the only query written in Golang, it involves several rules to cover the maximum possible cases. These rules are based on regexes. The default rules can be found here. Each one is mainly composed of id, name and regex.</p> <p>Since there are cases where it is necessary to filter the results of these rules (i.e. cases to exclude), you can use allowRules. Basically, there are two types: specific allowRules, which is just applied to a specific rule and generic allowRules, which is applied to all rules.</p> <p>NOTE: Terraform variables will not be resolved. Password and Secrets query will scan and point directly to tfvars file.</p> <pre><code>{\n  \"rules\": [\n      {\n        \"id\": \"rule identifier\",\n        \"name\": \"intuitive rule name\",\n        \"regex\": \"golang flavor regex\",\n        \"allowRules\": [\n          {\n            \"description\": \"brief description about the cases to exclude\",\n            \"regex\": \"golang flavor regex\"\n          }\n        ]\n      }\n  ],\n    \"allowRules\": [\n          {\n            \"description\": \"brief description about the cases to exclude\",\n            \"regex\": \"golang flavor regex\"\n          }\n    ]\n}\n</code></pre>"},{"location":"secrets/#example","title":"Example","text":"<p>The present rule defines a pattern that finds generic tokens. Since, in Terraform, we can come across cases like <code>token_key = data.terraform_remote_state.rancher.outputs.token_key</code>, we can use a specific allowRules (Avoiding TF resource access) to exclude these cases.</p> <p>Moreover, to exclude scenarios like <code>automountServiceAccountToken: false</code>, we can use a generic allowRules (Avoiding Boolean's) to be applied not only in this rule but also in the remaining ones.</p> <pre><code>{\n  \"rules\": [\n     {\n          \"id\": \"baee238e-1921-4801-9c3f-79ae1d7b2cbc\",\n          \"name\": \"Generic Token\",\n          \"regex\": \"(?i)['\\\"]?token(_)?(key)?['\\\"]?\\\\s*[:=]\\\\s*['\\\"]?([[A-Za-z0-9/~^_!@&amp;%()=?*+-]+)['\\\"]?\",\n          \"allowRules\": [\n            {\n              \"description\": \"Avoiding TF resource access\",\n              \"regex\": \"(?i)['\\\"]?password['\\\"]?\\\\s*=\\\\s*([a-zA-z_]+(.))?[a-zA-z_]+(.)[a-zA-z_]+(.)[a-zA-z_]+\"\n            }\n          ]\n     }\n  ],\n  \"allowRules\": [\n          {\n            \"description\": \"Avoiding Boolean's\",\n            \"regex\": \"(?i)['\\\"]?[a-zA-Z_]+['\\\"]?\\\\s*[=:]\\\\s*['\\\"]?(true|false)['\\\"]?\"\n          }\n   ]\n}\n</code></pre>"},{"location":"secrets/#flags","title":"Flags","text":""},{"location":"secrets/#passwords_and_secrets_exclusion","title":"Passwords And Secrets Exclusion","text":"<p>It is important to mention that you can disable this query through flag <code>--disable-secrets</code>. Furthermore, you also can disable it through flag <code>--exclude-queries</code>, which should point to its query ID.</p>"},{"location":"secrets/#passwords_and_secrets_inclusion","title":"Passwords And Secrets Inclusion","text":"<p>When the flag <code>--include-queries</code> is not used, the Password and Secrets query is included for default. However, when this flag is used, the Password and Secrets query is not included for default. So, to include this query, you can use the flag <code>--include-queries</code>, which should point to the Password and Secrets query ID.</p>"},{"location":"secrets/#new_rules_addition","title":"New Rules Addition","text":"<p>If you want to use your own rules, you can point the path through the flag <code>--secrets-regexes-path</code>. KICS is prepared for two cases: - only the use of the user's rule (through the flag <code>--secrets-regexes-path</code>) - the use of the user's rules plus all KICS rules (through the flag <code>--secrets-regexes-path</code> and <code>--include-queries</code>, which should point to the Passwords and Secrets query ID)</p>"},{"location":"utilities/","title":"UTILITIES","text":""},{"location":"utilities/#lines_scanned_and_lines_parsed","title":"LINES SCANNED AND LINES PARSED","text":"<p>KICS presents the number of lines scanned and the number of lines parsed. Both are presented in LOG messages and the JSON report. Note that the number of the lines includes empty ones.</p> <p>Lines scanned are the lines of the files that were scanned, in the first instance, before the \"parser step\". The lines parsed are the lines of the files that KICS parsed.</p>"},{"location":"utilities/#example_in_which_kics_scans_and_parses_the_file","title":"Example in which KICS scans and parses the file","text":""},{"location":"utilities/#example_in_which_kics_scans_and_not_parses_the_file","title":"Example in which KICS scans and not parses the file","text":""},{"location":"utilities/#resource_type_and_resource_name","title":"RESOURCE TYPE AND RESOURCE NAME","text":"<p>KICS presents the resource type and the resource name fields in the JSON result of each query. These fields are available for the following platforms: Ansible, Azure Resource Manager, CloudFormation, CrossPlane, Knative, Kubernetes, Google Deployment Manager, Pulumi, ServerlessFW and Terraform.</p> <pre><code>{\n    \"file_name\": \"assets/queries/azureResourceManager/account_admins_not_notified_by_email/test/positive3.json\",\n    \"similarity_id\": \"4db29b15c254f0d6b2226a9bea87e1db9098ba24ceab992646536cd33061d03f\",\n    \"line\": 16,\n    \"resource_type\": \"Microsoft.Sql/servers/databases/securityAlertPolicies\",\n    \"resource_name\": \"sample/server/default\",\n    \"issue_type\": \"IncorrectValue\",\n    \"search_key\": \"properties.template.resources.name={{sample/server/default}}.properties.emailAccountAdmins\",\n    \"search_line\": 0,\n    \"search_value\": \"\",\n    \"expected_value\": \"securityAlertPolicies.properties.emailAccountAdmins is set to true\",\n}\n</code></pre>"},{"location":"docker/digests/","title":"Digests","text":"TAG DIGEST v1.0.0 sha256:19dcbba1cfdf3c694655bd220388ec0259b917b1d8e2cfe5c9c2bcd2e622fac6 v1.1.0 sha256:c462502877759ad672a7ce23a8bb7a7919785ffc9c3c3e8080bd63527d3a1ffb v1.1.1 sha256:c5bf326a66663c2e60de3e34281fb4b261f96f9eedc44ebeedc0cf5429c620ce v1.1.2 sha256:0cd5432f46f03dd98152fd2fea2fee5217b9073962ff05e60271dfa2ad56e600 v1.1.3 sha256:f1ae5fd7b2aacb2e25197c730395fb856a06453e99c2a2975c21dad2cdcfbe4d v1.2.0 sha256:ea69752d9933f828db1c6dee1fc77f351254019e6f5854cb7c881ec462a81cec v1.2.1 sha256:4664defe259e6b5932f3588100c5eb579e9223ec4bb23ba210c2883798a8a907 v1.2.1-alpine sha256:6a101e54da3c0fcd44880c661a20c8ee3aa184294ade64b1f50cb0a368006869 v1.2.2 sha256:5f4c4848bb97afa741beb66925657a2b0c76bdd854e6ad563fe5042d8cc94abb v1.2.2-alpine sha256:ba8190c91c29f9ec1b7076e380c8e95000eae9f62633eeb2a92babc89c40dd3b v1.2.3 sha256:86da11359193a1917142d8cd0fd0f3145f8ee5c3626bff58a8693b74511a529a v1.2.3-alpine sha256:cdd53847672220aaf9eaf27164553cc5acf8057761f204a6a1d675aab2160adf v1.2.4 sha256:8c27f27c944e252854e2fb69fe7d3ced4534b9813fe0be3e23044f93acda64c0 v1.2.4-alpine sha256:ca544c0a5083457a5cb8c03a0c4fcc10d366c90bef92784d1fcd77dabced123d v1.3.0 sha256:86be8c6531e864af672585b13fffb26d9f9836e2f995a231443dbd196374e220 v1.3.0-alpine sha256:0e6f817b86ddf771c5dc4379bdcdd634a0491059692292bbbc3887903f1e4a7b v1.3.1 sha256:4b5827fa71e78155f2080f4c4d23808c96a3497a96106dc58fc44291ed6e8e92 v1.3.1-alpine sha256:0851c06f0a84a1a8e364c95f24f84371e94bef20738eb790341f27e79a6927af v1.3.2 sha256:71015611084453102bf6f28594a55b24226ca09dbfc0f7dae802b72286f89ff6 v1.3.2-alpine sha256:7d22988f6f7c4722248a491c9feb0a015683d0289eaab49ce473fc63e726f25e v1.3.2-debian sha256:aec9c374aaf03700439ffe2d65d08844c2ec3d9ca3e7a92e3a3337bec8e18736 v1.3.3 sha256:03f6698ac700ffcea28b2e59272f5eb9d8b3f71d74fbd028bef2e2eaf3fad950 v1.3.3-alpine sha256:8abdfee866ea0b20811400964dbe75f78d29e4a613e0267306661d496c72b89e v1.3.3-debian sha256:f838d7d9037c915b2912dd91dada8f47e5a96548a27e7bd2341f1dbf71404616 v1.3.4 sha256:a35ecf5328ad9f0b02e2f656a2359ae4d04764023b3d2a202bcdf19f0947534d v1.3.4-alpine sha256:88497c60aa901d0037965882467e2305a65351bd5f97e8cdea5b9b95565a1106 v1.3.4-debian sha256:2f9338d6101fdfc5deb31059faf4d06ac24c4be93cc0f904db90230a4266f57b v1.3.5 sha256:a02efc07bfd0194b56f8ae7f25bdfec3c87e4715601d6e15f6a4c287578853a0 v1.3.5-alpine sha256:10cecfec0fa5f75bdd78c55a70e9f355d5f5068e4dab59ee820aa09530790549 v1.3.5-debian sha256:c4d1efb2adbca74213c378653f3704277e92ec14b732f793540e9812bd65f5cb v1.4.0 sha256:69e022991c2c929549862e4a81702723f2fd008230bb4f0180345d9753fbd836 v1.4.0-alpine sha256:69e022991c2c929549862e4a81702723f2fd008230bb4f0180345d9753fbd836 v1.4.0-debian sha256:f70fb499cd30c0288f0c03e1eceb29ccbc391e42334e5ea563e8c0b93d48d8f3 v1.4.1 sha256:58d7f7077e1c5d5d322c9e7e8c9a6d67baa1e8bc04677eff2efc9a9b8e23e2af v1.4.1-alpine sha256:58d7f7077e1c5d5d322c9e7e8c9a6d67baa1e8bc04677eff2efc9a9b8e23e2af v1.4.1-debian sha256:7fc965cdd8ed288e2b284154744e6bea1fdb3fec53583db4b0e6cfa0a13045f0 v1.4.2 sha256:0e42b974003f780dffcaee4dfa7fdebcdebac3d7ecde4f453720c4f5571d4acc v1.4.2-alpine sha256:0e42b974003f780dffcaee4dfa7fdebcdebac3d7ecde4f453720c4f5571d4acc v1.4.2-debian sha256:50dd1df29a713cbb71760a9f749264f6f366fa7151722f0f5032df72ecc0a250 v1.4.3 sha256:b471d768cbd40385c77f52fbf3b00a0b1d73b71ea395482988ddf8029301c903 v1.4.3-alpine sha256:b471d768cbd40385c77f52fbf3b00a0b1d73b71ea395482988ddf8029301c903 v1.4.3-debian sha256:00dcc0bee775cfdeb8cd0c29cdc6c33595370cf876f2f4415e39a949b4909ca9 v1.4.4 sha256:758be1987c6bb99f49c4fcefe90f0568490e4d9e3d78baf36d4b47f4f05cf4d1 v1.4.4-alpine sha256:758be1987c6bb99f49c4fcefe90f0568490e4d9e3d78baf36d4b47f4f05cf4d1 v1.4.4-debian sha256:d802d4987c62abcfc04f2a3a30c5f1eb96aaef22fae94cb7904eed0685b00c49 v1.4.5 sha256:d0aa27f21d0a9f42c4a8991db1da34660e25ae87e1f113c757d3b67c8f4822de v1.4.5-alpine sha256:d0aa27f21d0a9f42c4a8991db1da34660e25ae87e1f113c757d3b67c8f4822de v1.4.5-debian sha256:a5ad43cb1e1a455109d4b9963f33ca38f0cf8dfb674fc6a6473aa585917c9928 v1.4.5-ubi7 sha256:29f7473ab2aa395fa4b84ed65c9c2ad24ca308d377992a8944291242d67ae4d8 v1.4.6 sha256:4ff21f073fa426e36031adc6a6753498ea95c7a5b9b0f72c4d134639e8363ce2 v1.4.6-alpine sha256:4ff21f073fa426e36031adc6a6753498ea95c7a5b9b0f72c4d134639e8363ce2 v1.4.6-debian sha256:05f3327ef3c009e1cc8ed09a8834143e52c2ac50ad9223e577db88fae3f8b953 v1.4.6-ubi7 sha256:bb78172235e1a22e320503fe3212cc442e87fd9d4fc6942cf2ece5f7728ea3d4 v1.4.6-1 sha256:6b94e3d980c098d35fed9fdcc4b6e9eec119713102faac5b2781615d8cc0ea3c v1.4.6-1-alpine sha256:6b94e3d980c098d35fed9fdcc4b6e9eec119713102faac5b2781615d8cc0ea3c v1.4.6-1-debian sha256:8bfbf74a249a7e4e92941e3c2f0972578a60a1bb331af507b112df0c5f7171b9 v1.4.6-1-ubi7 sha256:927a5531ad49b99d1452e1c39b1f6df1dcea9703a7a7677b80bfb6d3ab0a8e6c v1.4.7 sha256:7fda9ab5f0fcd543111c434d874e38a650176866033ecd050cd2192924c06fbf v1.4.7-alpine sha256:7fda9ab5f0fcd543111c434d874e38a650176866033ecd050cd2192924c06fbf v1.4.7-debian sha256:5fc5b75c2baa0bdc9fc26f57c4eee36510f0fef3dacb5c4b64bfad71351af423 v1.4.7-ubi7 sha256:a3ecd0a980948b4aa16cda5fac2e68e37326a4d7cf38965716480d82fb6b4a9d v1.4.8 sha256:d0d9d8c69e465fc28e19eb3db0c5018d5382a82ac3fc8c7a5129463faa68c2ca v1.4.8-alpine sha256:d0d9d8c69e465fc28e19eb3db0c5018d5382a82ac3fc8c7a5129463faa68c2ca v1.4.8-debian sha256:d6ef22c3847e0364afbc4347a99ffccb519677cd3ca652bad26c4dacf96b90fb v1.4.8-ubi7 sha256:586d52b8ccb190e2a9823155d64c253094c5eadb18675b4d273187fc225cde8e v1.4.8-gh-actions sha256:94f02e50fa6841dc7fece3e69bb1482788e937c3c57b3daaa0731302aaa6e344 v1.4.9 sha256:2a02e0f5f94e7f7efc9ded83a3eec353b3876c9208275fb13e318fac2e2117dd v1.4.9-alpine sha256:2a02e0f5f94e7f7efc9ded83a3eec353b3876c9208275fb13e318fac2e2117dd v1.4.9-debian sha256:284d7f4e3f5a8923d4d9f6e054408b52b1d823e31ce291ed1ed16c6170b6b00e v1.4.9-ubi7 sha256:837a2293c950483d6aad6562203214c297389f87bf2364ec57f79fd831eab6b4 v1.5.1-gh-actions sha256:e3fe50f550df1330a5000d0dca1ef5ed84b510d1ec78ef1a94ddf0c03decf05e v1.5.2-gh-actions sha256:afc52ed100a3443e11372a08744d478c5d371bfe65512995f12c36c34f22b459 v1.5.4 sha256:628ed3b084e6ace14838b2772bf261187a606066d7bb31ed77087beb66ed0847 v1.5.4-alpine sha256:628ed3b084e6ace14838b2772bf261187a606066d7bb31ed77087beb66ed0847 v1.5.4-debian sha256:9c6232e228520e5d6ba26975be9f509e3fd230714ef219dadffe86c8e7a398af v1.5.4-ubi8 sha256:4871c63055945e929cececc6139b8028145d537aa19c75c6d79cd0d65d250df0 v1.5.6-gh-actions sha256:f0232875171f3ef272ed3374a4f4e649fcddc9cc4fea3825d6ff103b91ffcc63 v1.5.8-gh-actions sha256:61a2d50c83f15acbcf536f56bebc114ba19eecfe5a356580ed931c4a01f341fd v1.5.9-gh-actions sha256:015eebbaeb31e8a9ea0909df089bed06442d8aabe60ac3e6afcdc00c269c0f41 v1.5.10-gh-actions sha256:78199d59ab734071f32746d84ff0443b9a9dd6088bd9e335bfb7867964f2223b v1.5.12-gh-actions sha256:e3172e976f6be1885dfd6164a181ad2d9b824b6baab3b32e0b0b957b394fe1eb v1.5.14-gh-actions sha256:15ceb7c65ad725488751987c1efa58c89bea4ee36194cb1bda0690d853bf0286 v1.5.15-gh-actions sha256:7e49da050fedab8a23b1f9a035091b271da6764d0fac7714e982c90f4780fae9 v1.6.0-gh-actions sha256:1b33723c40e8b5620d70879de57772e859ba13d864275a8d109e3b24911446cf v1.6.1-gh-actions sha256:003346d93e3174e550d32c8aeb5f2286f2536b74e5e1397496f51e1274a39bac"},{"location":"docker/nightly/","title":"Nightly","text":"Type Commit Date Digest scratch 115cd1ab 2020-04-23 sha256:edaae69a1e8224100ff720baae27ccf833e4a8ef3bce0bbcb612e1152927f62d alpine 115cd1ab 2020-04-23 sha256:0c0524454321bcaae6658a9f63140fc9d97d470868d9d677b15a289e7165d7bb scratch bae6ea50 2021-04-28 sha256:c8e2e11d53546a7d740b252c0ec7653e81b89fb26c4000c0b1f0779a34179b2e alpine bae6ea50 2021-04-28 sha256:66e23f9b22ad4d3538bda36df07946312e30fd38f378499089766c923d971933 scratch ee87d1e1 2021-04-29 sha256:2dd25b8ce436336dbca9220b03ddb22d08b17a8144909cb8b97e19a2cc6e0266 alpine ee87d1e1 2021-04-29 sha256:1d94c06ad5c9c579de76521bfcb6d019a6e93e2947d8ba541736ff1de8097d8c scratch 5af7fe95 2021-04-30 sha256:95f77f9aa21a964bb8ec55e534afc1a9199711acd118427cc59325294de9c97c alpine 5af7fe95 2021-04-30 sha256:55caa636b05a116c81077e34d8a0616a8e8aac1b0d326473c77cd8b0a1e9fd42 scratch 2ae02af3 2021-05-01 sha256:996f3d29f72555467806478ea72ac808ca617169e7c003fa4ca85fb5ca3de3aa alpine 2ae02af3 2021-05-01 sha256:d92f3d904dd563b72a4f629deef1e653b205591e9baab1087fe926cde5c53411 scratch fc96d124 2021-05-03 sha256:4dbc7ffa37a13d1de81496fbe5415162c34446c8fa7b8b604bac5866304bc057 alpine fc96d124 2021-05-03 sha256:9bdbc6d22977ba7c74064d0e5556e480d0f2da364b240d681d65403ec3ee2575 scratch da982427 2021-05-04 sha256:496811f04b4d15681d00817f4f4e793b94446dffde9624f082f720dc0c5efe7d alpine da982427 2021-05-04 sha256:16fd01212980c3dfe9a48e4b5b62337cbac7bb65b6e64a1223760e3df82b99ea scratch 2ffd8707 2021-05-06 sha256:131aabf4bfc8722063f9d29565caab08bf259f477d2cccce8550ad5e8eeccdf9 alpine 2ffd8707 2021-05-06 sha256:37d52a65c32c031724427206f2c905ac984e41cb48caa07788f3b85ec706e85d scratch 876c5568 2021-05-07 sha256:811fa3ee8ecd24da7e07d928a4cb097aa183038b4f1b819e11ba4556cac3b819 alpine 876c5568 2021-05-07 sha256:943b0e75bad89ca31a9b782bc566f7e8d4ce2a32635d8ccb3eb4bfdcabe3272b scratch c2889ec7 2021-05-08 sha256:b20ad2eeaec9fdb73b55b3e9fb9f0bf467e568789cfef9c07156ad8ab5e071b4 alpine c2889ec7 2021-05-08 sha256:c388d10f9354c8c2626a0a83094adab3fea0d53808043c6114191630d82adfef scratch b7879c34 2021-05-11 sha256:e4913df9a293739d371f08a42f17abf2c9e2014268897d324f23b7085a14959f alpine b7879c34 2021-05-11 sha256:53c0de8052ae1092ca56f6300bef5231c3d52447f83dff35a3947ccba48b5089 scratch 910c9f8a 2021-05-12 sha256:4c0dd7f6607a81c279a88e78aae1965d46a63242769a083254b560f53e0f202c alpine 910c9f8a 2021-05-12 sha256:a86e3059afd3135b98d71ac7492067cbe13e030443376368afd35556b37a493b scratch 90ab12e9 2021-05-13 sha256:b45f8b8588fb257d0d876eb82c5401a508acc0877b948f034e899eaf7e315503 alpine 90ab12e9 2021-05-13 sha256:ac28efcff79127e508eebf7d92eca72ba13e884999ca4b43d6ac9b12180b7fab scratch da3924aa 2021-05-15 sha256:2226b286dd467ef31dafaad853a3d7dd27bd57a98ec16cb06b139c8646afd6c8 alpine da3924aa 2021-05-15 sha256:388349925716d8a55e131a907c2cec0f6d33744260c8f4bdce809c10147c80df scratch 521ec3df 2021-05-18 sha256:655fcf21decf9286c15b96d2d7dd5dc8137ef79554461f280a36162accd77468 alpine 521ec3df 2021-05-18 sha256:5e42f0f009e93d9ab97bef3694e5183281344e2023310379b620949314037d10 scratch aab9b478 2021-05-20 sha256:a2d1d56f395f82cf30cf70951330d0ebf0e5cbfb71d275504ed72630ae89b63f alpine aab9b478 2021-05-20 sha256:b4e2fbd8e0210074643d64497ce48c777096b9be537a14b52946dc5f9e3f6fec scratch 4ef60e89 2021-05-21 sha256:32ce5af5badc24215cab3e6b9e48a59c4702ecf3567f6e56e0ab1dc4044a966d alpine 4ef60e89 2021-05-21 sha256:76b25e685913c46c0d4467b508502ca919cf4216bd69b658b0ab4c87d46022bb scratch 4464ff82 2021-05-22 sha256:3bad4268a107c973c6eb8dfa3bbba135ce7b59f650ee89cb840439fc0db2319d alpine 4464ff82 2021-05-22 sha256:e15d809f20005b89ab945b6f42b4abb40abbab675c4694a1af21a6a95ac2fcd5 scratch 67f0f697 2021-05-25 sha256:3a93a08b0c757e4f868ab2f736054ad0382e6a1f1bf528ce5e1156242f804231 alpine 67f0f697 2021-05-25 sha256:ea16451abe8006a0bebc5cfb78399513b2b9c77012c7ecdf0d59682c8fab52a0 scratch c8824ab6 2021-05-26 sha256:dba1f6877fe07aabc73738330c4fe076b9d95e968fcd8302b3be96b17183ca71 alpine c8824ab6 2021-05-26 sha256:a28ade62563ca215a6e93ad6640a8fe2d7cef4153fa7c2d9e8fcd0a18eba7958 scratch 523fd492 2021-05-27 sha256:65a0c06a2a5193f1356698db31568e7f04fd0d77a496cc64ef7ef6da00079c93 alpine 523fd492 2021-05-27 sha256:cd6fefcbe85f826217ffffe09d8c9c1629056d2c8d9537feca85bc978eda0dde scratch 246ced5f 2021-05-28 sha256:c262d25cd445bf2f0f6da26c281f6267a24f10449ec637340b21e58237f2a8aa alpine 246ced5f 2021-05-28 sha256:97f32e20506150339f7fc4da9a74f7478c6ea271b5a0617cba017179be422d70 debian 246ced5f 2021-05-28 sha256:f884ff731d1870356f6fc52ad762eb7875d0a816dac3ccbef6936114b83ac91d scratch 8b3d37fc 2021-05-29 sha256:47eb8b29e52724dd53d9c5d17712e351d100c2dc69ad63bd09e4bbe021b4d6ea alpine 8b3d37fc 2021-05-29 sha256:1e3ad1617106d1806e9f19be2fee23b7bfb9881a5681a9cb17d633d522eb3c20 debian 8b3d37fc 2021-05-29 sha256:325842da53d07e404a453ea04e19b5b02511a36b3de1c35e1f1de4bbc52475a6 scratch d5cdbe8d 2021-06-01 sha256:8efc2189b234d2ed7daba7778a816d01b9ce5df42c7dd41c98050bf5e61f3985 alpine d5cdbe8d 2021-06-01 sha256:3382a59d20ec83ad5e39acaea0d182b5e99ccaa16a7a7a49e8dd08d82456ad98 debian d5cdbe8d 2021-06-01 sha256:c7ed9eae0c27169488dcade97f9bffcf8f7de6a6dfc8bdcee2bb53018d87d406 scratch 5d184fbd 2021-06-02 sha256:801a0ce3041ce372dd1e1e01e081bb0dd6a3e310dd6f9e0e771ef81140919b75 alpine 5d184fbd 2021-06-02 sha256:bc107d304b930e16cf88562ecf339dad4c9f71a7638a3cccd784d3aea1aad5cd debian 5d184fbd 2021-06-02 sha256:2e3d3c199cfcb4c85292b9e85958912f336db808d06672cc111f0b75cebd6af5 scratch d6038b03 2021-06-05 sha256:5952dd9aaf54f9d55380de2de599ad2b2a12457187881657684041bb1c3541df alpine d6038b03 2021-06-05 sha256:f968a72b7ae133b3a8f84df2e29db775c19e133969d407c6d0265508b68e3ac5 debian d6038b03 2021-06-05 sha256:15cbe09ec84d08a18695c9d1ecd5cf5ae0d377510faab3626ac7da43c8be800d scratch 1b99a4b5 2021-06-08 sha256:3bcaa6278e1c1dee3aa3937d42fd849bfa4c40f07125933a4ad0c99a2211c4ef alpine 1b99a4b5 2021-06-08 sha256:4c5237baecfa9b5e952b68ba72e8f395298652ecb290b18f8fd38939a534e44c debian 1b99a4b5 2021-06-08 sha256:db47dee30d65013493375f809ed2416ae752e75ec5b98c6186d1a0a8d2265c21 scratch 528558b8 2021-06-12 sha256:8963dacca0b850389cb804a596495797f0d22f6873bc627d5e7f669730b149ad alpine 528558b8 2021-06-12 sha256:a8ddc094dc8532570743813299999edbe8708c5919206a02f1eaad94f79087e4 debian 528558b8 2021-06-12 sha256:ca43d2a8b99abe6f7a6e916bab25102489ab65230a4e33174e8a521692c9bd19 scratch d0b0c90d 2021-06-15 sha256:37d60efea40c9aa1612303407bdd7a31824010aa26b0ffca05efbd0e7a86700c alpine d0b0c90d 2021-06-15 sha256:2bc9d2f6bfa2ef5bddef03e3c39a06fe398282d975389a32a3ac4fc0f1130dd9 debian d0b0c90d 2021-06-15 sha256:267102656107f59d5f79ca7fcff0a6b14e09bd69c3e28f08e6d4bea34ac12c36 scratch 372f6538 2021-06-16 sha256:d07c4831e757f7afe98ed033ecd9f253880d478a0dd7a9068c0c21a1968ed526 alpine 372f6538 2021-06-16 sha256:3cb2c9adb141fe0e88d527ca04fc1559c45c6905595cea837496c923bfde4ced debian 372f6538 2021-06-16 sha256:56496168818d30b4b24c2559e18e98177ae3943531b78ce006b3eb54684ad1da scratch fd591421 2021-06-17 sha256:00ab0184567a05550e13dfa6fb49b82547b983c5938f970b1b051d41e0448d6a alpine fd591421 2021-06-17 sha256:dcf74d8a31c0d9fd538fe9c00c3fff08ac9e01a54fb3df8ea1014cd644577e53 debian fd591421 2021-06-17 sha256:65a92e015ea1ac684eae8fc5d201a49c73666547f29aa2894d8d7550dfbad65f scratch e69bcbf6 2021-06-18 sha256:7db049c802890480b819edec5bbed4e3e409d15f4bcc60bdaaa71e655b52300a alpine e69bcbf6 2021-06-18 sha256:c40b0920a057441a54f247fe4e8df30af5dda04f71dddcb016508608dedc0544 debian e69bcbf6 2021-06-18 sha256:b42c3d63222b8d196d99bc16c587ac071ad8d259e6c5c073a03520a3c312f305 scratch 7d36ca23 2021-06-19 sha256:c80854a5c8acfe2c84645633dfdf7332d231763351524968af1b3603295add12 alpine 7d36ca23 2021-06-19 sha256:dd81675a7ac0b606cdb9d8dd23801df18ad080cee70e31a5f382e6d23fbd2d65 debian 7d36ca23 2021-06-19 sha256:e4d3eacf87904b2044e7c5fc7df89a563c461c026e2024a50b26a528316f5d9d scratch 8c7d1fa8 2021-06-22 sha256:df27fee468f1ab6d0c8b8e0c1e7c5e28d7d7c7b9bdb3d0e13ad1a71288d73e19 alpine 8c7d1fa8 2021-06-22 sha256:790ae163ce2360a3139ea1cce932292ecadfadb24553da28a361204d9c77fc15 debian 8c7d1fa8 2021-06-22 sha256:9244f7b02c8066c74559c547301d9b62c350a904fe5f29c860918036b714b1aa scratch d0fd2825 2021-06-23 sha256:1b0e7fbe58d33347607d62f8f077c4c47b19c49d8f0ea1ae2b6c385b20d8de7b alpine d0fd2825 2021-06-23 sha256:2a2e307c8071c4f158df55e01e7540b252f4bd68a0df2d84b30bd9cd40ca6f44 debian d0fd2825 2021-06-23 sha256:5dbda1e920f18c482faaacff4cf59a498cee37682483814ed86fba20d02c4e8a scratch 3b38d3c0 2021-06-29 sha256:e31c4e415aad60ddbe7886f4fc66ea14c1116fa510153d28d37fd810b2ca944a alpine 3b38d3c0 2021-06-29 sha256:ea4964807cf6561fa79546d20eae27f29352b75309423d546bae0af967a411f3 debian 3b38d3c0 2021-06-29 sha256:3cc55b280703d5f049126d2ebb0317363274840c9ea3f4d7c5d9e560b53b39b8 scratch 486b82b2 2021-06-30 sha256:4643f3c8f3c68284990679359fdede4415a17a34bc17020b42a143b371b429b5 alpine 486b82b2 2021-06-30 sha256:862cf92d9e935b78f0d0533687e8d15de960090703e210d0286acdeb7220eaa9 debian 486b82b2 2021-06-30 sha256:aa55d8e751b174695cfbefe515b9ba5129b9e061bdd430c9998d3c5945ed2de5 scratch db2932c2 2021-07-01 sha256:d24776a65d1b44f1ec90e9a05d7d34d09f51ef643e1f903d377cff543a887c76 alpine db2932c2 2021-07-01 sha256:9e652a13410ce2cf2ea17f91a21387d72e83a60759ebc78b7d055b3022ac0051 debian db2932c2 2021-07-01 sha256:f72dedf498a1877fd4297cfa301650e4b950af3e0b7d48372e288151845ad459 scratch 9b4ed458 2021-07-02 sha256:ca7c6f8feb15269f61e2a19a770ea962bd5caeba3a846c32666e16be9deafa0f alpine 9b4ed458 2021-07-02 sha256:0af26462f6ff1e2fba9915ead0e23945ab002a47023a6b3e2f0f378ddcca703d debian 9b4ed458 2021-07-02 sha256:be999ab457429561080a2235f803da3a6798fe559f19009c902d2d3b74824c2c scratch afcee12f 2021-07-06 sha256:e7d3d5b6237a03710c22da10ec54ff12d9fc3df87d41f30a01b9701a861625d0 alpine afcee12f 2021-07-06 sha256:a363ccc583308fb99f4b63d812d2f1bb0484c0139afafaddeb53d201b1ff62f0 debian afcee12f 2021-07-06 sha256:777bfb598b1d7d76e2c2517b7383a70a9f8109e0c78da5acddd7bb3440729419 scratch 566b1bb8 2021-07-07 sha256:4b408226ebf3d91e5d3bad44e6e97a3e1adb0a62530fc4e13582ddd5c7dd18ea alpine 566b1bb8 2021-07-07 sha256:d89c0eb78b65ceaf08025cf8153c629b578156064786a2d3334a2708b193212a debian 566b1bb8 2021-07-07 sha256:3ee153607e8dee07318b2ae2968364cb63e06e39c5709d069aed0660ee52d64b scratch 467c7466 2021-07-08 sha256:473e2dad902b53b344dee4d1e039b9b6120f13ba3649dce05dfaca5ebcf13505 alpine 467c7466 2021-07-08 sha256:14741409e9a18ea7ee0d0f5fb50620bf5ab53ceadbf9c2a6d32a6ac5075badae debian 467c7466 2021-07-08 sha256:dfc585326693453e3d257b3eda119675712e7cbbe9d351cbc7aa284b549b9d75 scratch b5f229b8 2021-07-09 sha256:aca8221febb7e8809f98dad3e6345bd2e9cd4b1a6d771ca77d61eada31b00b03 alpine b5f229b8 2021-07-09 sha256:4abc236372bd542902b81b804f6f9dd963339e4cbd019d74bae773071dd79657 debian b5f229b8 2021-07-09 sha256:2c9a1bec275328d5f302589da4d4cb0433804f90ead8c59572c65ec0e38dbef0 scratch 8a932437 2021-07-10 sha256:f78c297ddfa20c16ee80fc4d8b5ce18f23493fbcb4958cd1358edf86665dd3c2 alpine 8a932437 2021-07-10 sha256:6e9d071913f5d7be4962fcaed0fd03aa646cd9568ab94c2daa0765e009cdd4de debian 8a932437 2021-07-10 sha256:ea7346bd334256b946a10c9ab630196acdcfed1e336b67b23edb20e82f06d7cf scratch ae943bdd 2021-07-11 sha256:4b0f37baa1eda8c4db280ca017f21160b5da4213b3884c76386d90b906085566 alpine ae943bdd 2021-07-11 sha256:ca08d21c9c8f3737b6c87affee3fca38eb434d5304d0950614459c992c2ebd23 debian ae943bdd 2021-07-11 sha256:26cf9ff2b586e1fea7f0f958006a02c9de831763f122a81dfd4fb3fd6b82f6c4 scratch 365be6f8 2021-07-13 sha256:f5310d9eb4a803cfd117c7c4fd240cb051ba5a0f3202526ff4770cef2fb38241 alpine 365be6f8 2021-07-13 sha256:2050b2dde401d49f0a89fe646ba7701a6548bc533c56c147890bc6d0776c154b debian 365be6f8 2021-07-13 sha256:b05efc836c611026b9bf360333bbb4b1783bb5d72b419bbbcb70452e3317e30c scratch d0d52a83 2021-07-14 sha256:91e3d4c33a9c88521d4c3f77c14aae4b6c950d475ea74bf61f6e75ebf657bc9d alpine d0d52a83 2021-07-14 sha256:3bc7ceb7cdfcb3292db671192aec2ea9ddabe405fdc62a414d85db34b58481cc debian d0d52a83 2021-07-14 sha256:f9d953bea379ab6ac6d1f34cb925f1ae0b3b054520facd20f2b43b41bdcf4e97 scratch b40fb27a 2021-07-15 sha256:a8b4e02d20d82d2e12c8f8e0ccb1464ded9acd52a971a9c82b584af15cb6e2f2 alpine b40fb27a 2021-07-15 sha256:73b865cb5573a8e59943cae34b7972ca9045fbe8d6b7a0c8081fe1baae6c5ff9 debian b40fb27a 2021-07-15 sha256:9e38160ff593af544f5496a09918d797702704f24485b1e492e0cbf115088fde scratch 404a56d7 2021-07-16 sha256:a1a896743c5fe42f16a048072c8486419e8e6509caac10f1f6f4619bb5be3d13 alpine 404a56d7 2021-07-16 sha256:632d259611d9fa8788e5957832c0adc930e17c31c242e6175f23c47f533ae853 debian 404a56d7 2021-07-16 sha256:fb4209ac359daa6b41dac898bd909c10930626673d1acefc21a90d56aec954c3 scratch d442e520 2021-07-17 sha256:8336cfeee6cc2dc9df39a8ea07a8e6a815d55582f9ff66e3ebb6b88f8d43011c alpine d442e520 2021-07-17 sha256:8330ad9ff3fac0653c957c1e3154cf93289935ab270be4c02dff2c17eef57d20 debian d442e520 2021-07-17 sha256:80a449cf67b26304326d1fe6a55e305a597971a714bd72521a57f60ce21425e9 scratch a0c67e47 2021-07-18 sha256:34f38b45c0ffca7755ceabd9440255e52388bfc5bb5bd7e962d02f109733fbb5 alpine a0c67e47 2021-07-18 sha256:e8e59c55ca527a9441043665cccbdb36e02712fcf2401911175dd03e895f66e8 debian a0c67e47 2021-07-18 sha256:7a77735075008d0f12c146fc2b2ec6a54f8752c9751f10597008a399a4ea921d scratch 5a0479d9 2021-07-19 sha256:a0c3f31f480cfab1ed01ff7b7cb214863f76eb70ff867188bbc200512b901e6b alpine 5a0479d9 2021-07-19 sha256:8195ebd7ba71af5813e7b8aef99b0e24a3d73fc1559c7742aa061138f88960f5 debian 5a0479d9 2021-07-19 sha256:6d85ddb14d58a1b2eccfd4c61e1dbcc809a70ea3adbb61dc94a4d648a9350346 scratch e7981208 2021-07-20 sha256:3367e182d6f81c6bc75d6417312947fda465c8809609edcb6284aeccddd649a3 alpine e7981208 2021-07-20 sha256:2638983c22536ab6ccdc43aebd03e7bc7fbe2e2c28a05145d5092aa9cd5d5fa2 debian e7981208 2021-07-20 sha256:aab2838585893c958ce33802abeb9836bba44730200c8558af38d56b79cf57ec scratch d2ce69e9 2021-07-24 sha256:f14b7a143a40d1c59abbd13cf8896ef21e2edf6a3de1e876797a43987427416e alpine d2ce69e9 2021-07-24 sha256:f14b7a143a40d1c59abbd13cf8896ef21e2edf6a3de1e876797a43987427416e debian d2ce69e9 2021-07-24 sha256:8e813c836d5100858b1b60c185783db62f9084a91b0609fddb0ad294e12d87d2 scratch 5acb218b 2021-07-25 sha256:f7f3b3d5779f57def16e93972d2dae296eeba7e994ccf562889fe9e1e5e5a0e9 alpine 5acb218b 2021-07-25 sha256:f7f3b3d5779f57def16e93972d2dae296eeba7e994ccf562889fe9e1e5e5a0e9 debian 5acb218b 2021-07-25 sha256:b611476bcb6dee6aa987adf6da7c2b1ea5e4cdda3638bbc16d5b50950f7cfc32 scratch 3a17fee6 2021-07-26 sha256:2aef122c0a731cf304b543d5cd26b439c4e10afa72c9edc5884a1a64cfacf95a alpine 3a17fee6 2021-07-26 sha256:2aef122c0a731cf304b543d5cd26b439c4e10afa72c9edc5884a1a64cfacf95a debian 3a17fee6 2021-07-26 sha256:53c52111d3193eef7b20c596d075c292bd0bdcdec58e38967e6bb262e275ac88 scratch 999824ed 2021-07-27 sha256:cc05fb639ba05ac9ef0c0b9682e2017617aafd38f78bae258ec75916088398fb alpine 999824ed 2021-07-27 sha256:cc05fb639ba05ac9ef0c0b9682e2017617aafd38f78bae258ec75916088398fb debian 999824ed 2021-07-27 sha256:c51328202b6cd8fe79b2b92b6f1535f14c24e1169abffaf3e07fa04b679b4b98 scratch 7cb40f95 2021-07-28 sha256:4e7342739a4a8a2d8ac8b13b6fa3cbeb35c983510651553df39058f26be418de alpine 7cb40f95 2021-07-28 sha256:4e7342739a4a8a2d8ac8b13b6fa3cbeb35c983510651553df39058f26be418de debian 7cb40f95 2021-07-28 sha256:c1f39f07fa21688367bb8a51266367a6abf66405a98239667975608804cfc987 scratch 93d9336a 2021-07-29 sha256:967a20819483a0adc85476e4586dd22f8c6d40917288585b0bf1ffe3c25e006b alpine 93d9336a 2021-07-29 sha256:967a20819483a0adc85476e4586dd22f8c6d40917288585b0bf1ffe3c25e006b debian 93d9336a 2021-07-29 sha256:42f2a65df45ad2dd524686985eeaaac543f1e6e23c2eedf0e099a2d6d6f419e2 scratch de7ebc55 2021-07-30 sha256:78c39ffee797ca78b0356ae14f227b30dba4c0accc7e552fc48383fc3c3ef523 alpine de7ebc55 2021-07-30 sha256:78c39ffee797ca78b0356ae14f227b30dba4c0accc7e552fc48383fc3c3ef523 debian de7ebc55 2021-07-30 sha256:46f42f6a62a32a084d84eb15ce62a024c78a058b498a80080c093751b9e645c7 scratch 12deee82 2021-07-31 sha256:65215b6140a0bfef96e83c06cd45bf8e7cd68fbe5665ebd2826318cf42351e98 alpine 12deee82 2021-07-31 sha256:65215b6140a0bfef96e83c06cd45bf8e7cd68fbe5665ebd2826318cf42351e98 debian 12deee82 2021-07-31 sha256:f8d4f65716db24dcb3cb1f4c08ad305946253ff883cc2e4426448bbed25493ec scratch 30065f21 2021-08-03 sha256:33c2fd9e16c54543265844bade6f467997bdb2c47b90ddb3f6dc8425a92a33d4 alpine 30065f21 2021-08-03 sha256:33c2fd9e16c54543265844bade6f467997bdb2c47b90ddb3f6dc8425a92a33d4 debian 30065f21 2021-08-03 sha256:c9b4ccd591a8e80ee1b626ba23ddb50017735261914df8e634223871e41197e4 scratch f10f7420 2021-08-04 sha256:6dd538b28a32cd4bfce929285f8cf30d67172e383636b0f36324b26e61cac2a1 alpine f10f7420 2021-08-04 sha256:6dd538b28a32cd4bfce929285f8cf30d67172e383636b0f36324b26e61cac2a1 debian f10f7420 2021-08-04 sha256:ec7a547d0b4c3245fb91ab0b87b9cc0c4f380a8f28a7536d962f3b8c1afd1eb2 scratch 9af1e186 2021-08-06 sha256:dee027741e31a61f99056448a5abbe07f0af89008ce3cfcf6800306224c3cfad alpine 9af1e186 2021-08-06 sha256:dee027741e31a61f99056448a5abbe07f0af89008ce3cfcf6800306224c3cfad debian 9af1e186 2021-08-06 sha256:77576ac5a28b10dd8ac7d4ac171eb264f84a1e739242c1f39a7255e132e80905 scratch e9b2b291 2021-08-10 sha256:6adca1f8ca8f0ee1f6b69d5c1790e90f1a9f6e1522729cb9fdd8206d99feb23f alpine e9b2b291 2021-08-10 sha256:6adca1f8ca8f0ee1f6b69d5c1790e90f1a9f6e1522729cb9fdd8206d99feb23f debian e9b2b291 2021-08-10 sha256:133e52d7123c44b6d0f8ca2cc063cfbe1e6d951e621c18bdf050cc88f02019fc scratch 7aca777e 2021-08-11 sha256:6ed1dcc5df36b4d003c60d57a0191e7ea2c762475671554411a8a5f864bbf4fd alpine 7aca777e 2021-08-11 sha256:6ed1dcc5df36b4d003c60d57a0191e7ea2c762475671554411a8a5f864bbf4fd debian 7aca777e 2021-08-11 sha256:8f6828ad6c9af014c3a82e39b7d8a3d8326d81db1d55e17970f69ece169016f8 scratch cee1e76e 2021-08-12 sha256:fc2d00654a6431715c87a7fa90e6f098b16c48ccb625f6efe3522fdbe0d65194 alpine cee1e76e 2021-08-12 sha256:fc2d00654a6431715c87a7fa90e6f098b16c48ccb625f6efe3522fdbe0d65194 debian cee1e76e 2021-08-12 sha256:9d38a2baa74462525d70db0f5511ecea0083dbd82da62a7191cdddc135b4dfb6 scratch 95ebf3ed 2021-08-13 sha256:232e53fe5d8e0f1eb1fc4c697569acb530dbbdde154c00a3ba17313f1c459029 alpine 95ebf3ed 2021-08-13 sha256:232e53fe5d8e0f1eb1fc4c697569acb530dbbdde154c00a3ba17313f1c459029 debian 95ebf3ed 2021-08-13 sha256:48607fc06c97ad31600e9f6251ea1f53f97d42d5f65228c8035062b15dbfb5be scratch ba3425d7 2021-08-14 sha256:0d1ae5e80b46e6841d1feb1f614415cc47385826b99a0159edaa2b54725bd2d4 alpine ba3425d7 2021-08-14 sha256:0d1ae5e80b46e6841d1feb1f614415cc47385826b99a0159edaa2b54725bd2d4 debian ba3425d7 2021-08-14 sha256:ae4ad528b361cc1d8a177cec65ae830346c6852543581917f1463cc47e8531f7 scratch 9ec5b676 2021-08-17 sha256:d566ae08aef4c3e6efec827e63a40f76309a917addb184ba5c82dbf007145f73 alpine 9ec5b676 2021-08-17 sha256:d566ae08aef4c3e6efec827e63a40f76309a917addb184ba5c82dbf007145f73 debian 9ec5b676 2021-08-17 sha256:cc552b37b4df33e0f12202d045b49684364fa23ac3bdecb8da0a8806a70ae49c scratch 931ac04a 2021-08-18 sha256:8342897b8645cdc288d8cdddaea90ef71f8a576eaa13d3b059c8ffdb2a71b650 alpine 931ac04a 2021-08-18 sha256:8342897b8645cdc288d8cdddaea90ef71f8a576eaa13d3b059c8ffdb2a71b650 debian 931ac04a 2021-08-18 sha256:3d03c3619f5cf576c10003bcb031b78c64de898ed65741f1f6024b69c01ea6b4 scratch 99832a54 2021-08-19 sha256:b449c203925be3c89af23852745cd4f76282d95f1c564ecbec9f7a5c897ac7ee alpine 99832a54 2021-08-19 sha256:b449c203925be3c89af23852745cd4f76282d95f1c564ecbec9f7a5c897ac7ee debian 99832a54 2021-08-19 sha256:9c347497b09712a5503cb5a42de680045fa6745e6b49a0768e16f8e6cb67954a scratch b9397142 2021-08-20 sha256:1b6c29555f6210313ea6efb6c8c252f208c6b7cbd4ddaca5e679936582b23b54 alpine b9397142 2021-08-20 sha256:1b6c29555f6210313ea6efb6c8c252f208c6b7cbd4ddaca5e679936582b23b54 debian b9397142 2021-08-20 sha256:db2127441a1b33d7bbd4cc42871b6976044075c3046826fd7f3f15cd91870dae scratch c98fa2c2 2021-08-21 sha256:6bd5ab363d505963a7dc44a2fc803e814e72a576380581f2c1df181812a1f8b9 alpine c98fa2c2 2021-08-21 sha256:6bd5ab363d505963a7dc44a2fc803e814e72a576380581f2c1df181812a1f8b9 debian c98fa2c2 2021-08-21 sha256:1eb0582e90b419df6af0797ce9392cd065fa34157fa239b735ed2fee0827d7cb scratch 40c51ebb 2021-08-22 sha256:0c83065209fd588cee151ba1edaeeffce30675e3274953b9102d7ff339d3ec87 alpine 40c51ebb 2021-08-22 sha256:0c83065209fd588cee151ba1edaeeffce30675e3274953b9102d7ff339d3ec87 debian 40c51ebb 2021-08-22 sha256:eb61d2bce98b9a9f20b50a22e3b2cb9580c48c6c32143065dce76e25ee731f16 scratch 047c751f 2021-08-24 sha256:1100bc2392e61dc46172d256be26bd4fa0020c6842ec154bbf334caf7b1cdc7c alpine 047c751f 2021-08-24 sha256:1100bc2392e61dc46172d256be26bd4fa0020c6842ec154bbf334caf7b1cdc7c debian 047c751f 2021-08-24 sha256:3b8e18df5e46c81f38feb3da9e1cf6f0cc6a62b4e4b9e95736dca07201013592 scratch 27b3f71b 2021-08-25 sha256:7f2280ad594b5e98ec75c64f5b6013102130c0e219ed4ee4aedc145f00ed56a5 alpine 27b3f71b 2021-08-25 sha256:7f2280ad594b5e98ec75c64f5b6013102130c0e219ed4ee4aedc145f00ed56a5 debian 27b3f71b 2021-08-25 sha256:dbe7ba7cda4cb9bd1c045471f7b2b7befc1f682ebef50dc426b68ca75204f25c scratch 6f21693d 2021-08-26 sha256:5032e1b94e4f6bdbbf34d11a6413994f01bba520ea647c3ef9deab46e0267621 alpine 6f21693d 2021-08-26 sha256:5032e1b94e4f6bdbbf34d11a6413994f01bba520ea647c3ef9deab46e0267621 debian 6f21693d 2021-08-26 sha256:a0607f77122eb9eb3d9d8219c36dfbd93f74b30a1fae3a412d67e14cd2eee9c1 scratch c5b560be 2021-08-27 sha256:6840067959e22994b349d9a28b31d17b6a377e3d6e8ca9d0b67a9af18a94d260 alpine c5b560be 2021-08-27 sha256:6840067959e22994b349d9a28b31d17b6a377e3d6e8ca9d0b67a9af18a94d260 debian c5b560be 2021-08-27 sha256:8129fe09b30e53961921a917c1d356a5c9c3f29a2c3d869294b5756c245590ed scratch adcdc9b6 2021-08-28 sha256:d82a9ac854942c9e2086c3b08e8eac94f52581b33ea6fa3781c3d54c6b16b6d2 alpine adcdc9b6 2021-08-28 sha256:d82a9ac854942c9e2086c3b08e8eac94f52581b33ea6fa3781c3d54c6b16b6d2 debian adcdc9b6 2021-08-28 sha256:b0677c45cd54b519eb01ad3b0c74529fe07fef148f8456bce61810dd850922e1 scratch 77ff972e 2021-10-07 sha256:909eb70676ba5d71ffac6d485a63859e396ba9bb30d9d3c8644e42bbf55b1ed4 alpine 77ff972e 2021-10-07 sha256:909eb70676ba5d71ffac6d485a63859e396ba9bb30d9d3c8644e42bbf55b1ed4 debian 77ff972e 2021-10-07 sha256:f4f21be11c6a24a77c8920685e91ae83a4a4721e720c4fae5483b294c3ffb1a8 scratch 164107bf 2021-12-16 sha256:f876d84970bf221bea682a9e4da5696b36d1cf0f8c2850c9c322ae765f0f5d20 alpine 164107bf 2021-12-16 sha256:f876d84970bf221bea682a9e4da5696b36d1cf0f8c2850c9c322ae765f0f5d20 debian 164107bf 2021-12-16 sha256:326767d6d8810ab36b8c64562744b6c7a79f5bcfa0908760faa3d72ee7ab2ea8 ubi7 164107bf 2021-12-16 sha256:3103f460b60fa22f9d18bbcda5db1a2ba15f2ac30acadbeabaa8b784b1915555 scratch a1431286 2022-01-24 sha256:21917e4394075ad87348ca20e9ecf7dec712b87409706ee9b40b33fa669d1b4e alpine a1431286 2022-01-24 sha256:21917e4394075ad87348ca20e9ecf7dec712b87409706ee9b40b33fa669d1b4e debian a1431286 2022-01-24 sha256:bb1826ba71fd39a66ebe583f58b1885d8bcbedcbcb37b3bdf0cf8ed1a4ce5895 ubi7 a1431286 2022-01-24 sha256:85d16297666a3b9ee127aa2854ef9675e5953d62f2cf4c14d37b50804a565dd2 scratch 459d88b6 2022-02-02 sha256:bbd201f4726bc0fa224220858e273eb7c60c8d515da9b4923323c658beaa4746 alpine 459d88b6 2022-02-02 sha256:bbd201f4726bc0fa224220858e273eb7c60c8d515da9b4923323c658beaa4746 debian 459d88b6 2022-02-02 sha256:a139d99832803080778764e1708ee30b3d25c5c47ea03b366a1788cf8a92cdf6 ubi7 459d88b6 2022-02-02 sha256:2867f05eb70b05f2d65a3faa97690f946bc43d6a6857af5ecce0a8d6d96f65f2 scratch 875ef387 2022-02-07 sha256:1c39339ee8b38e317112c26b815cbab334364b747d6da78a2023f0a4a685fd83 alpine 875ef387 2022-02-07 sha256:1c39339ee8b38e317112c26b815cbab334364b747d6da78a2023f0a4a685fd83 debian 875ef387 2022-02-07 sha256:d454bd5bfea2ca8c41851c6dfe3882e8fe5ea2f00402d56288ea7811dd91b279 ubi7 875ef387 2022-02-07 sha256:79c961bc3296f5c84269f3ba8a967b94f3168800811c1e8b1c48589a4a7ad85f scratch f615f864 2022-03-09 sha256:8ffc9f5d97a4a7e39c186d072d4cef9675a9736626321a9c9eeb4212e6db1057 alpine f615f864 2022-03-09 sha256:8ffc9f5d97a4a7e39c186d072d4cef9675a9736626321a9c9eeb4212e6db1057 debian f615f864 2022-03-09 sha256:001da0fee87394aca8dc72400671729a169f584df6d645b562f6732b3f3970d2 ubi8 f615f864 2022-03-09 sha256:2fb59831ead7486991359afd6896b97887210a556980704d676f1a7fda59652b scratch 8026554a 2022-03-17 sha256:64ec3382b8fb4a21ab1ce30dd3fbbe78087ffa3596f45a3c4f52293c9be69c77 alpine 8026554a 2022-03-17 sha256:64ec3382b8fb4a21ab1ce30dd3fbbe78087ffa3596f45a3c4f52293c9be69c77 debian 8026554a 2022-03-17 sha256:1bd6e2150b4580ccb763efcbb8af08537d20d013fb864ee51b0e490e4a36931b ubi8 8026554a 2022-03-17 sha256:87812a576b355d7b2ca02c95d0d5406816a00daf55c4705da978dc1e733dbcd6 scratch 0d0fed34 2022-04-14 sha256:779f2329ba80582f89758462734a75da9ac9f3f7ef420541e33fb1a9de643bf3 alpine 0d0fed34 2022-04-14 sha256:779f2329ba80582f89758462734a75da9ac9f3f7ef420541e33fb1a9de643bf3 debian 0d0fed34 2022-04-14 sha256:b42feae6460ffd1a19394619c439147e959d4d3c3327673f7c0b4f00300f8c57 ubi8 0d0fed34 2022-04-14 sha256:055fcdbe97c30aacacbdeb1643211ae90d67e7385382c681235d045c8513954b scratch 1af0298a 2022-04-22 sha256:a509201a2e1960187d046a6c1eb41315c5048d9503859eb023b8877afaf73f04 alpine 1af0298a 2022-04-22 sha256:a509201a2e1960187d046a6c1eb41315c5048d9503859eb023b8877afaf73f04 debian 1af0298a 2022-04-22 sha256:641c274fe965cd62f7260985c9f05fd25c3bcb19dae01b078277027ea4f2ee66 ubi8 1af0298a 2022-04-22 sha256:63cca4cbb9df50f6938cfaff7a54eea11029c7c6a94b6c0edee8aaee2860c716 scratch 5846333f 2022-05-02 sha256:ffb1e1a1aadb91fb07e08f9b2cda582767320c4888ecbef8d50f00e3d07e5db0 alpine 5846333f 2022-05-02 sha256:ffb1e1a1aadb91fb07e08f9b2cda582767320c4888ecbef8d50f00e3d07e5db0 debian 5846333f 2022-05-02 sha256:c81591e7508ecffd0c88f2ee884a7ef1144076310875bc9b4d51c8dc83f2370b ubi8 5846333f 2022-05-02 sha256:e50121cdc17f3b7afa6a6c2c820b0517b94b78dee6fb1fd4ccaa79b5d2640d1a scratch fd4160fd 2022-05-04 sha256:ec5c8ac7d7b0793782c2a42d5cc3c6092d4d582eeed46c3c8094ca2344dc1423 alpine fd4160fd 2022-05-04 sha256:ec5c8ac7d7b0793782c2a42d5cc3c6092d4d582eeed46c3c8094ca2344dc1423 debian fd4160fd 2022-05-04 sha256:ec36ec2197079b09ffe38ee5b68d4dfe0cf36efc47ceeaa72de4739a4c39dd36 ubi8 fd4160fd 2022-05-04 sha256:1925dc6ee1d01c27e702a84bcedb4925304602988caf4d9f22a27555bcf2fbee scratch c2993ec2 2022-05-05 sha256:3dc3e9cc84e1ee2ee45309f3a96b249aeddc2eea26ddb173edbf5e3780f6eb3e alpine c2993ec2 2022-05-05 sha256:3dc3e9cc84e1ee2ee45309f3a96b249aeddc2eea26ddb173edbf5e3780f6eb3e debian c2993ec2 2022-05-05 sha256:6ef241e07372a753f84a6e75a67491a2b101fe302c0baf198a6ad39f8cdda0d2 ubi8 c2993ec2 2022-05-05 sha256:66be122109613eea6e85a3f25e50846f382d675b23a36ca8ddb42f556739c1fe scratch fc9b5ee2 2022-05-11 sha256:e5d437179c654072eb5f19ba8e48f5e50aeb5411ae8e06e1e3777b6ac0ae2635 alpine fc9b5ee2 2022-05-11 sha256:e5d437179c654072eb5f19ba8e48f5e50aeb5411ae8e06e1e3777b6ac0ae2635 debian fc9b5ee2 2022-05-11 sha256:e633edf7517d78cb2df2fb07d6ca7cc5c55b8a4b57df871708ab49e07a4d96c4 ubi8 fc9b5ee2 2022-05-11 sha256:0fe13d186c04ff3fa98ecf75df39e33177915b732da707bd85d8ed44cb691186 scratch 38bb9f35 2022-05-12 sha256:8cb900572b75150e0e3fdb41f76de896b715da7835654bb57e8e6e5b34ce4ce3 alpine 38bb9f35 2022-05-12 sha256:8cb900572b75150e0e3fdb41f76de896b715da7835654bb57e8e6e5b34ce4ce3 debian 38bb9f35 2022-05-12 sha256:435f0114e3237658669e4e07fb78624e1aa60bf5e35b53342b8918e49ecdc0aa ubi8 38bb9f35 2022-05-12 sha256:d90206901911d2410f9de48830b8ea7082ac7a3dfcf94fbceaecdb44c1b5be1d scratch 1d4f6998 2022-05-13 sha256:66b05f6e514b2eff917cefee4ea4e8ec9ada0df10d5089b4a64762e0cb734132 alpine 1d4f6998 2022-05-13 sha256:66b05f6e514b2eff917cefee4ea4e8ec9ada0df10d5089b4a64762e0cb734132 debian 1d4f6998 2022-05-13 sha256:b20e176665db5bff6c0cacd4e8ec680ecd663b832ff7c44f59fd2f9ff3ec0ea8 ubi8 1d4f6998 2022-05-13 sha256:17b0a8df03b07ce088482c9d4624e9f370a06cb79d1c94a6ff3d911d51d67c69 scratch 73996ca2 2022-05-16 sha256:82b45b80f2babcc572f2b678d50ccfb865cbfd93b11c308388c1927f62cab69f alpine 73996ca2 2022-05-16 sha256:82b45b80f2babcc572f2b678d50ccfb865cbfd93b11c308388c1927f62cab69f debian 73996ca2 2022-05-16 sha256:4d1bef15eb5bbdea5945d04da02a8725c9514d61fd1ec0cad579cb94bc412602 ubi8 73996ca2 2022-05-16 sha256:604564dfa964867dff6949b0f3945e49389cbda267870cf0b70261b748841b9c scratch 75251d62 2022-05-17 sha256:63da4aa429fe4f0ea1cc41e07dd9199acaf48333bafa6cf6ab332958cbac98ba alpine 75251d62 2022-05-17 sha256:63da4aa429fe4f0ea1cc41e07dd9199acaf48333bafa6cf6ab332958cbac98ba debian 75251d62 2022-05-17 sha256:842218854c6afd07f68a56961b9ae989ef06a3b47cd608da10f25613be289df0 ubi8 75251d62 2022-05-17 sha256:8d62bf473eff3fe1b0e9f1be3c2ebe9bfef4eef3c6c0db1f910e494ed763a323 scratch 6ee1a14b 2022-05-18 sha256:830b28c320abe3e06f158c3a03ecbdd5f124aed6c9e5fd74446ea2549b6efff2 alpine 6ee1a14b 2022-05-18 sha256:830b28c320abe3e06f158c3a03ecbdd5f124aed6c9e5fd74446ea2549b6efff2 debian 6ee1a14b 2022-05-18 sha256:bbbfc0b9644c4bcdfdeb8149fe1d5e57157c8bf4635009ff7b86e835edab3086 ubi8 6ee1a14b 2022-05-18 sha256:04afb9c2dfe59dbf040734de356d255618146e5ee7070b5148cb64e9f048f590 scratch 8278b606 2022-05-19 sha256:b152eabcf75e0854996ef93eec678ccdf2042849e18b368a72cea3432e70fb2c alpine 8278b606 2022-05-19 sha256:b152eabcf75e0854996ef93eec678ccdf2042849e18b368a72cea3432e70fb2c debian 8278b606 2022-05-19 sha256:03272253cd61c373eed8b53155eb203ec2311274c857e02b0c99cbecacce1d3a ubi8 8278b606 2022-05-19 sha256:bfdb9db4e79c79f0b73552be16761ac171864db0a1d05a581ebe1a1269ee74a9 scratch e21eac49 2022-05-20 sha256:fa407f2b8bc817431b29fe34356675b13b599227bc6a1020433522b8779898e3 alpine e21eac49 2022-05-20 sha256:fa407f2b8bc817431b29fe34356675b13b599227bc6a1020433522b8779898e3 debian e21eac49 2022-05-20 sha256:10c30aa3793359a6c0beef15bb31da5dea9261c1656bcdf97dbe913ad8163094 ubi8 e21eac49 2022-05-20 sha256:130c0007df3b4eb5b71a7e75aa5984c3cf8cbf47de1133f5873026143c2a6de1 scratch 231d98c8 2022-05-23 sha256:8530996b0f90b7e7d2050be04d789daf931fe8ed3207e496247c3275ff254bb5 alpine 231d98c8 2022-05-23 sha256:8530996b0f90b7e7d2050be04d789daf931fe8ed3207e496247c3275ff254bb5 debian 231d98c8 2022-05-23 sha256:df9ebdad3d076dc2b4eb4aab87d4427d443666644f9dff14064c23dcbfb4f1fb ubi8 231d98c8 2022-05-23 sha256:13fbad6c670b205515d9f2d93288141351db986b9ab81ad0c9c4be9ae082dba0 scratch ff00cebf 2022-05-25 sha256:747848e7ca24722b29f8131daff0f5741c2685168ae4f161b85b62704e9fd75f alpine ff00cebf 2022-05-25 sha256:747848e7ca24722b29f8131daff0f5741c2685168ae4f161b85b62704e9fd75f debian ff00cebf 2022-05-25 sha256:e48390a41eac45c23a058bb102acb38bbb90ee8d2786c62504c51b9f26147a1e ubi8 ff00cebf 2022-05-25 sha256:1d0e34ada6cf0a72029e2c9458e26f5abcbe6a32876d4e906f3ed57d2888740d scratch 8dab4f0e 2022-05-26 sha256:b2af49773662b7f5af93eb6cd9d18cec5aaaa8c6af41335196d397254c6ecaf9 alpine 8dab4f0e 2022-05-26 sha256:b2af49773662b7f5af93eb6cd9d18cec5aaaa8c6af41335196d397254c6ecaf9 debian 8dab4f0e 2022-05-26 sha256:e10e9abab4d2c6fd1289ab1ac66857e9333ef1e633208719f3791ac695407f65 ubi8 8dab4f0e 2022-05-26 sha256:728a169b7e6f219c7546571aa22a2a1b71ff221866ea71903b9c09ff24936b2f scratch ede5d251 2022-05-27 sha256:7f723e00696fe8d3c47e5d16f6ff920baf78799cba88a1b56d34045ea4faccc4 alpine ede5d251 2022-05-27 sha256:7f723e00696fe8d3c47e5d16f6ff920baf78799cba88a1b56d34045ea4faccc4 debian ede5d251 2022-05-27 sha256:702a3296c7a4df68113761c656b4e94b0361cdc01040ecd80125ca7d9eb93041 ubi8 ede5d251 2022-05-27 sha256:f5c925e66126e1ae8b43ebf4960522594ab7c9824885a985807143486e4ee50e scratch b753e9b4 2022-05-30 sha256:4aa3d0fb8538ec91a9a84a244907a58e5a38ba0ad9d2e73d263102425f871b61 alpine b753e9b4 2022-05-30 sha256:4aa3d0fb8538ec91a9a84a244907a58e5a38ba0ad9d2e73d263102425f871b61 debian b753e9b4 2022-05-30 sha256:eafeb124270e8a65dc25d2da7b496e8338936c546b987673772602739e8d1d35 ubi8 b753e9b4 2022-05-30 sha256:9bf15ff5bb811f22460b27bcb340e784e50a28872aba87d40350d3289703743c scratch 2565134b 2022-05-31 sha256:1f0febaaef5a5798375acb80ff7db8582c16f4acfba671d707e3e68ca3d3fd23 alpine 2565134b 2022-05-31 sha256:1f0febaaef5a5798375acb80ff7db8582c16f4acfba671d707e3e68ca3d3fd23 debian 2565134b 2022-05-31 sha256:90c63b407c298e64cf7a6603dd1d42285e563244f4fc21aa26602a2340647dee ubi8 2565134b 2022-05-31 sha256:8a3e94f9e8cf361941ac86dc64b6974ef6a4ffd1120284b77b860ca299bfa4be scratch 92f459d4 2022-06-01 sha256:55c49afeeb2d28523c3dfe053423d32bafac88bd4b3ec20c0b7fb6b8d4b33df5 alpine 92f459d4 2022-06-01 sha256:55c49afeeb2d28523c3dfe053423d32bafac88bd4b3ec20c0b7fb6b8d4b33df5 debian 92f459d4 2022-06-01 sha256:1402c7beeedc914a21ff19980aa394bd1107261abda48c9a1168d435945d859e ubi8 92f459d4 2022-06-01 sha256:04a54b6e0b091f75282a3fe27a930770d67a0cc108a03fd4b26e33f8c42b93f9 scratch 86319d6d 2022-06-02 sha256:e645697094f5a31a396cd8bae608d38a827eef8122835c451670adbe11f82255 alpine 86319d6d 2022-06-02 sha256:e645697094f5a31a396cd8bae608d38a827eef8122835c451670adbe11f82255 debian 86319d6d 2022-06-02 sha256:e1712d482f09422dd12b226adcd1c1b8a47f1aa0e8f7343c54d77f334699a838 ubi8 86319d6d 2022-06-02 sha256:a3a1f9c123479cb6969a49a6cbe7285feac15a3aa88b6df059d65e6aee1f4f5e scratch 1e38e44b 2022-06-06 sha256:30a02aaec1f178622421d376d52fb3bd9a37926af2652efb5026ff20914b4a7d alpine 1e38e44b 2022-06-06 sha256:30a02aaec1f178622421d376d52fb3bd9a37926af2652efb5026ff20914b4a7d debian 1e38e44b 2022-06-06 sha256:6d6b301aa0222bebb4ae21a16beb9a341ffc7a7e43017f072c513e72ae12acf6 ubi8 1e38e44b 2022-06-06 sha256:ab0500e1de7cf7e5959907ff661cc1f5deba8853149aecab499f4832100584bc scratch 8d06099c 2022-06-07 sha256:93a5bdb4c77a7d5c982bffb6925d344185e074d2ec748e1bc1e363b4cedbd4c5 alpine 8d06099c 2022-06-07 sha256:93a5bdb4c77a7d5c982bffb6925d344185e074d2ec748e1bc1e363b4cedbd4c5 debian 8d06099c 2022-06-07 sha256:fd135718ec08fff72fc9dfb132b6c3e18607a693fe2043400a598cd653d25de7 ubi8 8d06099c 2022-06-07 sha256:47beaf3bbc505f97aa2511710f0b8bd32bcae81f69a70515ed8059f4a292d641 scratch d393cfa8 2022-06-08 sha256:85f4ce79e807543fe2b026871e624207c72a50d84b6684a6456cb7eb6e9b66fd alpine d393cfa8 2022-06-08 sha256:85f4ce79e807543fe2b026871e624207c72a50d84b6684a6456cb7eb6e9b66fd debian d393cfa8 2022-06-08 sha256:d3616df97ca7be9496dfe9fa8ecaa5df2f87fb83220f83a79f67948148a81fe0 ubi8 d393cfa8 2022-06-08 sha256:dc232df76aed2be2935ecdeea85765eed5d8d55fcdbe05ae35abb7efd9ff4a75 scratch 583aeb78 2022-06-13 sha256:57052ae9ae34c25e71bd458d9c149c6ea3d7fbd6fd7e69b4a365022e10c431b9 alpine 583aeb78 2022-06-13 sha256:57052ae9ae34c25e71bd458d9c149c6ea3d7fbd6fd7e69b4a365022e10c431b9 debian 583aeb78 2022-06-13 sha256:bfe795402c7fefa8607cc81d7eb6e87be23de3e610a5b40f71fae3af24168d57 ubi8 583aeb78 2022-06-13 sha256:de7bb87de5e3b90d544c8514ac8c511dbd05196bfb855206c013088055bb4905 scratch bce876d1 2022-06-14 sha256:111070b8f387f5c2c0acbd5ca7d820685f1d3a5b0af35240549c04918655242b alpine bce876d1 2022-06-14 sha256:111070b8f387f5c2c0acbd5ca7d820685f1d3a5b0af35240549c04918655242b debian bce876d1 2022-06-14 sha256:1514d992b223c6df7baa73f1dfab1896991cfd5079e73d0dae7b2a472da599d7 ubi8 bce876d1 2022-06-14 sha256:2412e4ddb6f7375361bc4f30ddd5293fef63c53c49a29a1210d8d803c5110a1e scratch 3330636b 2022-06-20 sha256:b914082a8d09706aa934dcc550afb6da860ae62904a3b9bc9f80a96366c7c9ea alpine 3330636b 2022-06-20 sha256:b914082a8d09706aa934dcc550afb6da860ae62904a3b9bc9f80a96366c7c9ea debian 3330636b 2022-06-20 sha256:4b3f57a8b6eb835a63c9e6734335de2bd3da9e33c1fa479e61bdf776f79a30a1 ubi8 3330636b 2022-06-20 sha256:85263019054afa688da5569c3b50f7bd5f746dd557b6af2750e9574cb88c301e scratch b92b481b 2022-06-21 sha256:e8b27472b6999ca9851e95bc62b7891340213d1ba6eadf24e89a202d1f8d5c10 alpine b92b481b 2022-06-21 sha256:e8b27472b6999ca9851e95bc62b7891340213d1ba6eadf24e89a202d1f8d5c10 debian b92b481b 2022-06-21 sha256:7adb83e7fe52e55d1481e5ccc7488250a58d0a83275b05f3062647259ffb48b5 ubi8 b92b481b 2022-06-21 sha256:40841db84b700c90b7a762eb30cbb110ae0a67b58ba1d7817adec1d6b4f68582 scratch 6c18f4c2 2022-06-22 sha256:c403f01c785024a9aefae27fe8037e832df6b300e4fdc7bf1cf8b19bb5ba54a1 alpine 6c18f4c2 2022-06-22 sha256:c403f01c785024a9aefae27fe8037e832df6b300e4fdc7bf1cf8b19bb5ba54a1 debian 6c18f4c2 2022-06-22 sha256:c9a4b3f2f1e86b3851bc1276134b0ffa581be9ca063e982e2af1570ff5dc493d ubi8 6c18f4c2 2022-06-22 sha256:2a0ffd9d806ee2f68fa17b1fd65135a24dc1f60ab9de50c8694054c876eec62f scratch 2343a0f8 2022-06-23 sha256:ce14939ff439de48f3ab8d1625f47770b05b535c481ad8af87d7f392e1bfdbdd alpine 2343a0f8 2022-06-23 sha256:ce14939ff439de48f3ab8d1625f47770b05b535c481ad8af87d7f392e1bfdbdd debian 2343a0f8 2022-06-23 sha256:a05915c88b2f339a54bcb30b981f143508daf1f40fc8b381e71fb4d43c944463 ubi8 2343a0f8 2022-06-23 sha256:27b6c7e1f7c4db72c374ccb43a7e6732a653914892bfb653a9e9958b594d9137 scratch 2c3d197f 2022-06-27 sha256:b0624ce0cb1aa7fc6f549198552e880504c5669f04682accdfcddbafcb699061 alpine 2c3d197f 2022-06-27 sha256:b0624ce0cb1aa7fc6f549198552e880504c5669f04682accdfcddbafcb699061 debian 2c3d197f 2022-06-27 sha256:96637db1bb51ac0f6141a42967067c7774c1210983810bbf76cee4a7e4a282b2 ubi8 2c3d197f 2022-06-27 sha256:02f8734bcbbd2d61f078ccfa9564e650d0ce8bcea443ed35407150f300b46122 scratch 0a3b222f 2022-06-28 sha256:5bc07ab2dbb5cbb098cf7f4efe01a163e68e2a379adaa9d44397b11b251e27f4 alpine 0a3b222f 2022-06-28 sha256:5bc07ab2dbb5cbb098cf7f4efe01a163e68e2a379adaa9d44397b11b251e27f4 debian 0a3b222f 2022-06-28 sha256:cab03caadffd636f314b8b2e85299341008694fbb0ec6aa85bb40a06f1177307 ubi8 0a3b222f 2022-06-28 sha256:41b1fb0ddc301bf3d9262c25e96f3218ea2cfcd1b0bd9bcfd22ab3af5bbe0323 scratch 4cec7269 2022-06-30 sha256:bdf3aeb368ee5ad355f991dece510631df1dbb5782e757cb6eee8c482ff9f81d alpine 4cec7269 2022-06-30 sha256:bdf3aeb368ee5ad355f991dece510631df1dbb5782e757cb6eee8c482ff9f81d debian 4cec7269 2022-06-30 sha256:dc8d8dfb1f0a8d60f3030809d23610883a15a90fc3449d4755a3d74c77718ed4 ubi8 4cec7269 2022-06-30 sha256:f28a9060b4b25962f9ad5655f4316cdba4658d908118cea42315f079fb7dd7e0 scratch 27009c3a 2022-07-01 sha256:0d4f0df314fd9f1677c06b7a601bf1bba96860c916350f61fd0d73fa80416b16 alpine 27009c3a 2022-07-01 sha256:0d4f0df314fd9f1677c06b7a601bf1bba96860c916350f61fd0d73fa80416b16 debian 27009c3a 2022-07-01 sha256:421ee3346c5399296183be4af84aaff73924a80fd06a72afd0640881603002d2 ubi8 27009c3a 2022-07-01 sha256:bb810e78ff1b5fc2c8c9ddcd822709eca3d5a11ccc55557a2bb4407676015f3c scratch 052994a1 2022-07-04 sha256:17373b35e75ba8f7bc02e0b471ba063a54583324b960216ee5653d256041e968 alpine 052994a1 2022-07-04 sha256:17373b35e75ba8f7bc02e0b471ba063a54583324b960216ee5653d256041e968 debian 052994a1 2022-07-04 sha256:f7965f0be1e487c142f3005802fe944172e2b3e3ee2580a010a4419cc0942d96 ubi8 052994a1 2022-07-04 sha256:fe1ba937676edf3e2c4cddc1fae9b897c4c18c9f328da96cc62be2dfb17102fa scratch 2b586d54 2022-07-05 sha256:0f1e584f3e451f407257db0701203d5b6a2163f735d266b5bf97a7538e0869a3 alpine 2b586d54 2022-07-05 sha256:0f1e584f3e451f407257db0701203d5b6a2163f735d266b5bf97a7538e0869a3 debian 2b586d54 2022-07-05 sha256:0434f7a80dd23ffcd350c41c6e5c93362c6b03730d95cd42f901316213ecd2d1 ubi8 2b586d54 2022-07-05 sha256:1cc635bd960c2df6a335fbe70127f4adf1b6ecff48d672b27e4c3475e9cfeb3b scratch f74d47d8 2022-07-06 sha256:d1bc1ba2f50503c7b95f0b36b25bd58eb2a3487e33e297e95bd681f1b5f96ed7 alpine f74d47d8 2022-07-06 sha256:d1bc1ba2f50503c7b95f0b36b25bd58eb2a3487e33e297e95bd681f1b5f96ed7 debian f74d47d8 2022-07-06 sha256:75adcea5c303ba2965ad68d1bf974c39d6c7dc3b8877352ef588167e6c93a4ad ubi8 f74d47d8 2022-07-06 sha256:687a59d4819ad4be7cbacd9e308d8dee496e88b9de8fe48c824fdb3309c66ece scratch c129eb31 2022-07-07 sha256:357f91cfed2a3596282d5f9dee770657cacf85bb1b3e3006bba0b2732513f977 alpine c129eb31 2022-07-07 sha256:357f91cfed2a3596282d5f9dee770657cacf85bb1b3e3006bba0b2732513f977 debian c129eb31 2022-07-07 sha256:9bc434e23431437bf1d1547c6a02c35e6f246f1fa2e23c16f0de0d1532e45032 ubi8 c129eb31 2022-07-07 sha256:f4b8d9b15bc3af086e1de39b5967be5f5350266fad6b77890dbd9cfeb81e858c scratch 4517cbb6 2022-07-08 sha256:553b383d7fab28496b5abe258071d52049c64212f89d613aad2c285b7ecbea14 alpine 4517cbb6 2022-07-08 sha256:553b383d7fab28496b5abe258071d52049c64212f89d613aad2c285b7ecbea14 debian 4517cbb6 2022-07-08 sha256:9a1c4743d8d9bf8fa4f168647354acbdfa21af36cad08e59d5307984e1d54130 ubi8 4517cbb6 2022-07-08 sha256:f1f6ffee3cc296b44c47663252c36d39067b0c1aedc6e4b62f701681392833bf scratch 69298d4e 2022-07-11 sha256:b81078f05e9332c2aed1180ff819b8509f5f5471c8897bd96a5e6bd6d1db335a alpine 69298d4e 2022-07-11 sha256:b81078f05e9332c2aed1180ff819b8509f5f5471c8897bd96a5e6bd6d1db335a debian 69298d4e 2022-07-11 sha256:78c120d1a44223d7473a780b62ba0dd3794cfe987d523241070e6462e59a54df ubi8 69298d4e 2022-07-11 sha256:01a8433134f8e0cfb9aba8c8f4d456a2d2d4d7419248eee515b7ec1f1e30ad5e scratch 77fa2416 2022-07-12 sha256:5f760fe5e1b8e49ab13d2cf5845b3eb13e484e5ad512aa9a452ca2ebb27764ff alpine 77fa2416 2022-07-12 sha256:5f760fe5e1b8e49ab13d2cf5845b3eb13e484e5ad512aa9a452ca2ebb27764ff debian 77fa2416 2022-07-12 sha256:da5b4542482c4437888b19236a59a34d5883d10b3917e943f54ed50e7ac6d049 ubi8 77fa2416 2022-07-12 sha256:2e5b28c1f1d4cd24954c5aa4e69f4037653b186e90fcb8955106023b032f5577 scratch 207bcf31 2022-07-13 sha256:8efd30673aedc406d7b0cb90e038d1741e2a5f36a19d83b7955ecab38008f870 alpine 207bcf31 2022-07-13 sha256:8efd30673aedc406d7b0cb90e038d1741e2a5f36a19d83b7955ecab38008f870 debian 207bcf31 2022-07-13 sha256:6a29b4baea63700dcca506177b8316941d374dc653e762af607618b5b840c373 ubi8 207bcf31 2022-07-13 sha256:1c4a131df2271919797be4c01c78a46996ff716d146d41feaabb1e0c03133a9c scratch b61dbe4b 2022-07-14 sha256:2a079441a2eecb78254c66bcbff237e5078e744c45a7bd6a6a4df795c6c36ae9 alpine b61dbe4b 2022-07-14 sha256:2a079441a2eecb78254c66bcbff237e5078e744c45a7bd6a6a4df795c6c36ae9 debian b61dbe4b 2022-07-14 sha256:37a0373be16c3db090d39872aca61640d35df7866ef62cfea15edaeadce90b2c ubi8 b61dbe4b 2022-07-14 sha256:980e53c789bccb1b9c56839241d765c65be59acedd29b7c61008fce283903fd6 scratch bc87c6bf 2022-07-15 sha256:180ae2bd2b8b27f13f716a5f645f602b8ee93fa31a07969d52e8de2046441fd7 alpine bc87c6bf 2022-07-15 sha256:180ae2bd2b8b27f13f716a5f645f602b8ee93fa31a07969d52e8de2046441fd7 debian bc87c6bf 2022-07-15 sha256:85b899a8ccbc3260b50239ca84a375087bbc57352c8b5dbd38efbb23118c2f5c ubi8 bc87c6bf 2022-07-15 sha256:1263b8496e10a4914efc1c09b8c9b10b8cb39eaced03e207891b58088914ee29 scratch 902fa7bb 2022-07-18 sha256:890cc5f3730e8a58db1a9e8984285fd100f534e549a735a3984024b9ec3e8473 alpine 902fa7bb 2022-07-18 sha256:890cc5f3730e8a58db1a9e8984285fd100f534e549a735a3984024b9ec3e8473 debian 902fa7bb 2022-07-18 sha256:4526282f445316fe1615aa98414d604828d9af9e3741bd85c9e00ddc3fe5f4cf ubi8 902fa7bb 2022-07-18 sha256:4b1935952706a5ccfbdd12378377f91d02b201d584f193ddbc89eb103fd9b8dd scratch 7e8b65d9 2022-07-19 sha256:846a9fafb7cf2e9b95ae2e8ff611b81aec79c0ff37860270ed63635ba637a995 alpine 7e8b65d9 2022-07-19 sha256:846a9fafb7cf2e9b95ae2e8ff611b81aec79c0ff37860270ed63635ba637a995 debian 7e8b65d9 2022-07-19 sha256:8a87129603cd5e6e1ff9d655e2cf33405354d7e1bb759a0440be21b07f2235ca ubi8 7e8b65d9 2022-07-19 sha256:fff30708f3809a04b3839a32a4cb4d267bace0cb30f6b0c77e38bb75640f3e8a scratch a8e7a611 2022-07-20 sha256:aa0db1182f560bb29d1afbaf8d0ca5e0779e8543d603110792bce24a19e706f6 alpine a8e7a611 2022-07-20 sha256:aa0db1182f560bb29d1afbaf8d0ca5e0779e8543d603110792bce24a19e706f6 debian a8e7a611 2022-07-20 sha256:0f2d0cf342f1df566800e286c4c926353a6b60b8355e0dcb460a839156c8e187 ubi8 a8e7a611 2022-07-20 sha256:6398049c8978b03454ff5d190cb358dd1f262871f879c368ec2271ba38c61246 scratch 278acb19 2022-07-21 sha256:027f5bbe9521c315060bc1a9198c911163cf155d68a31cfdca45e52e2a616979 alpine 278acb19 2022-07-21 sha256:027f5bbe9521c315060bc1a9198c911163cf155d68a31cfdca45e52e2a616979 debian 278acb19 2022-07-21 sha256:22c026a49665bf94751cc69a71d1d6e78af9cc3e6d1e301fe17b3b82e3b2d12a ubi8 278acb19 2022-07-21 sha256:a9d3bb91a83a79af4f33006f521f73163a64036d3ea681e1c3f07d319cefd194 scratch 76904519 2022-08-05 sha256:3b41f47a590804e1f032a91411bb4a3138758a08961efd3aaa8b4e679dcef542 alpine 76904519 2022-08-05 sha256:3b41f47a590804e1f032a91411bb4a3138758a08961efd3aaa8b4e679dcef542 debian 76904519 2022-08-05 sha256:09967016e92f40a2ac20d35d53f55c878f85c18c49dc6cad387a67ed27502052 ubi8 76904519 2022-08-05 sha256:3fe147287a25c2507e1c58d8e51c1265ac3aeef8025c270c865d68f4cc971669 scratch 1a025597 2022-08-18 sha256:358ccdf8824f43fc35d71d9099d343511503db62bc760544f3fe6207ce876659 alpine 1a025597 2022-08-18 sha256:358ccdf8824f43fc35d71d9099d343511503db62bc760544f3fe6207ce876659 debian 1a025597 2022-08-18 sha256:ca5808d9b34f8499d29af7edebe9c9414e1415469d258094ffb58c380df630ab ubi8 1a025597 2022-08-18 sha256:206fde3adfd77f0982d92b8dc8b39676662dc459174b8e358832c8fcc1f7d654 scratch f51edc3f 2022-08-19 sha256:d7ba0453bf9cc1433687e7a08175b5e9967706e1c35028e7301b7f4a51abf3f6 alpine f51edc3f 2022-08-19 sha256:d7ba0453bf9cc1433687e7a08175b5e9967706e1c35028e7301b7f4a51abf3f6 debian f51edc3f 2022-08-19 sha256:0fef92979e802509ce6243facab40b426111c7374ee116bae232e168d4b4b76d ubi8 f51edc3f 2022-08-19 sha256:e27da1987037eaf602bcc9c35f0f26edc30a6dfe2e385a50f9b76de818ac6e42 scratch e2ee4a94 2022-08-24 sha256:c0d391f6e9e70c09e12c707e9be44431679308e15580c232e75a41fcb3cef66f alpine e2ee4a94 2022-08-24 sha256:c0d391f6e9e70c09e12c707e9be44431679308e15580c232e75a41fcb3cef66f debian e2ee4a94 2022-08-24 sha256:d2f5a1896c4d841baa37aa63dd3b684fed2637fd54df0e51d648169725d16748 ubi8 e2ee4a94 2022-08-24 sha256:8e2baa1de149261c7ae3da3b41fe1c271c68f5042290b503dcd766dfd51f015e scratch 033fb200 2022-08-26 sha256:a6180578e6df0a7b763d4eecef9322e6aa419635a32a0970bb9426856e2ce934 alpine 033fb200 2022-08-26 sha256:a6180578e6df0a7b763d4eecef9322e6aa419635a32a0970bb9426856e2ce934 debian 033fb200 2022-08-26 sha256:6b3821454761979a153da7951306a7748363f885c54cad3439a64617ed68e1c2 ubi8 033fb200 2022-08-26 sha256:ae6b905fc6136e94bdf4ab1d495d90180622d08f3a1667a890ec34732e5558bf scratch 244066b0 2022-09-03 sha256:505ba6e5e7f6eda4cad079f91f2445b4ae88624c61193293dce32d6d1ca5d2f7 alpine 244066b0 2022-09-03 sha256:505ba6e5e7f6eda4cad079f91f2445b4ae88624c61193293dce32d6d1ca5d2f7 debian 244066b0 2022-09-03 sha256:7f8c170064f9be91b75b126f449f79db2928718e3909808942877f58399200f9 ubi8 244066b0 2022-09-03 sha256:e4b73cbe4e46e46937b1eb689d64da15018961292a5613e9a350a06653ef4c72 scratch d1aec86c 2022-09-17 sha256:0ce89ee82c784d12a58b379d4be1d216ea263eaab5ee2906120dea3b9cde7129 alpine d1aec86c 2022-09-17 sha256:0ce89ee82c784d12a58b379d4be1d216ea263eaab5ee2906120dea3b9cde7129 debian d1aec86c 2022-09-17 sha256:64561faf1ebdf87f7175d75d35b320a5b3eb510041d70b00e1a2f72909a44f16 ubi8 d1aec86c 2022-09-17 sha256:b0eac112efa4219cf98dcea66a0d2c4fc538c9434923c39833a1fa606e722814 scratch 400c4ffd 2022-09-21 sha256:412369b8c61d22ad367ddea0ca6632400527697f1c6aff0003a1c6a6399754d2 alpine 400c4ffd 2022-09-21 sha256:412369b8c61d22ad367ddea0ca6632400527697f1c6aff0003a1c6a6399754d2 debian 400c4ffd 2022-09-21 sha256:1a5ac46be1ea0454c92b4d17b9ecc9f8ab99fdf3b14a522b684ee1b8dbb6157d ubi8 400c4ffd 2022-09-21 sha256:e435b44429416dc6866990e3db26f55d527958e1a8cf5ac80db17861a0552e96 scratch 7a299c15 2022-09-30 sha256:edf0a7d3f81712dd225aa2b540f19520189ddc165cfd75e5099fb32d4d05f96d alpine 7a299c15 2022-09-30 sha256:edf0a7d3f81712dd225aa2b540f19520189ddc165cfd75e5099fb32d4d05f96d debian 7a299c15 2022-09-30 sha256:5b9569167e2805a9f41f1b58815b9dd447bc1f7d27e9f2c6868e9c0003074531 ubi8 7a299c15 2022-09-30 sha256:eaedda48a8d2e57b45afffef7e647a5d4885a03c5511ddca0cd21bebf9dead86 scratch 2da04299 2022-10-13 sha256:00342d2105e7c684c7b1f276d685b3540a93847dadaaa6962e3a10cf0af8a460 alpine 2da04299 2022-10-13 sha256:00342d2105e7c684c7b1f276d685b3540a93847dadaaa6962e3a10cf0af8a460 debian 2da04299 2022-10-13 sha256:0bb6449bdc86e12324335c8469be2a27db429ae37fd08360c17d7d1d8186cef3 ubi8 2da04299 2022-10-13 sha256:078b8b9449cc936684ac0a28bfc8d716ed088768294f251f9b41834819395dd0 scratch 2047baea 2022-10-14 sha256:9053e3a44906c3130e55bf4463d540951bd1fda73ac5ac8125a4ced94a04f94b alpine 2047baea 2022-10-14 sha256:9053e3a44906c3130e55bf4463d540951bd1fda73ac5ac8125a4ced94a04f94b debian 2047baea 2022-10-14 sha256:79c5678fb38c0d564433d1fa7d3dd5ba397bde877e0b9e50b936c97adc45df91 ubi8 2047baea 2022-10-14 sha256:ae517391798516522a13145227618b6453d53f856fcaae9608280c39d09756e7"},{"location":"img/logo/logo/","title":"Logo","text":"<p>Placeholder for all KICS logos</p>"},{"location":"queries/all-queries/","title":"All","text":""},{"location":"queries/all-queries/#queries_list","title":"Queries List","text":"<p>This page contains all queries.</p> Query Platform Severity Category Description Help Security Definitions Undefined or Emptye3f026e8-fdb4-4d5a-bcfd-bd94452073fe OpenAPI High Access Control Security Definitions Object should be set and not empty Documentation Non OAuth2 Security Requirement Defining OAuth2 Scopesba239cb9-f342-4c20-812d-7b5a2aa6969e OpenAPI High Structure and Semantics If the security scheme is not of type 'oauth2', the array value must be empty Documentation Security Requirement Not Defined In Security Definitiona599b0d1-ff89-4cb8-9ece-9951854c06f6 OpenAPI High Structure and Semantics All security requirement objects must be defined in 'securityDefinitions' Documentation Implicit Flow in OAuth2 (v2)e9817ad8-a8c9-4038-8a2f-db0e6e7b284b OpenAPI Medium Access Control There is a 'securityDefinition' using implicit flow on OAuth2, which is deprecated Documentation Global Security Using Password Flow2da46be4-4317-4650-9285-56d7103c4f93 OpenAPI Medium Access Control Security should not use 'password' Flow in OAuth2 authentication Documentation Security Definitions Allows Password Flow773116aa-2e6d-416f-bd85-f0301cc05d76 OpenAPI Medium Access Control Security Definition Object should not allow 'password' Flow in OAuth2 authentication Documentation Operation Using Password Flow2e44e632-d617-43cb-b294-6bfe72a08938 OpenAPI Medium Access Control Operation Object should not use 'password' Flow in OAuth2 authentication Documentation Invalid OAuth2 Authorization URL (v2)33d96c65-977d-4c33-943f-440baca49185 OpenAPI Medium Access Control The field authorizationUrl on implicit or authorizationCode fields from OAuth must be a valid URL Documentation Invalid OAuth2 Token URL (v2)274f910a-0665-4f08-b66d-7058fe927dba OpenAPI Medium Access Control OAuth2 security definition flow requires a valid URL in the tokenUrl field Documentation Schemes Uses HTTPa46928f1-43d7-4671-94e0-2dd99746f389 OpenAPI Medium Encryption Schemes should use 'https' protocol instead of 'http'. Scheme using 'http' allows for clear text credentials Documentation Global Schemes Uses HTTPf30ee711-0082-4480-85ab-31d922d9a2b2 OpenAPI Medium Encryption Global Schemes should use 'https' protocol instead of 'http' Documentation Path Scheme Accepts HTTP (v2)a6847dc6-f4ea-45ac-a81f-93291ae6c573 OpenAPI Medium Encryption The Scheme list of Operation Object should only allow 'HTTPS' protocol to ensure an encrypted connection Documentation Operation Object Without 'consumes'0c79e50e-b3cf-490c-b8f6-587c644d4d0c OpenAPI Medium Insecure Configurations Operation Object should have 'consumes' feild defined for 'POST', 'PUT' and 'PATCH' operations Documentation Operation Object Without 'produces'be3e170e-1572-461e-a8b6-d963def581ec OpenAPI Medium Insecure Configurations Operation Object should have 'produces' feild defined for 'GET'operation Documentation Operation Using Basic Authceefb058-8065-418f-9c4c-584a78c7e104 OpenAPI Low Access Control Operation Object should not use basic authentication Documentation Operation Using Implicit Flowf42dfe7e-787d-4478-a75e-a5f3d8a2269e OpenAPI Low Access Control Operation Object should not use implicit flow Documentation Undefined Scope 'securityDefinition' On Global 'security' Field9aa6e95c-d964-4239-a3a8-9f37a3c5a31f OpenAPI Low Access Control Using an scope on global security field that is undefined on 'securityDefinitions' can be defined by an attacker Documentation Security Definitions Using Basic Auth221015a8-aa2a-43f5-b00b-ad7d2b1d47a8 OpenAPI Low Access Control Security Definition Object should not use basic authentication Documentation Undefined Scope 'securityDefinition' On 'security' Field On Operations3847280c-9193-40bc-8009-76168e822ce2 OpenAPI Low Access Control Using an scope on security of operations that is undefined on 'securityDefinitions' can be defined by an attacker Documentation Operation Summary Too Longd47940ca-5970-45cc-bdd1-4d81398cee1f OpenAPI Low Best Practices Operation summary should be short (less than 120 characters) Documentation Global Schema Definition Not Being Used6d2e0790-cc3d-4c74-b973-d4e8b09f4455 OpenAPI Info Best Practices All global schemas definitions should be in use Documentation Global Parameter Definition Not Being Usedb30981fa-a12e-49c7-a5bb-eeafb61d0f0f OpenAPI Info Best Practices All global parameters definitions  should be in use Documentation Schema with 'additionalProperties' set as Boolean3a01790c-ebee-4da6-8fd3-e78657383b75 OpenAPI Info Best Practices The value of 'additionalProperties' should be set as object instead of boolean, since swagger 2.0 does not support boolean value for it Documentation Unknown Prefix (v2)3b615f00-c443-4ba9-acc4-7c308716917d OpenAPI Info Best Practices The media type prefix should be set as 'application', 'audio', 'font', 'example', 'image', 'message', 'model', 'multipart', 'text' or 'video' Documentation Global Responses Definition Not Being Used0b76d993-ee52-43e0-8b39-3787d2ddabf1 OpenAPI Info Best Practices All global responses definitions should be in use Documentation Invalid Media Type Value (v2)f985a7d2-d404-4a7f-9814-f645f791e46e OpenAPI Info Best Practices The Media Type value should match the following format: /[+suffix][;parameters] Documentation Constraining Enum Propertybe1d8733-3731-40c7-a845-734741c6871d OpenAPI Info Best Practices There is a constraining keyword in a property which is already restricted by enum values Documentation Body Parameter With Wrong Propertyc38d630d-a415-4e3e-bac2-65475979ba88 OpenAPI Info Structure and Semantics The Body Parameter Object should only have the following properties defined - 'name', 'in', 'description', 'required', and 'schema' Documentation BasePath With Wrong Formatb4803607-ed72-4d60-99e2-3fa6edf471c6 OpenAPI Info Structure and Semantics The 'basePath' value format must match the pattern '^/' Documentation Parameter JSON Reference Does Not Exists (v2)fb889ae9-2d16-40b5-b41f-9da716c5abc1 OpenAPI Info Structure and Semantics Parameter reference should exist on parameters definition field Documentation Parameter Object With Incorrect Ref (v2)2596545e-1757-4ff7-a15a-8a9a180a42f3 OpenAPI Info Structure and Semantics Parameter Object reference must always point to '#/parameters' Documentation Object Without Required Property (v2)5e5ecb9d-04b5-4e4f-b5a5-6ee04279b275 OpenAPI Info Structure and Semantics OpenAPI Object should contain all of its required fields Documentation Schema JSON Reference Does Not Exists (v2)98295b32-ec09-4b5b-89a9-39853197f914 OpenAPI Info Structure and Semantics Schema reference should exists on definitions field Documentation Responses JSON Reference Does Not Exists (v2)e9db5fb4-6a84-4abb-b4af-3b94fbdace6d OpenAPI Info Structure and Semantics Responses reference should exist on responses definition field Documentation Schema Object Incorrect Ref (v2)0220e1c5-65d1-49dd-b7c2-cef6d6cb5283 OpenAPI Info Structure and Semantics Schema Object reference must always point to '#/definitions' Documentation Property Not Unique750b40be-4bac-4f59-bdc4-1ca0e6c3450e OpenAPI Info Structure and Semantics Every defined property must be unique throughout the whole API Documentation Operation Example Mismatch Produces MimeType2cf35b40-ded3-43d6-9633-c8dcc8bcc822 OpenAPI Info Structure and Semantics Example should match one of MimeTypes on 'produces'. It is important to know that, if a 'produces' is declared on operation it will override global 'produces' Documentation Multi 'collectionformat' Not Valid For 'in' Parameter750f6448-27c0-49f8-a153-b81735c1e19c OpenAPI Info Structure and Semantics When 'collectionformat' is defined as 'multi', 'in' field must be 'query' or 'formData' Documentation Parameter File Type Not In 'formData'c3cab8c4-6c52-47a9-942b-c27f26fbd7d2 OpenAPI Info Structure and Semantics The In field of Parameter Object must be 'formData' when type is 'file' Documentation Host With Invalid Pattern3d7d7b6c-fb0a-475e-8a28-c125e30d15f0 OpenAPI Info Structure and Semantics Host field should be an IP or a valid host name Documentation Response Object With Incorrect Ref (v2)bccfa089-89e4-47e0-a0e5-185fe6902220 OpenAPI Info Structure and Semantics Response Object reference must always point to '#/responses' Documentation Multiple Body Parameters In The Same Operationb90033cf-ad9f-4fb9-acd1-1b9d6d278c87 OpenAPI Info Structure and Semantics Only one body parameter is allowed on operation's parameters type field Documentation Operation Object Parameters With 'body' And 'formatData' locationseb3f9744-d24e-4614-b1ff-2a9514eca21c OpenAPI Info Structure and Semantics Operation object parameters should not have both 'body' and 'formatData' locations Documentation Unknown Property (v2)429b2106-ba37-43ba-9727-7f699cc611e1 OpenAPI Info Structure and Semantics All properties defined in OpenAPI objects should be known Documentation File Parameter With Wrong Consumes Property7f91992f-b4c8-43bf-9bf9-fae9ecdb6e3a OpenAPI Info Structure and Semantics Operations file parameters consumes must be 'multipart/form-data', 'application/x-www-form-urlencoded' or both Documentation Non Body Parameter Without Schema73c3bc54-3cc6-4c0a-b30a-e19f2abfc951 OpenAPI Info Structure and Semantics The Body Parameter Object should have the attribute 'schema' defined Documentation Body Parameter Without Schemaed48229d-d43e-4da7-b453-5f98d964a57a OpenAPI Info Structure and Semantics The Body Parameter Object should have the attribute 'schema' defined Documentation Global Security Field Has An Empty Array (v2)da31d54b-ad54-41dc-95eb-8b3828629213 OpenAPI High Access Control Security object need to have defined rules in its array and rules should be defined on securityScheme Documentation Global Security Field Has An Empty Array (v3)d674aea4-ba8b-454b-bb97-88a772ea33f0 OpenAPI High Access Control Security object need to have defined rules in its array and rules should be defined on securityScheme Documentation No Global And Operation Security Defined (v2)586abcee-9653-462d-ad7b-2638a32bd6e6 OpenAPI High Access Control All paths should have security scheme, if it is omitted, global security field should be defined Documentation No Global And Operation Security Defined (v3)96729c6b-7400-4d9e-9807-17f00cdde4d2 OpenAPI High Access Control All paths should have security scheme, if it is omitted, global security field should be defined Documentation Security Field On Operations Has An Empty Array (v2)5d29effc-5d68-481f-9721-d74e5919226b OpenAPI High Access Control Security object for operations, if defined, must define a security scheme, otherwise it should be considered an error Documentation Security Field On Operations Has An Empty Array (v3)663c442d-f918-4f62-b096-0bf5dcbeb655 OpenAPI High Access Control Security object for operations, if defined, must define a security scheme, otherwise it should be considered an error Documentation Cleartext API Key In Operation Security (v2)99733b39-6413-4ed8-8acf-dc7cdc9b4e51 OpenAPI High Access Control API Keys should not be sent as cleartext over an unencrypted channel Documentation Cleartext API Key In Operation Security (v3)d90d4e40-44c1-4125-87a0-e072c3e195b5 OpenAPI High Access Control API Keys should not be sent as cleartext over an unencrypted channel Documentation Global security field has an empty object (v2)292919fb-7b26-4454-bee9-ce29094768dd OpenAPI High Access Control Global security definition must not have empty objects Documentation Global security field has an empty object (v3)543e38f4-1eee-479e-8eb0-15257013aa0a OpenAPI High Access Control Global security definition must not have empty objects Documentation Global Security Field Is Undefined (v2)74703c89-0ea2-49ab-a7db-bf04f19f5a57 OpenAPI High Access Control Global security field should be defined to prevent API to have insecure paths and have this rules defined on securityDefinitions Documentation Global Security Field Is Undefined (v3)8af270ce-298b-4405-9922-82a10aee7a4f OpenAPI High Access Control Global security field should be defined to prevent API to have insecure paths and have this rules defined on securitySchemes Documentation Security Field On Operations Has An Empty Object Definition (v2)74581e3b-1d55-4323-a139-5959a7b3abc5 OpenAPI High Access Control Security object for operations should not be empty object or has any empty object definition Documentation Security Field On Operations Has An Empty Object Definition (v3)baade968-7467-41e4-bf22-83ca222f5800 OpenAPI High Access Control Security object for operations should not be empty object or has any empty object definition Documentation Array Without Maximum Number of Items (v2)99eb2c95-2040-4104-9e7c-e16f7474d218 OpenAPI High Insecure Configurations Array schema/parameter should have the field 'maxItems' set Documentation Array Without Maximum Number of Items (v3)6998389e-66b2-473d-8d05-c8d71ac4d04d OpenAPI High Insecure Configurations Array schema should have the field 'maxItems' set Documentation Array Items Has No Type (v2)8697a1a4-82c6-4603-8ac8-57529756744e OpenAPI High Insecure Configurations Schema/Parameter array items type should be defined Documentation Array Items Has No Type (v3)be0e0df7-f3d9-42a1-9b6f-d425f94872c4 OpenAPI High Insecure Configurations Schema array items type should be defined Documentation API Key Exposed In Global Security (v2)533a0d13-6e89-4551-ae33-bce14e5849c1 OpenAPI Medium Access Control API Keys should not be transported over network Documentation API Key Exposed In Global Security (v3)aecee30b-8ea1-4776-a99c-d6d600f0862f OpenAPI Medium Access Control API Keys should not be transported over network Documentation Cleartext API Key In Global Security (v2)70d3873e-d537-46e5-ac3b-4e48fbdd29b4 OpenAPI Medium Access Control API Keys should not be sent as cleartext over an unencrypted channel Documentation Cleartext API Key In Global Security (v3)9c238c97-1991-4c0b-9c7d-6c7912e1dc7c OpenAPI Medium Access Control API Keys should not be sent as cleartext over an unencrypted channel Documentation JSON Object Schema Without Properties (v2)3d28f751-bc18-4f83-ace0-216b6086410b OpenAPI Medium Insecure Configurations Schema of the JSON object should have properties defined and 'additionalProperties' set to false. Documentation JSON Object Schema Without Properties (v3)9d967a2b-9d64-41a6-abea-dfc4960299bd OpenAPI Medium Insecure Configurations Schema of the JSON object should have properties defined and 'additionalProperties' set to false. Documentation String Schema with Broad Pattern (v2)e4a019f0-9af3-49c8-bf68-1939a6ff240d OpenAPI Medium Insecure Configurations String schema should restrict the pattern Documentation String Schema with Broad Pattern (v3)8c81d6c0-716b-49ec-afa5-2d62da4e3f3c OpenAPI Medium Insecure Configurations String schema should restrict the pattern Documentation JSON Object Schema Without Type (v2)62d52544-82ef-4b75-8308-cad49d50212b OpenAPI Medium Insecure Configurations Schema of the JSON object should have 'type' defined. Documentation JSON Object Schema Without Type (v3)e2ffa504-d22a-4c94-b6c5-f661849d2db7 OpenAPI Medium Insecure Configurations Schema of the JSON object should have 'type' defined. Documentation Numeric Schema Without Maximum (v2)203eee11-15b6-4d47-b888-4c7f534967ee OpenAPI Medium Insecure Configurations Numeric schema (type set to 'integer' or 'number') should have 'maximum' defined. Documentation Numeric Schema Without Maximum (v3)2ea04bef-c769-409e-9179-ee3a50b5c0ac OpenAPI Medium Insecure Configurations Numeric schema (type set to 'integer' or 'number') should have 'maximum' defined. Documentation Schema Object is Empty (v2)967575e5-eb44-4c24-aadb-7e33608ed30a OpenAPI Medium Insecure Configurations The Schema Object should not be empty to avoid accepting any JSON values Documentation Schema Object is Empty (v3)500ce696-d501-41dd-86eb-eceb011a386f OpenAPI Medium Insecure Configurations The Schema Object should not be empty to avoid accepting any JSON values Documentation Numeric Schema Without Minimum (v2)efd1dfc8-da91-4909-a3f3-c23abc5ec799 OpenAPI Medium Insecure Configurations Numeric schema (type set to 'integer' or 'number') should have 'minimum' defined. Documentation Numeric Schema Without Minimum (v3)181bd815-767e-4e95-a24d-bb3c87328e19 OpenAPI Medium Insecure Configurations Numeric schema (type set to 'integer' or 'number') should have 'minimum' defined. Documentation Maximum Length Undefined (v2)2ec86e48-ab90-4cb6-a131-0502afd1f442 OpenAPI Medium Insecure Configurations String schema/parameter/header should have 'maxLength' defined. Documentation Maximum Length Undefined (v3)8c8261c2-19a9-4ef7-ad37-b8bc7bdd4d85 OpenAPI Medium Insecure Configurations String schema should have 'maxLength' defined. Documentation Pattern Undefined (v2)afde15cf-9444-4126-8c62-41cd79db1d1d OpenAPI Medium Insecure Configurations String schema/parameter/header should have 'pattern' defined. Documentation Pattern Undefined (v3)00b78adf-b83f-419c-8ed8-c6018441dd3a OpenAPI Medium Insecure Configurations String schema should have 'pattern' defined. Documentation Numeric Schema Without Format (v2)3ed8fc82-c2bb-49e0-811f-c53923674c49 OpenAPI Medium Insecure Configurations Numeric schema (type set to 'integer' or 'number') should have 'format' defined. Documentation Numeric Schema Without Format (v3)fbf699b5-ef74-4542-9cf1-f6eeac379373 OpenAPI Medium Insecure Configurations Numeric schema (type set to 'integer' or 'number') should have 'format' defined. Documentation Success Response Code Undefined for Put Operation (v2)965a043f-5f3c-4d0a-be72-d9ce12fdb4d6 OpenAPI Medium Networking and Firewall Put should define at least one success response (200, 201, 202 or 204) Documentation Success Response Code Undefined for Put Operation (v3)60b5f56b-66ff-4e1c-9b62-5753e16825bc OpenAPI Medium Networking and Firewall Put should define at least one success response (200, 201, 202 or 204) Documentation Response on operations that should have a body has undefined schema (v2)31afbcb7-70e0-48bb-a31a-3374f95cf859 OpenAPI Medium Networking and Firewall If a response is not head or its code is not 204 or 304, it should have a schema defined Documentation Response on operations that should have a body has undefined schema (v3)a92be1d5-d762-484a-86d6-8cd0907ba100 OpenAPI Medium Networking and Firewall If a response is not head or its code is not 204 or 304, it should have a schema defined Documentation Success Response Code Undefined for Delete Operation (v2)ad432855-b7fb-4429-92a3-93b5ce34f0b1 OpenAPI Medium Networking and Firewall Delete should define at least one success response (200, 201, 202 or 204) Documentation Success Response Code Undefined for Delete Operation (v3)3b497874-ae59-46dd-8d72-1868a3b8f150 OpenAPI Medium Networking and Firewall Delete should define at least one success response (200, 201, 202 or 204) Documentation Success Response Code Undefined for Patch Operation (v2)f36e87cc-a209-4f37-8571-66833e4aead7 OpenAPI Medium Networking and Firewall Patch should define at least one success response (200, 201, 202 or 204) Documentation Success Response Code Undefined for Patch Operation (v3)1908a8ee-927d-4166-8f18-241152170cc1 OpenAPI Medium Networking and Firewall Patch should define at least one success response (200, 201, 202 or 204) Documentation Default Response Undefined On Operations (v2)5f34c7ae-4f3f-4cbb-8fe3-a11d6961062f OpenAPI Medium Networking and Firewall Operations responses should have a default response defined Documentation Default Response Undefined On Operations (v3)86e3702f-c868-44b2-b61d-ea5316c18110 OpenAPI Medium Networking and Firewall Operations responses should have a default response defined Documentation Success Response Code Undefined for Post Operation (v2)9fedee41-2e6d-4091-b011-4a16b4c18c70 OpenAPI Medium Networking and Firewall Post should define at least one success response (200, 201, 202 or 204) Documentation Success Response Code Undefined for Post Operation (v3)f368dd2d-9344-4146-a05b-7c6faa1269ad OpenAPI Medium Networking and Firewall Post should define at least one success response (200, 201, 202 or 204) Documentation Response Code Missing (v2)6e96ed39-bf45-4089-99ba-f1fe7cf6966f OpenAPI Medium Networking and Firewall 500, 429 and 400 responses should be defined for all operations, except head operation. 415 response should be defined for the post, put, and patch operations. 404 response should be defined for the get, put, head, delete operations. 200 response should be defined for options operation. 401 and 403 response should be defined for all operations when the security field is defined. Documentation Response Code Missing (v3)6c35d2c6-09f2-4e5c-a094-e0e91327071d OpenAPI Medium Networking and Firewall 500, 429 and 400 responses should be defined for all operations, except head operation. 415 response should be defined for the post, put, and patch operations. 404 response should be defined for the get, put, head, delete operations. 200 response should be defined for options operation. 401 and 403 response should be defined for all operations when the security field is defined. Documentation Success Response Code Undefined for Get Operation (v2)9b633f3b-c94b-4fbb-a65b-1a4e9134fb63 OpenAPI Medium Networking and Firewall Get should define at least one success response (200 or 202) Documentation Success Response Code Undefined for Get Operation (v3)b2f275be-7d64-4064-b418-be6b431363a7 OpenAPI Medium Networking and Firewall Get should define at least one success response (200 or 202) Documentation Success Response Code Undefined for Head Operation (v2)4f0b30e3-a498-4dd7-b3f2-f4b6471a8d5a OpenAPI Medium Networking and Firewall Head should define at least one success response (200 or 202) Documentation Success Response Code Undefined for Head Operation (v3)3b066059-f411-4554-ac8d-96f32bff90da OpenAPI Medium Networking and Firewall Head should define at least one success response (200 or 202) Documentation Response on operations that should not have a body has declared content (v2)268defd2-2839-4e15-8cbc-de86eb38c231 OpenAPI Medium Networking and Firewall If a response is head or its code is 204 or 304, it shouldn't have a schema defined Documentation Response on operations that should not have a body has declared content (v3)12a7210b-f4b4-47d0-acac-0a819e2a0ca3 OpenAPI Medium Networking and Firewall If a response is head or its code is 204 or 304, it shouldn't have a content defined Documentation API Key Exposed In Operation Security (v2)392599e4-a4e2-403d-bc56-3fe05755782d OpenAPI Low Access Control API Keys should not be transported over network Documentation API Key Exposed In Operation Security (v3)281b8071-6226-4a43-911d-fec246d422c2 OpenAPI Low Access Control API Keys should not be transported over network Documentation Invalid Format (v2)caf1793e-95dd-4b18-8d90-8f3c0ab5bddf OpenAPI Low Insecure Configurations The format should be valid for the type defined. For integer type must be int32 or int64 and number type must be float or double Documentation Invalid Format (v3)d929c031-078f-4241-b802-e224656ad890 OpenAPI Low Insecure Configurations The format should be valid for the type defined. For integer type must be int32 or int64 and number type must be float or double Documentation Path Without Operation (v2)609cd557-66b4-41fa-8edd-2abc6c7cfd08 OpenAPI Info Best Practices Path object should have at least one operation object defined Documentation Path Without Operation (v3)84c826c9-1893-4b34-8cdd-db97645b4bf3 OpenAPI Info Best Practices Path object should have at least one operation object defined Documentation Invalid License URL (v2)de2b4910-8484-46d6-a055-dc1e793ee3ff OpenAPI Info Best Practices License Object URL should be a valid URL Documentation Invalid License URL (v3)9239c289-9e4c-4d92-8be1-9d506057c971 OpenAPI Info Best Practices License Object URL should be a valid URL Documentation Header Parameter Named as 'Content-Type' (v2)51978067-3b22-4c29-aaf3-96bf0bc28897 OpenAPI Info Best Practices The header Parameter should not be named as 'Content-Type'. If so, it will be ignored. Documentation Header Parameter Named as 'Content-Type' (v3)72d259ca-9741-48dd-9f62-eb11f2936b37 OpenAPI Info Best Practices The header Parameter should not be named as 'Content-Type'. If so, it will be ignored. Documentation Invalid Schema External Documentation URL (v2)f7fa95b7-d819-484c-9a2b-665dd1bba25e OpenAPI Info Best Practices Schema External Documentation URL should be a valid URL Documentation Invalid Schema External Documentation URL (v3)6952a7e0-6e48-4285-bbc1-27c64e60f888 OpenAPI Info Best Practices Schema External Documentation URL should be a valid URL Documentation Required Property With Default Value (v2)f7ab6c83-ef89-40e1-8a99-32e2599fb665 OpenAPI Info Best Practices Required properties receive value from requests, which makes unnecessary declare a default value Documentation Required Property With Default Value (v3)013bdb4b-9246-4248-b0c3-7fb0fee42a29 OpenAPI Info Best Practices Required properties receive value from requests, which makes unnecessary declare a default value Documentation Header Parameter Named as 'Authorization' (v2)e2e00c97-7171-4fb4-b461-d631df9a711c OpenAPI Info Best Practices The header Parameter should not be named as 'Authorization'. If so, it will be ignored. Documentation Header Parameter Named as 'Authorization' (v3)8c84f75e-5048-4926-a4cb-33e7b3431300 OpenAPI Info Best Practices The header Parameter should not be named as 'Authorization'. If so, it will be ignored. Documentation Invalid Contact Email (v2)d83bebc8-4e5e-4241-b783-cba9fb5a1c9a OpenAPI Info Best Practices Contact Object Email should be a valid email Documentation Invalid Contact Email (v3)b1a7fcb0-2afe-4d5c-a6a1-4e6311fc29e7 OpenAPI Info Best Practices Contact Object Email should be a valid email Documentation Invalid Operation External Documentation URL (v2)25635c31-ee32-4708-88e5-fced87516f51 OpenAPI Info Best Practices Operation External Documentation URL should be a valid URL Documentation Invalid Operation External Documentation URL (v3)5ea61624-3733-4a3a-8ca4-b96fec9c5aeb OpenAPI Info Best Practices Operation External Documentation URL should be a valid URL Documentation Object Using Enum With Keyword (v2)7f15962a-d862-451c-ac9b-84ec13747aa6 OpenAPI Info Best Practices Schema/Parameter/Header Object properties should not contain 'enum' and schema keywords Documentation Object Using Enum With Keyword (v3)2e9b6612-8f69-42e0-a5b8-ed17739c2f3a OpenAPI Info Best Practices Schema Object properties should not contain 'enum' and schema keywords Documentation JSON '$ref' alongside other properties (v2)f34c1c68-4773-4df0-a103-6e2ca32e585f OpenAPI Info Best Practices Each field on Open API specification which accepts '$ref', infers that field is using a reference object, which has only '$ref' key Documentation JSON '$ref' alongside other properties (v3)96beb800-566f-49a9-a0ea-dbdf4bc80429 OpenAPI Info Best Practices Each field on Open API specification which accepts '$ref', infers that field is using a reference object, which has only '$ref' key Documentation Invalid Global External Documentation URL (v2)46d3b74d-9fe9-45bf-9e9e-efb7f701ee28 OpenAPI Info Best Practices Global External Documentation URL should be a valid URL Documentation Invalid Global External Documentation URL (v3)b2d9dbf6-539c-4374-a1fd-210ddf5563a8 OpenAPI Info Best Practices Global External Documentation URL should be a valid URL Documentation Header Response Name Is Invalid (v2)86733e01-a435-4bd5-a8b0-5108be9dc1e4 OpenAPI Info Best Practices The Header Response should not be named as 'Content-Type', 'Authorization' or 'Accept'. If so, it will be ignored. Documentation Header Response Name Is Invalid (v3)d4e43db5-54d8-4dda-b3c2-0dc6f31a46bd OpenAPI Info Best Practices The Header Response should not be named as 'Content-Type', 'Authorization' or 'Accept'. If so, it will be ignored. Documentation Example Not Compliant With Schema Type (v2)448db771-06ea-4dee-b48c-1689cbfb4b43 OpenAPI Info Best Practices Examples values and fields should be compliant with the schema type Documentation Example Not Compliant With Schema Type (v3)881a6e71-c2a7-4fe2-b9c3-dfcf08895331 OpenAPI Info Best Practices Examples values and fields should be compliant with the schema type Documentation Header Parameter Named as 'Accept' (v2)3ddd74cc-6582-486c-8b0c-2b48cb38e0a3 OpenAPI Info Best Practices The header Parameter should not be named as 'Accept'. If so, it will be ignored. Documentation Header Parameter Named as 'Accept' (v3)f2702af5-6016-46cb-bbc8-84c766032095 OpenAPI Info Best Practices The header Parameter should not be named as 'Accept'. If so, it will be ignored. Documentation Invalid Contact URL (v2)c7000383-16d0-4509-8cd3-585e5ea2e2f2 OpenAPI Info Best Practices Contact Object URL should be a valid URL Documentation Invalid Contact URL (v3)332cf2ad-380d-4b90-b436-46f8e635cf38 OpenAPI Info Best Practices Contact Object URL should be a valid URL Documentation Operation Without Successful HTTP Status Code (v2)a1ee6ebe-3877-42ec-b9a6-e524e7d06aa2 OpenAPI Info Best Practices Operation Object should have at least one successful HTTP status code defined Documentation Operation Without Successful HTTP Status Code (v3)48e9e1fe-cf79-45b5-93e6-8b55ae5dadfd OpenAPI Info Best Practices Operation Object should have at least one successful HTTP status code defined Documentation Invalid Tag External Documentation URL (v2)b4a7d925-738b-4219-99d9-87d6ee262a03 OpenAPI Info Best Practices Tag External Documentation URL should be a valid URL Documentation Invalid Tag External Documentation URL (v3)5aea1d7e-b834-4749-b143-2c7ec3bd5922 OpenAPI Info Best Practices Tag External Documentation URL should be a valid URL Documentation Template Path With No Corresponding Path Parameter (v2)e7656d8d-7288-4bbe-b07b-22b389be75ce OpenAPI Info Structure and Semantics The template path must have a corresponding path parameter for a given operation Documentation Template Path With No Corresponding Path Parameter (v3)561710b1-b845-4562-95ce-2397a05ccef4 OpenAPI Info Structure and Semantics The template path must have a corresponding path parameter for a given operation Documentation Default Invalid (v2)78dfd8f0-a6ee-48ec-af8c-e4d9b3292a07 OpenAPI Info Structure and Semantics The field 'default' of Schema/Parameter/Header Object should be consistent with the schema's/parameter's/header's type Documentation Default Invalid (v3)a96bbc06-8cde-4295-ad3c-ee343a7f658e OpenAPI Info Structure and Semantics The field 'default' of Schema Object should be consistent with the schema's type Documentation Schema Enum Invalid (v2)8fe6d18a-ad4c-4397-8884-e3a9da57f4c9 OpenAPI Info Structure and Semantics The field 'enum' of Schema Object should be consistent with the schema's type Documentation Schema Enum Invalid (v3)03856cb2-e46c-4daf-bfbf-214ec93c882b OpenAPI Info Structure and Semantics The field 'enum' of Schema Object should be consistent with the schema's type Documentation Responses With Wrong HTTP Status Code (v2)069a5378-2091-43f0-aa3b-ee8f20996e99 OpenAPI Info Structure and Semantics HTTP Responses status code should be in range of [200-599] Documentation Responses With Wrong HTTP Status Code (v3)d86655c0-92f6-4ffc-b4d5-5b5775804c27 OpenAPI Info Structure and Semantics HTTP Responses status code should be in range of [200-599] Documentation Schema Has A Required Property Undefined (v2)811762c8-2e99-4f70-88f9-a63875a953b1 OpenAPI Info Structure and Semantics Schema Object should not be have a required property that is not defined on properties Documentation Schema Has A Required Property Undefined (v3)2bd608ae-8a1f-457f-b710-c237883cb313 OpenAPI Info Structure and Semantics Schema Object should not be have a required property that is not defined on properties Documentation Parameters Name In Combination Not Unique (v2)ab871897-ec02-4835-9818-702536ee1dda OpenAPI Info Structure and Semantics Parameters properties 'name' and 'in' should have unique combinations Documentation Parameters Name In Combination Not Unique (v3)f5b2e6af-76f5-496d-8482-8f898c5fdb4a OpenAPI Info Structure and Semantics Parameters properties 'name' and 'in' should have unique combinations Documentation Items Undefined (v2)3e4d34d2-36cf-4449-976d-6c256db8fc49 OpenAPI Info Structure and Semantics Schema/Parameter items should be defined when the schema/parameter is set to an array. Documentation Items Undefined (v3)a8e859da-4a43-4e7f-94b8-25d6e3bf8e90 OpenAPI Info Structure and Semantics Schema/Parameter items should be defined when the schema/parameter is set to an array. Documentation Path Parameter With No Corresponding Template Path (v2)194ef1f8-360e-4c14-8ed2-e83e2bafa142 OpenAPI Info Structure and Semantics The path parameter must have a corresponding template path for a given operation Documentation Path Parameter With No Corresponding Template Path (v3)69d7aefd-149d-47b8-8d89-1c2181a8067b OpenAPI Info Structure and Semantics The path parameter must have a corresponding template path for a given operation Documentation OperationId Not Unique (v2)21245007-91c4-40e5-964e-40c85d1e5aa6 OpenAPI Info Structure and Semantics OperationId should be unique when defined Documentation OperationId Not Unique (v3)c254adc4-ef25-46e1-8270-b7944adb4198 OpenAPI Info Structure and Semantics OperationId should be unique when defined Documentation Schema Object With Circular Ref (v2)cbff2508-85c9-4448-a8b3-770070edf5ca OpenAPI Info Structure and Semantics Schema Object should not reference it self in 'allOf', 'oneOf', 'anyOf' and 'not' properties Documentation Schema Object With Circular Ref (v3)1a1aea94-745b-40a7-b860-0702ea6ee636 OpenAPI Info Structure and Semantics Schema Object should not reference it self in 'allOf', 'oneOf', 'anyOf' and 'not' properties Documentation Schema Discriminator Not Required (v2)be6a3722-af60-438c-b1b9-2a03e2958ab7 OpenAPI Info Structure and Semantics The discriminator property in the Schema Object should be a required property Documentation Schema Discriminator Not Required (v3)b481d46c-9c61-480f-86d9-af07146dc4a4 OpenAPI Info Structure and Semantics The discriminator property in the Schema Object should be a required property Documentation Path Is Ambiguous (v2)b2468463-3ac4-4930-890c-f35b2bf4485d OpenAPI Info Structure and Semantics All path should be unique, if has more than one operation, all operations should be part of same Path Object Documentation Path Is Ambiguous (v3)237402e2-c2f0-46c9-9cf5-286160cf7bfc OpenAPI Info Structure and Semantics All path should be unique, if has more than one operation, all operations should be part of same Path Object Documentation Path Parameter Not Required (v2)ccd0613f-cb77-4684-a892-183bd2674d12 OpenAPI Info Structure and Semantics The property 'required' determines whether the parameter is mandatory. If the parameter location is 'path', this property is required and its value must be true. Documentation Path Parameter Not Required (v3)0de50145-e845-47f4-9a15-23bcf2125710 OpenAPI Info Structure and Semantics The property 'required' determines whether the parameter is mandatory. If the parameter location is 'path', this property is required and its value must be true. Documentation Property 'allowEmptyValue' Improperly Defined (v2)0bc1477d-0922-478b-ae16-674a7634a1a8 OpenAPI Info Structure and Semantics Property 'allowEmptyValue' should be only defined for query parameters and formData parameters Documentation Property 'allowEmptyValue' Improperly Defined (v3)4bcbcd52-3028-469f-bc14-02c7dbba2df2 OpenAPI Info Structure and Semantics Property 'allowEmptyValue' should be only defined for query parameters and formData parameters Documentation Responses Object Is Empty (v2)6172e7ab-d2b7-45f8-a7db-1603931d8ba3 OpenAPI Info Structure and Semantics Responses Object should not be empty Documentation Responses Object Is Empty (v3)990eaf09-d6f1-4c3c-b174-a517b1de8917 OpenAPI Info Structure and Semantics Responses Object should not be empty Documentation Schema Object Properties With Duplicated Keys (v2)ded017bf-fb13-4f8d-868b-84aebcc572ad OpenAPI Info Structure and Semantics Schema Object Property key should be unique through out the fields 'properties', 'allOf', 'additionalProperties' Documentation Schema Object Properties With Duplicated Keys (v3)10c61e4b-eed5-49cf-9c7d-d4bf02e9edfa OpenAPI Info Structure and Semantics Schema Object Property key should be unique through out the fields 'properties', 'allOf', 'additionalProperties' Documentation Path Template is Empty (v2)c201b7ad-6173-4598-a407-5edb04a1bcd7 OpenAPI Info Structure and Semantics All path templates should not be empty Documentation Path Template is Empty (v3)ae13a37d-943b-47a7-a970-83c8598bcca3 OpenAPI Info Structure and Semantics All path templates should not be empty Documentation Schema Discriminator Property Not String (v2)949376f1-f560-4c6d-a016-63424ca931bb OpenAPI Info Structure and Semantics Schema discriminator property should be a string Documentation Schema Discriminator Property Not String (v3)dadc2f36-1f5a-46c0-8289-75e626583123 OpenAPI Info Structure and Semantics Schema discriminator property should be a string Documentation Non-Array Schema With Items (v2)9d47956b-29cd-43b1-9e6e-b39a4d484353 OpenAPI Info Structure and Semantics Non-Array Schema should not have 'items' defined Documentation Non-Array Schema With Items (v3)20cb3159-b219-496b-8dac-54ae3ab2021a OpenAPI Info Structure and Semantics Non-Array Schema should not have 'items' defined Documentation Paths Object is Empty (v2)3e6c7b1c-8a8d-43ab-98b9-65159f44db4a OpenAPI Info Structure and Semantics Paths object may be empty due to ACL constraints, meaning they are not exposed Documentation Paths Object is Empty (v3)815021c8-a50c-46d9-b192-24f71072c400 OpenAPI Info Structure and Semantics Paths object may be empty due to ACL constraints, meaning they are not exposed Documentation Property Defining Minimum Greater Than Maximum (v2)b5102ea9-6527-4bb7-94fc-9b4076150e55 OpenAPI Info Structure and Semantics Property defining minimum has greater value than maximum defined Documentation Property Defining Minimum Greater Than Maximum (v3)ab2af219-cd08-4233-b5a1-a788aac88b51 OpenAPI Info Structure and Semantics Property defining minimum has greater value than maximum defined Documentation Parameter Objects Headers With Duplicated Name (v2)bd2cbef5-62c4-40f1-af07-4b7f9ced6616 OpenAPI Info Structure and Semantics Parameter Objects should not have duplicate names for 'header' location, since HTTP headers are not case sensitive. Documentation Parameter Objects Headers With Duplicated Name (v3)05505192-ba2c-4a81-9b25-dcdbcc973746 OpenAPI Info Structure and Semantics Parameter Objects should not have duplicate names for 'header' location, since HTTP headers are not case sensitive. Documentation Type Has Invalid Keyword (v2)492c6cbb-f3f8-4807-aa4f-42b8b1c46b59 OpenAPI Info Structure and Semantics Schema/Parameter/Header Object define type should not use a keyword of another type Documentation Type Has Invalid Keyword (v3)a9228976-10cf-4b5f-b902-9e962aad037a OpenAPI Info Structure and Semantics Schema Object define type should not use a keyword of another type Documentation Properties Missing Required Property (v2)71beb6ab-8b70-4816-a9ac-a0ff1fb22a62 OpenAPI Info Structure and Semantics Schema Object should have all required properties defined Documentation Properties Missing Required Property (v3)3fb03214-25d4-4bd4-867c-c2d8d708a483 OpenAPI Info Structure and Semantics Schema Object should have all required properties defined Documentation Schema Discriminator Mismatch Defined Properties (v2)addc0eab-27f6-4c26-8526-d2ccd3732662 OpenAPI Info Structure and Semantics Schema discriminator values should match defined properties. Documentation Schema Discriminator Mismatch Defined Properties (v3)40d3df21-c170-4dbe-9c02-4289b51f994f OpenAPI Info Structure and Semantics Schema discriminator values should match defined properties. Documentation Cleartext Credentials With Basic Authentication For Operation86b1fa30-9790-4980-994d-a27e0f6f27c1 OpenAPI High Access Control Cleartext credentials over unencrypted channel should not be accepted for the operation Documentation Field 'securityScheme' On Components Is Undefined8db5544e-4874-4baa-9322-e9f75a2d219e OpenAPI High Access Control Components' securityScheme field must have a valid scheme Documentation Implicit Flow in OAuth2 (v3)4a1f3d75-ab73-41b2-83e7-06a93dc3a75a OpenAPI Medium Access Control There is a 'securityScheme' using implicit flow on OAuth2, which is deprecated Documentation Security Scheme HTTP Unknown Scheme06764426-3c56-407e-981f-caa25db1c149 OpenAPI Medium Access Control Security Scheme HTTP scheme should be registered in the IANA Authentication Scheme registry Documentation OAuth2 With Implicit Flow39cb32f2-3a42-4af0-8037-82a7a9654b6c OpenAPI Medium Access Control OAuth2 implicit flow is vulnerable to access token leakage and access token replay Documentation Security Scheme Using HTTP Digesta4247b11-890b-45df-bf42-350a7a3af9be OpenAPI Medium Access Control Security Scheme HTTP should not be using digest authentication Documentation Invalid OAuth2 Authorization URL (v3)52c0d841-60d6-4a81-88dd-c35fef36d315 OpenAPI Medium Access Control The field authorizationUrl on implicit or authorizationCode fields from OAuth must be a valid URL Documentation Invalid OAuth2 Token URL (v3)3ba0cca1-b815-47bf-ac62-1e584eb64a05 OpenAPI Medium Access Control OAuth2 security scheme flow requires a valid URL in the tokenUrl field Documentation OAuth2 With Password Flow3979b0a4-532c-4ea7-86e4-34c090eaa4f2 OpenAPI Medium Access Control OAuth2 password flow insecurely exposes the credentials of the resource owner to the client Documentation Security Scheme Using HTTP Negotiatef525cc92-9050-4c41-a75c-890dc6f64449 OpenAPI Medium Access Control Security Scheme HTTP should not be using negotiate authentication Documentation Security Scheme Using HTTP Basic68e5fcac-390c-4939-a373-6074b7be7c71 OpenAPI Medium Access Control Security Scheme HTTP should not be using basic authentication Documentation Path Server Object Uses HTTP (v3)9670f240-7b4d-4955-bd93-edaa9fa38b58 OpenAPI Medium Encryption The property 'url' in the Path Server Object should only allow 'HTTPS' protocols to ensure an encrypted connection Documentation Global Server Object Uses HTTP2d8c175a-6d90-412b-8b0e-e034ea49a1fe OpenAPI Medium Encryption Global server object URL should use 'https' protocol instead of 'http' Documentation Parameter Object Without Schema8fe1846f-52cc-4413-ace9-1933d7d23672 OpenAPI Medium Insecure Configurations The Parameter Object should have the attribute 'schema' defined Documentation Additional Properties Too Permissive9f88c88d-824d-4d9a-b985-e22977046042 OpenAPI Medium Insecure Configurations Objects should not accept 'additionalProperties' if it is possible Documentation Media Type Object Without Schemaf79b9d26-e945-44e7-98a1-b93f0f7a68a0 OpenAPI Medium Insecure Configurations The Media Type Object should have the attribute 'schema' defined Documentation Additional Properties Too Restrictivea19c3bbd-c056-40d7-9e1c-eeb0634e320d OpenAPI Medium Insecure Configurations Objects should accept 'additionalProperties' if it is allOf or an object with anyOf or oneOf Documentation Success Response Code Undefined for Trace Operation105e20dd-8449-4d71-95c6-d5dac96639af OpenAPI Medium Networking and Firewall Trace should define the '200' successful code Documentation Header Object Without Schema50de3b5b-6465-4e06-a9b0-b4c2ba34326b OpenAPI Medium Networking and Firewall The header object should have schema defined Documentation Security Scheme Using Oauth 1.01bc3205c-0d60-44e6-84f3-44fbf4dac5b3 OpenAPI Low Access Control Oauth 1.0 is deprecated, OAuth2 should be used instead Documentation Global Security Scheme Using Basic Authentication77276d82-4f45-4cf1-8e2b-4d345b936228 OpenAPI Low Access Control A security scheme is allowing basic authentication credentials to be transported over network Documentation Undefined Scope 'securityScheme' On Global 'security' Field23a9e2d9-8738-4556-a71c-2802b6ffa022 OpenAPI Low Access Control Using an scope on global security field that is undefined on 'securityScheme' can be defined by an attacker Documentation API Key Exposed In Global Security Scheme40e1d1bf-11a9-4f63-a3a2-a8b84c602839 OpenAPI Low Access Control API Keys should not be transported over network Documentation Undefined Scope 'securityScheme' On 'security' Field On Operations462d6a1d-fed9-4d75-bb9e-3de902f35e6e OpenAPI Low Access Control Using an scope on security of operations that is undefined on 'securityScheme' can be defined by an attacker Documentation Property 'allowReserved' of Encoding Object Ignored4190dda7-af03-4cf0-a128-70ac1661ca09 OpenAPI Info Best Practices Property 'allowReserved' of the encoding object should be defined when the media type of the request body is 'application/x-www-form-urlencoded'. If not, it will be ignored. Documentation Components Header Definition Is Unuseda68da022-e95a-4bc2-97d3-481e0bd6d446 OpenAPI Info Best Practices Components headers definitions should be referenced or removed from Open API definition Documentation Components Schema Definition Is Unused962fa01e-b791-4dcc-b04a-4a3e7389be5e OpenAPI Info Best Practices Components schemas definitions should be referenced or removed from Open API definition Documentation Components Callback Definition Is Unusedd15db953-a553-4b8a-9a14-a3d62ea3d79d OpenAPI Info Best Practices Components callbacks definitions should be referenced or removed from Open API definition Documentation Unknown Prefix (v3)a5375be3-521c-43bb-9eab-e2432e368ee4 OpenAPI Info Best Practices The media type prefix should be set as 'application', 'audio', 'font', 'example', 'image', 'message', 'model', 'multipart', 'text' or 'video' Documentation Property 'style' of Encoding Object Ignoredd3ea644a-9a5c-4fee-941f-f8a6786c0470 OpenAPI Info Best Practices Property 'style' of the encoding object should be defined when the media type of the request body is 'application/x-www-form-urlencoded'. If not, it will be ignored. Documentation Components Request Body Definition Is Unused6b76f589-9713-44ab-97f5-59a3dba1a285 OpenAPI Info Best Practices Components request bodies definitions should be referenced or removed from Open API definition Documentation Components Link Definition Is Unusedc19779a9-5774-4d2f-a3a1-a99831730375 OpenAPI Info Best Practices Components links definitions should be referenced or removed from Open API definition Documentation Encoding Header 'Content-Type' Improperly Defined4cd8de87-b595-48b6-ab3c-1904567135ab OpenAPI Info Best Practices Encoding Map Key should not define a 'Content-Type' in the 'headers' field. If so, it will be ignored. Documentation Components Parameter Definition Is Unused698a464e-bb3e-4ba8-ab5e-e6599b7644a0 OpenAPI Info Best Practices Components parameters definitions should be referenced or removed from Open API definition Documentation Property 'allowEmptyValue' Ignored59c2f769-7cc2-49c8-a3de-4e211135cfab OpenAPI Info Best Practices Property 'allowEmptyValue' is ignored in the following cases: {\"sytle\": \"simple\", \"explode\": false}, {\"sytle\": \"simple\", \"explode\": true}, {\"sytle\": \"spaceDelimited\", \"explode\": false}, {\"sytle\": \"pipeDelimited\", \"explode\": false}, and {\"sytle\": \"deepObject\", \"explode\": true} Documentation Invalid Media Type Value (v3)cf4a5f45-a27b-49df-843a-9911dbfe71d4 OpenAPI Info Best Practices The Media Type value should match the following format: /[+suffix][;parameters] Documentation Components Response Definition Is Unused9c3ea128-7e9a-4b4c-8a32-75ad17a2d3ae OpenAPI Info Best Practices Components responses definitions should be referenced or removed from Open API definition Documentation Property 'explode' of Encoding Object Ignoreda4dd69b8-49fa-45d2-a060-c76655405b05 OpenAPI Info Best Practices Property 'explode' of the encoding object should be defined when the media type of the request body is 'application/x-www-form-urlencoded'. If not, it will be ignored. Documentation Components Example Definition Is Unusedb05bb927-2df5-43cc-8d7b-6825c0e71625 OpenAPI Info Best Practices Components examples definitions should be referenced or removed from Open API definition Documentation Server URL Uses Undefined Variables8d0921d6-4131-461f-a253-99e873f8f77e OpenAPI Info Structure and Semantics Any variable used in the Service URL should be defined in the Service Object through 'variables'. Documentation Request Body With Incorrect Ref0f6cd0ab-c366-4595-84fc-fbd8b9901e4d OpenAPI Info Structure and Semantics Request Body reference must always point to '#/components/RequestBodies' Documentation Parameter JSON Reference Does Not Exists (v3)2e275f16-b627-4d3f-ae73-a6153a23ae8f OpenAPI Info Structure and Semantics Parameter reference should exists on components field Documentation Parameter Object Content With Multiple Entries8bfed1c6-2d59-4924-bc7f-9b9d793ed0df OpenAPI Info Structure and Semantics The map content property of the parameter object should only contain one entry Documentation Parameter Object With Incorrect Ref (v3)d40f27e6-15fb-4b56-90f8-fc0ff0291c51 OpenAPI Info Structure and Semantics Parameter Object reference must always point to '#/components/parameters' Documentation Server Object Variable Not Used8aee4754-970d-4c5f-8142-a49dfe388b1a OpenAPI Info Structure and Semantics Every defined Server Variable Object should be used in a Service URL. Documentation Example JSON Reference Does Not Exists6a2c219f-da5e-4745-941e-5ea8cde23356 OpenAPI Info Structure and Semantics Example reference should exists on components field Documentation Header Object With Incorrect Ref2d6646f4-2946-420f-8c14-3232d49ae0cb OpenAPI Info Structure and Semantics Header Object reference must always point to '#/components/headers' Documentation Security Field Undefinedab1263c2-81df-46f0-9f2c-0b62fdb68419 OpenAPI Info Structure and Semantics Security field should be defined in '#/components/securitySchemes' Documentation Object Without Required Property (v3)d172a060-8569-4412-8045-3560ebd477e8 OpenAPI Info Structure and Semantics OpenAPI Object should contain all of its required fields Documentation Parameter Object With Undefined Type46facedc-f243-4108-ab33-583b807d50b0 OpenAPI Info Structure and Semantics A Parameter Object must contain either a 'schema' property, or a 'content' property Documentation Invalid Content Type For Multiple Files Upload26f06397-36d8-4ce7-b993-17711261d777 OpenAPI Info Structure and Semantics Content Type should be set to 'multipart/form-data' in case of uploading an arbitrary number of files (array) Documentation Server URL Not Absolutea0bf7382-5d5a-4224-924c-3db8466026c9 OpenAPI Info Structure and Semantics The Server URL should be an absolute URL Documentation Property 'allowReserved' Improperly Defined7f203940-39c4-4ea7-91ee-7aba16bca9e2 OpenAPI Info Structure and Semantics Property 'allowReserved' should be only defined for query parameters Documentation Empty Array5915c20f-dffa-4cee-b5d4-f457ddc0151a OpenAPI Info Structure and Semantics All array fields should not be empty Documentation Schema JSON Reference Does Not Exists (v3)015eac96-6313-43c0-84e5-81b1374fa637 OpenAPI Info Structure and Semantics Schema reference should exists on components field Documentation Callback JSON Reference Does Not Existsf29904c8-6041-4bca-b043-dfa0546b8079 OpenAPI Info Structure and Semantics Callback reference should exists on components field Documentation Response JSON Reference Does Not Exists (v3)7a01dfbd-da62-4165-aed7-71349ad42ab4 OpenAPI Info Structure and Semantics Response reference should exists on components field Documentation Schema Object Incorrect Ref (v3)4cac7ace-b0fb-477d-830d-65395d9109d9 OpenAPI Info Structure and Semantics Schema Object reference must always point to '#/components/schemas' Documentation Request Body JSON Reference Does Not Existsca02f4e8-d3ae-4832-b7db-bb037516d9e7 OpenAPI Info Structure and Semantics Request Body reference should exists on components field Documentation Servers Array Undefinedc66ebeaa-676c-40dc-a3ff-3e49395dcd5e OpenAPI Info Structure and Semantics The Servers array should have at least one server defined. If not, the default value would be a Server Object with a URL value of '/'. Documentation Schema With Both ReadOnly And WriteOnlyd2361d58-361c-49f0-9e50-b957fd608b29 OpenAPI Info Structure and Semantics Schema should not have both 'writeOnly' and 'readOnly' set to true Documentation Link Object OperationId Does Not Target Operation Objectc5bb7461-aa57-470b-a714-3bc3d74f4669 OpenAPI Info Structure and Semantics Link object 'OperationId' should target an existing operation object in the OpenAPI definition Documentation Components Object Fixed Field Key Improperly Named151331e2-11f4-4bb6-bd35-9a005e695087 OpenAPI Info Structure and Semantics Components object fixed fields (schemas, responses, parameters, examples, requestBodies, headers, securitySchemes, links, and callbacks) should use keys that match the following REGEX: <code>^[a-zA-Z0-9\\.\\-_]+$</code> Documentation Encoding Map Key Mismatch Schema Defined Propertiescd7a52cf-8d7f-4cfe-bbeb-6306d23f576b OpenAPI Info Structure and Semantics Encoding Map Key should be set in schema defined properties Documentation Security Requirement Object With Wrong Scopes37140f7f-724a-4c87-a536-e9cee1d61533 OpenAPI Info Structure and Semantics Security Requirement Object should only have scopes defined for security schemes of type 'oauth2' and 'openIdConnect' Documentation Response Object With Incorrect Ref (v3)b3871dd8-9333-4d6c-bd52-67eb898b71ab OpenAPI Info Structure and Semantics Response Object reference must always point to '#/components/responses' Documentation Parameter Object With Schema And Content31dd6fc0-f274-493b-9614-e063086c19fc OpenAPI Info Structure and Semantics A Parameter Object must contain either a 'schema' property, or a 'content' property, but not both since they are mutually exclusive Documentation Callback Object With Incorrect Refba066cda-e808-450d-92b6-f29109754d45 OpenAPI Info Structure and Semantics Callback Object reference must always point to '#/components/callbacks' Documentation Link Object Incorrect Refb9db8a10-020c-49ca-88c6-780e5fdb4328 OpenAPI Info Structure and Semantics Link object reference must always point to '#/components/links' Documentation Unknown Property (v3)fb7d81e7-4150-48c4-b914-92fc05da6a2f OpenAPI Info Structure and Semantics All properties defined in OpenAPI objects should be known Documentation Link JSON Reference Does Not Exists801f0c6a-a834-4467-89c6-ddecffb46b5a OpenAPI Info Structure and Semantics Link reference should exists on components field Documentation Security Operation Field Undefined20a482d5-c5d9-4a7a-b7a4-60d0805047b4 OpenAPI Info Structure and Semantics Security operation field should be defined in '#/components/securitySchemes' Documentation Example JSON Reference Outside Components Examplesbac56e3c-1f71-4a74-8ae6-2fba07efcddb OpenAPI Info Structure and Semantics Reference to examples should point to #/components/examples Documentation Header JSON Reference Does Not Exists376c9390-7e9e-4cb8-a067-fd31c05451fd OpenAPI Info Structure and Semantics Header reference should exists on components field Documentation Request Body Object With Incorrect Media Type58f06434-a88c-4f74-826c-db7e10cc7def OpenAPI Info Structure and Semantics The field 'content' of the request body object should be set to 'multipart' or 'application/x-www-form-urlencoded' when field 'encoding' is set. Documentation Link Object With Both 'operationId' And 'operationRef'60fb6621-9f02-473b-9424-ba9a825747d3 OpenAPI Info Structure and Semantics Link object 'OperationId' should not have both 'operationId' and 'operationRef' defined since they are mutually exclusive. Documentation Lambda Functions With Full Privilegesa0ae0a4e-712b-4115-8112-51b9eeed9d69 CloudFormation High Access Control AWS Lambda Functions should not have roles with policies granting full administrative privileges. Documentation S3 Bucket Allows Public Policy860ba89b-b8de-4e72-af54-d6aee4138a69 CloudFormation High Access Control S3 bucket allows public policy Documentation S3 Bucket With All Permissions4ae8af91-5108-42cb-9471-3bdbe596eac9 CloudFormation High Access Control S3 Buckets should not have all permissions, as to prevent leaking private information to the entire internet or allow unauthorized data tampering / deletion. This means the 'Effect' must not be 'Allow' when the 'Action' is '*', for all Principals. Documentation S3 Bucket Access to Any Principal7772bb8c-c0f3-42d4-8e4e-f1b8939ad085 CloudFormation High Access Control The S3 Bucket should not be associated with a policy statement that grants access to any principal Documentation S3 Bucket ACL Allows Read Or Write to All Users07dda8de-d90d-469e-9b37-1aca53526ced CloudFormation High Access Control S3 Buckets should not be readable and writable to all users Documentation S3 Bucket ACL Allows Read to Any Authenticated User835d5497-a526-4aea-a23f-98a9afd1635f CloudFormation High Access Control S3 Buckets should not be readable to any authenticated user Documentation IAM Policies With Full Privileges953b3cdb-ce13-428a-aa12-318726506661 CloudFormation High Access Control IAM policies shouldn't allow full administrative privileges (for all resources) Documentation SNS Topic is Publicly Accessibleae53ce91-42b5-46bf-a84f-9a13366a4f13 CloudFormation High Access Control SNS Topic Policy should not allow any principal to access Documentation MSK Broker Is Publicly Accessible0ce1ba20-8ba8-4364-836f-40c24b8cb0ab CloudFormation High Access Control Public AWS MSK allows anyone to interact with the Apache Kafka broker, therefore increasing the opportunity for malicious activity. To prevent such a scenario, it is recommended for AWS MSK to not be publicly accessible Documentation IAM Policy Grants Full Permissionsf62aa827-4ade-4dc4-89e4-1433d384a368 CloudFormation High Access Control IAM policy should not grant full permissions to resources from the get-go, instead of granting permissions gradually as necessary. Documentation S3 Bucket Allows Restore Actions From All Principals456b00a3-1072-4149-9740-6b8bb60251b0 CloudFormation High Access Control S3 Buckets must not allow Restore Actions From All Principals, as to prevent leaking private information to the entire internet or allow unauthorized data tampering / deletion. This means the 'Effect' must not be 'Allow' when the 'Action' is Restore, for all Principals. Documentation S3 Bucket Allows Put Action From All Principalsf6397a20-4cf1-4540-a997-1d363c25ef58 CloudFormation High Access Control S3 Buckets must not allow Put Action From All Principals, as to prevent leaking private information to the entire internet or allow unauthorized data tampering / deletion. This means the 'Effect' must not be 'Allow' when the 'Action' is Put, for all Principals. Documentation S3 Bucket Allows Get Action From All Principalsf97b7d23-568f-4bcc-9ac9-02df0d57fbba CloudFormation High Access Control S3 Buckets must not allow Get Action From All Principals, as to prevent leaking private information to the entire internet or allow unauthorized data tampering / deletion. This means the 'Effect' must not be 'Allow' when the 'Action' is Get, for all Principals. Documentation S3 Bucket Allows List Action From All Principalsfaa8fddf-c0aa-4b2d-84ff-e993e233ebe9 CloudFormation High Access Control S3 Buckets must not allow List Action From All Principals, as to prevent leaking private information to the entire internet or allow unauthorized data tampering / deletion. This means the 'Effect' must not be 'Allow' when the 'Action' is List, for all Principals. Documentation ECS Service Admin Role Is Present01986452-bdd8-4aaa-b5df-d6bf61d616ff CloudFormation High Access Control ECS Services must not have Admin roles, which means the attribute 'role' must not be an admin role Documentation S3 Bucket Allows Delete Action From All Principalsacc78859-765e-4011-a229-a65ea57db252 CloudFormation High Access Control S3 Buckets must not allow Delete Action From All Principals, as to prevent leaking private information to the entire internet or allow unauthorized data tampering / deletion. This means the 'Effect' must not be 'Allow' when the 'Action' is Delete, for all Principals. Documentation S3 Bucket ACL Allows Read to All Users219f4c95-aa50-44e0-97de-cf71f4641170 CloudFormation High Access Control S3 Buckets should not be readable to all users Documentation ElastiCache With Disabled at Rest Encryptione4ee3903-9225-4b6a-bdfb-e62dbadef821 CloudFormation High Encryption Ensure AWS ElastiCache Redis clusters have encryption for data at rest enabled Documentation SageMaker Data Encryption Disabled709e6da6-fa1f-44cc-8f17-7f25f96dadbe CloudFormation High Encryption Amazon SageMaker's Notebook Instance must have its Data Encryption enabled, which means the attribute 'KmsKeyId' must be defined not empty or null. Documentation S3 Bucket SSE Disabled64ab651b-f5b2-4af0-8c89-ddd03c4d0e61 CloudFormation High Encryption If algorithm is AES256 then the master key is null, empty or undefined, otherwise the master key is required Documentation Connection Between CloudFront Origin Not Encrypteda5366a50-932f-4085-896b-41402714a388 CloudFormation High Encryption Checks if the connection between the CloudFront and the origin server is encrypted Documentation ELB Using Insecure Protocols61a94903-3cd3-4780-88ec-fc918819b9c8 CloudFormation High Encryption ELB Predefined or Custom Security Policies must not use insecure protocols, to reduce the risk of the SSL connection between the client and the load balancer being exploited. That means the ELB Listeners must not have Policies that posses Protocols that coincide with any of a predefined list of insecure protocols. Documentation User Data Contains Encoded Private Key568cc372-ca64-420d-9015-ee347d00d288 CloudFormation High Encryption User Data should not contain a base64 encoded private key. If so, anyone can decode the private key easily Documentation S3 Bucket Without Server-side-encryptionb2e8752c-3497-4255-98d2-e4ae5b46bbf5 CloudFormation High Encryption S3 Buckets should have server-side encryption at rest enabled to protect sensitive data Documentation Redshift Not Encrypted3b316b05-564c-44a7-9c3f-405bb95e211e CloudFormation High Encryption AWS Redshift Cluster should be encrypted. Check if 'Encrypted' field is false or undefined (default is false) Documentation EFS Without KMS6d087495-2a42-4735-abf7-02ef5660a7e6 CloudFormation High Encryption Amazon Elastic Filesystem should have filesystem encryption enabled using KMS CMK customer-managed keys instead of AWS managed-keys Documentation Secure Ciphers Disabledbe96849c-3df6-49c2-bc16-778a7be2519c CloudFormation High Encryption Check if secure ciphers aren't used in CloudFront Documentation ELB Using Weak Ciphers809f77f8-d10e-4842-a84f-3be7b6ff1190 CloudFormation High Encryption ELB Predefined or Custom Security Policies must not use weak ciphers, to reduce the risk of the SSL connection between the client and the load balancer being exploited. That means the ELB Listeners must not have Policies that posses Ciphers that coincide with any of a predefined list of weak ciphers. Documentation CMK Unencrypted Storageffee2785-c347-451e-89f3-11aeb08e5c84 CloudFormation High Encryption Ensure that storage is encrypted. Documentation RDS Storage Not Encrypted5beacce3-4020-4a3d-9e1d-a36f953df630 CloudFormation High Encryption RDS Storage should be encrypted, which means the attribute 'StorageEncrypted' should be set to 'true' Documentation DynamoDB With Aws Owned CMKc8dee387-a2e6-4a73-a942-183c975549ac CloudFormation High Encryption AWS DynamoDb should be encrypted using AWS Managed CMK, instead of AWS-owned CMK. To verify this, SSEEnabled must be verified if false for AWS-owned CMK or true for AWS-Managed CMK. Default value is false. Documentation ElastiCache With Disabled Transit Encryption3b02569b-fc6f-4153-b3a3-ba91022fed68 CloudFormation High Encryption Ensure AWS ElastiCache Redis clusters have encryption for data at transit enabled Documentation ELB Without Secure Protocol80908a75-586b-4c61-ab04-490f4f4525b8 CloudFormation High Encryption Check if the ELB is setup with SSL or HTTPS for secure communication Documentation CloudFormation Specifying Credentials Not Safe9ecb6b21-18bc-4aa7-bd07-db20f1c746db CloudFormation High Encryption Specifying credentials in the template itself is probably not safe to do. Documentation IAM Database Auth Not Enabled9fcd0a0a-9b6f-4670-a215-d94e6bf3f184 CloudFormation High Encryption IAM Database Auth Enabled should be configured to true when using compatible engine and version Documentation User Data Shell Script Is Encoded48c3bc58-6959-4f27-b647-4fedeace23be CloudFormation High Encryption User Data Shell Script must be encoded Documentation Redshift Cluster Without KMS CMKde76a0d6-66d5-45c9-9022-f05545b85c78 CloudFormation High Encryption AWS Redshift Cluster should have KMS CMK defined Documentation Cloudfront Viewer Protocol Policy Allows HTTP31733ee2-fef0-4e87-9778-65da22a8ecf1 CloudFormation High Encryption Checks if the connection between CloudFront and the viewer is encrypted Documentation MSK Cluster Encryption Disableda976d63f-af0e-46e8-b714-8c1a9c4bf768 CloudFormation High Encryption Ensure MSK Cluster encryption in rest and transit is enabled Documentation API Gateway Cache Encrypted Disabled37cca703-b74c-48ba-ac81-595b53398e9b CloudFormation High Encryption 'API::Gateway::Deployment' should have 'CacheDataEncrypted' enabled when 'CachingEnabled' is set to true Documentation ECS Task Definition Container With Plaintext Passwordf9b10cdb-eaab-4e39-9793-e12b94a582ad CloudFormation High Encryption It's not recommended to use plaintext environment variables for sensitive information, such as credential data. Documentation S3 Bucket Without SSL In Write Actions38c64e76-c71e-4d92-a337-60174d1de1c9 CloudFormation High Encryption S3 Buckets should enforce encryption of data transfers using Secure Sockets Layer (SSL) Documentation ECS Cluster Not Encrypted At Rest6c131358-c54d-419b-9dd6-1f7dd41d180c CloudFormation High Encryption Ensure that AWS ECS clusters are encrypted. Data encryption at rest, prevents unauthorized users from accessing sensitive data on your AWS ECS clusters and associated cache storage systems. Documentation Kinesis SSE Not Configured7f65be75-90ab-4036-8c2a-410aef7bb650 CloudFormation High Encryption AWS Kinesis Stream should have SSE (Server Side Encryption) defined Documentation EFS Not Encrypted2ff8e83c-90e1-4d68-a300-6d652112e622 CloudFormation High Encryption Elastic File System (EFS) must be encrypted Documentation CloudFront Without Minimum Protocol TLS 1.2dc17ee4b-ddf2-4e23-96e8-7a36abad1303 CloudFormation High Insecure Configurations CloudFront Minimum Protocol version should be at least TLS 1.2 Documentation Redshift Publicly Accessiblebdf8dcb4-75df-4370-92c4-606e4ae6c4d3 CloudFormation High Insecure Configurations AWS Redshift Clusters must not be publicly accessible, which means the attribute 'PubliclyAccessible' must be set to false Documentation DB Instance Publicly Accessiblede38e1d5-54cb-4111-a868-6f7722695007 CloudFormation High Insecure Configurations RDS must not be defined with public interface, which means the attribute 'PubliclyAccessible' must be set to false. Documentation S3 Bucket With Unsecured CORS Rule3609d27c-3698-483a-9402-13af6ae80583 CloudFormation High Insecure Configurations If the CORS (Cross-Origin Resource Sharing) rule is defined in an S3 bucket, it should be secure Documentation API Gateway Without Security Policy8275fab0-68ec-4705-bbf4-86975edb170e CloudFormation High Insecure Configurations API Gateway should have a Security Policy defined and use TLS 1.2. Documentation ECS Task Definition Network Mode Not Recommended027a4b7a-8a59-4938-a04f-ed532512cf45 CloudFormation High Insecure Configurations Network_Mode should be 'awsvpc' in ecs_task_definition. AWS VPCs provides the controls to facilitate a formal process for approving and testing all network connections and changes to the firewall and router configurations Documentation S3 Static Website Host Enabled90501b1b-cded-4cc1-9e8b-206b85cda317 CloudFormation High Insecure Configurations Checks if any static websites are hosted on buckets. Even static websites can be a liability when poorly configured. Documentation Root Account Has Active Access Keys4c137350-7307-4803-8c04-17c09a7a9fcf CloudFormation High Insecure Configurations The AWS Root Account must not have active access keys associated, which means if there are access keys associated to the Root Account, they must be inactive. Documentation S3 Bucket Without Restriction Of Public Bucket350cd468-0e2c-44ef-9d22-cfb73a62523c CloudFormation High Insecure Configurations S3 bucket without restriction of public bucket Documentation KMS Key With Vulnerable Policyda905474-7454-43c0-b8d2-5756ab951aba CloudFormation High Insecure Configurations Checks if the policy is vulnerable and needs updating. Documentation Batch Job Definition With Privileged Container Properties76ddf32c-85b1-4808-8935-7eef8030ab36 CloudFormation High Insecure Configurations Batch Job Definition should not have Privileged Container Properties Documentation Vulnerable Default SSL Certificateb4d9c12b-bfba-4aeb-9cb8-2358546d8041 CloudFormation High Insecure Defaults CloudFront web distributions should use custom (and not default) SSL certificates. Custom SSL certificates allow only defined users to access content by using an alternate domain name instead of the default one. Documentation Permissive Web ACL Default Action6d64f311-3da6-45f3-80f1-14db9771ea40 CloudFormation High Insecure Defaults WebAcl DefaultAction should not be ALLOW Documentation Security Group With Unrestricted Access To SSH6e856af2-62d7-4ba2-adc1-73b62cef9cc1 CloudFormation High Networking and Firewall 'SSH' (TCP:22) should not be public in AWS Security Group Documentation Security Group Unrestricted Access To RDP3ae83918-7ec7-4cb8-80db-b91ef0f94002 CloudFormation High Networking and Firewall Security Groups does not allow 0.0.0.0/0 for rdp (port:3389) Documentation Unknown Port Exposed To Internet829ce3b8-065c-41a3-ad57-e0accfea82d2 CloudFormation High Networking and Firewall AWS Security Group should not have an unknown port exposed to the entire Internet Documentation ALB Listening on HTTP275a3217-ca37-40c1-a6cf-bb57d245ab32 CloudFormation High Networking and Firewall AWS Application Load Balancer (alb) should not listen on HTTP Documentation EC2 Network ACL Overlapping Ports77b6f1e2-bde4-4a6a-ae7e-a40659ff1576 CloudFormation High Networking and Firewall NetworkACL Entries are reusing or overlapping ports which may create ineffective rules Documentation Security Groups With Meta IPadcd0082-e90b-4b63-862b-21899f6e6a48 CloudFormation High Networking and Firewall Security Groups allows 0.0.0.0/0 for all ports and protocols. Documentation DB Security Group Open To Large Scope0104165b-02d5-426f-abc9-91fb48189899 CloudFormation High Networking and Firewall The IP address in a DB Security Group must not have more than 256 hosts. Documentation EC2 Instance Subnet Has Public IP Mapping On Launchb3de4e4c-14be-4159-b99d-9ad194365e4c CloudFormation High Networking and Firewall EC2 Instance Subnet should not have MapPublicIpOnLaunch set to true Documentation EKS node group remote access73d59e76-a12c-4b74-a3d8-d3e1e19c25b3 CloudFormation High Networking and Firewall Ensure Amazon EKS Node group has implict SSH access Documentation Fully Open Ingresse415f8d3-fc2b-4f52-88ab-1129e8c8d3f5 CloudFormation High Networking and Firewall ECS Service's security group should not allow unrestricted access to all ports from all IPv4 addresses Documentation DB Security Group With Public Scope9564406d-e761-4e61-b8d7-5926e3ab8e79 CloudFormation High Networking and Firewall The IP address in a DB Security Group should not be '0.0.0.0/0' (IPv4) or '::/0' (IPv6). If so, any IP can access it Documentation HTTP Port Open To Internetddfc4eaa-af23-409f-b96c-bf5c45dc4daa CloudFormation High Networking and Firewall The HTTP port is open to the internet in a Security Group Documentation Unrestricted Security Group Ingress4a1e6b34-1008-4e61-a5f2-1f7c276f8d14 CloudFormation High Networking and Firewall AWS Security Group Ingress CIDR should not be open to the world Documentation Security Groups With Exposed Admin Portscdbb0467-2957-4a77-9992-7b55b29df7b7 CloudFormation High Networking and Firewall Security Groups should not have ports open in (20, 21, 22, 23, 115, 137, 138, 139, 2049, 3389) Documentation RDS Associated with Public Subnet4e88adee-a8eb-4605-a78d-9fb1096e3091 CloudFormation High Networking and Firewall RDS should not run in public subnet Documentation Default Security Groups With Unrestricted Trafficea33fcf7-394b-4d11-a228-985c5d08f205 CloudFormation High Networking and Firewall Check if default security group does not restrict all inbound and outbound traffic. Documentation SageMaker Notebook Not Placed In VPC9c7028d9-04c2-45be-b8b2-1188ccaefb36 CloudFormation High Networking and Firewall SageMaker Notebook must be placed in a VPC Documentation EC2 Sensitive Port Is Publicly Exposed494b03d3-bf40-4464-8524-7c56ad0700ed CloudFormation High Networking and Firewall The EC2 instance has a sensitive port connection exposed to the entire network Documentation ELB Sensitive Port Is Exposed To Entire Network78055456-f670-4d2e-94d5-392d1cf4f5e4 CloudFormation High Networking and Firewall The load balancer of the application with a sensitive port connection is exposed to the entire internet. Documentation Security Groups Allows Unrestricted Outbound Traffic66f2d8f9-a911-4ced-ae27-34f09690bb2c CloudFormation High Networking and Firewall No security group should allow unrestricted egress access Documentation Remote Desktop Port Open To Internetc9846969-d066-431f-9b34-8c4abafe422a CloudFormation High Networking and Firewall The Remote Desktop port is open to the internet in a Security Group Documentation EC2 Public Instance Exposed Through Subnetc44c95fc-ae92-4bb8-bdf8-bb9bc412004a CloudFormation High Networking and Firewall EC2 instances with public IP addresses shouldn't allow for unrestricted traffic to their subnets Documentation Route53 Record Undefined24d932e1-91f0-46ea-836f-fdbd81694151 CloudFormation High Networking and Firewall Route53 HostedZone must have the Record Set defined. Documentation CMK Rotation Disabled1c07bfaf-663c-4f6f-b22b-8e2d481e4df5 CloudFormation High Observability Customer Master Keys (CMK) must have rotation enabled, which means the attribute 'EnableKeyRotation' must be set to 'true' when the key is enabled. Documentation S3 Bucket CloudTrail Logging Disabledc3ce69fd-e3df-49c6-be78-1db3f802261c CloudFormation High Observability Server Access Logging should be enabled on S3 Buckets so that all changes are logged and trackable when the Service used is CloudTrail Documentation CloudTrail Logging Disabled5c0b06d5-b7a4-484c-aeb0-75a836269ff0 CloudFormation High Observability Checks if logging is enabled for CloudTrail. Documentation Cross-Account IAM Assume Role Policy Without ExternalId or MFA85138beb-ce7c-4ca3-a09f-e8fbcc57ddd7 CloudFormation Medium Access Control Cross-Account IAM Assume Role Policy should require external ID or MFA to protect cross-account access Documentation ECR Repository Is Publicly Accessible75be209d-1948-41f6-a8c8-e22dd0121134 CloudFormation Medium Access Control Amazon ECR image repositories shouldn't have public access Documentation IAM Policy On Usere4239438-e639-44aa-adb8-866e400e3ade CloudFormation Medium Access Control IAM policies should be applied to groups and not to users Documentation Elasticsearch Without IAM Authentication5c666ed9-b586-49ab-9873-c495a833b705 CloudFormation Medium Access Control AWS Elasticsearch should ensure IAM Authentication Documentation S3 Bucket Allows Public ACL48f100d9-f499-4c6d-b2b8-deafe47ffb26 CloudFormation Medium Access Control S3 bucket allows public ACL Documentation Public Lambda via API Gateway57b12981-3816-4c31-b190-a1e614361dd2 CloudFormation Medium Access Control Allowing to run lambda function using public API Gateway Documentation API Gateway Method Does Not Contains An API Key3641d5b4-d339-4bc2-bfb9-208fe8d3477f CloudFormation Medium Access Control An API Key should be required on a method request. Documentation KMS Allows Wildcard Principalf6049677-ec4a-43af-8779-5190b6d03cba CloudFormation Medium Access Control KMS Should not allow Principal parameter to be set as * Documentation API Gateway Without Configured Authorizer7fd0d461-5b8c-4815-898c-f2b4b117eb28 CloudFormation Medium Access Control API Gateway REST API should have an API Gateway Authorizer Documentation IoT Policy Allows Action as Wildcard4d32780f-43a4-424a-a06d-943c543576a5 CloudFormation Medium Access Control IoT Policy should not allow Action to be set as * Documentation Neptune Cluster With IAM Database Authentication Disableda3aa0087-8228-4e7e-b202-dc9036972d02 CloudFormation Medium Access Control Neptune Cluster should have IAM Database Authentication enabled Documentation Empty Roles For ECS Cluster Task Definitions7f384a5f-b5a2-4d84-8ca3-ee0a5247becb CloudFormation Medium Access Control Check if any ECS cluster has not defined proper roles for services' task definitions. Documentation IoT Policy Allows Wildcard Resourcebe5b230d-4371-4a28-a441-85dc760e2aa3 CloudFormation Medium Access Control IoT Policy should not allow Resource to be set as * Documentation Lambda Permission Principal Is Wildcard1d6e16f1-5d8a-4379-bfb3-2dadd38ed5a7 CloudFormation Medium Access Control Lambda Permission Principal should not contain a wildcard. Documentation SQS Queue Policy Allows NotAction4fbfee74-8186-40d5-a24e-4baa76a855de CloudFormation Medium Access Control AWS SQS Queue Policy should not allow NotAction since the actions specified in this element are the only actions in that are limited Documentation IAM Policies Attached To Useredc95c10-7366-4f30-9b4b-f995c84eceb5 CloudFormation Medium Access Control IAM policies should be attached only to groups or roles Documentation SQS Policy With Public Access9b6a3f5b-5fd6-40ee-9bc0-ed604911212d CloudFormation Medium Access Control Checks for dangerous permissions in Action statements in an SQS Queue Policy. This is deemed a potential security risk as it would allow various attacks to the queue Documentation EC2 Network ACL Ineffective Denied Traffic2623d682-dccb-44cd-99d0-54d9fd62f8f2 CloudFormation Medium Access Control Ineffective deny rules. A deny rule should be applied to all IP addresses. Documentation SNS Topic Publicity Has Allow and NotAction Simultaneously818f38ed-8446-4132-9c03-474d49e10195 CloudFormation Medium Access Control SNS topic Publicity should not have 'Effect: Allow' and argument 'NotAction' at the same time. If it has 'Effect: Allow', the argument stated should be 'Action'. Documentation EC2 Instance Has No IAM Rolef914357d-8386-4d56-9ba6-456e5723f9a6 CloudFormation Medium Access Control Check if an EC2 instance refers to an IAM profile, which represents an IAM Role. Documentation SQS Queue Policy Allows NotPrincipal4a8fc9a2-2b2f-4b3f-aa8d-401425872034 CloudFormation Medium Access Control Checks if an SQS Queue policy has an Allow and a NotPrincipal. AWS strongly recommends against using <code>NotPrincipal</code> in the same policy statement as <code>\"Effect\": \"Allow\"</code>. Documentation EBS Volume Not Attached To Instances1819ac03-542b-4026-976b-f37addd59f3b CloudFormation Medium Availability EBS Volumes that are unattached to instances may contain sensitive data Documentation Auto Scaling Group With No Associated ELBad21e616-5026-4b9d-990d-5b007bfe679c CloudFormation Medium Availability AWS Auto Scaling Groups must have associated ELBs to ensure high availability and improve application performance. This means the attribute 'LoadBalancerNames' must be defined and not empty. Documentation ECS Service Without Running Tasks79d745f0-d5f3-46db-9504-bef73e9fd528 CloudFormation Medium Availability ECS Service should have at least 1 task running Documentation ElastiCache Nodes Not Created Across Multi AZcfdef2e5-1fe4-4ef4-bea8-c56e08963150 CloudFormation Medium Availability ElastiCache Nodes should be created across multi az, which means 'AZMode' should be set to 'cross-az' in multi nodes cluster Documentation CMK Is Unusable2844c749-bd78-4cd1-90e8-b179df827602 CloudFormation Medium Availability AWS Key Management Service (KMS) must only possess usable Customer Master Keys (CMK), which means the CMKs must have the attribute 'Enabled' set to true and the attribute 'PendingWindowInDays' must be undefined. Documentation RDS Multi-AZ Deployment Disabled2b1d4935-9acf-48a7-8466-10d18bf51a69 CloudFormation Medium Backup AWS RDS Instance should have a multi-az deployment Documentation RDS With Backup Disabled8c415f6f-7b90-4a27-a44a-51047e1506f9 CloudFormation Medium Backup Make sure the AWS RDS configuration has automatic backup configured. If the retention period is equal to 0 there is no backup Documentation Low RDS Backup Retention Periode649a218-d099-4550-86a4-1231e1fcb60d CloudFormation Medium Backup AWS RDS backup retention policy should be at least 7 days Documentation Stack Retention Disabledfe974ae9-858e-4991-bbd5-e040a834679f CloudFormation Medium Backup Make sure that retain_stack is enabled to keep the Stack and it's associated resources during resource destruction Documentation IAM Password Without Uppercase Letter445020f6-b69e-4484-847f-02d4b7768902 CloudFormation Medium Best Practices IAM password should have at least one uppercase letter Documentation IAM Password Without Lowercase Letterf4cf35d6-da92-48de-ab70-57be2b2e6497 CloudFormation Medium Best Practices IAM Password should have at least one lowercase letter Documentation IAM Password Without Number839f238f-2e3a-4a72-b945-8abdf91af955 CloudFormation Medium Best Practices IAM user resource Login Profile Password should have at least one number Documentation IAM User Without Password Reseta964d6e3-8e1e-4d93-8120-61fa640dd55a CloudFormation Medium Best Practices IAM User Login Profile should exist and have PasswordResetRequired property set to true Documentation Cognito UserPool Without MFA74a18d1a-cf02-4a31-8791-ed0967ad7fdc CloudFormation Medium Best Practices AWS Cognito UserPool should have MFA (Multi-Factor Authentication) defined to users Documentation IAM Password Without Symbold72a7869-e8b9-4e12-bcd2-e8be10b39fa7 CloudFormation Medium Best Practices IAM password should have the required symbols Documentation IAM Managed Policy Applied to a User0e5872b4-19a0-4165-8b2f-56d9e14b909f CloudFormation Medium Best Practices Make sure that any managed IAM policies are implemented in a group and not in a user. Documentation ECS No Load Balancer Attachedfb2b0ecf-1492-491a-a70d-ba1df579175d CloudFormation Medium Best Practices Amazon ECS service should be configured to use Load Balancing to distribute traffic evenly across the tasks, which means there must exist at least one LoadBalancer. Documentation IAM Password Without Minimum Lengthb1b20ae3-8fa7-4af5-a74d-a2145920fcb1 CloudFormation Medium Best Practices IAM password should have the required minimum length Documentation API Gateway With Invalid Compressiond6653eee-2d4d-4e6a-976f-6794a497999a CloudFormation Medium Encryption API Gateway should have valid compression, which means attribute 'MinimumCompressionSize' should be set and its value should be greater than -1 and smaller than 10485760. Documentation KMS Key Rotation Disabled235ca980-eb71-48f4-9030-df0c371029eb CloudFormation Medium Encryption EnableKeyRotation should not be false or undefined Documentation Neptune Database Cluster Encryption Disabledbf4473f1-c8a2-4b1b-8134-bd32efabab93 CloudFormation Medium Encryption Neptune database cluster storage should have encryption enabled Documentation CodeBuild Not Encryptedd7467bb6-3ed1-4c82-8095-5e7a818d0aad CloudFormation Medium Encryption CodeBuild Project should be encrypted, which means 'EncryptionKey' should be defined Documentation Default KMS Key Usagee52395b4-250b-4c60-81d5-2e58c1d37abc CloudFormation Medium Encryption When <code>StorageEncrypted</code> is set to true, <code>KmsKeyId</code> should be defined, to avoid the use of the default KMS Key Documentation SageMaker EndPoint Config Should Specify KmsKeyId Attribute44034eda-1c3f-486a-831d-e09a7dd94354 CloudFormation Medium Encryption KmsKeyId attribute should be defined Documentation ElasticSearch Not Encrypted At Rest86a248ab-0e01-4564-a82a-878303e253bb CloudFormation Medium Encryption Check if ElasticSearch encryption is disabled at Rest Documentation Unscanned ECR Image9025b2b3-e554-4842-ba87-db7aeec36d35 CloudFormation Medium Encryption Checks if the ECR Image has been scanned Documentation RDS Storage Encryption Disabled65844ba3-03a1-40a8-b3dd-919f122e8c95 CloudFormation Medium Encryption RDS DBCluster should have storage encrypted set to true Documentation Config Rule For Encrypted Volumes Disabled1b6322d9-c755-4f8c-b804-32c19250f2d9 CloudFormation Medium Encryption Check if AWS config rules do not identify Encrypted Volumes as a source. Documentation IAM Group Inline Policiesa58d1a2d-4078-4b80-855b-84cc3f7f4540 CloudFormation Medium Encryption IAM Groups should not use inline policies and instead use managed policies. If a group is deleted, the inline policy is also deleted Documentation Workspace Without Encryption89827c57-5a8a-49eb-9731-976a606d70db CloudFormation Medium Encryption Workspaces should have encryption enabled Documentation AmazonMQ Broker Encryption Disabled316278b3-87ac-444c-8f8f-a733a28da60f CloudFormation Medium Encryption AmazonMQ Broker should have Encryption Options defined Documentation ElasticSearch Encryption With KMS Disabledd926aa95-0a04-4abc-b20c-acf54afe38a1 CloudFormation Medium Encryption Check if any ElasticSearch domain isn't encrypted with KMS. Documentation EMR Security Configuration Encryption Disabled5b033ec8-f079-4323-b5c8-99d4620433a9 CloudFormation Medium Encryption EMR SecurityConfiguration should enable and properly configure encryption at rest and in transit. Documentation EBS Volume Encryption Disabled80b7ac3f-d2b7-4577-9b10-df7913497162 CloudFormation Medium Encryption EBS volumes should be encrypted Documentation Alexa Skill Plaintext Client Secret Exposed3c3b7a58-b018-4d07-9444-d9ee7156e111 CloudFormation Medium Encryption Alexa skills' client secrets should not be defined as a plaintext string. It should either use 'AWS Systems Manager Parameter Store' or 'AWS Secrets Manager' to retrieve sensitive information Documentation SQS With SSE Disabled12726829-93ed-4d51-9cbe-13423f4299e1 CloudFormation Medium Encryption Amazon Simple Queue Service (SQS) queue should protect the contents of their messages using Server-Side Encryption (SSE) Documentation Memcached Disableddd0971a6-09c3-4168-8474-a7ef8fbfd99d CloudFormation Medium Encryption Check if the Memcached is disabled on the ElastiCache Documentation ECR Image Tag Not Immutable33f41d31-86b1-46a4-81f7-9c9a671f59ac CloudFormation Medium Insecure Configurations ECR should have an image tag be immutable. This prevents image tags from being overwritten. Documentation IAM User Has Too Many Access Keys48677914-6fdf-40ec-80c4-2b0e94079f54 CloudFormation Medium Insecure Configurations Any IAM User should not have more than one access key since it increases the risk of unauthorized access and compromise credentials Documentation Inline Policies Are Attached To ECS Service9e8c89b3-7997-4d15-93e4-7911b9db99fd CloudFormation Medium Insecure Configurations Check if any ECS service has inline policies attached, which are embedded directly into an entity (user, group,...), instead of the equivalent recommended managed policies. Documentation API Gateway With Open Access1056dfbb-5802-4762-bf2b-8b9b9684b1b0 CloudFormation Medium Insecure Configurations API Gateway Method should restrict the authorization type, except for the HTTP OPTIONS method. Documentation Instance With No VPC8a6d36cd-0bc6-42b7-92c4-67acc8576861 CloudFormation Medium Insecure Configurations EC2 Instances should be configured under a VPC network. AWS VPCs provide the controls to facilitate a formal process for approving and testing all network connections and changes to the firewall and router configurations. Documentation Lambda Functions Without Unique IAM Rolesae03f542-1423-402f-9cef-c834e7ee9583 CloudFormation Medium Insecure Configurations AWS Lambda Functions should not share IAM roles to ensure they will have the minimum privileges needed to perform the required tasks Documentation GitHub Repository Set To Public5906092d-5f74-490d-9a03-78febe0f65e1 CloudFormation Medium Insecure Configurations Repositories must be set to private, which means the attribute 'visibility' must be set to 'private' and/or the attribute 'private' must be set to true (the attribute 'visibility' overrides 'private') Documentation EMR Cluster Without Security Configuration48af92a5-c89b-4936-bc62-1086fe2bab23 CloudFormation Medium Insecure Configurations EMR Cluster should have security configuration defined. Documentation SageMaker Enabling Internet Access88d55d94-315d-4564-beee-d2d725feab11 CloudFormation Medium Insecure Configurations SageMaker must have disabled internet access and root access for Creating Notebook Instances. Documentation API Gateway Without SSL Certificateed4c48b8-eccc-4881-95c1-09fdae23db25 CloudFormation Medium Insecure Configurations SSL Client Certificate should be enabled Documentation MQ Broker Is Publicly Accessible68b6a789-82f8-4cfd-85de-e95332fe6a61 CloudFormation Medium Insecure Configurations Check if any MQ Broker is not publicly accessible Documentation Lambda Function Without Tags8df8e857-bd59-44fa-9f4c-d77594b95b46 CloudFormation Medium Insecure Configurations AWS Lambda Functions must have associated tags. Documentation IAM User LoginProfile Password Is In Plaintext06adef8c-c284-4de7-aad2-af43b07a8ca1 CloudFormation Medium Insecure Configurations IAM User LoginProfile Password must not be a plaintext string Documentation RouterTable with Default Routing4f0908b9-eb66-433f-9145-134274e1e944 CloudFormation Medium Insecure Defaults NAT gateways are recommended, and not the default route which permits all traffic, in Route Tables. Documentation S3 Bucket Should Have Bucket Policy37fa8188-738b-42c8-bf82-6334ea567738 CloudFormation Medium Insecure Defaults Checks if S3 Bucket has the same name as a Bucket Policy, if it has, S3 Bucket has a Bucket Policy associated Documentation Security Group Egress With All Protocolsee464fc2-54a6-4e22-b10a-c6dcd2474d0c CloudFormation Medium Networking and Firewall AWS Security Group Egress should not specify all protocols to prevent allow traffic on all ports Documentation API Gateway without WAFfcbf9019-566c-4832-a65c-af00d8137d2b CloudFormation Medium Networking and Firewall API Gateway should have WAF (Web Application Firewall) enabled Documentation ELB With Security Group Without Outbound Rules01d5a458-a6c4-452a-ac50-054d59275b7c CloudFormation Medium Networking and Firewall An AWS Elastic Load Balancer (ELB) shouldn\u00b4t have security groups without outbound rules Documentation ELB With Security Group Without Inbound Rulese200a6f3-c589-49ec-9143-7421d4a2c845 CloudFormation Medium Networking and Firewall An AWS Elastic Load Balancer (ELB) shouldn\u00b4t have security groups without outbound rules Documentation Security Groups Without VPC Attached493d9591-6249-47bf-8dc0-5c10161cc558 CloudFormation Medium Networking and Firewall Security Groups must have a VPC. Documentation VPC Without Network Firewall3e293410-d5b8-411f-85fd-7d26294f20c9 CloudFormation Medium Networking and Firewall VPC should have a Network Firewall associated Documentation Security Group Ingress With All Protocols1a427b25-2e9e-4298-9530-0499a55e736b CloudFormation Medium Networking and Firewall AWS Security Group Ingress should not specify all protocols to prevent allow traffic on all ports Documentation API Gateway Endpoint Config is Not Private4a8daf95-709d-4a36-9132-d3e19878fa34 CloudFormation Medium Networking and Firewall The API Endpoint type in API Gateway should be set to PRIVATE so it's not exposed to the public internet Documentation Security Group Ingress With Port Range87482183-a8e7-4e42-a566-7a23ec231c16 CloudFormation Medium Networking and Firewall AWS Security Group Ingress should have a single port Documentation GameLift Fleet EC2 InboundPermissions With Port Range43356255-495d-4148-ad8d-f6af5eac09dd CloudFormation Medium Networking and Firewall AWS GameLift Fleet EC2InboundPermissions should have a single port Documentation TCP/UDP Protocol Network ACL Entry Allows All Portsf57f849c-883b-4cb7-85e7-f7b199dff163 CloudFormation Medium Networking and Firewall TCP/UDP protocol AWS Network ACL Entry should not allow all ports Documentation EC2 Permissive Network ACL Protocols03879981-efa2-47a0-a818-c843e1441b88 CloudFormation Medium Networking and Firewall To avoid opening all ports for Allow rules, EC2 NetworkACL Entry Protocol should be either 6 (for TCP), 17 (for UDP), 1 (for ICMP), or 58 (for ICMPv6, which must include an IPv6 CIDR block, ICMP type, and code). Documentation Security Group Egress With Port Rangedae9c373-8287-462f-8746-6f93dad93610 CloudFormation Medium Networking and Firewall AWS Security Group Egress should have a single port Documentation ALB Is Not Integrated With WAF105ba098-1e34-48cd-b0f2-a8a43a51bf9b CloudFormation Medium Networking and Firewall All Application Load Balancers (ALB) must be protected with Web Application Firewall (WAF) service Documentation Security Group Egress CIDR Open To World1cc2fbd7-816c-4fbf-ad6d-38a4afa4312a CloudFormation Medium Networking and Firewall AWS Security Group Egress CIDR should not be open to the world Documentation API Gateway Deployment Without Access Log Setting06ec63e3-9f72-4fe2-a218-2eb9200b8db5 CloudFormation Medium Observability API Gateway Deployment should have access log setting defined when connected to an API Gateway Stage. Documentation API Gateway V2 Stage Access Logging Settings Not Defined80d45af4-4920-4236-a56e-b7ef419d1941 CloudFormation Medium Observability API Gateway V2 Stage should have Access Logging Settings defined. Documentation Stack Notifications Disabled837e033c-4717-40bd-807e-6abaa30161b7 CloudFormation Medium Observability AWS CloudFormation should have stack notifications enabled to be notified when an event occurs Documentation API Gateway X-Ray Disabled4ab10c48-bedb-4deb-8f3b-ff12783b61de CloudFormation Medium Observability API Gateway should have X-Ray Tracing enabled Documentation MSK Cluster Logging Disabledfc7c2c15-f5d0-4b80-adb2-c89019f8f62b CloudFormation Medium Observability Ensure MSK Cluster Logging is enabled Documentation CloudWatch Logging Disabled0f0fb06b-0f2f-4374-8588-f2c7c348c7a0 CloudFormation Medium Observability Check if CloudWatch logging is disabled for Route53 hosted zones Documentation CloudTrail Not Integrated With CloudWatch65d07da5-9af5-44df-8983-52d2e6f24c44 CloudFormation Medium Observability CloudTrail should be integrated with CloudWatch Documentation Configuration Aggregator to All Regions Disabled9f3cf08e-72a2-4eb1-8007-e3b1b0e10d4d CloudFormation Medium Observability AWS Config Configuration Aggregator All Regions must be set to True Documentation CloudWatch Metrics Disabled5d3c1807-acb3-4bb0-be4e-0440230feeaf CloudFormation Medium Observability Checks if CloudWatch Metrics is Enabled Documentation ELBv2 ALB Access Log Disabledc62e8b7d-1fdf-4050-ac4c-76ba9e1d9621 CloudFormation Medium Observability ELBv2 ALBs should have access log enabled to capture detailed information about requests sent to your load balancer. Documentation S3 Bucket Logging Disabled4552b71f-0a2a-4bc4-92dd-ed7ec1b4674c CloudFormation Medium Observability Server Access Logging should be enabled on S3 Buckets so that all changes are logged and trackable Documentation S3 Bucket Without Versioninga227ec01-f97a-4084-91a4-47b350c1db54 CloudFormation Medium Observability S3 bucket should have versioning enabled Documentation Redshift Cluster Logging Disabled3de2d4ff-fe53-4fc9-95d3-2f8a69bf90d6 CloudFormation Medium Observability Make sure Logging is enabled for Redshift Cluster Documentation CloudTrail Multi Region Disabled058ac855-989f-4378-ba4d-52d004020da7 CloudFormation Medium Observability CloudTrail multi region should be enabled, which means attribute 'IsMultiRegionTrail' should be set to true Documentation MQ Broker Logging Disablede519ed6a-8328-4b69-8eb7-8fa549ac3050 CloudFormation Medium Observability Check if MQ Brokers don't have logging enabled in any of the two options possible (audit and general). Documentation CloudFront Logging Disabledde77cd9f-0e8b-46cc-b4a4-b6b436838642 CloudFormation Medium Observability AWS CloudFront distributions should have logging enabled to collect all viewer requests, which means the attribute 'DistributionConfig.Logging' should be defined Documentation ELB Access Log Disabledee12ad32-2863-4c0f-b13f-28272d115028 CloudFormation Medium Observability ELB should have access log enabled Documentation CloudTrail SNS Topic Name Undefined3e09413f-471e-40f3-8626-990c79ae63f3 CloudFormation Medium Observability Check if SNS topic name is set for CloudTrail Documentation GuardDuty Detector Disableda25cd877-375c-4121-a640-730929936fac CloudFormation Medium Observability Make sure that Amazon GuardDuty is Enabled Documentation ElasticSearch Without Slow Logs086ea2eb-14a6-4fd4-914b-38e0bc8703e8 CloudFormation Medium Observability Ensure that AWS Elasticsearch enables support for slow logs Documentation SNS Topic Without KmsMasterKeyId9d13b150-a2ab-42a1-b6f4-142e41f81e52 CloudFormation Medium Secret Management KmsMasterKeyId attribute should not be undefined Documentation Directory Service Microsoft AD Password Set to Plaintext or Default Ref06b9f52a-8cd5-459b-bdc6-21a22521e1be CloudFormation Medium Secret Management Directory Service Microsoft AD password must not be a plaintext string or a Ref to a Parameter with a Default value. Documentation DocDB Cluster Master Password In Plaintext39423ce4-9011-46cd-b6b1-009edcd9385d CloudFormation Medium Secret Management DocDB DB Cluster master user password must not be in a plain text string or referenced in a parameter as a default value. Documentation DMS Endpoint MongoDB Settings Password Exposedf988a17f-1139-46a3-8928-f27eafd8b024 CloudFormation Medium Secret Management DMS Endpoint MongoDbSettings Password must not be a plaintext string or a Ref to a Parameter with a Default value. Documentation Amplify App OAuth Token Exposed03b38885-8f4e-480c-a0e4-12c1affd15db CloudFormation Medium Secret Management Amplify App OAuth Token must not be a plaintext string or a Ref to a Parameter with a Default value. Documentation High Access Key Rotation Period800fa019-49dd-421b-9042-7331fdd83fa2 CloudFormation Medium Secret Management ConfigRule should enforce access keys to be rotated within 90 days. Documentation Amplify App Basic Auth Config Password Exposed71493c8b-3014-404c-9802-078b74496fb7 CloudFormation Medium Secret Management Amplify App BasicAuthConfig Password must not be a plaintext string or a Ref to a Parameter with a Default value. Documentation Hardcoded AWS Access Key In Lambda2564172f-c92b-4261-9acd-464aed511696 CloudFormation Medium Secret Management Lambda access/secret keys should not be hardcoded Documentation EBS Volume Without KmsKeyIdb7063015-6c31-4658-a8e7-14f98f37fd42 CloudFormation Medium Secret Management EBS Volume should specify a KmsKeyId value Documentation Secrets Manager Should Specify KmsKeyIdc8ae9ba9-c2f7-4e5c-b32e-a4b7712d4d22 CloudFormation Medium Secret Management Secrets Manager Secret should explicitly specify KmsKeyId, this will allow the secret to be shared cross-account Documentation Amplify Branch Basic Auth Config Password Exposeddfb56e5d-ee68-446e-b32a-657b62befe69 CloudFormation Medium Secret Management Amplify Branch BasicAuthConfig Password must not be a plaintext string or a Ref to a Parameter with a Default value. Documentation Directory Service Simple AD Password Exposed6685d912-d81f-4cfa-95ad-e316ea31c989 CloudFormation Medium Secret Management DirectoryService SimpleAD password must not be a plaintext string or a Ref to a Parameter with a Default value. Documentation RefreshToken Is Exposed5b48c507-0d1f-41b0-a630-76817c6b4189 CloudFormation Medium Secret Management Alexa ASK Skill AuthenticationConfiguration RefreshToken should not be a plaintext string Documentation Amplify App Access Token Exposed73980e43-f399-4fcc-a373-658228f7adf7 CloudFormation Medium Secret Management Amplify App Access Token must not be in a plain text string or referenced in a parameter as a default value. Documentation DMS Endpoint Password Exposed5f700072-b7ce-4e84-b3f3-497bf1c24a4d CloudFormation Medium Secret Management DMS Endpoint password must not be a plaintext string or a Ref to a Parameter with a Default value. Documentation IAM Group Without Users8f957abd-9703-413d-87d3-c578950a753c CloudFormation Low Access Control IAM Group should have at least one user associated Documentation IAM User With No Group06933df4-0ea7-461c-b9b5-104d27390e0e CloudFormation Low Access Control A IAM user should belong to a group Documentation Support Has No Role Associatedd71b5fd7-9020-4b2d-9ec8-b3839faa2744 CloudFormation Low Access Control Check if any AWS Support policy does not have any role and users and group associated, which means that is not being managed. Documentation IAM Policy Grants 'AssumeRole' Permission Across All Servicese835bd0d-65da-49f7-b6d1-b646da8727e6 CloudFormation Low Access Control IAM Policy should not grant 'AssumeRole' permission across all services. Documentation EC2 Instance Using Default Security Group08b81bb3-0985-4023-8602-b606ad81d279 CloudFormation Low Access Control EC2 instances should not use default security group(s) Documentation IAM Role Allows All Principals To Assumef80e3aa7-7b34-4185-954e-440a6894dde6 CloudFormation Low Access Control IAM role allows all services or principals to assume it Documentation VPC Attached With Too Many Gateways97e94d17-e2c7-4109-a53b-6536ac1bb64e CloudFormation Low Availability The number of gateways attached should not approach or go beyond the limit of 3, in a particular VPC Documentation RDS DB Instance With Deletion Protection Disabled2c161e58-cb52-454f-abea-6470c37b5e6e CloudFormation Low Backup RDS DBInstance should have deletion protection set to true Documentation IAM Access Analyzer Not Enabled8d29754a-2a18-460d-a1ba-9509f8d359da CloudFormation Low Best Practices IAM Access Analyzer should be enabled and configured to continuously monitor resource permissions Documentation Automatic Minor Upgrades Disabledf0104061-8bfc-4b45-8a7d-630eb502f281 CloudFormation Low Best Practices RDS instance should have automatic minor upgrades enabled, which means the attribute 'AutoMinorVersionUpgrade' must be set to true. Documentation CDN Configuration Is Missinge4f54ff4-d352-40e8-a096-5141073c37a2 CloudFormation Low Best Practices Content Delivery Network (CDN) service is used within an AWS account to secure and accelerate the delivery of websites. The use of a CDN can provide a layer of security between your origin content and the destination. Documentation Security Group Ingress Has CIDR Not Recommendeda3e4e39a-e5fc-4ee9-8cf5-700febfa86dd CloudFormation Low Best Practices AWS Security Group Ingress CIDR should not be /32 in case of IPV4 or /128 in case of IPV6 Documentation IAM Policies Without Groups5e7acff5-095b-40ac-9073-ac2e4ad8a512 CloudFormation Low Best Practices IAM policy should not apply directly to users, should be with a group Documentation Geo Restriction Disabled7f8843f0-9ea5-42b4-a02b-753055113195 CloudFormation Low Best Practices Geo Restriction feature should be enabled, to restrict or allow users in specific locations accessing web application content Documentation Lambda Permission Misconfigured9b83114b-b2a1-4534-990d-06da015e47aa CloudFormation Low Best Practices Lambda permission may be misconfigured if the action field is not filled in by 'lambda:InvokeFunction' Documentation DynamoDB With Not Recommented Table Billing Modec333e906-8d8b-4275-b999-78b6318f8dc6 CloudFormation Low Build Process Checks if DynamoDB Table Billing Mode is set to either PAY_PER_REQUEST or PROVISIONED Documentation EFS Without Tags08e39832-5e42-4304-98a0-aa5b43393162 CloudFormation Low Build Process Amazon Elastic Filesystem should have filesystem tags associated Documentation CloudTrail Log Files Not Encrypted With KMS050a9ba8-d1cb-4c61-a5e8-8805a70d3b85 CloudFormation Low Encryption Logs delivered by CloudTrail should be encrypted using KMS to increase security of your CloudTrail Documentation S3 Bucket Without Ignore Public ACL6c8d51af-218d-4bfb-94a9-94eabaa0703a CloudFormation Low Insecure Configurations S3 bucket without ignore public ACL Documentation API Gateway Cache Cluster Disabled52790cad-d60d-41d5-8483-146f9f21208d CloudFormation Low Insecure Configurations AWS API Gateway should have cache clustering enabled Documentation Wildcard In ACM Certificate Domain Namecc8b294f-006f-4f8f-b5bb-0a9140c33131 CloudFormation Low Insecure Configurations ACM Certificate should not use wildcards (*) in the domain name Documentation Lambda Function Without Dead Letter Queuec2eae442-d3ba-4cb1-84ca-1db4f80eae3d CloudFormation Low Insecure Configurations AWS Lambda Function should be configured for a Dead Letter Queue(DLQ) Documentation RDS Using Default Port1fe9d958-ddce-4228-a124-05265a959a8b CloudFormation Low Networking and Firewall RDS should not use the default port (an attacker can easily guess the port). For engines related to Aurora, MariaDB or MySQL, the default port is 3306. PostgreSQL default port is 5432, Oracle default port is 1521 and SQL Server default port is 1433 Documentation EMR Without VPCbf89373a-be40-4c04-99f5-746742dfd7f3 CloudFormation Low Networking and Firewall Elastic MapReduce Cluster (EMR) should be launched in a Virtual Private Cloud (VPC) Documentation ElastiCache Without VPCba766c53-fe71-4bbb-be35-b6803f2ef13e CloudFormation Low Networking and Firewall ElastiCache should be launched in a Virtual Private Cloud (VPC) Documentation EC2 Network ACL Duplicate Rule045ddb54-cfc5-4abb-9e05-e427b2bc96fe CloudFormation Low Networking and Firewall A Network ACL's rule numbers cannot be repeated unless one is egress and the other is ingress Documentation CloudFront Without WAF0f139403-303f-467c-96bd-e717e6cfd62d CloudFormation Low Networking and Firewall All AWS CloudFront distributions should be integrated with the Web Application Firewall (AWS WAF) service Documentation ElastiCache Using Default Port323db967-c68e-44e6-916c-a777f95af34b CloudFormation Low Networking and Firewall ElastiCache should not use the default port (an attacker can easily guess the port). For engine set to Redis, the default port is 6379. The Memcached default port is 11211 Documentation EC2 Instance Using Default VPCe42a3ef0-5325-4667-84bf-075ba1c9d58e CloudFormation Low Networking and Firewall EC2 Instances should not be configured under a default VPC network Documentation Redshift Using Default Porta478af30-8c3a-404d-aa64-0b673cee509a CloudFormation Low Networking and Firewall Redshift should not use the default port (5439) because an attacker can easily guess the port Documentation Shield Advanced Not In Usead7444cf-817a-4765-a79e-2145f7981faf CloudFormation Low Networking and Firewall AWS Shield Advanced should be used for Amazon Route 53 hosted zone, AWS Global Accelerator accelerator, Elastic IP Address, Elastic Load Balancing, and Amazon CloudFront Distribution to protect these resources against robust DDoS attacks Documentation CloudTrail Log File Validation Disabled2a3560fe-52ca-4443-b34f-bf0ed5eb74c8 CloudFormation Low Observability CloudTrail log file validation should be enabled to determine whether a log file has not been tampered Documentation API Gateway Deployment Without API Gateway UsagePlan Associated783860a3-6dca-4c8b-81d0-7b62769ccbca CloudFormation Low Observability API Gateway Deployment should have API Gateway UsagePlan defined and associated. Documentation VPC FlowLogs Disabledf6d299d2-21eb-41cc-b1e1-fe12d857500b CloudFormation Low Observability Every VPC resource should have an associated Flow Log Documentation Lambda Functions Without X-Ray Tracing9488c451-074e-4cd3-aee3-7db6104f542c CloudFormation Low Observability AWS Lambda functions should have TracingConfig enabled. For this, property 'tracingConfig.mode' should have the value 'Active' Documentation ECS Task Definition HealthCheck Missingd24389b4-b209-4ff0-8345-dc7a4569dcdd CloudFormation Low Observability Amazon ECS must have the HealthCheck property defined to give more control over monitoring the health of tasks Documentation API Gateway Stage Without API Gateway UsagePlan Associated7f8f1b60-43df-4c28-aa21-fb836dbd8071 CloudFormation Low Resource Management API Gateway Stage should have API Gateway UsagePlan defined and associated. Documentation VPC Without Attached Subnet3b3b4411-ad1f-40e7-b257-a78a6bb9673a CloudFormation Low Resource Management VPCs without attached subnets may indicate that they are not being used Documentation SDB Domain Declared As A Resource6ea57c8b-f9c0-4ec7-bae3-bd75a9dee27d CloudFormation Low Resource Management SimpleDB Domain resource should not be declared Documentation ECS Task Definition Invalid CPU or Memoryf4c9b5f5-68b8-491f-9e48-4f96644a1d51 CloudFormation Low Resource Management In ECS Task Definition of FARGATE launch type if you specify an invalid CPU or Memory value, you will receive an error Documentation Security Group Rule Without Description5e6c9c68-8a82-408e-8749-ddad78cbb9c5 CloudFormation Info Best Practices It's considered a best practice for AWS Security Group to have a description Documentation EC2 Not EBS Optimized8dd0ff1f-0da4-48df-9bb3-7f338ae36a40 CloudFormation Info Best Practices It's considered a best practice for an EC2 instance to use an EBS optimized instance. This provides the best performance for your EBS volumes by minimizing contention between Amazon EBS I/O and other traffic from your instance Documentation BOM - AWS DynamoDB4e67c0ae-38a0-47f4-a50c-f0c9b75826df CloudFormation Trace Bill Of Materials A list of DynamoDB resources found. Amazon DynamoDB is a fully managed, serverless, key-value NoSQL database designed to run high-performance applications at any scale. Documentation BOM - AWS MQ209189f3-c879-48a7-9703-fbcfa96d0cef CloudFormation Trace Bill Of Materials A list of MQ resources found. Amazon MQ is a managed message broker service for Apache ActiveMQ and RabbitMQ that makes it easy to set up and operate message brokers on AWS. Documentation BOM - AWS Cassandra124b173b-e06d-48a6-8acd-f889443d97a4 CloudFormation Trace Bill Of Materials A list of Cassandra resources found. Amazon Cassandra is an open-source NoSQL database designed to store data for applications that require fast read and write performance Documentation BOM - AWS RDS6ef03ff6-a2bd-483c-851f-631f248bc0ea CloudFormation Trace Bill Of Materials A list of RDS resources found. Amazon Relational Database Service (Amazon RDS) is a collection of managed services that makes it simple to set up, operate, and scale databases in the cloud. Documentation BOM - AWS Elasticachec689f51b-9203-43b3-9d8b-caed123f706c CloudFormation Trace Bill Of Materials A list of Elasticache resources found. Amazon ElastiCache is a fully managed, in-memory caching service supporting flexible, real-time use cases. You can use ElastiCache for caching, which accelerates application and database performance, or as a primary data store for use cases that don't require durability like session stores, gaming leaderboards, streaming, and analytics. ElastiCache is compatible with Redis and Memcached. Documentation BOM - AWS SNS42e7dca3-8cce-4325-8df0-108888259136 CloudFormation Trace Bill Of Materials A list of SNS resources specified. Amazon Simple Notification Service (Amazon SNS) is a fully managed messaging service for both application-to-application (A2A) and application-to-person (A2P) communication. Documentation BOM - AWS EFSef05a925-8568-4054-8ff1-f5ba82631c16 CloudFormation Trace Bill Of Materials A list of EFS resources found. Amazon Elastic File System (Amazon EFS) automatically grows and shrinks as you add and remove files with no need for management or provisioning. Documentation BOM - AWS Kinesisd53323be-dde6-4457-9a43-42df737e71d2 CloudFormation Trace Bill Of Materials A list of Kinesis resources found. Amazon Kinesis is a real-time streaming service that provides collection, processing, and analysis of video and data streams in real-time Documentation BOM - AWS MSK2730c169-51d7-4ae7-99b5-584379eff1bb CloudFormation Trace Bill Of Materials A list of MSK resources specified. Amazon Managed Streaming for Apache Kafka (Amazon MSK) is a fully managed service that enables you to build and run applications that use Apache Kafka to process streaming data. Documentation BOM - AWS EBS0b0556ea-9cd9-476f-862e-20679dda752b CloudFormation Trace Bill Of Materials A list of EBS resources found. Amazon Elastic Block Store (Amazon EBS) is an easy-to-use, scalable, high-performance block-storage service designed for Amazon Elastic Compute Cloud (Amazon EC2). Documentation BOM - AWS S3 Bucketsb5d6a2e0-8f15-4664-bd5b-68ec5c9bab83 CloudFormation Trace Bill Of Materials A list of S3 resources found. Amazon Simple Storage Service (Amazon S3) is an object storage service that offers industry-leading scalability, data availability, security, and performance. Documentation BOM - AWS SQS59a849c2-1127-4023-85a5-ef906dcd458c CloudFormation Trace Bill Of Materials A list of SQS resources specified. Amazon Simple Queue Service (SQS) is a fully managed message queuing service that enables you to decouple and scale microservices, distributed systems, and serverless applications. Documentation Serverless Function Environment Variables Not Encrypteda7f8ac28-eed1-483d-87c8-4c325f022572 CloudFormation High Encryption AWS Serverless Function should encrypt environment variables Documentation Serverless API Without Content Encodinga2f2800e-614b-4bc8-89e6-fec8afd24800 CloudFormation Medium Encryption AWS Serverless API should enable Content Encoding through the attribute 'MinimumCompressionSize'. This value should be greater than -1 and smaller than 10485760 Documentation Serverless Function Without Unique IAM Role4ba74f01-aba5-4be2-83bc-be79ff1a3b92 CloudFormation Medium Insecure Configurations AWS Serverless Function should not share IAM Role to ensure it will have the minimum privileges needed to perform the required tasks Documentation Serverless Function Without Tagsa71ecabe-03b6-456a-b3bc-d1a39aa20c98 CloudFormation Medium Insecure Configurations AWS Serverless Function should have associated tags Documentation Serverless API Endpoint Config Not Private6b5b0313-771b-4319-ad7a-122ee78700ef CloudFormation Medium Networking and Firewall AWS Serverless API should set API Endpoint Config type to 'PRIVATE'. This way, it's not exposed to the public internet Documentation Serverless API Access Logging Setting Undefined0a994e04-c6dc-471d-817e-d37451d18a3b CloudFormation Medium Observability AWS Serverless API/AWS Serverless HTTP API should have Access Logging Setting(s) defined Documentation Serverless API X-Ray Tracing Disabledc757c6a3-ac87-4b9d-b28d-e5a5add6a315 CloudFormation Medium Observability AWS Serverless API should have X-Ray Tracing enabled Documentation Serverless API Cache Cluster Disabled60a05ede-0a68-4d0d-a58f-f538cf55ff79 CloudFormation Low Insecure Configurations AWS Serverless API should have cache clustering enabled Documentation Serverless Function Without Dead Letter Queuecb2f612b-ed42-4ff5-9fb9-255c73d39a18 CloudFormation Low Insecure Configurations AWS Serverless Function should be configured for a Dead Letter Queue(DLQ) Documentation Serverless Function Without X-Ray Tracingdc1ab429-1481-4540-9b1d-280e3f15f1f8 CloudFormation Low Observability AWS Serverless Function should have Tracing enabled. For this, property 'Tracing' should have the value 'Active' Documentation Serving Revision Spec Without Timeout Secondse8bb41e4-2f24-4e84-8bea-8c7c070cf93d Knative Info Insecure Configurations Serving Revision Spec should have Timeout Seconds defined to avoid Denial of Service Documentation Serverless Role With Full Privileges59ebb4f3-2a6c-46dc-b4f0-cc5418dcddcd ServerlessFW High Access Control Roles defined in Serverless files should not have policies granting full administrative privileges. Documentation Serverless Function Environment Variables Not Encrypted4495bc5d-4d1e-4a26-ae92-152d18195648 ServerlessFW High Encryption Serverless Function should encrypt environment variables Documentation Serverless API Without Content Encodingd5d1fe08-89db-440c-8725-b93223387309 ServerlessFW Medium Encryption Serverless should have API Gateway with Content Encoding enabled through the attribute 'minimumCompressionSize'. This value should be greater than -1 and smaller than 10485760 Documentation Serverless Function Without Unique IAM Role165aae3b-a56a-48f3-b76d-d2b5083f5b8f ServerlessFW Medium Insecure Configurations Serverless Function should not share IAM Role to ensure it will have the minimum privileges needed to perform the required tasks Documentation Serverless Function Without Tagsf99d3482-fa8c-4f79-bad9-35212dded164 ServerlessFW Medium Insecure Configurations Serverless Function should be have associated tags Documentation Serverless API Endpoint Config Not Private4d424558-c6d1-453c-be98-9a7f877abd9a ServerlessFW Medium Networking and Firewall Serverless should have endpointType set to 'PRIVATE'. This way, it's not exposed to the public internet Documentation Serverless API Access Logging Setting Undefineda4d32883-aac7-42e1-b403-9415af0f3846 ServerlessFW Medium Observability Serverless FW API should have HTTP Access Logging enabled Documentation Serverless API X-Ray Tracing Disabled434945e5-4dfd-41b1-aba1-47075ccd9265 ServerlessFW Medium Observability Serverless API Gateway should have X-Ray Tracing enabled Documentation Serverless Function Without Dead Letter Queuedec7bc85-d156-4f64-9a33-96ed3d9f3fed ServerlessFW Low Insecure Configurations Serverless Function should be configured for a Dead Letter Queue(DLQ). A Dead Letter Queue(DLQ) can be set up in 'onError' config parameter Documentation Serverless Function Without X-Ray Tracing0d7ef70f-e176-44e6-bdba-add3e429788d ServerlessFW Low Observability Serverless Function should have Tracing enabled. For this, property 'tracing' should have the value 'Active' Documentation ElastiCache Nodes Not Created Across Multi AZ9b18fc19-7fb8-49b1-8452-9c757c70f926 Pulumi Medium Availability ElastiCache Nodes should be created across multi az, which means 'AZMode' should be set to 'cross-az' in multi nodes cluster Documentation ElastiCache Redis Cluster Without Backupe93bbe63-a631-4c0f-b6ef-700d48441ff2 Pulumi Medium Backup ElastiCache Redis cluster should have 'snapshotRetentionLimit' higher than 0 Documentation IAM Password Without Lowercase Letterde92dd34-1b88-43e8-b825-6e02d73c4549 Pulumi Medium Best Practices IAM Password should have at least one lowercase letter Documentation IAM Password Without Minimum Length9850d621-7485-44f7-8bdd-b3cf426315cf Pulumi Medium Best Practices IAM password should have the required minimum length Documentation DynamoDB Table Not Encryptedb6a7e0ae-aed8-4a19-a993-a95760bf8836 Pulumi Medium Encryption AWS DynamoDB Tables should have serverSideEncryption enabled Documentation API Gateway Without SSL Certificatef27791a5-e2ae-4905-8910-6f995c576d09 Pulumi Medium Insecure Configurations SSL Client Certificate should be defined Documentation API Gateway Access Logging Disabledbf4b48b9-fc1f-4552-984a-4becdb5bf503 Pulumi Medium Observability API Gateway should have Access Log Settings defined Documentation EC2 Not EBS Optimizedd991e4ae-42ab-429b-ab43-d5e5fa9ca633 Pulumi Info Best Practices It's considered a best practice for an EC2 instance to use an EBS optimized instance. This provides the best performance for your EBS volumes by minimizing contention between Amazon EBS I/O and other traffic from your instance Documentation DynamoDB Table Point In Time Recovery Disabled327b0729-4c5c-4c44-8b5c-e476cd9c7290 Pulumi Info Best Practices It's considered a best practice to have point in time recovery enabled for DynamoDB Table Documentation EC2 Instance Monitoring Disableddaa581ef-731c-4121-832d-cf078f67759d Pulumi Info Observability EC2 Instance should have detailed monitoring enabled. With detailed monitoring enabled data is available in 1-minute periods Documentation PSP Set To Privilegedee305555-6b1d-4055-94cf-e22131143c34 Pulumi Medium Insecure Configurations Do not allow pod to request execution as privileged. Documentation Missing App Armor Config95588189-1abd-4df1-9588-b0a5034f9e87 Pulumi Low Access Control Containers should be configured with AppArmor for any application to reduce its potential attack Documentation Cloud Storage Bucket Logging Not Enabled48f7e44d-d1d1-44c2-b336-9f11b65c4fb0 Pulumi High Observability Cloud storage bucket should have logging enabled Documentation Google Compute SSL Policy Weak Cipher In Use965e8830-2bec-4b9b-a7f0-24dbc200a68f Pulumi Medium Encryption This query confirms if Google Compute SSL Policy Weak Chyper Suits is Enabled, to do so we need to check if TLS is TLS_1_2, because other version have Weak Chypers Documentation Storage Account Not Forcing HTTPScb8e4bf0-903d-45c6-a278-9a947d82a27b Pulumi High Encryption Storage Accounts should enforce the use of HTTPS Documentation Redis Cache Allows Non SSL Connections49e30ac8-f58e-4222-b488-3dcb90158ec1 Pulumi Medium Encryption Redis Cache resource should not allow non-SSL connections. Documentation Passwords And Secretsa88baa34-e2ad-44ea-ad6f-8cac87bc7c71 Common High Secret Management Query to find passwords and secrets in infrastructure code. Documentation EFS Without KMSbdecd6db-2600-47dd-a10c-72c97cf17ae9 Crossplane High Encryption Amazon Elastic Filesystem should have filesystem encryption enabled using KMS CMK customer-managed keys instead of AWS managed-keys Documentation DB Instance Storage Not Encryptede50eb68a-a4af-4048-8bbe-8ec324421469 Crossplane High Encryption RDS Instance should have its storage encrypted by setting the parameter to 'true'. The storageEncrypted default value is 'false'. Documentation ELB Using Weak Ciphersa507daa5-0795-4380-960b-dd7bb7c56661 Crossplane High Encryption ELB Predefined or Custom Security Policies must not use weak ciphers, to reduce the risk of the SSL connection between the client and the load balancer being exploited. That means the 'sslPolicy' of 'Listener' must not coincide with any of a predefined list of weak ciphers. Documentation EFS Not Encrypted72840c35-3876-48be-900d-f21b2f0c2ea1 Crossplane High Encryption Elastic File System (EFS) must be encrypted Documentation CloudFront Without Minimum Protocol TLS 1.2255b0fcc-9f82-41fe-9229-01b163e3376b Crossplane High Insecure Configurations CloudFront Minimum Protocol version should be at least TLS 1.2 Documentation DB Security Group Has Public Interfacedd667399-8d9d-4a8d-bbb4-e49ab53b2f52 Crossplane High Insecure Configurations The CIDR IP should not be a public interface Documentation Neptune Database Cluster Encryption Disabled83bf5aca-138a-498e-b9cd-ad5bc5e117b4 Crossplane Medium Encryption Neptune database cluster storage should have encryption enabled Documentation SQS With SSE Disabled9296f1cc-7a40-45de-bd41-f31745488a0e Crossplane Medium Encryption Amazon Simple Queue Service (SQS) queue should protect the contents of their messages using Server-Side Encryption (SSE) Documentation CloudFront Logging Disabled7b590235-1ff4-421b-b9ff-5227134be9bb Crossplane Medium Observability AWS CloudFront distributions should have logging enabled to collect all viewer requests, which means the attribute 'logging' must be defined with 'enabled' set to true Documentation CloudWatch Without Retention Period Specified934613fe-b12c-4e5a-95f5-c1dcdffac1ff Crossplane Medium Observability AWS CloudWatch should have CloudWatch Logs enabled in order to monitor, store, and access log events Documentation CloudFront Without WAF6d19ce0f-b3d8-4128-ac3d-1064e0f00494 Crossplane Low Networking and Firewall All AWS CloudFront distributions should be integrated with the Web Application Firewall (AWS WAF) service Documentation Cloud Storage Bucket Logging Not Enabled6c2d627c-de0f-45fb-b33d-dad9bffbb421 Crossplane High Observability Cloud storage bucket should have logging enabled Documentation Google Container Node Pool Auto Repair Disabledb4f65d13-a609-4dc1-af7c-63d2e08bffe9 Crossplane Medium Insecure Configurations Google Container Node Pool Auto Repair should be enabled. This service periodically checks for failing nodes and repairs them to ensure a smooth running state. Documentation AKS RBAC Disabledb2418936-cd47-4ea2-8346-623c0bdb87bd Crossplane Medium Access Control Azure Container Service (AKS) instance should have role-based access control (RBAC) enabled Documentation Redis Cache Allows Non SSL Connections6c7cfec3-c686-4ed2-bf58-a1ec054b63fc Crossplane Medium Encryption Redis Cache resource should not allow non-SSL connections. Documentation Enum Name Not CamelCasedaaace5f-c0dc-4835-b526-7a116b7f4b4e GRPC Low Best Practices All Enum Names should follow CamelCase and start with Capital Letter Documentation Run Using apta1bc27c6-7115-48d8-bf9d-5a7e836845ba Buildah Medium Supply-Chain apt is discouraged by the linux distributions as an unattended tool as its interface may suffer changes between versions. Better use the more stable apt-get and apt-cache Documentation Key Vault Not Recoverable7c25f361-7c66-44bf-9b69-022acd5eb4bd AzureResourceManager High Backup Key Vault should have 'enableSoftDelete' and 'enablePurgeProtection' set to true Documentation Secret Without Expiration Datecff9c3f7-e8f0-455f-9fb4-5f72326da96e AzureResourceManager High Best Practices All Secrets must have an expiration date defined Documentation Azure Instance Using Basic Authentication6797f581-0433-4768-ae3e-7ceb2f8b138e AzureResourceManager High Best Practices Azure Instances should use SSH Key instead of basic authentication Documentation Azure Managed Disk Without Encryption350f3955-b5be-436f-afaa-3d2be2fa6cdd AzureResourceManager High Encryption Azure Disk Encryption should be enabled Documentation Storage Account Allows Unsecure Transfer1367dd13-2c90-4020-80b7-e4339a3dc2c4 AzureResourceManager High Encryption 'Microsoft.Storage/storageAccounts' should force the use of HTTPS Documentation Web App Not Using TLS Last Versionb5c851d5-00f1-43dc-a8de-3218fd6f71be AzureResourceManager High Encryption Resources of type 'Microsoft.Web/sites' should define 'properties.siteConfig.minTlsVersion' with '1.2' Documentation Website Not Forcing HTTPS488847ff-6031-487c-bf42-98fd6ac5c9a0 AzureResourceManager High Insecure Configurations 'Microsoft.Web/sites' should force the use of HTTPS Documentation MySQL Server SSL Enforcement Disabled90120147-f2e7-4fda-bb21-6fa9109afd63 AzureResourceManager High Networking and Firewall 'Microsoft.DBforMySQL/servers' should enforce SSL Documentation Website with Client Certificate Auth Disabled92302b47-b0cc-46cb-a28f-5610ecda140b AzureResourceManager High Networking and Firewall 'Microsoft.Web/sites' should have client certificate authentication enabled Documentation SQL Database Server Firewall Allows All IPS6a3201a5-1630-494b-b294-3129d06b0eca AzureResourceManager High Networking and Firewall SQL Database Server Firewall endIpAddress should not be '255.255.255.255' when startIpAddress is '0.0.0.0' since this allows all IPS Documentation Network Security Group With Unrestricted Access To RDP59cb3da7-f206-4ae6-b827-7abf0a9cab9d AzureResourceManager High Networking and Firewall Port 3389 (Remote Desktop) is exposed to the Internet Documentation Network Security Group With Unrestricted Access To SSH2ade1579-4b2c-4590-bebb-f99bf597f612 AzureResourceManager High Networking and Firewall Port 22 (SSH) is exposed to the Internet Documentation PostgreSQL Database Server SSL Disabledbf500309-da53-4dd3-bcf7-95f7974545a5 AzureResourceManager High Networking and Firewall Microsoft.DBforPostgreSQL/servers sslEnforcement property should be set to 'Enabled' Documentation Storage Blob Service Container With Public Accessa0ab985d-660b-41f7-ac81-70957ee8e627 AzureResourceManager High Networking and Firewall Storage Blob Service Container should not publicly accessible Documentation Trusted Microsoft Services Not Enablede25b56cd-a4d6-498f-ab92-e6296a082097 AzureResourceManager High Networking and Firewall Trusted Microsoft Services should be enabled for Storage Account access Documentation AKS Cluster RBAC Disabled9307a2ed-35c2-413d-94de-a1a0682c2158 AzureResourceManager Medium Access Control Microsoft.ContainerService/managedClusters should have enableRBAC set to true Documentation Role Definitions Allow Custom Subscription Role Creation8fa9ceea-881f-4ef0-b0b8-728f589699a7 AzureResourceManager Medium Access Control Role Definitions should not allow custom subscription role creation (actions set to '*' or 'Microsoft.Authorization/roleDefinitions/write') Documentation SQL Server Database With Alerts Disabled574e8d82-1db2-4b9c-b526-e320ede9a9ff AzureResourceManager Medium Best Practices All Alerts should be enabled in SQL Database Server SecurityAlerts Policy Properties Documentation AKS Cluster Network Policy Not Configured25c0228e-4444-459b-a2df-93c7df40b7ed AzureResourceManager Medium Insecure Configurations Azure Kubernetes Service must have a network policy defined. Documentation AKS With Authorized IP Ranges Disabled2583fab1-953b-4fae-bd02-4a136a6c21f9 AzureResourceManager Medium Networking and Firewall Azure Kubernetes Service must have an authorized IP range for API Services enabled Documentation Standard Price Is Not Selected2081c7d6-2851-4cce-bda5-cb49d462da42 AzureResourceManager Medium Networking and Firewall Azure Security Center provides more features for standard pricing mode, so it must be activated. Documentation PostgreSQL Database Server Log Checkpoints Disabledf9112910-c7bb-4864-9f5e-2059ba413bb7 AzureResourceManager Medium Networking and Firewall Microsoft.DBforPostgreSQL/servers/configurations should have 'log_checkpoint' property set to 'on' Documentation PostgreSQL Database Server Log Connections Disablede69bda39-e1e2-47ca-b9ee-b6531b23aedd AzureResourceManager Medium Networking and Firewall Microsoft.DBforPostgreSQL/servers/configurations should have 'log_connections' property set to 'on' Documentation PostgresSQL Database Server Connection Throttling Disableda6d774b6-d9ea-4bf4-8433-217bf15d2fb8 AzureResourceManager Medium Networking and Firewall Microsoft.DBforPostgreSQL/servers/configurations should have 'connection_throttling' property set to 'on' Documentation Unrecommended Log Profile Retention Policy25684eac-daaa-4c2c-94b4-8d2dbb627909 AzureResourceManager Medium Observability Log Profile Retention Policy should be enabled and the recommended number of days for the retention should be higher than 365 or 0 (0 will retain the events indefinitely) Documentation Storage Logging For Read Write And Delete Requests Disabled43f6e60c-9cdb-4e77-864d-a66595d26518 AzureResourceManager Medium Observability Storage Logging should be enabled for read, write and delete methods Documentation AKS Logging To Azure Monitoring Is Disabled9b09dee1-f09b-4013-91d2-158fa4695f4b AzureResourceManager Medium Observability Azure Kubernetes Service should have logging to Azure Monitoring enabled. Documentation Log Profile Incorrect Category4d522e7b-f938-4d51-a3b1-974ada528bd3 AzureResourceManager Medium Observability Log Profile Categories should be set to 'Write', 'Delete', and/or 'Action' Documentation Unrecommended Network Watcher Flow Log Retention Policy564b70f8-41cd-4690-aff8-bb53add86bc9 AzureResourceManager Medium Observability Network Watcher Flow Log Retention Policy should be enabled and the recommended number of days for the retention should be higher than 90 Documentation SQL Server Database Without Auditinge055285c-bc01-48b4-8aa5-8a54acdd29df AzureResourceManager Medium Observability Every 'Microsoft.Sql/servers/databases' resource should have Auditing Enabled Documentation SQL Server Database With Unrecommended Retention Daysc09cdac2-7670-458a-bf6c-efad6880973a AzureResourceManager Medium Observability SQL Server Database Auditing Settings should keep the audit logs in the storage account for at least 90 days Documentation Hardcoded SecureString Parameter Default Value4d2cf896-c053-4be5-9c95-8b4771112f29 AzureResourceManager Medium Secret Management Secure parameters should not have hardcoded default value Documentation Website Azure Active Directory Disablede9c133e5-c2dd-4b7b-8fff-40f2de367b56 AzureResourceManager Low Access Control WebApp should have Azure Active Directory  enabled with 'identity.type' set to 'SystemAssigned' or 'userAssignedIdentities' set to 'true' Documentation Phone Number Not Set For Security Contacts3e9fcc67-1f64-405f-b2f9-0a6be17598f0 AzureResourceManager Low Best Practices Microsoft.Security securityContacts should have a phone number defined Documentation AKS Dashboard Is Enabledc62d3b92-9a11-4ffd-b7b7-6faaae83faed AzureResourceManager Low Insecure Configurations Azure Kubernetes Service should have the Kubernetes dashboard disabled. Documentation Website with 'Http20Enabled' Disabled70111098-7f85-48f0-b1b4-e4261cf5f61b AzureResourceManager Low Networking and Firewall 'Microsoft.Web/sites' should have 'Http20Enabled' enabled Documentation Storage Account Allows Default Network Access9073f073-5d60-4b46-b569-0d6baa80ed95 AzureResourceManager Low Networking and Firewall 'Microsoft.Storage/storageAccounts' should force the use of HTTPS Documentation App Service Authentication Is Not Set83130a07-235b-4a80-918b-a370e53f0bd9 AzureResourceManager Info Access Control Azure App Service should have App Service Authentication set Documentation Account Admins Not Notified By Emaila8852cc0-fd4b-4fc7-9372-1e43fad0732e AzureResourceManager Info Best Practices Account admins should be notified by email in the event of security alerts Documentation SQL Alert Policy Without Emails89b79fe5-49bd-4d39-84ce-55f5fc6f7764 AzureResourceManager Info Best Practices SQL Database Server should contain emails to be notified in the event of a Security Alert Documentation Email Notifications Disabled79c2c2c0-eb00-47c0-ac16-f8b0e2c81c92 AzureResourceManager Info Networking and Firewall Email notifications about new security alerts, should be set to 'On', and be sent to persons with specific RBAC roles on the subscription Documentation UNIX Ports Out Of Range71bf8cf8-f0a1-42fa-b9d2-d10525e0a38e Dockerfile High Availability Exposing UNIX ports out of range from 0 to 65535 Documentation Multiple ENTRYPOINT Instructions Listed6938958b-3f1a-451c-909b-baeee14bdc97 Dockerfile High Build Process There can only be one ENTRYPOINT instruction in a Dockerfile. Only the last ENTRYPOINT instruction in the Dockerfile will have an effect Documentation Copy With More Than Two Arguments Not Ending With Slash6db6e0c2-32a3-4a2e-93b5-72c35f4119db Dockerfile High Build Process When a COPY command has more than two arguments, the last one should end with a slash Documentation COPY '--from' References Current FROM Aliascdddb86f-95f6-4fc4-b5a1-483d9afceb2b Dockerfile High Build Process COPY '--from' should not mention the current FROM alias, since it is impossible to copy from itself Documentation Missing User Instructionfd54f200-402c-4333-a5a4-36ef6709af2f Dockerfile High Build Process A user should be specified in the dockerfile, otherwise the image will run as root Documentation Same Alias In Different Fromsf2daed12-c802-49cd-afed-fe41d0b82fed Dockerfile High Build Process Different FROMS cant have the same alias defined Documentation WORKDIR Path Not Absolute6b376af8-cfe8-49ab-a08d-f32de23661a4 Dockerfile High Build Process For clarity and reliability, you should always use absolute paths for your WORKDIR Documentation Run Using Sudo8ada6e80-0ade-439e-b176-0b28f6bce35a Dockerfile High Insecure Configurations Avoid RUN with sudo command as it leads to unpredictable behavior Documentation Vulnerable OpenSSL Version5fa731ea-e844-47a6-a1e8-abc25e95847e Dockerfile High Supply-Chain OpenSSL versions from 3.0.0 to 3.0.5 are affected by a critical vulnerability Documentation Last User Is 'root'67fd0c4a-68cf-46d7-8c41-bc9fba7e40ae Dockerfile Medium Best Practices Leaving the last user as root can cause security risks. Change to another user after running the commands the need privileges Documentation Changing Default Shell Using RUN Command8a301064-c291-4b20-adcb-403fe7fd95fd Dockerfile Medium Best Practices Using the command RUN to override the default shell instead of the SHELL command leads to inefficiencies. It also does not make sense since Docker provides the SHELL command for this exact purpose. Documentation Multiple CMD Instructions Listed41c195f4-fc31-4a5c-8a1b-90605538d49f Dockerfile Medium Build Process There can only be one CMD instruction in a Dockerfile. If you list more than one CMD then only the last CMD will take effect Documentation Update Instruction Alone9bae49be-0aa3-4de5-bab2-4c3a069e40cd Dockerfile Medium Build Process Instruction 'RUN  update' should always be followed by ' install' in the same RUN statement Documentation Not Using JSON In CMD And ENTRYPOINT Argumentsb86987e1-6397-4619-81d5-8807f2387c79 Dockerfile Medium Build Process Ensure that we are using JSON in the CMD and ENTRYPOINT Arguments Documentation RUN Instruction Using 'cd' Instead of WORKDIRf4a6bcd3-e231-4acf-993c-aa027be50d2e Dockerfile Medium Build Process When using RUN command 'cd' should only be used for full path. For relative path make use of WORKDIR command instead. Documentation Shell Running A Pipe Without Pipefail Flagefbf148a-67e9-42d2-ac47-02fa1c0d0b22 Dockerfile Medium Insecure Defaults Check if shell commands with pipes (except Powershell) have the pipefail flag set (-o). Documentation Missing Flag From Dnf Install7ebd323c-31b7-4e5b-b26f-de5e9e477af8 Dockerfile Medium Supply-Chain The '-y' or '--assumeyes' flag should be added when invoking dnf install. If omitted, it can cause the command to fail during the build process, because dnf would expect manual input. Documentation Unpinned Package Version in Pip Install02d9c71f-3ee8-4986-9c27-1a20d0d19bfc Dockerfile Medium Supply-Chain Package version pinning reduces the range of versions that can be installed, reducing the chances of failure due to unanticipated changes Documentation Missing Dnf Clean All295acb63-9246-4b21-b441-7c1f1fb62dc0 Dockerfile Medium Supply-Chain Cached package data should be cleaned after installation to reduce image size Documentation Gem Install Without Version22cd11f7-9c6c-4f6e-84c0-02058120b341 Dockerfile Medium Supply-Chain Instead of 'gem install ' we should use 'gem install :' Documentation Unpinned Package Version in Apk Addd3499f6d-1651-41bb-a9a7-de925fea487b Dockerfile Medium Supply-Chain Package version pinning reduces the range of versions that can be installed, reducing the chances of failure due to unanticipated changes Documentation Add Instead of Copy9513a694-aa0d-41d8-be61-3271e056f36b Dockerfile Medium Supply-Chain Using ADD to load external installation scripts could lead to an evil web server leveraging this and loading a malicious script. Documentation Pip install Keeping Cached Packagesf2f903fb-b977-461e-98d7-b3e2185c6118 Dockerfile Medium Supply-Chain When installing packages with pip, the '--no-cache-dir' flag should be set to make Docker images smaller Documentation Image Version Not Explicit9efb0b2d-89c9-41a3-91ca-dcc0aec911fd Dockerfile Medium Supply-Chain Always tag the version of an image explicitly Documentation Missing Zypper Clean38300d1a-feb2-4a48-936a-d1ef1cd24313 Dockerfile Medium Supply-Chain Reduce layer and image size by deleting unneeded caches after running zypper Documentation Using Platform Flag with FROM Commandb16e8501-ef3c-44e1-a543-a093238099c9 Dockerfile Medium Supply-Chain Don't use '--platform' flag with FROM Documentation Run Using 'wget' and 'curl'fc775e75-fcfb-4c98-b2f2-910c5858b359 Dockerfile Medium Supply-Chain Shouldn't use both 'wget' and 'curl' since they are two tools that have the same effect Documentation Yum Clean All Missing00481784-25aa-4a55-8633-3136dfcf4f37 Dockerfile Medium Supply-Chain Need to use 'yum clean all' after using a 'yum install' command to clean package cached data and reduce image size Documentation Missing Version Specification In dnf install93d88cf7-f078-46a8-8ddc-178e03aeacf1 Dockerfile Medium Supply-Chain Specifying a package version allows to reduce failures due to unanticipated changes in required packages. Documentation Missing Zypper Non-interactive Switch45e1fca5-f90e-465d-825f-c2cb63fa3944 Dockerfile Medium Supply-Chain Omitting the non-interactive switch causes the command to fail during the build process, because zypper would expect manual input Documentation Yum Install Allows Manual Input6e19193a-8753-436d-8a09-76dcff91bb03 Dockerfile Medium Supply-Chain Need to use -y to avoid manual input 'yum install -y ' Documentation Apt Get Install Pin Version Not Defined965a08d7-ef86-4f14-8792-4a3b2098937e Dockerfile Medium Supply-Chain When installing a package, its pin version should be defined Documentation NPM Install Command Without Pinned Versione36d8880-3f78-4546-b9a1-12f0745ca0d5 Dockerfile Medium Supply-Chain Check if packages installed by npm are pinning a specific version. Documentation Image Version Using 'latest'f45ea400-6bbe-4501-9fc7-1c3d75c32067 Dockerfile Medium Supply-Chain When building images, always tag them with useful tags which codify version information, intended destination (prod or test, for instance), stability, or other information that is useful when deploying the application in different environments. Do not rely on the automatically-created latest tag Documentation Run Using aptb84a0b47-2e99-4c9f-8933-98bcabe2b94d Dockerfile Medium Supply-Chain apt is discouraged by the linux distributions as an unattended tool as its interface may suffer changes between versions. Better use the more stable apt-get and apt-cache Documentation Zypper Install Without Version562952e4-0348-4dea-9826-44f3a2c6117b Dockerfile Medium Supply-Chain Not specifying the package version can cause failures due to unanticipated changes in required packages Documentation Yum install Without Version6452c424-1d92-4deb-bb18-a03e95d579c4 Dockerfile Medium Supply-Chain Not specifying the package version can cause failures due to unanticipated changes in required packages Documentation APT-GET Missing '-y' To Avoid Manual Input77783205-c4ca-4f80-bb80-c777f267c547 Dockerfile Medium Supply-Chain Check if apt-get calls use the flag -y to avoid user manual input. Documentation Multiple RUN, ADD, COPY, Instructions Listed0008c003-79aa-42d8-95b8-1c2fe37dbfe6 Dockerfile Low Best Practices Multiple commands (RUN, COPY, ADD) should be grouped in order to reduce the number of layers. Documentation MAINTAINER Instruction Being Used99614418-f82b-4852-a9ae-5051402b741c Dockerfile Low Best Practices The MAINTAINER instruction sets the Author field of the generated images. The LABEL instruction is a much more flexible version of this and you should use it instead, as it enables setting any metadata you require, and can be viewed easily Documentation Chown Flag Existsaa93e17f-b6db-4162-9334-c70334e7ac28 Dockerfile Low Best Practices It is considered a best practice for every executable in a container to be owned by the root user even if it is executed by a non-root user, only execution permissions are required on the file, not ownership Documentation Curl or Wget Instead of Add4b410d24-1cbe-4430-a632-62c9a931cf1c Dockerfile Low Best Practices Use of Curl or Wget should be done instead of Add to fetch packages from remote URLs due to the use of Add being strongly discouraged Documentation Exposing Port 22 (SSH)5907595b-5b6d-4142-b173-dbb0e73fbff8 Dockerfile Low Best Practices Expose only the ports that your application needs and avoid exposing ports like SSH (22) Documentation Using Unnamed Build Stages68a51e22-ae5a-4d48-8e87-b01a323605c9 Dockerfile Low Build Process This query is used to ensure that build stages are named. This way even if the Dockerfile is re-ordered, the COPY instruction doesn\u2019t break. Documentation Healthcheck Instruction Missingb03a748a-542d-44f4-bb86-9199ab4fd2d5 Dockerfile Low Insecure Configurations Ensure that HEALTHCHECK is being used. The HEALTHCHECK instruction tells Docker how to test a container to check that it is still working Documentation Apk Add Using Local Cache Pathae9c56a6-3ed1-4ac0-9b54-31267f51151d Dockerfile Info Supply-Chain When installing packages, use the '--no-cache' switch to avoid the need to use '--update' and remove '/var/cache/apk/*' Documentation Run Utilities And POSIX Commands9b6b0f38-92a2-41f9-b881-3a1083d99f1b Dockerfile Info Supply-Chain Some POSIX commands and interactive utilities shouldn't run inside a Docker Container Documentation APT-GET Not Avoiding Additional Packages7384dfb2-fcd1-4fbf-91cd-6c44c318c33c Dockerfile Info Supply-Chain Check if any apt-get installs don't use '--no-install-recommends' flag to avoid installing additional packages. Documentation Apt Get Install Lists Were Not Deleteddf746b39-6564-4fed-bf85-e9c44382303c Dockerfile Info Supply-Chain After using apt-get install, it is needed to delete apt-get lists Documentation S3 Bucket Allows List Action From All Principalsd395a950-12ce-4314-a742-ac5a785ab44e Ansible High Access Control S3 Buckets must not allow List Action From All Principals, as to prevent leaking private information to the entire internet or allow unauthorized data tampering / deletion. This means the 'Effect' must not be 'Allow' when the 'Action' is List, for all Principals. Documentation S3 Bucket With All Permissions6a6d7e56-c913-4549-b5c5-5221e624d2ec Ansible High Access Control S3 Buckets should not have all permissions, as to prevent leaking private information to the entire internet or allow unauthorized data tampering / deletion. This means the 'Effect' must not be 'Allow' when the 'Action' is '*', for all Principals. Documentation S3 Bucket Access to Any Principal3ab1f27d-52cc-4943-af1d-43c1939e739a Ansible High Access Control Checks if the S3 bucket is accessible for all users Documentation S3 Bucket ACL Allows Read to Any Authenticated User75480b31-f349-4b9a-861f-bce19588e674 Ansible High Access Control S3 Buckets should not be readable to any authenticated user Documentation S3 Bucket Allows Put Action From All Principalsa0f1bfe0-741e-473f-b3b2-13e66f856fab Ansible High Access Control S3 Buckets must not allow Put Action From All Principals, as to prevent leaking private information to the entire internet or allow unauthorized data tampering / deletion. This means the 'Effect' must not be 'Allow' when the 'Action' is Put, for all Principals. Documentation IAM Policies With Full Privilegese401d614-8026-4f4b-9af9-75d1197461ba Ansible High Access Control IAM policies shouldn't allow full administrative privileges (for all resources) Documentation SNS Topic is Publicly Accessible905f4741-f965-45c1-98db-f7a00a0e5c73 Ansible High Access Control SNS Topic Policy should not allow any principal to access Documentation IAM Policy Grants Full Permissionsb5ed026d-a772-4f07-97f9-664ba0b116f8 Ansible High Access Control IAM policy should not grant full permissions to resources from the get-go, instead of granting permissions gradually as necessary. Documentation Authentication Without MFAeee107f9-b3d8-45d3-b9c6-43b5a7263ce1 Ansible High Access Control Users should authenticate with MFA (Multi-factor Authentication) to ensure an extra layer of protection when authenticating Documentation SQS Queue Exposed86b0efa7-4901-4edd-a37a-c034bec6645a Ansible High Access Control Checks if the SQS Queue is exposed Documentation S3 Bucket Allows Get Action From All Principals53bce6a8-5492-4b1b-81cf-664385f0c4bf Ansible High Access Control S3 Buckets must not allow Get Action From All Principals, as to prevent leaking private information to the entire internet or allow unauthorized data tampering / deletion. This means the 'Effect' must not be 'Allow' when the 'Action' is Get, for all Principals. Documentation ECS Service Admin Role Is Present7db727c1-1720-468e-b80e-06697f71e09e Ansible High Access Control ECS Services must not have Admin roles, which means the attribute 'role' must not be an admin role Documentation S3 Bucket ACL Allows Read to All Usersa1ef9d2e-4163-40cb-bd92-04f0d602a15d Ansible High Access Control S3 Buckets should not be readable to all users Documentation S3 Bucket Allows Delete Action From All Principals6fa44721-ef21-41c6-8665-330d59461163 Ansible High Access Control S3 Buckets must not allow Delete Action From All Principals, as to prevent leaking private information to the entire internet or allow unauthorized data tampering / deletion. This means the 'Effect' must not be 'Allow' when the 'Action' is Delete, for all Principals. Documentation S3 Bucket SSE Disabled309edc5b-5a59-42b4-a357-d4d098311fd4 Ansible High Encryption If algorithm is AES256 then the master key is null, empty or undefined, otherwise the master key is required Documentation ELB Using Insecure Protocols730a5951-2760-407a-b032-dd629b55c23a Ansible High Encryption ELB Predefined or Custom Security Policies must not use insecure protocols, to reduce the risk of the SSL connection between the client and the load balancer being exploited. That means the 'SslPolicy' of 'listeners' must not coincide with any of a predefined list of insecure protocols. Documentation User Data Contains Encoded Private Keyc09f4d3e-27d2-4d46-9453-abbe9687a64e Ansible High Encryption User Data should not contain a base64 encoded private key. If so, anyone can decode the private key easily Documentation Redshift Not Encrypted6a647814-def5-4b85-88f5-897c19f509cd Ansible High Encryption AWS Redshift Cluster should be encrypted. Check if 'encrypted' field is false or undefined (default is false) Documentation EFS Without KMSbd77554e-f138-40c5-91b2-2a09f878608e Ansible High Encryption Amazon Elastic Filesystem should have filesystem encryption enabled using KMS CMK customer-managed keys instead of AWS managed-keys Documentation Cloudfront Viewer Protocol Policy Allows HTTPa6d27cf7-61dc-4bde-ae08-3b353b609f76 Ansible High Encryption Checks if the connection between CloudFront and the viewer is encrypted Documentation Secure Ciphers Disabled218413a0-c716-4b94-9e08-0bb70d854709 Ansible High Encryption Check if secure ciphers aren't used in CloudFront Documentation Launch Configuration Is Not Encrypted66477506-6abb-49ed-803d-3fa174cd5f6a Ansible High Encryption Launch Configurations should have the data in the volumes encrypted. To encrypt the data, the 'encrypted' parameter should be set to true in each volume Documentation DB Instance Storage Not Encrypted7dfb316c-a6c2-454d-b8a2-97f147b0c0ff Ansible High Encryption AWS DB Instance should have its storage encrypted by setting the parameter to 'true'. The storage_encrypted default value is 'false'. Documentation Kinesis Not Encrypted With KMSf2ea6481-1d31-4d40-946a-520dc6321dd7 Ansible High Encryption AWS Kinesis Streams and metadata should be protected with KMS Documentation ELB Using Weak Ciphers2034fb37-bc23-4ca0-8d95-2b9f15829ab5 Ansible High Encryption ELB Predefined or Custom Security Policies must not use weak ciphers, to reduce the risk of the SSL connection between the client and the load balancer being exploited. That means the 'SslPolicy' of 'listeners' must not coincide with any of a predefined list of weak ciphers. Documentation IAM Database Auth Not Enabled0ed012a4-9199-43d2-b9e4-9bd049a48aa4 Ansible High Encryption IAM Database Auth Enabled should be configured to true when using compatible engine and version Documentation User Data Shell Script Is Encoded1e2341ba-a5cf-4f0a-a5f6-47e90c68ea89 Ansible High Encryption User Data Shell Script must be encoded Documentation CA Certificate Identifier Is Outdated5eccd62d-8b4d-46d3-83ea-1879f3cbd3ce Ansible High Encryption The CA certificate Identifier must be 'rds-ca-2019'. Documentation Redis Not Compliant9f34885e-c08f-4d13-a7d1-cf190c5bd268 Ansible High Encryption Check if the redis version is compliant with the necessary AWS PCI DSS requirements Documentation ECS Task Definition Container With Plaintext Password7fdc2bf3-6bc0-4cb3-84c5-cfd041c0f892 Ansible High Encryption It's not recommended to use plaintext environment variables for sensitive information, such as credential data. Documentation AMI Not Encrypted97707503-a22c-4cd7-b7c0-f088fa7cf830 Ansible High Encryption AWS AMI Encryption is not enabled Documentation S3 Bucket Without Server-side-encryption594f54e7-f744-45ab-93e4-c6dbaf6cd571 Ansible High Encryption AWS S3 Storage should be protected with SSE (Server-Side Encryption) Documentation EFS Not Encrypted727c4fd4-d604-4df6-a179-7713d3c85e20 Ansible High Encryption Elastic File System (EFS) must be encrypted Documentation CloudFront Without Minimum Protocol TLS 1.2d0c13053-d2c8-44a6-95da-d592996e9e67 Ansible High Insecure Configurations CloudFront Minimum Protocol version should be at least TLS 1.2 Documentation EC2 Group Has Public Interface5330b503-3319-44ff-9b1c-00ee873f728a Ansible High Insecure Configurations The CIDR IP should not be a public interface Documentation Redshift Publicly Accessible5c6b727b-1382-4629-8ba9-abd1365e5610 Ansible High Insecure Configurations AWS Redshift Clusters must not be publicly accessible. Check if 'publicly_accessible' field is true (default is false) Documentation DB Instance Publicly Accessiblec09e3ca5-f08a-4717-9c87-3919c5e6d209 Ansible High Insecure Configurations RDS must not be defined with public interface, which means the field 'publicly_accessible' should not be set to 'true' (default is 'false'). Documentation S3 Bucket with Unsecured CORS Rule3505094c-f77c-4ba0-95da-f83db712f86c Ansible High Insecure Configurations If the CORS (Cross-Origin Resource Sharing) rule is defined in an S3 bucket, it should be secure Documentation ECS Task Definition Network Mode Not Recommended01aec7c2-3e4d-4274-ae47-2b8fea22fd1f Ansible High Insecure Configurations Network_Mode should be 'awsvpc' in ecs_task_definition. AWS VPCs provides the controls to facilitate a formal process for approving and testing all network connections and changes to the firewall and router configurations Documentation Root Account Has Active Access Keyse71d0bc7-d9e8-4e6e-ae90-0a4206db6f40 Ansible High Insecure Configurations The AWS Root Account must not have active access keys associated, which means if there are access keys associated to the Root Account, they must be inactive. Documentation KMS Key With Vulnerable Policy5b9d237a-57d5-4177-be0e-71434b0fef47 Ansible High Insecure Configurations Checks if the policy is vulnerable and needs updating. Documentation Batch Job Definition With Privileged Container Propertiesdefe5b18-978d-4722-9325-4d1975d3699f Ansible High Insecure Configurations Batch Job Definition should not have Privileged Container Properties Documentation Vulnerable Default SSL Certificatefb8f8929-afeb-4c46-99f0-a6cf410f7df4 Ansible High Insecure Defaults CloudFront web distributions should use custom (and not default) SSL certificates. Custom SSL certificates allow only defined users to access content by using an alternate domain name instead of the default one. Documentation Public Port Wide71ea648a-d31a-4b5a-a589-5674243f1c33 Ansible High Networking and Firewall AWS Security Group should not have public port wide Documentation Unknown Port Exposed To Internet722b0f24-5a64-4cca-aa96-cfc26b7e3a5b Ansible High Networking and Firewall AWS Security Group should not have an unknown port exposed to the entire Internet Documentation ALB Listening on HTTPf81d63d2-c5d7-43a4-a5b5-66717a41c895 Ansible High Networking and Firewall AWS Application Load Balancer (alb) should not listen on HTTP Documentation HTTP Port Open To Interneta14ad534-acbe-4a8e-9404-2f7e1045646e Ansible High Networking and Firewall The HTTP port is open to the internet in a Security Group Documentation DB Security Group Open To Large Scopeea0ed1c7-9aef-4464-b7c7-94c762da3640 Ansible High Networking and Firewall The IP address in a DB Security Group must not have more than 256 hosts. Documentation Security Group With Unrestricted Access To SSH57ced4b9-6ba4-487b-8843-b65562b90c77 Ansible High Networking and Firewall 'SSH' (TCP:22) should not be public in AWS Security Group Documentation DB Security Group With Public Scope0956aedf-6a7a-478b-ab56-63e2b19923ad Ansible High Networking and Firewall The IP address in a DB Security Group should not be '0.0.0.0/0' (IPv4) or '::/0' (IPv6). If so, any IP can access it Documentation Unrestricted Security Group Ingress83c5fa4c-e098-48fc-84ee-0a537287ddd2 Ansible High Networking and Firewall Security groups allow ingress from 0.0.0.0/0 Documentation RDS Associated with Public Subnet16732649-4ff6-4cd2-8746-e72c13fae4b8 Ansible High Networking and Firewall RDS should not run in public subnet Documentation EC2 Instance Has Public IPa8b0c58b-cd25-4b53-9ad0-55bca0be0bc1 Ansible High Networking and Firewall EC2 Instance should not have a public IP address. Documentation Default Security Groups With Unrestricted Traffic8010e17a-00e9-4635-a692-90d6bcec68bd Ansible High Networking and Firewall Check if default security group does not restrict all inbound and outbound traffic. Documentation Remote Desktop Port Open To Interneteda7301d-1f3e-47cf-8d4e-976debc64341 Ansible High Networking and Firewall The Remote Desktop port is open to the internet in a Security Group Documentation Security Group Ingress Not Restrictedea6bc7a6-d696-4dcf-a788-17fa03c17c81 Ansible High Networking and Firewall AWS Security Group should restrict ingress access Documentation Route53 Record Undefined445dce51-7e53-4e50-80ef-7f94f14169e4 Ansible High Networking and Firewall Route53 Record should have a list of records Documentation CMK Rotation Disabledaf96d737-0818-4162-8c41-40d969bd65d1 Ansible High Observability Customer Master Keys (CMK) must have rotation enabled, which means the attribute 'enable_key_rotation' must be set to 'true' when the key is enabled. Documentation CloudTrail Logging Disabledd4a73c49-cbaa-4c6f-80ee-d6ef5a3a26f5 Ansible High Observability Checks if logging is enabled for CloudTrail. Documentation Cross-Account IAM Assume Role Policy Without ExternalId or MFAaf167837-9636-4086-b815-c239186b9dda Ansible Medium Access Control Cross-Account IAM Assume Role Policy should require external ID or MFA to protect cross-account access Documentation ECR Repository Is Publicly Accessiblefb5a5df7-6d74-4243-ab82-ff779a958bfd Ansible Medium Access Control Amazon ECR image repositories shouldn't have public access Documentation S3 Bucket With Public Accessc3e073c1-f65e-4d18-bd67-4a8f20ad1ab9 Ansible Medium Access Control S3 Bucket allows public access Documentation Public Lambda via API Gateway5e92d816-2177-4083-85b4-f61b4f7176d9 Ansible Medium Access Control Allowing to run lambda function using public API Gateway Documentation IAM Access Key Is Exposed7f79f858-fbe8-4186-8a2c-dfd0d958a40f Ansible Medium Access Control Check if IAM Access Key is active for some user besides 'root' Documentation Certificate Has Expired5a443297-19d4-4381-9e5b-24faf947ec22 Ansible Medium Access Control Expired SSL/TLS certificates should be removed Documentation API Gateway Without Configured Authorizerb16cdb37-ce15-4ab2-8401-d42b05d123fc Ansible Medium Access Control API Gateway REST API should have an API Gateway Authorizer Documentation SES Policy With Allowed IAM Actions8ed0bfce-f780-46d4-b086-21c3628f09ad Ansible Medium Access Control SES policy should not allow IAM actions to all principals Documentation Lambda Permission Principal Is Wildcard1d972c56-8ec2-48c1-a578-887adb09c57a Ansible Medium Access Control Lambda Permission Principal should not contain a wildcard. Documentation IAM Policies Attached To Usereafe4bc3-1042-4f88-b988-1939e64bf060 Ansible Medium Access Control IAM policies should be attached only to groups or roles Documentation SQS Policy With Public Accessd994585f-defb-4b51-b6d2-c70f020ceb10 Ansible Medium Access Control Checks for dangerous permissions in Action statements in an SQS Queue Policy. This is deemed a potential security risk as it would allow various attacks to the queue Documentation AMI Shared With Multiple Accountsa19b2942-142e-4e2b-93b7-6cf6a6c8d90f Ansible Medium Access Control Limits access to AWS AMIs by checking if more than one account is using the same image Documentation SQS Policy Allows All Actionsed9b3beb-92cf-44d9-a9d2-171eeba569d4 Ansible Medium Access Control SQS policy allows ALL (*) actions Documentation Auto Scaling Group With No Associated ELB050f085f-a8db-4072-9010-2cca235cc02f Ansible Medium Availability AWS Auto Scaling Groups must have associated ELBs to ensure high availability and improve application performance. This means the attribute 'load_balancers' must be defined and not empty. Documentation ECS Service Without Running Tasksf5c45127-1d28-4b49-a692-0b97da1c3a84 Ansible Medium Availability ECS Service should have at least 1 task running Documentation CMK Is Unusable133fee21-37ef-45df-a563-4d07edc169f4 Ansible Medium Availability AWS Key Management Service (KMS) must only possess usable Customer Master Keys (CMK), which means the CMKs must have the attribute 'enabled' set to true and the attribute 'pending_window' must be undefined. Documentation RDS With Backup Disablede69890e6-fce5-461d-98ad-cb98318dfc96 Ansible Medium Backup Make sure the AWS RDS configuration has automatic backup configured. If the retention period is equal to 0 there is no backup Documentation Stack Retention Disabled17d5ba1d-7667-4729-b1a6-b11fde3db7f7 Ansible Medium Backup Make sure that retain_stack is enabled to keep the Stack and it's associated resources during resource destruction Documentation IAM Password Without Uppercase Letter83957b81-39c1-4191-8e12-671d2ce14354 Ansible Medium Best Practices IAM password should have at least one uppercase letter Documentation Misconfigured Password Policy Expiration3f2cf811-88fa-4eda-be45-7a191a18aba9 Ansible Medium Best Practices No password expiration policy Documentation Password Without Reuse Prevention6f5f5444-1422-495f-81ef-24cefd61ed2c Ansible Medium Best Practices Password policy <code>password_reuse_prevention</code> doesn't exist or is equal to 0 Documentation IAM Password Without Lowercase Letter8e3063f4-b511-45c3-b030-f3b0c9131951 Ansible Medium Best Practices IAM Password should have at least one lowercase letter Documentation IAM Password Without Number9cf25d62-0b96-42c8-b66d-998cd6ee5bb8 Ansible Medium Best Practices IAM user resource Login Profile Password should have at least one number Documentation IAM Password Without Minimum Length8bc2168c-1723-4eeb-a6f3-a1ba614b9a6d Ansible Medium Best Practices IAM password should have the required minimum length Documentation Stack Without Template32d31f1f-0f83-4721-b7ec-1e6948c60145 Ansible Medium Build Process AWS CloudFormation should have a template defined through the attribute template, template_url or attribute template_body Documentation CodeBuild Not Encrypteda1423864-2fbc-4f46-bfe1-fbbf125c71c9 Ansible Medium Encryption CodeBuild Project should be encrypted Documentation Config Rule For Encrypted Volumes Disabled7674a686-e4b1-4a95-83d4-1fd53c623d84 Ansible Medium Encryption Check if AWS config rules do not identify Encrypted Volumes as a source. Documentation EBS Volume Encryption Disabled4b6012e7-7176-46e4-8108-e441785eae57 Ansible Medium Encryption EBS volumes should be encrypted Documentation SQS With SSE Disablede1e7b278-2a8b-49bd-a26e-66a7f70b17eb Ansible Medium Encryption Amazon Simple Queue Service (SQS) queue should protect the contents of their messages using Server-Side Encryption (SSE) Documentation Memcached Disabled2d55ef88-b616-4890-b822-47f280763e89 Ansible Medium Encryption Check if the Memcached is disabled on the ElastiCache Documentation ECR Image Tag Not Immutable60bfbb8a-c72f-467f-a6dd-a46b7d612789 Ansible Medium Insecure Configurations ECR should have an image tag be immutable. This prevents image tags from being overwritten. Documentation Instance With No VPC61d1a2d0-4db8-405a-913d-5d2ce49dff6f Ansible Medium Insecure Configurations EC2 Instances should be configured under a VPC network. AWS VPCs provide the controls to facilitate a formal process for approving and testing all network connections and changes to the firewall and router configurations. Documentation AWS Password Policy With Unchangeable Passwordse28ceb92-d588-4166-aac5-766c8f5b7472 Ansible Medium Insecure Configurations Unchangeable passwords in AWS password policy Documentation Certificate RSA Key Bytes Lower Than 256d5ec2080-340a-4259-b885-f833c4ea6a31 Ansible Medium Insecure Configurations The certificate should use a RSA key with a length equal to or higher than 256 bytes Documentation API Gateway Without SSL Certificateb47b98ab-e481-4a82-8bb1-1ab39fd36e33 Ansible Medium Insecure Configurations SSL Client Certificate should be enabled Documentation Lambda Function Without Tags265d9725-2fb8-42a2-bc57-3279c5db82d5 Ansible Medium Insecure Configurations AWS Lambda Functions must have associated tags. Documentation SQL Analysis Services Port 2383 (TCP) Is Publicly Accessible7af1c447-c014-4f05-bd8b-ebe3a15734ac Ansible Medium Networking and Firewall Check if port 2383 on TCP is publicly accessible by checking the CIDR block range that can access it. Documentation API Gateway without WAFf5f38943-664b-4acc-ab11-f292fa10ed0b Ansible Medium Networking and Firewall API Gateway should have WAF (Web Application Firewall) enabled Documentation API Gateway Endpoint Config is Not Private559439b2-3e9c-4739-ac46-17e3b24ec215 Ansible Medium Networking and Firewall The API Endpoint type in API Gateway should be set to PRIVATE so it's not exposed to the public internet Documentation API Gateway With CloudWatch Logging Disabled72a931c2-12f5-40d1-93cc-47bff2f7aa2a Ansible Medium Observability AWS CloudWatch Logs for APIs is not enabled Documentation Stack Notifications Disabledd39761d7-94ab-45b0-ab5e-27c44e381d58 Ansible Medium Observability AWS CloudFormation should have stack notifications enabled to be notified when an event occurs Documentation API Gateway X-Ray Disabled2059155b-27fd-441e-b616-6966c468561f Ansible Medium Observability API Gateway should have X-Ray Tracing enabled Documentation CloudTrail Not Integrated With CloudWatchebb2118a-03bc-4d53-ab43-d8750f5cb8d3 Ansible Medium Observability CloudTrail should be integrated with CloudWatch Documentation Configuration Aggregator to All Regions Disableda2fdf451-89dd-451e-af92-bf6c0f4bab96 Ansible Medium Observability AWS Config Configuration Aggregator All Regions must be set to True Documentation S3 Bucket Logging Disabledc3b9f7b0-f5a0-49ec-9cbc-f1e346b7274d Ansible Medium Observability Server Access Logging should be enabled on S3 Buckets so that all changes are logged and trackable Documentation S3 Bucket Without Versioning9232306a-f839-40aa-b3ef-b352001da9a5 Ansible Medium Observability S3 bucket should have versioning enabled Documentation CloudTrail Multi Region Disabled6ad087d7-a509-4b20-b853-9ef6f5ebaa98 Ansible Medium Observability CloudTrail multi region should be enabled, which means attribute 'is_multi_region_trail' should be set to true Documentation CloudFront Logging Disabledd31cb911-bf5b-4eb6-9fc3-16780c77c7bd Ansible Medium Observability AWS CloudFront distributions should have logging enabled to collect all viewer requests, which means the attribute 'logging' should be defined with 'enabled' set to true Documentation CloudWatch Without Retention Period Specifiede24e18d9-4c2b-4649-b3d0-18c088145e24 Ansible Medium Observability AWS CloudWatch should have CloudWatch Logs enabled in order to monitor, store, and access log events Documentation CloudTrail SNS Topic Name Undefined5ba316a9-c466-4ec1-8d5b-bc6107dc9a92 Ansible Medium Observability Check if SNS topic name is set for CloudTrail Documentation No Stack Policyffe0fd52-7a8b-4a5c-8fc7-49844418e6c9 Ansible Medium Resource Management AWS CloudFormation Stack should have a stack policy in order to protect stack resources from update actions Documentation Hardcoded AWS Access Key In Lambdaf34508b9-f574-4330-b42d-88c44cced645 Ansible Medium Secret Management Lambda access/secret keys should not be hardcoded Documentation Hardcoded AWS Access Keyc2f15af3-66a0-4176-a56e-e4711e502e5c Ansible Medium Secret Management AWS Access Key should not be hardcoded Documentation IAM Group Without Usersf509931b-bbb0-443c-bd9b-10e92ecf2193 Ansible Low Access Control IAM Group should have at least one user associated Documentation IAM Policy Grants 'AssumeRole' Permission Across All Services12a7a7ce-39d6-49dd-923d-aeb4564eb66c Ansible Low Access Control IAM Policy should not grant 'AssumeRole' permission across all services. Documentation EC2 Instance Using Default Security Group8d03993b-8384-419b-a681-d1f55149397c Ansible Low Access Control EC2 instances should not use default security group(s) Documentation IAM Role Allows All Principals To Assumebabdedcf-d859-43da-9a7b-6d72e661a8fd Ansible Low Access Control IAM role allows all services or principals to assume it Documentation Automatic Minor Upgrades Disabled857f8808-e96a-4ba8-a9b7-f2d4ec6cad94 Ansible Low Best Practices RDS instance should have automatic minor upgrades enabled, which means the attribute 'auto_minor_version_upgrade' must be set to true. Documentation CDN Configuration Is Missingb25398a2-0625-4e61-8e4d-a1bb23905bf6 Ansible Low Best Practices Content Delivery Network (CDN) service is used within an AWS account to secure and accelerate the delivery of websites. The use of a CDN can provide a layer of security between your origin content and the destination. Documentation Lambda Permission Misconfigured3ddf3417-424d-420d-8275-0724dc426520 Ansible Low Best Practices Lambda permission may be misconfigured if the action field is not filled in by 'lambda:InvokeFunction' Documentation EFS Without Tagsb8a9852c-9943-4973-b8d5-77dae9352851 Ansible Low Build Process Amazon Elastic Filesystem should have filesystem tags associated Documentation CloudTrail Log Files Not Encrypted With KMSf5587077-3f57-4370-9b4e-4eb5b1bac85b Ansible Low Encryption Logs delivered by CloudTrail should be encrypted using KMS to increase security of your CloudTrail Documentation RDS Using Default Port2cb674f6-32f9-40be-97f2-62c0dc38f0d5 Ansible Low Networking and Firewall RDS should not use the default port (an attacker can easily guess the port). For engines related to Aurora, MariaDB or MySQL, the default port is 3306. PostgreSQL default port is 5432, Oracle default port is 1521 and SQL Server default port is 1433 Documentation ElastiCache Without VPC5527dcfc-94f9-4bf6-b7d4-1b78850cf41f Ansible Low Networking and Firewall ElastiCache should be launched in a Virtual Private Cloud (VPC) Documentation CloudFront Without WAF22c80725-e390-4055-8d14-a872230f6607 Ansible Low Networking and Firewall All AWS CloudFront distributions should be integrated with the Web Application Firewall (AWS WAF) service Documentation ElastiCache Using Default Port7cc6c791-5f68-4816-a564-b9b699f9d26e Ansible Low Networking and Firewall ElastiCache should not use the default port (an attacker can easily guess the port). For engine set to Redis, the default port is 6379. The Memcached default port is 11211 Documentation EC2 Instance Using Default VPC8833f180-96f1-46f4-9147-849aafa56029 Ansible Low Networking and Firewall EC2 Instances should not be configured under a default VPC network Documentation Redshift Using Default Porte01de151-a7bd-4db4-b49b-3c4775a5e881 Ansible Low Networking and Firewall Redshift should not use the default port (5439) because an attacker can easily guess the port Documentation CloudTrail Log File Validation Disabled4d8681a2-3d30-4c89-8070-08acd142748e Ansible Low Observability CloudTrail log file validation should be enabled to determine whether a log file has not been tampered Documentation Lambda Functions Without X-Ray Tracing71397b34-1d50-4ee1-97cb-c96c34676f74 Ansible Low Observability AWS Lambda functions should have TracingConfig enabled. For this, property 'tracing_mode' should have the value 'Active' Documentation EC2 Not EBS Optimized338b6cab-961d-4998-bb49-e5b6a11c9a5c Ansible Info Best Practices It's considered a best practice for an EC2 instance to use an EBS optimized instance. This provides the best performance for your EBS volumes by minimizing contention between Amazon EBS I/O and other traffic from your instance Documentation VM With Full Cloud Accessbc20bbc6-0697-4568-9a73-85af1dd97bdd Ansible High Access Control A VM instance is configured to use the default service account with full access to all Cloud APIs Documentation BigQuery Dataset Is Public2263b286-2fe9-4747-a0ae-8b4768a2bbd2 Ansible High Access Control BigQuery dataset is anonymously or publicly accessible Documentation Cloud Storage Anonymous or Publicly Accessible086031e1-9d4a-4249-acb3-5bfe4c363db2 Ansible High Access Control Cloud Storage Buckets must not be anonymously or publicly accessible, which means the attribute 'entity' must not be 'allUsers' or 'allAuthenticatedUsers' Documentation SQL DB Instance Backup Disabled0c82eae2-aca0-401f-93e4-fb37a0f9e5e8 Ansible High Backup Checks if backup configuration is enabled for all Cloud SQL Database instances Documentation DNSSEC Using RSASHA16cf4c3a7-ceb0-4475-8892-3745b84be24a Ansible High Encryption DNSSEC should not use the RSASHA1 algorithm Documentation SQL DB Instance With SSL Disabledd0f7da39-a2d5-4c78-bb85-4b7f338b3cbb Ansible High Encryption Cloud SQL Database Instance should have SLL enabled Documentation Cloud SQL Instance With Cross DB Ownership Chaining On9e0c33ed-97f3-4ed6-8be9-bcbf3f65439f Ansible High Insecure Configurations GCP SQL Instance should not have Cross DB Ownership Chaining On Documentation SQL DB Instance Publicly Accessible7d7054c0-3a52-4e9b-b9ff-cbfe16a2378b Ansible High Insecure Configurations Cloud SQL instances should not be publicly accessible. Documentation Cluster Labels Disabledfbe9b2d0-a2b7-47a1-a534-03775f3013f7 Ansible High Insecure Configurations Kubernetes Clusters must be configured with labels, which means the attribute 'resource_labels' must be defined Documentation Cluster Master Authentication Disabled9df7f78f-ebe3-432e-ac3b-b67189c15518 Ansible High Insecure Configurations Kubernetes Engine Clusters must have Master Authentication set to enabled, which means the attribute 'master_auth' must have the subattributes 'username' and 'password' defined and not empty Documentation IP Aliasing Disableded672a9f-fbf0-44d8-a47d-779501b0db05 Ansible High Insecure Configurations Kubernetes Clusters must be created with Alias IP ranges enabled, which means the attribute 'ip_allocation_policy' must be defined and the subattribute 'use_ip_aliases' must be set to 'yes'. Documentation GKE Basic Authentication Enabled344bf8ab-9308-462b-a6b2-697432e40ba1 Ansible High Insecure Configurations GCP - Google Kubernetes Engine (GKE) Basic Authentication must be disabled, which means the username and password provided in the master_auth block must be empty Documentation Cloud SQL Instance With Contained Database Authentication On6d34aff3-fdd2-460c-8190-756a3b4969e8 Ansible High Insecure Configurations SQL Instance should not have Contained Database Authentication On Documentation MySQL Instance With Local Infile Ona7b520bb-2509-4fb0-be05-bc38f54c7a4c Ansible High Insecure Configurations MySQL Instance should not have Local Infile On Documentation Network Policy Disabled98e04ca0-34f5-4c74-8fec-d2e611ce2790 Ansible High Insecure Configurations Kubernetes Engine Clusters must have Network Policy enabled, meaning that the attribute 'network_policy.enabled' must be true and the attribute 'addons_config.network_policy_config.disabled' must be false Documentation Private Cluster Disabled3b30e3d6-c99b-4318-b38f-b99db74578b5 Ansible High Insecure Configurations Kubernetes Clusters must be created with Private Clusters enabled, meaning the 'private_cluster_config' must be defined and the attributes 'enable_private_endpoint' and 'enable_private_nodes' must be true. Documentation GKE Legacy Authorization Enabled300a9964-b086-41f7-9378-b6de3ba1c32b Ansible High Insecure Configurations Kubernetes Engine Clusters must have Legacy Authorization set to disabled, which means the attribute 'legacy_abac.enabled' must be false. Documentation Client Certificate Disabled20180133-a0d0-4745-bfe0-94049fbb12a9 Ansible High Insecure Configurations Kubernetes Clusters must be created with Client Certificate enabled, which means 'master_auth' must have 'client_certificate_config' with the attribute 'issue_client_certificate' equal to true Documentation PostgreSQL Misconfigured Logging Duration Flagaed98a2a-e680-497a-8886-277cea0f4514 Ansible High Insecure Configurations PostgreSQL database 'log_min_duration_statement' flag isn't set to '-1' Documentation GKE Master Authorized Networks Disabledd43366c5-80b0-45de-bbe8-2338f4ab0a83 Ansible High Networking and Firewall Master authorized networks must be enabled in GKE clusters Documentation Compute Instance Is Publicly Accessible829f1c60-2bab-44c6-8a21-5cd9d39a2c82 Ansible High Networking and Firewall Compute instances shouldn't be accessible from the Internet. Documentation Cloud Storage Bucket Logging Not Enabled507df964-ad97-4035-ab14-94a82eabdfdd Ansible High Observability Cloud storage bucket should have logging enabled Documentation Stackdriver Monitoring Disabled20dcd953-a8b8-4892-9026-9afa6d05a525 Ansible High Observability Kubernetes Engine Clusters must have Stackdriver Monitoring enabled, which means the attribute 'monitoring_service' must be defined and different than 'none' Documentation PostgreSQL Logging Of Temporary Files Disabledd6fae5b6-ada9-46c0-8b36-3108a2a2f77b Ansible High Observability PostgreSQL database 'log_temp_files' flag isn't set to '0' Documentation Stackdriver Logging Disabled19c9e2a0-fc33-4264-bba1-e3682661e8f7 Ansible High Observability Kubernetes Engine Clusters must have Stackdriver Logging enabled, which means the attribute 'logging_service' must be defined and different from 'none' Documentation Cloud Storage Bucket Versioning Disabled7814ddda-e758-4a56-8be3-289a81ded929 Ansible High Observability Cloud Storage Bucket should have versioning enabled Documentation PostgreSQL Log Connections Disabledd7a5616f-0a3f-4d43-bc2b-29d1a183e317 Ansible High Observability PostgreSQL database instance should have a 'log_connections' flag with its value set to 'on' Documentation Node Auto Upgrade Disabledd6e10477-2e19-4bcd-b8a8-19c65b89ccdf Ansible High Resource Management Kubernetes nodes must have auto upgrades set to true, which means Node 'auto_upgrade' should be enabled for Kubernetes Clusters Documentation Google Compute SSL Policy Weak Cipher In Useb28bcd2f-c309-490e-ab7c-35fc4023eb26 Ansible Medium Encryption This query confirms if Google Compute SSL Policy Weak Chyper Suits is Enabled, to do so we need to check if TLS is TLS_1_2, because other version have Weak Chypers Documentation Disk Encryption Disabled092bae86-6105-4802-99d2-99cd7e7431f3 Ansible Medium Encryption VM disks for critical VMs must be encrypted with Customer Supplied Encryption Keys (CSEK) or with Customer-managed encryption keys (CMEK), which means the attribute 'disk_encryption_key' must be defined and its sub attributes 'raw_key' or 'kms_key_self_link' must also be defined Documentation Google Container Node Pool Auto Repair Disabledd58c6f24-3763-4269-9f5b-86b2569a003b Ansible Medium Insecure Configurations Google Container Node Pool Auto Repair should be enabled. This service periodically checks for failing nodes and repairs them to ensure a smooth running state. Documentation OSLogin Is Disabled In VM Instance66dae697-507b-4aef-be18-eec5bd707f33 Ansible Medium Insecure Configurations VM instance should have OSLogin enabled Documentation Cloud DNS Without DNSSEC80b15fb1-6207-40f4-a803-6915ae619a03 Ansible Medium Insecure Configurations DNSSEC must be enabled for Cloud DNS Documentation Using Default Service Account2775e169-e708-42a9-9305-b58aadd2c4dd Ansible Medium Insecure Configurations Instances must not be configured to use the Default Service Account, that has full access to all Cloud APIs, which means the attribute 'service_account_email' must be defined. Additionally, it must not be empty and must also not be a default Google Compute Engine service account. Documentation COS Node Image Not Usedbe41f891-96b1-4b9d-b74f-b922a918c778 Ansible Medium Insecure Configurations The node image should be Container-Optimized OS(COS) Documentation Shielded VM Disabled18d3a83d-4414-49dc-90ea-f0387b2856cc Ansible Medium Insecure Configurations Compute instances must be launched with Shielded VM enabled, which means the attribute 'shielded_instance_config' must be defined and its sub attributes 'enable_secure_boot', 'enable_vtpm' and 'enable_integrity_monitoring' must be set to true Documentation GKE Using Default Service Accountdc126833-125a-40fb-905a-ce5f2afde240 Ansible Medium Insecure Defaults Kubernetes Engine Clusters should not be configured to use the default service account Documentation SSH Access Is Not Restrictedb2fbf1df-76dd-4d78-a6c0-e538f4a9b016 Ansible Medium Networking and Firewall Google Firewall should not allow SSH access (port 22) from the Internet (public CIDR block) to ensure the principle of least privileges Documentation RDP Access Is Not Restricted75418eb9-39ec-465f-913c-6f2b6a80dc77 Ansible Medium Networking and Firewall Check if the Google compute firewall allows unrestricted RDP access. Allowed ports should not contain RDP port 3389 Documentation Google Compute Network Using Default Firewall Rule29b8224a-60e9-4011-8ac2-7916a659841f Ansible Medium Networking and Firewall Google Compute Network should not use default firewall rule Documentation IP Forwarding Enabled11bd3554-cd56-4257-8e25-7aaf30cf8f5f Ansible Medium Networking and Firewall Instances must not have IP forwarding enabled, which means the attribute 'can_ip_forward' must not be true Documentation Serial Ports Are Enabled For VM Instancesc6fc6f29-dc04-46b6-99ba-683c01aff350 Ansible Medium Networking and Firewall Google Compute Engine VM instances should not enable serial ports. When enabled, anyone can access your VM, if they know the username, project ID, SSH key, instance name and zone Documentation Google Compute Network Using Firewall Rule that Allows All Ports3602d273-3290-47b2-80fa-720162b1a8af Ansible Medium Networking and Firewall Google Compute Network should not use a firewall rule that allows all ports Documentation PostgreSQL Misconfigured Log Messages Flag28a757fc-3d8f-424a-90c0-4233363b2711 Ansible Medium Observability PostgreSQL database 'log_min_messages' flag isn't set to a valid value Documentation PostgreSQL log_checkpoints Flag Not Set To ON89afe3f0-4681-4ce3-89ed-896cebd4277c Ansible Medium Observability PostgreSQL database instance should have a 'log_checkpoints' flag with its value set to 'on' Documentation Project-wide SSH Keys Are Enabled In VM Instances099b4411-d11e-4537-a0fc-146b19762a79 Ansible Medium Secret Management VM Instance should block project-wide SSH keys Documentation High Google KMS Crypto Key Rotation Periodf9b7086b-deb8-4034-9330-d7fd38f1b8de Ansible Medium Secret Management KMS encryption keys should be rotated every 90 days or less. A short lifetime of encryption keys reduces the potential blast radius in case of compromise. Documentation Google Compute Network Using Firewall Rule that Allows Port Range7289eebd-a477-4064-8ad4-3c044bd70b00 Ansible Low Networking and Firewall Google Compute Network should not use a firewall rule that allows port range Documentation Google Compute Subnetwork with Private Google Access Disabled6a4080ae-79bd-42f6-a924-8f534c1c018b Ansible Low Networking and Firewall Google Compute Subnetwork should have Private Google Access enabled, which means 'private_ip_google_access' should be set to yes Documentation Public Storage Account35e2f133-a395-40de-a79d-b260d973d1bd Ansible High Access Control Storage Account should not be public to grant the principle of least privileges Documentation Storage Container Is Publicly Accessible4d3817db-dd35-4de4-a80d-3867157e7f7f Ansible High Access Control Anonymous, public read access to a container and its blobs are enabled in Azure Blob Storage Documentation Admin User Enabled For Container Registry29f35127-98e6-43af-8ec1-201b79f99604 Ansible High Access Control Admin user is enabled for Container Registry Documentation MySQL SSL Connection Disabled2a901825-0f3b-4655-a0fe-e0470e50f8e6 Ansible High Encryption Make sure that for MySQL Database Server, 'Enforce SSL connection' is enabled Documentation Storage Account Not Forcing HTTPS2c99a474-2a3c-4c17-8294-53ffa5ed0522 Ansible High Encryption Storage Accounts should enforce the use of HTTPS Documentation SSL Enforce Disabled961ce567-a16d-4d7d-9027-f0ec2628a555 Ansible High Encryption Make sure that for PosgreSQL, the 'Enforce SSL connection' is set to 'ENABLED' Documentation Azure Container Registry With No Locks581dae78-307d-45d5-aae4-fe2b0db267a5 Ansible High Insecure Configurations Azurerm Container Registry should contain associated locks, which means 'azure_rm_lock.managed_resource_id' or 'azure_rm_lock.resource_group' association should be defined Documentation AD Admin Not Configured For SQL Serverb176e927-bbe2-44a6-a9c3-041417137e5f Ansible High Insecure Configurations The Active Directory Administrator is not configured for a SQL server Documentation VM Not Attached To Network1e5f5307-3e01-438d-8da6-985307ed25ce Ansible High Insecure Configurations No Network Security Group is attached to the Virtual Machine Documentation Web App Accepting Traffic Other Than HTTPSeb8c2560-8bee-4248-9d0d-e80c8641dd91 Ansible High Insecure Configurations Web app should only accept HTTPS traffic in Azure Web App Service. Documentation CosmosDB Account IP Range Filter Not Sete8c80448-31d8-4755-85fc-6dbab69c2717 Ansible High Networking and Firewall The IP range filter should be defined to secure the data stored Documentation Redis Publicly Accessible0632d0db-9190-450a-8bb3-c283bffea445 Ansible High Networking and Firewall Firewall rule allowing unrestricted access to Redis from other Azure sources Documentation SQLServer Ingress From Any IPf4e9ff70-0f3b-4c50-a713-26cbe7ec4039 Ansible High Networking and Firewall Check if all IPs are allowed, check from start 0.0.0.0 to end 255.255.255.255. Documentation Redis Entirely Accessible0d0c12b9-edce-4510-9065-13f6a758750c Ansible High Networking and Firewall Firewall rule allowing unrestricted access to Redis from the Internet Documentation Sensitive Port Is Exposed To Entire Network0ac9abbc-6d7a-41cf-af23-2e57ddb3dbfc Ansible High Networking and Firewall A sensitive port, such as port 23 or port 110, is open for the whole network in either TCP or UDP protocol Documentation Trusted Microsoft Services Not Enabled1bc398a8-d274-47de-a4c8-6ac867b353de Ansible High Networking and Firewall Trusted Microsoft Services should be enabled for Storage Account access Documentation AKS RBAC Disabled149fa56c-4404-4f90-9e25-d34b676d5b39 Ansible Medium Access Control Azure Container Service (AKS) instance should have role-based access control (RBAC) enabled Documentation Role Definition Allows Custom Role Creation5c80db8e-03f5-43a2-b4af-1f3f87018157 Ansible Medium Access Control Role Definition should not allow custom role creation (Microsoft.Authorization/roleDefinitions/write) Documentation Key Vault Soft Delete Is Disabled881696a8-68c5-4073-85bc-7c38a3deb854 Ansible Medium Backup Make sure Soft Delete is enabled for Key Vault Documentation SQL Server Predictable Admin Account Name663062e9-473d-4e87-99bc-6f3684b3df40 Ansible Medium Best Practices Azure SQL Server's Admin account login must avoid using names like 'Admin', that are too predictable, which means the attribute 'admin_username' must be set to a name that is not easy to predict Documentation SQL Server Predictable Active Directory Account Name530e8291-2f22-4bab-b7ea-306f1bc2a308 Ansible Medium Best Practices Azure SQL Server must avoid using predictable Active Directory Administrator Account names, like 'Admin', which means the attribute 'ad_user' must be set to a name that is not easy to predict Documentation Cosmos DB Account Without Tags23a4dc83-4959-4d99-8056-8e051a82bc1e Ansible Medium Build Process Cosmos DB Account must have a mapping of tags. Documentation Storage Account Not Using Latest TLS Encryption Versionc62746cf-92d5-4649-9acf-7d48d086f2ee Ansible Medium Encryption Ensure Storage Account is using the latest version of TLS encryption Documentation Redis Cache Allows Non SSL Connections869e7fb4-30f0-4bdb-b360-ad548f337f2f Ansible Medium Insecure Configurations Redis Cache resources should not allow non-SSL connections Documentation AKS Network Policy Misconfigured8c3bedf1-c570-4c3b-b414-d068cd39a00c Ansible Medium Insecure Configurations Azure Kubernetes Service should have the proper network policy configuration to ensure the principle of least privileges, which means that 'network_profile.network_policy' should be defined Documentation Security Group is Not Configuredda4f2739-174f-4cdd-b9ef-dc3f14b5931f Ansible Medium Insecure Configurations Azure Virtual Network subnet must be configured with a Network Security Group, which means the attribute 'security_group' must be defined and not empty Documentation Default Network Access is Allowed974e6fe7-63fd-4fa4-aa72-77b21a4a959d Ansible Medium Insecure Defaults Default Network Access rule for Storage Accounts must be set to deny, which means the attribute 'default_action' must be 'Deny' Documentation WAF Is Disabled For Azure Application Gateway2fc5ab5a-c5eb-4ae4-b687-0f16fe77c255 Ansible Medium Networking and Firewall Check if Web Application Firewall is disabled or not configured for Azure's Application Gateway. Documentation Unrestricted SQL Server Access3f23c96c-f9f5-488d-9b17-605b8da5842f Ansible Medium Networking and Firewall Azure SQL Server Accessibility should be set to a minimal address range to grant the principle of least privileges, which means the difference between the values of the 'end_ip_address' and 'start_ip_address' should be less than 256. Additionally, both ips should be different from '0.0.0.0' Documentation Firewall Rule Allows Too Many Hosts To Access Redis Cache69f72007-502e-457b-bd2d-5012e31ac049 Ansible Medium Networking and Firewall Check if any firewall rule allows too many hosts to access Redis Cache. Documentation Small Activity Log Retention Period37fafbea-dedb-4e0d-852e-d16ee0589326 Ansible Medium Observability Ensure that Activity Log Retention is set 365 days or greater Documentation PostgreSQL Log Disconnections Not Set054d07b5-941b-4c28-8eef-18989dc62323 Ansible Medium Observability Make sure that for PostgreSQL Database, server parameter 'log_disconnections' is set to 'ON' Documentation PostgreSQL Log Checkpoints Disabled7ab33ac0-e4a3-418f-a673-50da4e34df21 Ansible Medium Observability Make sure that for Postgre SQL Database Server, parameter 'log_checkpoints' is set to 'ON' Documentation Log Retention Is Not Set0461b4fd-21ef-4687-929e-484ee4796785 Ansible Medium Observability Make sure that for PostgreSQL Database, server parameter 'log_retention' is set to 'ON' Documentation Monitoring Log Profile Without All Activities89f84a1e-75f8-47c5-83b5-bee8e2de4168 Ansible Medium Observability Monitoring log profile captures all the activities (Action, Write, Delete) Documentation PostgreSQL Server Without Connection Throttlinga9becca7-892a-4af7-b9e1-44bf20a4cd9a Ansible Medium Observability Ensure that Connection Throttling is set for the PostgreSQL server Documentation AKS Monitoring Logging Disabledd5e83b32-56dd-4247-8c2e-074f43b38a5e Ansible Medium Observability Azure Container Service (AKS) instance should have logging enabled to Azure Monitoring Documentation PostgreSQL Log Connections Not Set7b47138f-ec0e-47dc-8516-e7728fe3cc17 Ansible Medium Observability Make sure that for PostgreSQL Database, server parameter 'log_connections' is set to 'ON' Documentation PostgreSQL Log Duration Not Set729ebb15-8060-40f7-9017-cb72676a5487 Ansible Medium Observability Make sure that for PostgreSQL Database, server parameter 'log_duration' is set to 'ON' Documentation S3 Bucket Allows List Action From All Principals66c6f96f-2d9e-417e-a998-9058aeeecd44 Terraform High Access Control S3 Buckets must not allow List Action From All Principals, as to prevent leaking private information to the entire internet or allow unauthorized data tampering / deletion. This means the 'Effect' must not be 'Allow' when the 'Action' is List, for all Principals. Documentation S3 Bucket Allows Public Policy1a4bc881-9f69-4d44-8c9a-d37d08f54c50 Terraform High Access Control S3 bucket allows public policy Documentation S3 Bucket With All Permissionsa4966c4f-9141-48b8-a564-ffe9959945bc Terraform High Access Control S3 Buckets should not have all permissions, as to prevent leaking private information to the entire internet or allow unauthorized data tampering / deletion. This means the 'Effect' must not be 'Allow' when the 'Action' is '*', for all Principals. Documentation SSO Policy with full privileges132a8c31-9837-4203-9fd1-15ca210c7b73 Terraform High Access Control SSO policies should be configured to grant limited administrative privileges, rather than full access to all resources. This approach allows for better security and control over the resources being accessed. Documentation S3 Bucket Access to Any Principal7af43613-6bb9-4a0e-8c4d-1314b799425e Terraform High Access Control S3 Buckets must not allow Actions From All Principals, as to prevent leaking private information to the entire internet or allow unauthorized data tampering / deletion. This means the 'Effect' must not be 'Allow' when there are All Principals Documentation S3 Bucket ACL Allows Read Or Write to All Users38c5ee0d-7f22-4260-ab72-5073048df100 Terraform High Access Control S3 Buckets should not be readable and writable to all users Documentation S3 Bucket ACL Allows Read to Any Authenticated User57b9893d-33b1-4419-bcea-a717ea87e139 Terraform High Access Control S3 Buckets should not be readable to any authenticated user Documentation IAM Role With Full Privilegesb1ffa705-19a3-4b73-b9d0-0c97d0663842 Terraform High Access Control IAM role policy that allow full administrative privileges (for all resources) Documentation S3 Bucket Allows Put Action From All Principalsd24c0755-c028-44b1-b503-8e719c898832 Terraform High Access Control S3 Buckets must not allow Put Action From All Principals, as to prevent leaking private information to the entire internet or allow unauthorized data tampering / deletion. This means the 'Effect' must not be 'Allow' when the 'Action' is Put, for all Principals. Documentation IAM Policies With Full Privileges2f37c4a3-58b9-4afe-8a87-d7f1d2286f84 Terraform High Access Control IAM policies shouldn't allow full administrative privileges (for all resources) Documentation SNS Topic is Publicly Accessibleb26d2b7e-60f6-413d-a3a1-a57db24aa2b3 Terraform High Access Control SNS Topic Policy should not allow any principal to access Documentation EFS With Vulnerable Policyfae52418-bb8b-4ac2-b287-0b9082d6a3fd Terraform High Access Control EFS (Elastic File System) policy should avoid wildcard in 'Action' and 'Principal'. Documentation MSK Broker Is Publicly Accessible54378d69-dd7c-4b08-a43e-80d563396857 Terraform High Access Control Public AWS MSK allows anyone to interact with the Apache Kafka broker, therefore increasing the opportunity for malicious activity. To prevent such a scenario, it is recommended for AWS MSK to not be publicly accessible Documentation S3 Bucket ACL Grants WRITE_ACP Permission64a222aa-7793-4e40-915f-4b302c76e4d4 Terraform High Access Control S3 Buckets should not allow WRITE_ACP permission to the S3 Bucket Access Control List in order to prevent AWS accounts or IAM users to modify access control permissions to the bucket. Documentation IAM Policy Grants Full Permissions575a2155-6af1-4026-b1af-d5bc8fe2a904 Terraform High Access Control IAM policy should not grant full permissions to resources from the get-go, instead of granting permissions gradually as necessary. Documentation Authentication Without MFA3ddfa124-6407-4845-a501-179f90c65097 Terraform High Access Control Users should authenticate with MFA (Multi-factor Authentication) to ensure an extra layer of protection when authenticating Documentation Neptune Cluster Instance is Publicly Accessible9ba198e0-fef4-464a-8a4d-75ea55300de7 Terraform High Access Control Neptune Cluster Instance should not be publicly accessible Documentation SQS Queue Exposedabb06e5f-ef9a-4a99-98c6-376d396bfcdf Terraform High Access Control Checks if the SQS Queue is exposed Documentation S3 Bucket Allows Get Action From All Principals1df37f4b-7197-45ce-83f8-9994d2fcf885 Terraform High Access Control S3 Buckets must not allow Get Action From All Principals, as to prevent leaking private information to the entire internet or allow unauthorized data tampering / deletion. This means the 'Effect' must not be 'Allow' when the 'Action' is Get, for all Principals. Documentation ECS Service Admin Role Is Present3206240f-2e87-4e58-8d24-3e19e7c83d7c Terraform High Access Control ECS Services must not have Admin roles, which means the attribute 'iam_role' must not be an admin role Documentation S3 Bucket Allows Delete Action From All Principalsffdf4b37-7703-4dfe-a682-9d2e99bc6c09 Terraform High Access Control S3 Buckets must not allow Delete Action From All Principals, as to prevent leaking private information to the entire internet or allow unauthorized data tampering / deletion. This means the 'Effect' must not be 'Allow' when the 'Action' is Delete, for all Principals. Documentation DOCDB Cluster Not Encryptedbc1f9009-84a0-490f-ae09-3e0ea6d74ad6 Terraform High Encryption AWS DOCDB Cluster storage should be encrypted Documentation DAX Cluster Not Encryptedf11aec39-858f-4b6f-b946-0a1bf46c0c87 Terraform High Encryption AWS DAX Cluster should have server-side encryption at rest Documentation EBS Default Encryption Disabled3d3f6270-546b-443c-adb4-bb6fb2187ca6 Terraform High Encryption EBS Encryption should be enabled Documentation S3 Bucket SSE Disabled6726dcc0-5ff5-459d-b473-a780bef7665c Terraform High Encryption If algorithm is AES256 then the master key is null, empty or undefined, otherwise the master key is required Documentation ELB Using Insecure Protocols126c1788-23c2-4a10-906c-ef179f4f96ec Terraform High Encryption ELB Predefined or Custom Security Policies must not use insecure protocols, to reduce the risk of the SSL connection between the client and the load balancer being exploited. That means the 'name' of 'policy_attributes' must not coincide with any of a predefined list of insecure protocols. Documentation User Data Contains Encoded Private Key443488f5-c734-460b-a36d-5b3f330174dc Terraform High Encryption User Data should not contain a base64 encoded private key. If so, anyone can decode the private key easily Documentation CodeBuild Project Encrypted With AWS Managed Key3deec14b-03d2-4d27-9670-7d79322e3340 Terraform High Encryption CodeBuild Project should be encrypted with customer-managed KMS keys instead of AWS managed keys Documentation EBS Volume Snapshot Not Encryptede6b4b943-6883-47a9-9739-7ada9568f8ca Terraform High Encryption The value on AWS EBS Volume Snapshot Encryptation must be true Documentation Redshift Not Encryptedcfdcabb0-fc06-427c-865b-c59f13e898ce Terraform High Encryption AWS Redshift Cluster should be encrypted. Check if 'encrypted' field is false or undefined (default is false) Documentation Workspaces Workspace Volume Not Encryptedb9033580-6886-401a-8631-5f19f5bb24c7 Terraform High Encryption AWS Workspaces Workspace data stored in volumes should be encrypted Documentation EFS Without KMS25d251f3-f348-4f95-845c-1090e41a615c Terraform High Encryption Amazon Elastic Filesystem should have filesystem encryption enabled using KMS CMK customer-managed keys instead of AWS managed-keys Documentation Secure Ciphers Disabled5c0003fb-9aa0-42c1-9da3-eb0e332bef21 Terraform High Encryption Check if secure ciphers aren't used in CloudFront Documentation API Gateway Method Settings Cache Not Encryptedb7c9a40c-23e4-4a2d-8d39-a3352f10f288 Terraform High Encryption API Gateway Method Settings Cache should be encrypted Documentation Launch Configuration Is Not Encrypted4de9de27-254e-424f-bd70-4c1e95790838 Terraform High Encryption Launch Configurations should have the data in the volumes encrypted. To encrypt the data, the 'encrypted' parameter should be set to true in each volume Documentation DB Instance Storage Not Encrypted08bd0760-8752-44e1-9779-7bb369b2b4e4 Terraform High Encryption AWS DB Instance should have its storage encrypted by setting the parameter to 'true'. The storage_encrypted default value is 'false'. Documentation S3 Bucket Object Not Encrypted5fb49a69-8d46-4495-a2f8-9c8c622b2b6e Terraform High Encryption S3 Bucket Object should have server-side encryption enabled Documentation Glue Security Configuration Encryption Disabledad5b4e97-2850-4adf-be17-1d293e0b85ee Terraform High Encryption Glue Security Configuration Encryption should have 'cloudwatch_encryption', 'job_bookmarks_encryption' and 's3_encryption' enabled Documentation Kinesis Not Encrypted With KMS862fe4bf-3eec-4767-a517-40f378886b88 Terraform High Encryption AWS Kinesis Streams and metadata should be protected with KMS Documentation ELB Using Weak Ciphers4a800e14-c94a-442d-9067-5a2e9f6c0a4c Terraform High Encryption ELB Predefined or Custom Security Policies must not use weak ciphers, to reduce the risk of the SSL connection between the client and the load balancer being exploited. That means the 'name' of 'policy_attributes' must not coincide with any of a predefined list of weak ciphers. Documentation Athena Database Not Encryptedb2315cae-b110-4426-81e0-80bb8640cdd3 Terraform High Encryption AWS Athena Database data in S3 should be encrypted Documentation Sagemaker Notebook Instance Without KMSf3674e0c-f6be-43fa-b71c-bf346d1aed99 Terraform High Encryption AWS SageMaker should encrypt model artifacts at rest using Amazon S3 server-side encryption with an AWS KMS Documentation RDS Storage Not Encrypted3199c26c-7871-4cb3-99c2-10a59244ce7f Terraform High Encryption RDS Storage should be encrypted, which means the attribute 'storage_encrypted' should be set to 'true' Documentation RDS Database Cluster not Encrypted656880aa-1388-488f-a6d4-8f73c23149b2 Terraform High Encryption RDS Database Cluster Encryption should be enabled Documentation IAM Database Auth Not Enabled88fd05e0-ac0e-43d2-ba6d-fc0ba60ae1a6 Terraform High Encryption IAM Database Auth Enabled should be configured to true when using compatible engine and version Documentation User Data Shell Script Is Encoded9cf718ce-46f9-430e-89ec-c456f8b469ee Terraform High Encryption User Data Shell Script must be encoded Documentation CA Certificate Identifier Is Outdated9f40c07e-699e-4410-8856-3ba0f2e3a2dd Terraform High Encryption The CA certificate Identifier must be 'rds-ca-2019'. Documentation ECS Task Definition Volume Not Encrypted4d46ff3b-7160-41d1-a310-71d6d370b08f Terraform High Encryption AWS ECS Task Definition EFS data in transit between AWS ECS host and AWS EFS server should be encrypted Documentation Redis Not Compliant254c932d-e3bf-44b2-bc9d-eb5fdb09f8d4 Terraform High Encryption Check if the redis version is compliant with the necessary AWS PCI DSS requirements Documentation Cloudfront Viewer Protocol Policy Allows HTTP55af1353-2f62-4fa0-a8e1-a210ca2708f5 Terraform High Encryption Checks if the connection between CloudFront and the viewer is encrypted Documentation MSK Cluster Encryption Disabled6db52fa6-d4da-4608-908a-89f0c59e743e Terraform High Encryption Ensure MSK Cluster encryption in rest and transit is enabled Documentation ECS Task Definition Container With Plaintext Passwordd40210ea-64b9-4cce-a4fb-e8604f3c062c Terraform High Encryption It's not recommended to use plaintext environment variables for sensitive information, such as credential data. Documentation AMI Not Encrypted8bbb242f-6e38-4127-86d4-d8f0b2687ae2 Terraform High Encryption AWS AMI Encryption is not enabled Documentation Athena Workgroup Not Encryptedd364984a-a222-4b5f-a8b0-e23ab19ebff3 Terraform High Encryption Athena Workgroup query results should be encrypted, for all queries that run in the workgroup Documentation Glue Data Catalog Encryption Disabled01d50b14-e933-4c99-b314-6d08cd37ad35 Terraform High Encryption Glue Data Catalog Encryption Settings should have 'connection_password_encryption' and 'encryption_at_rest' enabled Documentation EKS Cluster Encryption Disabled63ebcb19-2739-4d3f-aa5c-e8bbb9b85281 Terraform High Encryption EKS Cluster should be encrypted Documentation Kinesis SSE Not Configured5c6dd5e7-1fe0-4cae-8f81-4c122717cef3 Terraform High Encryption AWS Kinesis Server data at rest should have Server Side Encryption (SSE) enabled Documentation Sagemaker Endpoint Configuration Encryption Disabled58b35504-0287-4154-bf69-02c0573deab8 Terraform High Encryption Sagemaker endpoint configuration should encrypt data Documentation EFS Not Encrypted48207659-729f-4b5c-9402-f884257d794f Terraform High Encryption Elastic File System (EFS) must be encrypted Documentation DOCDB Cluster Without KMS4766d3ea-241c-4ee6-93ff-c380c996bd1a Terraform High Encryption AWS DOCDB Cluster should be encrypted with a KMS encryption key Documentation CloudFront Without Minimum Protocol TLS 1.200e5e55e-c2ff-46b3-a757-a7a1cd802456 Terraform High Insecure Configurations CloudFront Minimum Protocol version should be at least TLS 1.2 Documentation DB Security Group Has Public Interfacef0d8781f-99bf-4958-9917-d39283b168a0 Terraform High Insecure Configurations The CIDR IP should not be a public interface Documentation Redshift Publicly Accessibleaf173fde-95ea-4584-b904-bb3923ac4bda Terraform High Insecure Configurations AWS Redshift Clusters must not be publicly accessible. Check if 'publicly_accessible' field is true or undefined (default is true) Documentation DB Instance Publicly Accessible35113e6f-2c6b-414d-beec-7a9482d3b2d1 Terraform High Insecure Configurations RDS must not be defined with public interface, which means the field 'publicly_accessible' should not be set to 'true' (default is 'false'). Documentation S3 Bucket with Unsecured CORS Rule98a8f708-121b-455b-ae2f-da3fb59d17e1 Terraform High Insecure Configurations If the CORS (Cross-Origin Resource Sharing) rule is defined in an S3 bucket, it should be secure Documentation Lambda Function With Privileged Role1b3af2f9-af8c-4dfc-a0f1-a03adb70deb2 Terraform High Insecure Configurations It is not advisable for AWS Lambda Functions to have privileged permissions. Documentation API Gateway Without Security Policy4e1cc5d3-2811-4fb2-861c-ee9b3cb7f90b Terraform High Insecure Configurations API Gateway should have a Security Policy defined and use TLS 1.2. Documentation ECS Task Definition Network Mode Not Recommended9f4a9409-9c60-4671-be96-9716dbf63db1 Terraform High Insecure Configurations Network_Mode should be 'awsvpc' in ecs_task_definition. AWS VPCs provides the controls to facilitate a formal process for approving and testing all network connections and changes to the firewall and router configurations Documentation IAM User Policy Without MFAb5681959-6c09-4f55-b42b-c40fa12d03ec Terraform High Insecure Configurations Check if the root user is authenticated with MFA Documentation S3 Static Website Host Enabled42bb6b7f-6d54-4428-b707-666f669d94fb Terraform High Insecure Configurations Checks if any static websites are hosted on buckets. Even static websites can be a liability when poorly configured. Documentation Root Account Has Active Access Keys970d224d-b42a-416b-81f9-8f4dfe70c4bc Terraform High Insecure Configurations The AWS Root Account must not have active access keys associated, which means if there are access keys associated to the Root Account, they must be inactive. Documentation No Password Policy Enabledb592ffd4-0577-44b6-bd35-8c5ee81b5918 Terraform High Insecure Configurations IAM password policies should be set through the password minimum length and reset password attributes Documentation S3 Bucket Without Restriction Of Public Bucket1ec253ab-c220-4d63-b2de-5b40e0af9293 Terraform High Insecure Configurations S3 bucket without restriction of public bucket Documentation KMS Key With Vulnerable Policy7ebc9038-0bde-479a-acc4-6ed7b6758899 Terraform High Insecure Configurations Checks if the policy is vulnerable and needs updating. Documentation Batch Job Definition With Privileged Container Properties66cd88ac-9ddf-424a-b77e-e55e17630bee Terraform High Insecure Configurations Batch Job Definition should not have Privileged Container Properties Documentation S3 Bucket Without Enabled MFA Deletec5b31ab9-0f26-4a49-b8aa-4cc064392f4d Terraform High Insecure Configurations S3 bucket without MFA Delete Enabled. MFA delete cannot be enabled through Terraform, it can be done by adding a MFA device (https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_mfa_enable.html) and enabling versioning and MFA delete by using AWS CLI: 'aws s3api put-bucket-versioning --versioning-configuration=Status=Enabled,MFADelete=Enabled --bucket= --mfa='. Please, also notice that MFA delete can not be used with lifecycle configurations Documentation Vulnerable Default SSL Certificate3a1e94df-6847-4c0e-a3b6-6c6af4e128ef Terraform High Insecure Defaults CloudFront web distributions should use custom (and not default) SSL certificates. Custom SSL certificates allow only defined users to access content by using an alternate domain name instead of the default one. Documentation Network ACL With Unrestricted Access To SSH3af7f2fd-06e6-4dab-b996-2912bea19ba4 Terraform High Networking and Firewall 'SSH' (TCP:22) should not be public in AWS Network ACL Documentation EKS node group remote access disabledba40ace1-a047-483c-8a8d-bc2d3a67a82d Terraform High Networking and Firewall EKS node group remote access is disabled when 'SourceSecurityGroups' is missing Documentation VPC Peering Route Table with Unrestricted CIDRb3a41501-f712-4c4f-81e5-db9a7dc0e34e Terraform High Networking and Firewall VPC Peering Route Table should restrict CIDR Documentation Unknown Port Exposed To Internet590d878b-abdc-428f-895a-e2b68a0e1998 Terraform High Networking and Firewall AWS Security Group should not have an unknown port exposed to the entire Internet Documentation ALB Listening on HTTPde7f5e83-da88-4046-871f-ea18504b1d43 Terraform High Networking and Firewall AWS Application Load Balancer (alb) should not listen on HTTP Documentation EKS Cluster Has Public Access CIDRs61cf9883-1752-4768-b18c-0d57f2737709 Terraform High Networking and Firewall Amazon EKS public endpoint is enables and accessible to all: 0.0.0.0/0\" Documentation DB Security Group Open To Large Scope4f615f3e-fb9c-4fad-8b70-2e9f781806ce Terraform High Networking and Firewall The IP address in a DB Security Group must not have more than 256 hosts. Documentation Security Group With Unrestricted Access To SSH65905cec-d691-4320-b320-2000436cb696 Terraform High Networking and Firewall 'SSH' (TCP:22) should not be public in AWS Security Group Documentation VPC Default Security Group Accepts All Traffic9a4ef195-74b9-4c58-b8ed-2b2fe4353a75 Terraform High Networking and Firewall Default Security Group attached to every VPC should restrict all traffic Documentation DB Security Group With Public Scope1e0ef61b-ad85-4518-a3d3-85eaad164885 Terraform High Networking and Firewall The IP address in a DB Security Group should not be '0.0.0.0/0' (IPv4) or '::/0' (IPv6). If so, any IP can access it Documentation HTTP Port Open To Internetffac8a12-322e-42c1-b9b9-81ff85c39ef7 Terraform High Networking and Firewall The HTTP port is open to the internet in a Security Group Documentation Unrestricted Security Group Ingress4728cd65-a20c-49da-8b31-9c08b423e4db Terraform High Networking and Firewall Security groups allow ingress from 0.0.0.0:0 and/or ::/0 Documentation RDS Associated with Public Subnet2f737336-b18a-4602-8ea0-b200312e1ac1 Terraform High Networking and Firewall RDS should not run in public subnet Documentation EC2 Instance Has Public IP5a2486aa-facf-477d-a5c1-b010789459ce Terraform High Networking and Firewall EC2 Instance should not have a public IP address. Documentation Default Security Groups With Unrestricted Traffic46883ce1-dc3e-4b17-9195-c6a601624c73 Terraform High Networking and Firewall Check if default security group does not restrict all inbound and outbound traffic. Documentation Sensitive Port Is Exposed To Entire Network381c3f2a-ef6f-4eff-99f7-b169cda3422c Terraform High Networking and Firewall A sensitive port, such as port 23 or port 110, is open for the whole network in either TCP or UDP protocol Documentation Network ACL With Unrestricted Access To RDPa20be318-cac7-457b-911d-04cc6e812c25 Terraform High Networking and Firewall 'RDP' (TCP:3389) should not be public in AWS Network ACL Documentation Remote Desktop Port Open To Internet151187cb-0efc-481c-babd-ad24e3c9bc22 Terraform High Networking and Firewall The Remote Desktop port is open to the internet in a Security Group Documentation Route53 Record Undefined25db74bf-fa3b-44da-934e-8c3e005c0453 Terraform High Networking and Firewall Check if Record is set Documentation CloudWatch Root Account Use Missing8b1b1e67-6248-4dca-bbad-93486bb181c0 Terraform High Observability Ensure a log metric filter and alarm exist for root acount usage Documentation KMS Key With No Deletion Window0b530315-0ea4-497f-b34c-4ff86268f59d Terraform High Observability AWS KMS Key should have a valid deletion window Documentation CMK Rotation Disabled22fbfeac-7b5a-421a-8a27-7a2178bb910b Terraform High Observability Customer Master Keys (CMK) must have rotation enabled, which means the attribute 'enable_key_rotation' must be set to 'true' when the key is enabled. Documentation CloudWatch Unauthorized Access Alarm Missing4c18a45b-4ab1-4790-9f83-399ac695f1e5 Terraform High Observability Ensure a log metric filter and alarm exist for unauthorized API calls Documentation CloudTrail Logging Disabled4bb76f17-3d63-4529-bdca-2b454529d774 Terraform High Observability Checks if logging is enabled for CloudTrail. Documentation CloudTrail Log Files S3 Bucket with Logging Disabledee9e50e8-b2ed-4176-ad42-8fc0cf7593f4 Terraform High Observability CloudTrail Log Files S3 Bucket should have 'logging' enabled Documentation CloudTrail Log Files S3 Bucket is Publicly Accessiblebd0088a5-c133-4b20-b129-ec9968b16ef3 Terraform High Observability CloudTrail Log Files S3 Bucket should not be publicly accessible Documentation CloudWatch IAM Policy Changes Alarm Missingeaaba502-2f94-411a-a3c2-83d63cc1776d Terraform High Observability Ensure a log metric filter and alarm exist for IAM policy changes Documentation CloudWatch Console Sign-in Without MFA Alarm Missing44ceb4fa-0897-4fd2-b676-30e7a58f2933 Terraform High Observability Ensure a log metric filter and alarm exist for management console sign-in without MFA Documentation Cross-Account IAM Assume Role Policy Without ExternalId or MFA09c35abf-5852-4622-ac7a-b987b331232e Terraform Medium Access Control Cross-Account IAM Assume Role Policy should require external ID or MFA to protect cross-account access Documentation Role With Privilege Escalation By Actions 'lambda:UpdateFunctionCode'c583f0f9-7dfd-476b-a056-f47c62b47b46 Terraform Medium Access Control Role with privilege escalation by actions 'lambda:UpdateFunctionCode' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation User With Privilege Escalation By Actions 'iam:AttachGroupPolicy'6d23d87e-1c5b-4308-b224-92624300f29b Terraform Medium Access Control User with privilege escalation by actions 'iam:AttachGroupPolicy' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation User With Privilege Escalation By Actions 'iam:PutGroupPolicy'8bfbf7ab-d5e8-4100-8618-798956e101e0 Terraform Medium Access Control User with privilege escalation by actions 'iam:PutGroupPolicy' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation Group With Privilege Escalation By Actions 'glue:UpdateDevEndpoint'8f3c16b3-354d-45db-8ad5-5066778a9485 Terraform Medium Access Control Group with privilege escalation by actions 'glue:UpdateDevEndpoint' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation Role With Privilege Escalation By Actions 'iam:CreatePolicyVersion'ee49557d-750c-4cc1-aa95-94ab36cbefde Terraform Medium Access Control Role with privilege escalation by actions 'iam:CreatePolicyVersion' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation ECR Repository Is Publicly Accessiblee86e26fc-489e-44f0-9bcd-97305e4ba69a Terraform Medium Access Control Amazon ECR image repositories shouldn't have public access Documentation Group With Privilege Escalation By Actions 'iam:PutGroupPolicy'e77c89f6-9c85-49ea-b95b-5f960fe5be92 Terraform Medium Access Control Group with privilege escalation by actions 'iam:PutGroupPolicy' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation Elasticsearch Domain With Vulnerable Policy16c4216a-50d3-4785-bfb2-4adb5144a8ba Terraform Medium Access Control Elasticsearch Domain policy should avoid wildcard in 'Action' and 'Principal'. Documentation User With Privilege Escalation By Actions 'iam:UpdateLoginProfile'6deb34e2-5d9c-499a-801b-ea6d9eda894f Terraform Medium Access Control User with privilege escalation by actions 'iam:UpdateLoginProfile' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation Group With Privilege Escalation By Actions 'iam:AddUserToGroup'970ed7a2-0aca-4425-acf1-0453c9ecbca1 Terraform Medium Access Control Group with privilege escalation by actions 'iam:AddUserToGroup' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation Group With Privilege Escalation By Actions 'iam:UpdateLoginProfile'ad296c0d-8131-4d6b-b030-1b0e73a99ad3 Terraform Medium Access Control Group with privilege escalation by actions 'iam:UpdateLoginProfile' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation Lambda With Vulnerable Policyad9dabc7-7839-4bae-a957-aa9120013f39 Terraform Medium Access Control The attribute 'action' should not have wildcard Documentation User With Privilege Escalation By Actions 'iam:SetDefaultPolicyVersion'43a41523-386a-4cb1-becb-42af6b414433 Terraform Medium Access Control User with privilege escalation by actions 'iam:SetDefaultPolicyVersion' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation Group With Privilege Escalation By Actions 'ec2:RunInstances' And 'iam:PassRole'15e6ad8c-f420-49a6-bafb-074f5eb1ec74 Terraform Medium Access Control Group with privilege escalation by actions 'ec2:RunInstances' and 'iam:PassRole' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation Role With Privilege Escalation By Actions 'iam:CreateLoginProfile'9a205ba3-0dd1-42eb-8d54-2ffec836b51a Terraform Medium Access Control Role with privilege escalation by actions 'iam:CreateLoginProfile' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation Elasticsearch Without IAM Authenticatione7530c3c-b7cf-4149-8db9-d037a0b5268e Terraform Medium Access Control AWS Elasticsearch should ensure IAM Authentication Documentation User With Privilege Escalation By Actions 'iam:AttachUserPolicy'70cb518c-d990-46f6-bc05-44a5041493d6 Terraform Medium Access Control User with privilege escalation by actions 'iam:AttachUserPolicy' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation Policy Without Principalbbe3dd3d-fea9-4b68-a785-cfabe2bbbc54 Terraform Medium Access Control All policies, except IAM identity-based policies, should have the 'Principal' element defined Documentation IAM User With Access To Console9ec311bf-dfd9-421f-8498-0b063c8bc552 Terraform Medium Access Control AWS IAM Users should not have access to console Documentation User With Privilege Escalation By Actions 'cloudformation:CreateStack' And 'iam:PassRole'19ffbe31-9d72-4379-9768-431195eae328 Terraform Medium Access Control User with privilege escalation by actions 'cloudformation:CreateStack' and 'iam:PassRole' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation User With Privilege Escalation By Actions 'glue:CreateDevEndpoint' And 'iam:PassRole'94fbe150-27e3-4eba-9ca6-af32865e4503 Terraform Medium Access Control User with privilege escalation by actions 'glue:CreateDevEndpoint' and 'iam:PassRole' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation S3 Bucket Allows Public ACLd0cc8694-fcad-43ff-ac86-32331d7e867f Terraform Medium Access Control S3 bucket allows public ACL Documentation Public Lambda via API Gateway3ef8696c-e4ae-4872-92c7-520bb44dfe77 Terraform Medium Access Control Allowing to run lambda function using public API Gateway Documentation IAM Role Policy passRole Allows Alle39bee8c-fe54-4a3f-824d-e5e2d1cca40a Terraform Medium Access Control Using the iam:passrole action with wildcards (*) in the resource can be overly permissive because it allows iam:passrole permissions on multiple resources Documentation API Gateway Method Does Not Contains An API Key671211c5-5d2a-4e97-8867-30fc28b02216 Terraform Medium Access Control An API Key should be required on a method request. Documentation IAM Access Key Is Exposed7081f85c-b94d-40fd-8b45-a4f1cac75e46 Terraform Medium Access Control IAM Access Key should not be active for root users Documentation REST API With Vulnerable Policyb161c11b-a59b-4431-9a29-4e19f63e6b27 Terraform Medium Access Control REST API policy should avoid wildcard in 'Action' and 'Principal' Documentation Public and Private EC2 Share Rolec53c7a89-f9d7-4c7b-8b66-8a555be99593 Terraform Medium Access Control Public and private EC2 istances should not share the same role. Documentation User With Privilege Escalation By Actions 'lambda:UpdateFunctionCode'b69247e5-7e73-464e-ba74-ec9b715c6e12 Terraform Medium Access Control User with privilege escalation by actions 'lambda:UpdateFunctionCode' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation Certificate Has Expiredc3831315-5ae6-4fa8-b458-3d4d5ab7a3f6 Terraform Medium Access Control Expired SSL/TLS certificates should be removed Documentation Group With Privilege Escalation By Actions 'iam:AttachGroupPolicy'70b42736-efee-4bce-80d5-50358ed94990 Terraform Medium Access Control Group with privilege escalation by actions 'iam:AttachGroupPolicy' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation Group With Privilege Escalation By Actions 'iam:CreateLoginProfile'04c686f1-e0cd-4812-88e1-4e038410074c Terraform Medium Access Control Group with privilege escalation by actions 'iam:CreateLoginProfile' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation API Gateway Without Configured Authorizered35928e-195c-4405-a252-98ccb664ab7C Terraform Medium Access Control API Gateway REST API should have an API Gateway Authorizer Documentation Glue With Vulnerable Policyd25edb51-07fb-4a73-97d4-41cecdc53a22 Terraform Medium Access Control Glue policy should avoid wildcard in 'principals' and 'actions' Documentation Role With Privilege Escalation By Actions 'iam:UpdateAssumeRolePolicy' And 'sts:AssumeRole'f1173d8c-3264-4148-9fdb-61181e031b51 Terraform Medium Access Control Role with privilege escalation by actions 'iam:UpdateAssumeRolePolicy' and 'sts:AssumeRole' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation User With Privilege Escalation By Actions 'ec2:RunInstances' And 'iam:PassRole'89561b03-cb35-44a9-a7e9-8356e71606f4 Terraform Medium Access Control User with privilege escalation by actions 'ec2:RunInstances' and 'iam:PassRole' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation Group With Privilege Escalation By Actions 'iam:PutUserPolicy'60263b4a-6801-4587-911d-919c37ed733b Terraform Medium Access Control Group with privilege escalation by actions 'iam:PutUserPolicy' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation User With Privilege Escalation By Actions 'iam:PutUserPolicy'0c10d7da-85c4-4d62-b2a8-d6c104f1bd77 Terraform Medium Access Control User with privilege escalation by actions 'iam:PutUserPolicy' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation Role With Privilege Escalation By Actions 'iam:AttachRolePolicy'f465fff1-0a0f-457d-aa4d-1bddb6f204ff Terraform Medium Access Control Role with privilege escalation by actions 'iam:AttachRolePolicy' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation Group With Privilege Escalation By Actions 'iam:UpdateAssumeRolePolicy' And 'sts:AssumeRole'78f1ec6f-5659-41ea-bd48-d0a142dce4f2 Terraform Medium Access Control Group with privilege escalation by actions 'iam:UpdateAssumeRolePolicy' and 'sts:AssumeRole' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation Group With Privilege Escalation By Actions 'cloudformation:CreateStack' And 'iam:PassRole'9b0ffadc-a61f-4c2a-b1e6-68fab60f6267 Terraform Medium Access Control Group with privilege escalation by actions 'cloudformation:CreateStack' and 'iam:PassRole' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation Role With Privilege Escalation By Actions 'glue:CreateDevEndpoint' And 'iam:PassRole'0a592060-8166-49f5-8e65-99ac6dce9871 Terraform Medium Access Control Role with privilege escalation by actions 'glue:CreateDevEndpoint' and 'iam:PassRole' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation Neptune Cluster With IAM Database Authentication Disabledc91d7ea0-d4d1-403b-8fe1-c9961ac082c5 Terraform Medium Access Control Neptune Cluster should have IAM Database Authentication enabled Documentation Role With Privilege Escalation By Actions 'iam:PutGroupPolicy'd6047119-a0b2-4b59-a4f2-127a36fb685b Terraform Medium Access Control Role with privilege escalation by actions 'iam:PutGroupPolicy' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation Group With Privilege Escalation By Actions 'lambda:UpdateFunctionCode'571254d8-aa6a-432e-9725-535d3ef04d69 Terraform Medium Access Control Group with privilege escalation by actions 'lambda:UpdateFunctionCode' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation Role With Privilege Escalation By Actions 'glue:UpdateDevEndpoint'eda48c88-2b7d-4e34-b6ca-04c0194aee17 Terraform Medium Access Control Role with privilege escalation by actions 'glue:UpdateDevEndpoint' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation User With Privilege Escalation By Actions 'iam:CreatePolicyVersion'1743f5f1-0bb0-4934-acef-c80baa5dadfa Terraform Medium Access Control User with privilege escalation by actions 'iam:CreatePolicyVersion' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation SSO Permission With Inadequate User Session Durationce9dfce0-5fc8-433b-944a-3b16153111a8 Terraform Medium Access Control SSO permissions should be configured to limit user sessions to no longer than 1 hour. Allowing longer sessions can increase the risk of unauthorized access or session hijacking. This is a best practice for security and should be implemented in SSO permission settings. Documentation Role With Privilege Escalation By Actions 'cloudformation:CreateStack' And 'iam:PassRole'be2aa235-bd93-4b68-978a-1cc65d49082f Terraform Medium Access Control Role with privilege escalation by actions 'cloudformation:CreateStack' and 'iam:PassRole' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation Role With Privilege Escalation By Actions 'iam:AttachUserPolicy'7c96920c-6fd0-449d-9a52-0aa431b6beaf Terraform Medium Access Control Role with privilege escalation by actions 'iam:AttachUserPolicy' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation Role With Privilege Escalation By Actions 'iam:SetDefaultPolicyVersion'118281d0-6471-422e-a7c5-051bc667926e Terraform Medium Access Control Role with privilege escalation by actions 'iam:SetDefaultPolicyVersion' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation SES Policy With Allowed IAM Actions34b921bd-90a0-402e-a0a5-dc73371fd963 Terraform Medium Access Control SES policy should not allow IAM actions to all principals Documentation User With Privilege Escalation By Actions 'iam:CreateLoginProfile'0fd7d920-4711-46bd-aff2-d307d82cd8b7 Terraform Medium Access Control User with privilege escalation by actions 'iam:CreateLoginProfile' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation Group With Privilege Escalation By Actions 'iam:CreateAccessKey'846646e3-2af1-428c-ac5d-271eccfa6faf Terraform Medium Access Control Group with privilege escalation by actions 'iam:CreateAccessKey' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation Role With Privilege Escalation By Actions 'ec2:RunInstances' And 'iam:PassRole'30b88745-eebe-4ecb-a3a9-5cf886e96204 Terraform Medium Access Control Role with privilege escalation by actions 'ec2:RunInstances' and 'iam:PassRole' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation User With Privilege Escalation By Actions 'iam:AddUserToGroup'bf9d42c7-c2f9-4dfe-942c-c8cc8249a081 Terraform Medium Access Control User with privilege escalation by actions 'iam:AddUserToGroup' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation Lambda Permission Principal Is Wildcarde08ed7eb-f3ef-494d-9d22-2e3db756a347 Terraform Medium Access Control Lambda Permission Principal should not contain a wildcard. Documentation Role With Privilege Escalation By Actions 'iam:UpdateLoginProfile'35ccf766-0e4d-41ed-9ec4-2dab155082b4 Terraform Medium Access Control Role with privilege escalation by actions 'iam:UpdateLoginProfile' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation Group With Privilege Escalation By Actions 'iam:SetDefaultPolicyVersion'7782d4b3-e23e-432b-9742-d9528432e771 Terraform Medium Access Control Group with privilege escalation by actions 'iam:SetDefaultPolicyVersion' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation User With Privilege Escalation By Actions 'iam:CreateAccessKey'113208f2-a886-4526-9ecc-f3218600e12c Terraform Medium Access Control User with privilege escalation by actions 'iam:CreateAccessKey' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation IAM Policies Attached To Userb4378389-a9aa-44ee-91e7-ef183f11079e Terraform Medium Access Control IAM policies should be attached only to groups or roles Documentation Group With Privilege Escalation By Actions 'iam:PutRolePolicy'c0c1e744-0f37-445e-924a-1846f0839f69 Terraform Medium Access Control Group with privilege escalation by actions 'iam:PutRolePolicy' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation SQS Policy With Public Access730675f9-52ed-49b6-8ead-0acb5dd7df7f Terraform Medium Access Control Checks for dangerous permissions in Action statements in an SQS Queue Policy. This is deemed a potential security risk as it would allow various attacks to the queue Documentation Group With Privilege Escalation By Actions 'iam:CreatePolicyVersion'ec49cbfd-fae4-45f3-81b1-860526d66e3f Terraform Medium Access Control Group with privilege escalation by actions 'iam:CreatePolicyVersion' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation Group With Privilege Escalation By Actions 'lambda:CreateFunction' And 'iam:PassRole' And 'lambda:InvokeFunction'034d0aee-620f-4bf7-b7fb-efdf661fdb9e Terraform Medium Access Control Group with privilege escalation by actions 'lambda:CreateFunction' and 'iam:PassRole' and 'lambda:InvokeFunction' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation User With Privilege Escalation By Actions 'lambda:CreateFunction' And 'iam:PassRole' And 'lambda:InvokeFunction'8055dec2-efb8-4fe6-8837-d9bed6ff202a Terraform Medium Access Control User with privilege escalation by actions 'lambda:CreateFunction' and 'iam:PassRole' and 'lambda:InvokeFunction' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation AMI Shared With Multiple Accountsba4e0031-3e9d-4d7d-b0d6-bd8f003f8698 Terraform Medium Access Control Limits access to AWS AMIs by checking if more than one account is using the same image Documentation Group With Privilege Escalation By Actions 'iam:AttachRolePolicy'3dd96caa-0b5f-4a85-b929-acfac4646cc2 Terraform Medium Access Control Group with privilege escalation by actions 'iam:AttachRolePolicy' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation Role With Privilege Escalation By Actions 'iam:PutUserPolicy'8f75840d-9ee7-42f3-b203-b40e3979eb12 Terraform Medium Access Control Role with privilege escalation by actions 'iam:PutUserPolicy' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation SQS Policy Allows All Actions816ea8cf-d589-442d-a917-2dd0ce0e45e3 Terraform Medium Access Control SQS policy allows ALL (*) actions Documentation User With Privilege Escalation By Actions 'glue:UpdateDevEndpoint'9b877bd8-94b4-4c10-a060-8e0436cc09fa Terraform Medium Access Control User with privilege escalation by actions 'glue:UpdateDevEndpoint' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation Group With Privilege Escalation By Actions 'glue:CreateDevEndpoint' And 'iam:PassRole'7d544dad-8a6c-431c-84c1-5f07fe9afc0e Terraform Medium Access Control Group with privilege escalation by actions 'glue:CreateDevEndpoint' and 'iam:PassRole' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation Role With Privilege Escalation By Actions 'iam:AttachGroupPolicy'f906113d-cdc0-415a-ba60-609cc6daaf4d Terraform Medium Access Control Role with privilege escalation by actions 'iam:AttachGroupPolicy' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation Role With Privilege Escalation By Actions 'lambda:CreateFunction' And 'iam:PassRole' And 'lambda:InvokeFunction'fa62ac4f-f5b9-45b9-97c1-625c8b6253ca Terraform Medium Access Control Role with privilege escalation by actions 'lambda:CreateFunction' and 'iam:PassRole' and 'lambda:InvokeFunction' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation Group With Privilege Escalation By Actions 'iam:AttachUserPolicy'db78d14b-10e5-4e6e-84b1-dace6327b1ec Terraform Medium Access Control Group with privilege escalation by actions 'iam:AttachUserPolicy' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation Role With Privilege Escalation By Actions 'iam:PutRolePolicy'eb64f1e9-f67d-4e35-8a3c-3d6a2f9efea7 Terraform Medium Access Control Role with privilege escalation by actions 'iam:PutRolePolicy' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation User With Privilege Escalation By Actions 'iam:PutRolePolicy'eeb4d37a-3c59-4789-a00c-1509bc3af1e5 Terraform Medium Access Control User with privilege escalation by actions 'iam:PutRolePolicy' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation SNS Topic Publicity Has Allow and NotAction Simultaneously5ea624e4-c8b1-4bb3-87a4-4235a776adcc Terraform Medium Access Control SNS topic Publicity should not have 'Effect: Allow' and argument 'NotAction' at the same time. If it has 'Effect: Allow', the argument stated should be 'Action'. Documentation User With Privilege Escalation By Actions 'iam:AttachRolePolicy'e227091e-2228-4b40-b046-fc13650d8e88 Terraform Medium Access Control User with privilege escalation by actions 'iam:AttachRolePolicy' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation Role With Privilege Escalation By Actions 'iam:CreateAccessKey'5b4d4aee-ac94-4810-9611-833636e5916d Terraform Medium Access Control Role with privilege escalation by actions 'iam:CreateAccessKey' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation CloudWatch Logs Destination With Vulnerable Policydb0ec4c4-852c-46a2-b4f3-7ec13cdb12a8 Terraform Medium Access Control CloudWatch Logs destination policy should avoid wildcard in 'principals' and 'actions' Documentation Secrets Manager With Vulnerable Policyfa00ce45-386d-4718-8392-fb485e1f3c5b Terraform Medium Access Control Secrets Manager policy should avoid wildcard in 'Principal' and 'Action' Documentation User With Privilege Escalation By Actions 'iam:UpdateAssumeRolePolicy' And 'sts:AssumeRole'33627268-1445-4385-988a-318fd9d1a512 Terraform Medium Access Control User with privilege escalation by actions 'iam:UpdateAssumeRolePolicy' and 'sts:AssumeRole' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation Role With Privilege Escalation By Actions 'iam:AddUserToGroup'b8a31292-509d-4b61-bc40-13b167db7e9c Terraform Medium Access Control Role with privilege escalation by actions 'iam:AddUserToGroup' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation Auto Scaling Group With No Associated ELB8e94dced-9bcc-4203-8eb7-7e41202b2505 Terraform Medium Availability AWS Auto Scaling Groups must have associated ELBs to ensure high availability and improve application performance. This means the attribute 'load_balancers' must be defined and not empty. Documentation ECS Service Without Running Tasks91f16d09-689e-4926-aca7-155157f634ed Terraform Medium Availability ECS Service should have at least 1 task running Documentation ElastiCache Nodes Not Created Across Multi AZ6db03a91-f933-4f13-ab38-a8b87a7de54d Terraform Medium Availability ElastiCache Nodes should be created across multi az, which means 'az_mode' should be set to 'cross-az' in multi nodes cluster Documentation CMK Is Unusable7350fa23-dcf7-4938-916d-6a60b0c73b50 Terraform Medium Availability AWS Key Management Service (KMS) must only possess usable Customer Master Keys (CMK), which means the CMKs must have the attribute 'is_enabled' set to true Documentation RDS With Backup Disabled1dc73fb4-5b51-430c-8c5f-25dcf9090b02 Terraform Medium Backup Make sure the AWS RDS configuration has automatic backup configured. If the retention period is equal to 0 there is no backup Documentation Stack Retention Disabled6e0e2f68-3fd9-4cd8-a5e4-e2213ef0df97 Terraform Medium Backup Make sure that retain_stack is enabled to keep the Stack and it's associated resources during resource destruction Documentation ElastiCache Redis Cluster Without Backup8fdb08a0-a868-4fdf-9c27-ccab0237f1ab Terraform Medium Backup ElastiCache Redis cluster should have 'snapshot_retention_limit' higher than 0 Documentation IAM Password Without Uppercase Letterc5ff7bc9-d8ea-46dd-81cb-8286f3222249 Terraform Medium Best Practices IAM password should have at least one uppercase letter Documentation ALB Not Dropping Invalid Headers6e3fd2ed-5c83-4c68-9679-7700d224d379 Terraform Medium Best Practices It's considered a best practice when using Application Load Balancers to drop invalid header fields Documentation Misconfigured Password Policy Expirationce60d060-efb8-4bfd-9cf7-ff8945d00d90 Terraform Medium Best Practices No password expiration policy Documentation Password Without Reuse Prevention89806cdc-9c2e-4bd1-a0dc-53f339bcfb2a Terraform Medium Best Practices Check if IAM account password has the reuse password configured with 24 Documentation IAM Password Without Lowercase Letterbbc7c137-6c7b-4fc4-984a-0c88e91fcaf9 Terraform Medium Best Practices IAM Password should have at least one lowercase letter Documentation RDS Cluster With Backup Disablede542bd46-58c4-4e0f-a52a-1fb4f9548e02 Terraform Medium Best Practices RDS Cluster backup retention period should be specifically defined Documentation Cognito UserPool Without MFAec28bf61-a474-4dbe-b414-6dd3a067d6f0 Terraform Medium Best Practices AWS Cognito UserPool should have MFA (Multi-Factor Authentication) defined to users Documentation IAM Password Without Symbol7a70eed6-de3a-4da2-94da-a2bbc8fe2a48 Terraform Medium Best Practices IAM password should have the required symbols Documentation IAM Password Without Minimum Length1bc1c685-e593-450e-88fb-19db4c82aa1d Terraform Medium Best Practices IAM password should have the required minimum length Documentation Stack Without Template91bea7b8-0c31-4863-adc9-93f6177266c4 Terraform Medium Build Process AWS CloudFormation should have a template defined through the attribute template_url or attribute template_body Documentation ElastiCache Replication Group Not Encrypted At Rest76976de7-c7b1-4f64-a94f-90c1345914c2 Terraform Medium Encryption ElastiCache Replication Group encryption should be enabled at Rest Documentation API Gateway With Invalid Compressioned35928e-195c-4405-a252-98ccb664ab7b Terraform Medium Encryption API Gateway should have valid compression, which means attribute 'minimum_compression_size' should be set and its value should be greater than -1 and smaller than 10485760. Documentation DOCDB Cluster Encrypted With AWS Managed Key2134641d-30a4-4b16-8ffc-2cd4c4ffd15d Terraform Medium Encryption DOCDB Cluster should be encrypted with customer-managed KMS keys instead of AWS managed keys Documentation Neptune Database Cluster Encryption Disabled98d59056-f745-4ef5-8613-32bca8d40b7e Terraform Medium Encryption Neptune database cluster storage should have encryption enabled Documentation ElastiCache Replication Group Not Encrypted At Transit1afbb3fa-cf6c-4a3d-b730-95e9f4df343e Terraform Medium Encryption ElastiCache Replication Group encryption should be enabled at Transit Documentation Config Rule For Encrypted Volumes Disabledabdb29d4-5ca1-4e91-800b-b3569bbd788c Terraform Medium Encryption Check if AWS config rules do not identify Encrypted Volumes as a source. Documentation ElasticSearch Not Encrypted At Rest24e16922-4330-4e9d-be8a-caa90299466a Terraform Medium Encryption Check if ElasticSearch encryption is disabled at Rest Documentation ElasticSearch Encryption With KMS Disabled7af2f4a3-00d9-47f3-8d15-ca0888f4e5b2 Terraform Medium Encryption Check if any ElasticSearch domain isn't encrypted with KMS. Documentation Unscanned ECR Image9630336b-3fed-4096-8173-b9afdfe346a7 Terraform Medium Encryption Checks if the ECR Image has been scanned Documentation Redis Disabled4bd15dd9-8d5e-4008-8532-27eb0c3706d3 Terraform Medium Encryption ElastiCache should have Redis enabled, since it covers Compliance Certifications such as FedRAMP, HIPAA, and PCI DSS. For more information, take a look at 'https://docs.aws.amazon.com/AmazonElastiCache/latest/mem-ug/SelectEngine.html' Documentation CloudWatch Log Group Without KMS0afbcfe9-d341-4b92-a64c-7e6de0543879 Terraform Medium Encryption AWS CloudWatch Log groups should be encrypted using KMS Documentation SNS Topic Not Encrypted28545147-2fc6-42d5-a1f9-cf226658e591 Terraform Medium Encryption SNS (Simple Notification Service) Topic should be encrypted Documentation S3 Bucket Policy Accepts HTTP Requests4bc4dd4c-7d8d-405e-a0fb-57fa4c31b4d9 Terraform Medium Encryption S3 Bucket policy should not accept HTTP Requests Documentation AmazonMQ Broker Encryption Disabled3db3f534-e3a3-487f-88c7-0a9fbf64b702 Terraform Medium Encryption AmazonMQ Broker should have Encryption Options defined Documentation Secretsmanager Secret Encrypted With AWS Managed Keyb0d3ef3f-845d-4b1b-83d6-63a5a380375f Terraform Medium Encryption Secrets Manager secret should be encrypted with customer-managed KMS keys instead of AWS managed keys Documentation DynamoDB Table Not Encryptedce089fd4-1406-47bd-8aad-c259772bb294 Terraform Medium Encryption AWS DynamoDB Tables should have server-side encryption Documentation Secretsmanager Secret Without KMSa2f548f2-188c-4fff-b172-e9a6acb216bd Terraform Medium Encryption AWS Secretmanager should use AWS KMS customer master key (CMK) to encrypt the secret values in the versions stored in the secret Documentation EBS Volume Encryption Disabledcc997676-481b-4e93-aa81-d19f8c5e9b12 Terraform Medium Encryption EBS volumes should be encrypted Documentation SNS Topic Encrypted With AWS Managed Keyb1a72f66-2236-4f3b-87ba-0da1b366956f Terraform Medium Encryption SNS (Simple Notification Service) Topic should be encrypted with customer-managed KMS keys instead of AWS managed keys Documentation SQS With SSE Disabled6e8849c1-3aa7-40e3-9063-b85ee300f29f Terraform Medium Encryption Amazon Simple Queue Service (SQS) queue should protect the contents of their messages using Server-Side Encryption (SSE) Documentation Elasticsearch Domain Not Encrypted Node To Node967eb3e6-26fc-497d-8895-6428beb6e8e2 Terraform Medium Encryption Elasticsearch Domain encryption should be enabled node to node Documentation SSM Session Transit Encryption Disabledce60cc6b-6831-4bd7-84a2-cc7f8ee71433 Terraform Medium Encryption SSM Session should be encrypted in transit Documentation ECR Image Tag Not Immutabled1846b12-20c5-4d45-8798-fc35b79268eb Terraform Medium Insecure Configurations ECR should have an image tag be immutable. This prevents image tags from being overwritten. Documentation IAM User Has Too Many Access Keys3561130e-9c5f-485b-9e16-2764c82763e5 Terraform Medium Insecure Configurations Any IAM User should not have more than one access key since it increases the risk of unauthorized access and compromise credentials Documentation API Gateway With Open Access15ccec05-5476-4890-ad19-53991eba1db8 Terraform Medium Insecure Configurations API Gateway Method should restrict the authorization type, except for the HTTP OPTIONS method. Documentation Instance With No VPCa31a5a29-718a-4ff4-8001-a69e5e4d029e Terraform Medium Insecure Configurations EC2 Instances should be configured under a VPC network. AWS VPCs provide the controls to facilitate a formal process for approving and testing all network connections and changes to the firewall and router configurations. Documentation Service Control Policies Disabled5ba6229c-8057-433e-91d0-21cf13569ca9 Terraform Medium Insecure Configurations Check if the Amazon Organizations ensure that all features are enabled to achieve full control over the use of AWS services and actions across multiple AWS accounts using Service Control Policies (SCPs). Documentation AWS Password Policy With Unchangeable Passwords9ef7d25d-9764-4224-9968-fa321c56ef76 Terraform Medium Insecure Configurations Unchangeable passwords in AWS password policy Documentation Certificate RSA Key Bytes Lower Than 256874d68a3-bfbe-4a4b-aaa0-9e74d7da634b Terraform Medium Insecure Configurations The certificate should use a RSA key with a length equal to or higher than 256 bytes Documentation API Gateway Without SSL Certificate0b4869fc-a842-4597-aa00-1294df425440 Terraform Medium Insecure Configurations SSL Client Certificate should be enabled Documentation MQ Broker Is Publicly Accessible4eb5f791-c861-4afd-9f94-f2a6a3fe49cb Terraform Medium Insecure Configurations Check if any MQ Broker is not publicly accessible Documentation EKS Cluster Has Public Access42f4b905-3736-4213-bfe9-c0660518cda8 Terraform Medium Insecure Configurations Amazon EKS public endpoint shoud be set to false Documentation Redshift Cluster Without VPC0a494a6a-ebe2-48a0-9d77-cf9d5125e1b3 Terraform Medium Insecure Configurations Redshift Cluster should be configured in VPC (Virtual Private Cloud) Documentation SQL Analysis Services Port 2383 (TCP) Is Publicly Accessible54c417bf-c762-48b9-9d31-b3d87047e3f0 Terraform Medium Networking and Firewall Check if port 2383 on TCP is publicly accessible by checking the CIDR block range that can access it. Documentation API Gateway without WAFa186e82c-1078-4a7b-85d8-579561fde884 Terraform Medium Networking and Firewall API Gateway should have WAF (Web Application Firewall) enabled Documentation VPC Without Network Firewallfd632aaf-b8a1-424d-a4d1-0de22fd3247a Terraform Medium Networking and Firewall VPC should have a Network Firewall associated Documentation SQS VPC Endpoint Without DNS Resolutione9b7acf9-9ba0-4837-a744-31e7df1e434d Terraform Medium Networking and Firewall SQS VPC Endpoint should have DNS resolution enabled Documentation Sensitive Port Is Exposed To Small Public Networke35c16a2-d54e-419d-8546-a804d8e024d0 Terraform Medium Networking and Firewall A sensitive port, such as port 23 or port 110, is open for a small public network in either TCP or UDP protocol Documentation API Gateway Endpoint Config is Not Private6b2739db-9c49-4db7-b980-7816e0c248c1 Terraform Medium Networking and Firewall The API Endpoint type in API Gateway should be set to PRIVATE so it's not exposed to the public internet Documentation Dynamodb VPC Endpoint Without Route Table Association0bc534c5-13d1-4353-a7fe-b8665d5c1d7d Terraform Medium Networking and Firewall Dynamodb VPC Endpoint should be associated with Route Table Association Documentation VPC Subnet Assigns Public IP52f04a44-6bfa-4c41-b1d3-4ae99a2de05c Terraform Medium Networking and Firewall VPC Subnet should not assign public IP Documentation Sensitive Port Is Exposed To Wide Private Network92fe237e-074c-4262-81a4-2077acb928c1 Terraform Medium Networking and Firewall A sensitive port, such as port 23 or port 110, is open for a wide private network in either TCP or UDP protocol Documentation ALB Is Not Integrated With WAF0afa6ab8-a047-48cf-be07-93a2f8c34cf7 Terraform Medium Networking and Firewall All Application Load Balancers (ALB) must be protected with Web Application Firewall (WAF) service Documentation API Gateway With CloudWatch Logging Disabled982aa526-6970-4c59-8b9b-2ce7e019fe36 Terraform Medium Observability AWS CloudWatch Logs for APIs should be enabled and using the naming convention described in documentation Documentation API Gateway Deployment Without Access Log Setting625abc0e-f980-4ac9-a775-f7519ee34296 Terraform Medium Observability API Gateway Deployment should have access log setting defined when connected to an API Gateway Stage. Documentation CloudWatch Disabling Or Scheduled Deletion Of Customer Created CMK Alarm Missing56a585f5-555c-48b2-8395-e64e4740a9cf Terraform Medium Observability Ensure a log metric filter and alarm exist for disabling or scheduled deletion of customer created CMK Documentation API Gateway Access Logging Disabled1b6799eb-4a7a-4b04-9001-8cceb9999326 Terraform Medium Observability API Gateway should have Access Log Settings defined Documentation Stack Notifications Disabledb72d0026-f649-4c91-a9ea-15d8f681ac09 Terraform Medium Observability AWS CloudFormation should have stack notifications enabled to be notified when an event occurs Documentation ELB Access Log Disabled20018359-6fd7-4d05-ab26-d4dffccbdf79 Terraform Medium Observability ELB should have logging enabled to help on error investigation Documentation CloudWatch S3 policy Change Alarm Missing27c6a499-895a-4dc7-9617-5c485218db13 Terraform Medium Observability Ensure a log metric filter and alarm exist for S3 bucket policy changes Documentation API Gateway X-Ray Disabled5813ef56-fa94-406a-b35d-977d4a56ff2b Terraform Medium Observability API Gateway should have X-Ray Tracing enabled Documentation Cloudwatch Security Group Changes Alarm Missing4beaf898-9f8b-4237-89e2-5ffdc7ee6006 Terraform Medium Observability Ensure a log metric filter and alarm exist for security group changes Documentation MSK Cluster Logging Disabled2f56b7ab-7fba-4e93-82f0-247e5ddeb239 Terraform Medium Observability Ensure MSK Cluster Logging is enabled Documentation CloudWatch Logging Disabled7dbba512-e244-42dc-98bb-422339827967 Terraform Medium Observability Check if CloudWatch logging is disabled for Route53 hosted zones Documentation CloudTrail Not Integrated With CloudWatch17b30f8f-8dfb-4597-adf6-57600b6cf25e Terraform Medium Observability CloudTrail should be integrated with CloudWatch Documentation Configuration Aggregator to All Regions Disabledac5a0bc0-a54c-45aa-90c3-15f7703b9132 Terraform Medium Observability AWS Config Configuration Aggregator All Regions must be set to True Documentation Default VPC Exists96ed3526-0179-4c73-b1b2-372fde2e0d13 Terraform Medium Observability It isn't recommended to use resources in default VPC Documentation CloudWatch Metrics Disabled081069cb-588b-4ce1-884c-2a1ce3029fe5 Terraform Medium Observability Checks if CloudWatch Metrics is Enabled Documentation S3 Bucket Logging Disabledf861041c-8c9f-4156-acfc-5e6e524f5884 Terraform Medium Observability Server Access Logging should be enabled on S3 Buckets so that all changes are logged and trackable Documentation S3 Bucket Without Versioning568a4d22-3517-44a6-a7ad-6a7eed88722c Terraform Medium Observability S3 bucket should have versioning enabled Documentation CloudWatch AWS Organizations Changes Missing Alarm38b85c45-e772-4de8-a247-69619ca137b3 Terraform Medium Observability Ensure a log metric filter and alarm exist for AWS organizations changes Documentation Redshift Cluster Logging Disabled15ffbacc-fa42-4f6f-a57d-2feac7365caa Terraform Medium Observability Make sure Logging is enabled for Redshift Cluster Documentation Cloudwatch Cloudtrail Configuration Changes Alarm Missing0f6cbf69-41bb-47dc-93f3-3844640bf480 Terraform Medium Observability Ensure a log metric filter and alarm exist for CloudTrail configuration changes Documentation S3 Bucket Object Level CloudTrail Logging Disableda8fc2180-b3ac-4c93-bd0d-a55b974e4b07 Terraform Medium Observability S3 Bucket object-level CloudTrail logging should be enabled for read and write events Documentation CloudTrail Multi Region Disabled8173d5eb-96b5-4aa6-a71b-ecfa153c123d Terraform Medium Observability CloudTrail multi region should be enabled, which means attributes 'is_multi_region_trail' and 'include_global_service_events' should be enabled Documentation CloudWatch Management Console Auth Failed Alarm Missing5864d189-ee9a-4009-ac0c-8a582e6b7919 Terraform Medium Observability Ensure a log metric filter and alarm exist for AWS Management Console authentication failures Documentation MQ Broker Logging Disabled31245f98-a6a9-4182-9fc1-45482b9d030a Terraform Medium Observability Check if MQ Brokers don't have logging enabled in any of the two options possible (audit and general). Documentation CloudFront Logging Disabled94690d79-b3b0-43de-b656-84ebef5753e5 Terraform Medium Observability AWS CloudFront distributions should have logging enabled to collect all viewer requests, which means the attribute 'logging_config' should be defined Documentation CloudWatch Without Retention Period Specifiedef0b316a-211e-42f1-888e-64efe172b755 Terraform Medium Observability AWS CloudWatch Log groups should have retention days specified Documentation Elasticsearch Log Disabledacb6b4e2-a086-4f35-aefd-4db6ea51ada2 Terraform Medium Observability AWS Elasticsearch should have logs enabled Documentation CloudTrail SNS Topic Name Undefined482b7d26-0bdb-4b5f-bf6f-545826c0a3dd Terraform Medium Observability Check if SNS topic name is set for CloudTrail Documentation GuardDuty Detector Disabled704dadd3-54fc-48ac-b6a0-02f170011473 Terraform Medium Observability Make sure that Amazon GuardDuty is Enabled Documentation ElasticSearch Without Slow Logse979fcbc-df6c-422d-9458-c33d65e71c45 Terraform Medium Observability Ensure that AWS Elasticsearch enables support for slow logs Documentation No Stack Policy2f01fb2d-828a-499d-b98e-b83747305052 Terraform Medium Resource Management AWS CloudFormation Stack should have a stack policy in order to protect stack resources from update actions Documentation Hardcoded AWS Access Key In Lambda1402afd8-a95c-4e84-8b0b-6fb43758e6ce Terraform Medium Secret Management Lambda access/secret keys should not be hardcoded Documentation Hardcoded AWS Access Keyd7b9d850-3e06-4a75-852f-c46c2e92240b Terraform Medium Secret Management AWS Access Key should not be hardcoded Documentation IAM Group Without Usersfc101ca7-c9dd-4198-a1eb-0fbe92e80044 Terraform Low Access Control IAM Group should have at least one user associated Documentation SSO Identity User Unsafe Creation4003118b-046b-4640-b200-b8c7a4c8b89f Terraform Low Access Control The use of AWS SSO for creating users may pose a security risk as it does not synchronize with external Identity Providers (IdP) or Active Directory (AD). This can lead to inconsistencies and potential unauthorized access to resources. It is recommended to review and update user creation processes to ensure proper security protocols are in place. Documentation S3 Bucket Public ACL Overridden By Public Access Blockbf878b1a-7418-4de3-b13c-3a86cf894920 Terraform Low Access Control S3 bucket public access is overridden by S3 bucket Public Access Block when the following attributes are set to true - 'block_public_acls', 'block_public_policy', 'ignore_public_acls', and 'restrict_public_buckets' Documentation EC2 Instance Using API Keys0b93729a-d882-4803-bdc3-ac429a21f158 Terraform Low Access Control EC2 instances should use roles to be granted access to other AWS services Documentation IAM Policy Grants 'AssumeRole' Permission Across All Servicesbcdcbdc6-a350-4855-ae7c-d1e6436f7c97 Terraform Low Access Control IAM Policy should not grant 'AssumeRole' permission across all services. Documentation EC2 Instance Using Default Security Groupf1adc521-f79a-4d71-b55b-a68294687432 Terraform Low Access Control EC2 instances should not use default security group(s) Documentation IAM Role Allows All Principals To Assume12b7e704-37f0-4d1e-911a-44bf60c48c21 Terraform Low Access Control IAM role allows all services or principals to assume it Documentation Autoscaling Groups Supply Tagsba48df05-eaa1-4d64-905e-4a4b051e7587 Terraform Low Availability Autoscaling groups should supply tags to configurate Documentation IAM Access Analyzer Not Enablede592a0c5-5bdb-414c-9066-5dba7cdea370 Terraform Low Best Practices IAM Access Analyzer should be enabled and configured to continuously monitor resource permissions Documentation Automatic Minor Upgrades Disabled3b6d777b-76e3-4133-80a3-0d6f667ade7f Terraform Low Best Practices RDS instance should have automatic minor upgrades enabled, which means the attribute 'auto_minor_version_upgrade' must be set to true. Documentation CDN Configuration Is Missing1bc367f6-901d-4870-ad0c-71d79762ef52 Terraform Low Best Practices Content Delivery Network (CDN) service is used within an AWS account to secure and accelerate the delivery of websites. The use of a CDN can provide a layer of security between your origin content and the destination. Documentation Lambda IAM InvokeFunction Misconfigured0ca1017d-3b80-423e-bb9c-6cd5898d34bd Terraform Low Best Practices Lambda permission may be misconfigured if the action field is not filled in by 'lambda:InvokeFunction' Documentation ECR Repository Without Policy69e7c320-b65d-41bb-be02-d63ecc0bcc9d Terraform Low Best Practices ECR Repository should have Policies attached to it Documentation Lambda Permission Misconfigured75ec6890-83af-4bf1-9f16-e83726df0bd0 Terraform Low Best Practices Lambda permission may be misconfigured if the action field is not filled in by 'lambda:InvokeFunction' Documentation CloudTrail Log Files Not Encrypted With KMS5d9e3164-9265-470c-9a10-57ae454ac0c7 Terraform Low Encryption Logs delivered by CloudTrail should be encrypted using KMS to increase security of your CloudTrail Documentation ECR Repository Not Encrypted With CMK0e32d561-4b5a-4664-a6e3-a3fa85649157 Terraform Low Encryption ECR repositories should be encrypted with customer-managed keys to meet stricter security and compliance requirements on access control, monitoring, and key rotation Documentation S3 Bucket Without Ignore Public ACL4fa66806-0dd9-4f8d-9480-3174d39c7c91 Terraform Low Insecure Configurations S3 bucket without ignore public ACL Documentation ALB Deletion Protection Disabledafecd1f1-6378-4f7e-bb3b-60c35801fdd4 Terraform Low Insecure Configurations Application Load Balancer should have deletion protection enabled Documentation RDS Using Default Portbca7cc4d-b3a4-4345-9461-eb69c68fcd26 Terraform Low Networking and Firewall RDS should not use the default port (an attacker can easily guess the port). For engines related to Aurora, MariaDB or MySQL, the default port is 3306. PostgreSQL default port is 5432, Oracle default port is 1521 and SQL Server default port is 1433 Documentation EMR Without VPC2b3c8a6d-9856-43e6-ab1d-d651094f03b4 Terraform Low Networking and Firewall Elastic MapReduce Cluster (EMR) should be launched in a Virtual Private Cloud (VPC) Documentation ElastiCache Without VPC8c849af7-a399-46f7-a34c-32d3dc96f1fc Terraform Low Networking and Firewall ElastiCache should be launched in a Virtual Private Cloud (VPC) Documentation CloudFront Without WAF1419b4c6-6d5c-4534-9cf6-6a5266085333 Terraform Low Networking and Firewall All AWS CloudFront distributions should be integrated with the Web Application Firewall (AWS WAF) service Documentation ElastiCache Using Default Port5d89db57-8b51-4b38-bb76-b9bd42bd40f0 Terraform Low Networking and Firewall ElastiCache should not use the default port (an attacker can easily guess the port). For engine set to Redis, the default port is 6379. The Memcached default port is 11211 Documentation EC2 Instance Using Default VPC7e4a6e76-568d-43ef-8c4e-36dea481bff1 Terraform Low Networking and Firewall EC2 Instances should not be configured under a default VPC network Documentation Redshift Using Default Port41abc6cc-dde1-4217-83d3-fb5f0cc09d8f Terraform Low Networking and Firewall Redshift should not use the default port (5439) because an attacker can easily guess the port Documentation Shield Advanced Not In Use084c6686-2a70-4710-91b1-000393e54c12 Terraform Low Networking and Firewall AWS Shield Advanced should be used for Amazon Route 53 hosted zone, AWS Global Accelerator accelerator, Elastic IP Address, Elastic Load Balancing, and Amazon CloudFront Distribution to protect these resources against robust DDoS attacks Documentation DocDB Logging Is Disabled56f6a008-1b14-4af4-b9b2-ab7cf7e27641 Terraform Low Observability DocDB logging should be enabled Documentation EKS cluster logging is not enabled37304d3f-f852-40b8-ae3f-725e87a7cedf Terraform Low Observability Amazon EKS control plane logging is not enabled Documentation CloudWatch Network Gateways Changes Alarm Missing6b6874fe-4c2f-4eea-8b90-7cceaa4a125e Terraform Low Observability Ensure a log metric filter and alarm exist for network gateways changes Documentation CloudTrail Log File Validation Disabled52ffcfa6-6c70-4ea6-8376-d828d3961669 Terraform Low Observability CloudTrail log file validation should be enabled to determine whether a log file has not been tampered Documentation CloudWatch Changes To NACL Alarm Missing0a8e8dc5-b6fc-44fc-b5a1-969ec950f9b0 Terraform Low Observability Ensure a log metric filter and alarm exist for changes to NACL Documentation API Gateway Deployment Without API Gateway UsagePlan Associatedb3a59b8e-94a3-403e-b6e2-527abaf12034 Terraform Low Observability API Gateway Deployment should have API Gateway UsagePlan defined and associated. Documentation CloudWatch Route Table Changes Alarm Missing2285e608-ddbc-47f3-ba54-ce7121e31216 Terraform Low Observability Ensure a log metric filter and alarm exist for route table changes Documentation VPC FlowLogs Disabledf83121ea-03da-434f-9277-9cd247ab3047 Terraform Low Observability Every VPC resource should have an associated Flow Log Documentation Missing Cluster Log Types66f130d9-b81d-4e8e-9b08-da74b9c891df Terraform Low Observability Amazon EKS control plane logging don't enabled for all log types Documentation Lambda Functions Without X-Ray Tracing8152e0cf-d2f0-47ad-96d5-d003a76eabd1 Terraform Low Observability AWS Lambda functions should have TracingConfig enabled. For this, property 'tracing_Config.mode' should have the value 'Active' Documentation CloudWatch AWS Config Configuration Changes Alarm Missing5b8d7527-de8e-4114-b9dd-9d988f1f418f Terraform Low Observability Ensure a log metric filter and alarm exist for AWS Config configuration changes Documentation ECS Cluster with Container Insights Disabled97cb0688-369a-4d26-b1f7-86c4c91231bc Terraform Low Observability ECS Cluster should enable container insights Documentation CloudWatch VPC Changes Alarm Missing9d0d4512-1959-43a2-a17f-72360ff06d1b Terraform Low Observability Ensure a log metric filter and alarm exist for VPC changes Documentation Global Accelerator Flow Logs Disabled96e8183b-e985-457b-90cd-61c0503a3369 Terraform Low Observability Global Accelerator should have flow logs enabled Documentation API Gateway Stage Without API Gateway UsagePlan Associatedc999cf62-0920-40f8-8dda-0caccd66ed7e Terraform Low Resource Management API Gateway Stage should have API Gateway UsagePlan defined and associated. Documentation Security Group Not Used4849211b-ac39-479e-ae78-5694d506cb24 Terraform Info Access Control Security group must be used or not declared Documentation Resource Not Using Tagse38a8e0a-b88b-4902-b3fe-b0fcb17d5c10 Terraform Info Best Practices AWS services resource tags are an essential part of managing components. As a best practice, the field 'tags' should have additional tags defined other than 'Name' Documentation Security Group Rule Without Description68eb4bf3-f9bf-463d-b5cf-e029bb446d2e Terraform Info Best Practices It's considered a best practice for all rules in AWS Security Group to have a description Documentation Security Group Rule Without Descriptioncb3f5ed6-0d18-40de-a93d-b3538db31e8c Terraform Info Best Practices It's considered a best practice for AWS Security Group to have a description Documentation EC2 Not EBS Optimized60224630-175a-472a-9e23-133827040766 Terraform Info Best Practices It's considered a best practice for an EC2 instance to use an EBS optimized instance. This provides the best performance for your EBS volumes by minimizing contention between Amazon EBS I/O and other traffic from your instance Documentation DynamoDB Table Point In Time Recovery Disabled741f1291-47ac-4a85-a07b-3d32a9d6bd3e Terraform Info Best Practices It's considered a best practice to have point in time recovery enabled for DynamoDB Table Documentation EC2 Instance Monitoring Disabled23b70e32-032e-4fa6-ba5c-82f56b9980e6 Terraform Info Observability EC2 Instance should have detailed monitoring enabled. With detailed monitoring enabled data is available in 1-minute periods Documentation Neptune Logging Is Disabled45cff7b6-3b80-40c1-ba7b-2cf480678bb8 Terraform Info Observability Neptune logging should be enabled Documentation RDS Without Logging8d7f7b8c-6c7c-40f8-baa6-62006c6c7b56 Terraform Info Observability RDS does not have any kind of logger Documentation Github Organization Webhook With SSL Disabledce7c874e-1b88-450b-a5e4-cb76ada3c8a9 Terraform Medium Encryption Check if insecure SSL is being used in the GitHub organization webhooks Documentation GitHub Repository Set To Public15d8a7fd-465a-4d15-a868-add86552f17b Terraform Medium Insecure Configurations Repositories must be set to private, which means the attribute 'visibility' must be set to 'private' and/or the attribute 'private' must be set to true (the attribute 'visibility' overrides 'private') Documentation Output Without Description59312e8a-a64e-41e7-a252-618533dd1ea8 Terraform Info Best Practices All outputs should contain a valid description. Documentation Variable Without Typefc5109bf-01fd-49fb-8bde-4492b543c34a Terraform Info Best Practices All variables should contain a valid type. Documentation Variable Without Description2a153952-2544-4687-bcc9-cc8fea814a9b Terraform Info Best Practices All variables should contain a valid description. Documentation Generic Git Module Without Revision3a81fc06-566f-492a-91dd-7448e409e2cd Terraform Info Best Practices All generic git repositories should reference a revision. Documentation Name Is Not Snake Case1e434b25-8763-4b00-a5ca-ca03b7abbb66 Terraform Info Best Practices All names should follow snake case pattern. Documentation Cluster Allows Unsafe Sysctlsa9174d31-d526-4ad9-ace4-ce7ddbf52e03 Terraform High Insecure Configurations A Kubernetes Cluster must not allow unsafe sysctls, to prevent a pod from having any influence on any other pod on the node, harming the node's health or gaining CPU or memory resources outside of the resource limits of a pod. This means the 'spec.security_context.sysctl' must not have an unsafe sysctls and that the attribute 'allowed_unsafe_sysctls' must be undefined. Documentation Tiller (Helm v2) Is Deployedca2fba76-c1a7-4afd-be67-5249f861cb0e Terraform High Insecure Configurations Check if Tiller is deployed. Documentation PSP Allows Containers To Share The Host Network Namespace4950837c-0ce5-4e42-9bee-a25eae73740b Terraform High Insecure Configurations Check if Pod Security Policies allow containers to share the host network namespace. Documentation Not Limited Capabilities For Pod Security Policy2acb555f-f4ad-4b1b-b984-84e6588f4b05 Terraform High Insecure Configurations Limit capabilities for a Pod Security Policy Documentation Container Is Privileged87065ef8-de9b-40d8-9753-f4a4303e27a4 Terraform High Insecure Configurations Privileged containers lack essential security restrictions and should be avoided by removing the 'privileged' flag or by changing its value to false Documentation Privilege Escalation Allowedc878abb4-cca5-4724-92b9-289be68bd47c Terraform High Insecure Configurations Containers should not run with allowPrivilegeEscalation in order to prevent them from gaining more privileges than their parent process Documentation Role Binding To Default Service Account3360c01e-c8c0-4812-96a2-a6329b9b7f9f Terraform High Insecure Defaults No role nor cluster role should bind to a default service account Documentation Permissive Access to Create Pods522d4a64-4dc9-44bd-9240-7d8a0d5cb5ba Terraform Medium Access Control The permission to create pods in a cluster should be restricted because it allows privilege escalation. Documentation Non Kube System Pod With Host Mount86a947ea-f577-4efb-a8b0-5fc00257d521 Terraform Medium Access Control A non kube-system workload should not have hostPath mounted Documentation RBAC Roles with Read Secrets Permissions826abb30-3cd5-4e0b-a93b-67729b4f7e63 Terraform Medium Access Control Roles and ClusterRoles with get/watch/list RBAC permissions on Kubernetes secrets are dangerous and should be avoided. In case of compromise, attackers could abuse these roles to access sensitive data, such as passwords, tokens and keys Documentation Readiness Probe Is Not Configured8657197e-3f87-4694-892b-8144701d83c1 Terraform Medium Availability Check if Readiness Probe is not configured. Documentation Root Containers Admitted4c415497-7410-4559-90e8-f2c8ac64ee38 Terraform Medium Best Practices Containers must not be allowed to run with root privileges, which means the attributes 'privileged' and 'allow_privilege_escalation' must be set to false, 'run_as_user.rule' must be set to 'MustRunAsNonRoot', and adding the root group must be forbidden Documentation Incorrect Volume Claim Access Mode ReadWriteOnce26b047a9-0329-48fd-8fb7-05bbe5ba80ee Terraform Medium Build Process Kubernetes Stateful Sets must have one Volume Claim template with the access mode 'ReadWriteOnce' Documentation PSP Allows Privilege Escalation2bff9906-4e9b-4f71-9346-8ebedfdf43ef Terraform Medium Insecure Configurations PodSecurityPolicy should not allow privilege escalation Documentation Containers With Added Capabilitiesfe771ff7-ba15-4f8f-ad7a-8aa232b49a28 Terraform Medium Insecure Configurations Containers should not have extra capabilities allowed Documentation Containers With Sys Admin Capabilities3f55386d-75cd-4e9a-ac47-167b26c04724 Terraform Medium Insecure Configurations Containers should not have CAP_SYS_ADMIN Linux capability Documentation NET_RAW Capabilities Disabled for PSP9aa32890-ac1a-45ee-81ca-5164e2098556 Terraform Medium Insecure Configurations Containers need to have NET_RAW or All as drop capabilities Documentation Container Resources Limits Undefined60af03ff-a421-45c8-b214-6741035476fa Terraform Medium Insecure Configurations Kubernetes container should have resource limitations defined such as CPU and memory Documentation Workload Mounting With Sensitive OS Directorya737be28-37d8-4bff-aa6d-1be8aa0a0015 Terraform Medium Insecure Configurations Workload is mounting a volume with sensitive OS Directory Documentation Container Host Pid Is True587d5d82-70cf-449b-9817-f60f9bccb88c Terraform Medium Insecure Configurations Minimize the admission of containers wishing to share the host process ID namespace Documentation Seccomp Profile Is Not Configured455f2e0c-686d-4fcb-8b5f-3f953f12c43c Terraform Medium Insecure Configurations Containers should be configured with a secure Seccomp profile to restrict potentially dangerous syscalls Documentation PSP Set To Privilegeda6a4d4fc-4e8f-47d1-969f-e9d4a084f3b9 Terraform Medium Insecure Configurations Do not allow pod to request execution as privileged. Documentation NET_RAW Capabilities Not Being Droppede5587d53-a673-4a6b-b3f2-ba07ec274def Terraform Medium Insecure Configurations Containers should drop 'ALL' or at least 'NET_RAW' capabilities Documentation Ingress Controller Exposes Workloade2c83c1f-84d7-4467-966c-ed41fd015bb9 Terraform Medium Insecure Configurations Ingress Controllers should not expose workload in order to avoid vulnerabilities and DoS attacks Documentation PSP With Added Capabilities48388bd2-7201-4dcc-b56d-e8a9efa58fad Terraform Medium Insecure Configurations PodSecurityPolicy should not have added capabilities Documentation Using Default Namespaceabcb818b-5af7-4d72-aba9-6dd84956b451 Terraform Medium Insecure Configurations The default namespace should not be used Documentation Container Runs Unmasked0ad60203-c050-4115-83b6-b94bde92541d Terraform Medium Insecure Configurations Check if a container has full access (unmasked) to the host\u2019s /proc command, which would allow to retrieve sensitive information and possibly change the kernel parameters in runtime. Documentation PSP Allows Sharing Host IPC51bed0ac-a8ae-407a-895e-90c6cb0610ce Terraform Medium Insecure Configurations Pod Security Policy allows containers to share the host IPC namespace Documentation Default Service Account In Use737a0dd9-0aaa-4145-8118-f01778262b8a Terraform Medium Insecure Configurations Default service accounts should not be actively used Documentation Service Account Token Automount Not Disableda9a13d4f-f17a-491b-b074-f54bffffcb4a Terraform Medium Insecure Defaults Service Account Tokens are automatically mounted even if not necessary Documentation Service Account Name Undefined Or Empty24b132df-5cc7-4823-8029-f898e1c50b72 Terraform Medium Insecure Defaults A Kubernetes Pod should have a Service Account defined so to restrict Kubernetes API access, which means the attribute 'service_account_name' should be defined and not empty. Documentation Service With External Load Balancer2a52567c-abb8-4651-a038-52fa27c77aed Terraform Medium Networking and Firewall Service has an external load balancer, which may cause accessibility from other networks and the Internet Documentation Network Policy Is Not Targeting Any Podb80b14c6-aaa2-4876-b651-8a48b6c32fbf Terraform Medium Networking and Firewall Check if any network policy is not targeting any pod. Documentation Memory Limits Not Definedfd097ed0-7fe6-4f58-8b71-fef9f0820a21 Terraform Medium Resource Management Memory limits should be defined for each container. This prevents potential resource exhaustion by ensuring that containers consume not more than the designated amount of memory Documentation CPU Limits Not Set5f4735ce-b9ba-4d95-a089-a37a767b716f Terraform Medium Resource Management CPU limits should be set because if the system has CPU time free, a container is guaranteed to be allocated as much CPU as it requests Documentation Memory Requests Not Defined21719347-d02b-497d-bda4-04a03c8e5b61 Terraform Medium Resource Management Memory requests should be defined for each container. This allows the kubelet to reserve the requested amount of system resources and prevents over-provisioning on individual nodes Documentation Shared Host Network Namespaceac1564a3-c324-4747-9fa1-9dfc234dace0 Terraform Medium Resource Management Container should not share the host network namespace Documentation Volume Mount With OS Directory Write Permissionsa62a99d1-8196-432f-8f80-3c100b05d62a Terraform Medium Resource Management Containers can mount sensitive folders from the hosts, giving them potentially dangerous access to critical host configurations and binaries. Documentation Shared Host IPC Namespacee94d3121-c2d1-4e34-a295-139bfeb73ea3 Terraform Medium Resource Management Container should not share the host IPC namespace Documentation CPU Requests Not Set577ac19c-6a77-46d7-9f14-e049cdd15ec2 Terraform Medium Resource Management CPU requests should be set to ensure the sum of the resource requests of the scheduled Containers is less than the capacity of the node Documentation Shared Service Accountf74b9c43-161a-4799-bc95-0b0ec81801b9 Terraform Medium Secret Management A Service Account token is shared between workloads Documentation Service Account Allows Access Secrets07fc3413-e572-42f7-9877-5c8fc6fccfb5 Terraform Medium Secret Management Kubernetes_role and Kubernetes_cluster_role when binded, should not use get, list or watch as verbs Documentation Docker Daemon Socket is Exposed to Containers4e203a65-c8d8-49a2-b749-b124d43c9dc1 Terraform Low Access Control Sees if Docker Daemon Socket is not exposed to Containers Documentation Missing App Armor Configbd6bd46c-57db-4887-956d-d372f21291b6 Terraform Low Access Control Containers should be configured with AppArmor for any application to reduce its potential attack Documentation Cluster Admin Rolebinding With Superuser Permissions17172bc2-56fb-4f17-916f-a014147706cd Terraform Low Access Control Ensure that the cluster-admin role is only used where required (RBAC) Documentation HPA Targets Invalid Object17e52ca3-ddd0-4610-9d56-ce107442e110 Terraform Low Availability The Horizontal Pod Autoscaler must target a valid object Documentation Deployment Without PodDisruptionBudgeta05331ee-1653-45cb-91e6-13637a76e4f0 Terraform Low Availability Deployments should be assigned with a PodDisruptionBudget to ensure high availability Documentation Liveness Probe Is Not Defined5b6d53dd-3ba3-4269-b4d7-f82e880e43c3 Terraform Low Availability In case of an unresponsive container, a Liveness Probe can help your application become more available since it restarts the container. However, it can lead to cascading failures. Define one if you really need it Documentation StatefulSet Without PodDisruptionBudget7249e3b0-9231-4af3-bc5f-5daf4988ecbf Terraform Low Availability StatefulSets should be assigned with a PodDisruptionBudget to ensure high availability Documentation StatefulSet Without Service Name420e6360-47bb-46f6-9072-b20ed22c842d Terraform Low Availability StatefulSets should have an existing headless 'serviceName'. The headless service labels should also be implemented on StatefulSets labels. Documentation Metadata Label Is Invalidbc3dabb6-fd50-40f8-b9ba-7429c9f1fb0e Terraform Low Best Practices Check if any label in the metadata is invalid. Documentation No Drop Capabilities for Containers21cef75f-289f-470e-8038-c7cee0664164 Terraform Low Best Practices Sees if Kubernetes Drop Capabilities exists to ensure containers security context Documentation Root Container Not Mounted As Read-onlyd532566b-8d9d-4f3b-80bd-361fe802f9c2 Terraform Low Build Process Check if the root container filesystem is not being mounted as read-only. Documentation StatefulSet Requests Storagefcc2612a-1dfe-46e4-8ce6-0320959f0040 Terraform Low Build Process A StatefulSet requests volume storage. Documentation Image Pull Policy Of The Container Is Not Set To Alwaysaa737abf-6b1d-4aba-95aa-5c160bd7f96e Terraform Low Insecure Configurations Image Pull Policy of the container must be defined and set to Always Documentation Pod or Container Without Security Contextad69e38a-d92e-4357-a8da-f2f29d545883 Terraform Low Insecure Configurations A security context defines privilege and access control settings for a Pod or Container Documentation Image Without Digest228c4c19-feeb-4c18-848c-800ac70fdfb7 Terraform Low Insecure Configurations Images should be specified together with their digests to ensure integrity Documentation Workload Host Port Not Specified4e74cf4f-ff65-4c1a-885c-67ab608206ce Terraform Low Networking and Firewall Verifies if Kubernetes workload's host port is specified Documentation Service Type is NodePort5c281bf8-d9bb-47f2-b909-3f6bb11874ad Terraform Low Networking and Firewall Service type should not be NodePort Documentation CronJob Deadline Not Configured58876b44-a690-4e9f-9214-7735fa0dd15d Terraform Low Resource Management Cronjobs must have a configured deadline, which means the attribute 'starting_deadline_seconds' must be defined Documentation Deployment Has No PodAntiAffinity461ed7e4-f8d5-4bc1-b3c6-64ddb4fd00a3 Terraform Low Resource Management Check if Deployment resources don't have a podAntiAffinity policy, which prevents multiple pods from being scheduled on the same node. Documentation Secrets As Environment Variables6d8f1a10-b6cd-48f0-b960-f7c535d5cdb8 Terraform Low Secret Management Container should not use secrets as environment variables Documentation Invalid Imagee76cca7c-c3f9-4fc9-884c-b2831168ebd8 Terraform Low Supply-Chain Image must be defined and not be empty or equal to latest. Documentation OSS Bucket Allows List Action From All Principals88541597-6f88-42c8-bac6-7e0b855e8ff6 Terraform High Access Control OSS Bucket should not allow list action from all principals, as to prevent leaking private information to the entire internet or allow unauthorized data tampering/deletion. This means the 'Effect' must not be 'Allow' when the 'Action' contains 'List', for all Principals. Documentation OSS Bucket Allows Put Action From All Principalsfe286195-e75c-4359-bd58-00847c4f855a Terraform High Access Control OSS Bucket should not allow put action from all principals, as to prevent leaking private information to the entire internet or allow unauthorized data tampering/deletion. This means the 'Effect' must not be 'Allow' when the 'Action' contains 'Put', for all Principals. Documentation OSS Bucket Public Access Enabled62232513-b16f-4010-83d7-51d0e1d45426 Terraform High Access Control OSS Bucket should have public access disabled Documentation OSS Bucket Allows Delete Action From All Principals8c0695d8-2378-4cd6-8243-7fd5894fa574 Terraform High Access Control OSS Bucket should not allow delete action from all principals, as to prevent leaking private information to the entire internet or allow unauthorized data tampering/deletion. This means the 'Effect' must not be 'Allow' when the 'Action' is DeleteBucket, for all Principals. Documentation OSS Bucket Allows All Actions From All Principalsec62a32c-a297-41ca-a850-cab40b42094a Terraform High Access Control OSS Buckets should not allow all actions (wildcard) from all principals, as to prevent leaking private information to the entire internet or allow unauthorized data tampering/deletion. This means the 'Effect' must not be 'Allow' when the 'Action' is *, for all Principals. Documentation Ram Policy Admin Access Not Attached to Users Groups Rolese8e62026-da63-4904-b402-65adfe3ca975 Terraform High Access Control Ram policies with admin access should not be associated to users, groups or roles Documentation RAM Security Preference Not Enforce MFA Logindcda2d32-e482-43ee-a926-75eaabeaa4e0 Terraform High Access Control RAM Security preferences should enforce MFA login for RAM users Documentation NAS File System Not Encrypted67bfdff1-31ce-4525-b564-e94368735360 Terraform High Encryption NAS File System must be encrypted Documentation Ecs Data Disk Kms Key Id Undefinedf262118c-1ac6-4bb3-8495-cc48f1775b85 Terraform High Encryption Ecs Data Disk Kms Key Id should be set Documentation NAS File System Without KMS5f670f9d-b1b4-4c90-8618-2288f1ab9676 Terraform High Encryption NAS File System should have encryption provided by user KMS Documentation Launch Template Is Not Encrypted1455cb21-1d48-46d6-8ae3-cef911b71fd5 Terraform High Encryption ECS Launch Template should have the data in the disk encrypted. To encrypt the data, the 'encrypted' argument should be set to true. Documentation RDS Instance TDE Status Disabled44d434ca-a9bf-4203-8828-4c81a8d5a598 Terraform High Encryption tde_status parameter should be Enabled for supported RDS instances Documentation DB Instance Publicly Accessiblefaaefc15-51a5-419e-bb5e-51a4b5ab3485 Terraform High Insecure Configurations The field 'address' should not be set to '0.0.0.0/0' Documentation RDS DB Instance Publicly Accessible1b4565c0-4877-49ac-ab03-adebbccd42ae Terraform High Insecure Configurations '0.0.0.0' or '0.0.0.0/0' should not be in 'security_ips' list Documentation OSS Bucket Has Static Website2b13c6ff-b87a-484d-86fd-21ef6e97d426 Terraform High Insecure Configurations Checks if any static websties are hosted on buckets. Be aware of any website you are running. Documentation API Gateway API Protocol Not HTTPS1bcdf9f0-b1aa-40a4-b8c6-cd7785836843 Terraform High Networking and Firewall API Gateway API protocol should be set to HTTPS Documentation OSS Bucket Ip Restriction Disabled6107c530-7178-464a-88bc-df9cdd364ac8 Terraform High Networking and Firewall OSS Bucket should have ip restricted access Documentation ALB Listening on HTTPee3b1557-9fb5-4685-a95d-93f1edf2a0d7 Terraform High Networking and Firewall Application Load Balancer (alb) Listener should not listen on HTTP Documentation Public Security Group Rule Sensitive Port2ae9d554-23fb-4065-bfd1-fe43d5f7c419 Terraform High Networking and Firewall A sensitive port, such as port 23 or port 110, is open to the public in either TCP or UDP protocol Documentation Public Security Group Rule All Ports or Protocols60587dbd-6b67-432e-90f7-a8cf1892d968 Terraform High Networking and Firewall Alicloud Security Group Rule should not allow all ports or all protocols to the public Documentation OSS Buckets Secure Transport Disabledc01d10de-c468-4790-b3a0-fc887a56f289 Terraform High Networking and Firewall OSS Buckets should have secure transport enabled Documentation RDS Instance Events Not Loggedb9c524a4-fe76-4021-a6a2-cb978fb4fde1 Terraform High Observability All RDS Instance events trackers should be 'true' Documentation ActionTrail Trail OSS Bucket is Publicly Accessible69b5d7da-a5db-4db9-a42e-90b65d0efb0b Terraform High Observability ActionTrail Trail OSS Bucket should not be publicly accessible Documentation Ram Account Password Policy Max Login Attempts Unrecommendede76fd7ab-7333-40c6-a2d8-ea28af4a319e Terraform High Secret Management Ram Account Password Policy should have 'max_login_attempts' to a maximum of 5 incorrect login attempts Documentation Ram Account Password Policy Not Required Minimum Lengtha9dfec39-a740-4105-bbd6-721ba163c053 Terraform High Secret Management Ram Account Password Policy should have 'minimum_password_length' defined and set to 14 or above Documentation Ram Policy Attached to User66505003-7aba-45a1-8d83-5162d5706ef5 Terraform Medium Access Control Ram policies should not be attached to users Documentation CMK Is Unusableed6e3ba0-278f-47b6-a1f5-173576b40b7e Terraform Medium Availability Alicloud KMS must only possess usable Customer Master Keys (CMK), which means the CMKs must have the attribute 'is_enabled' set to true Documentation OSS Bucket Versioning Disabled70919c0b-2548-4e6b-8d7a-3d84ab6dabba Terraform Medium Backup OSS Bucket should have versioning enabled Documentation ROS Stack Retention Disabled4bb06fa1-2114-4a00-b7b5-6aeab8b896f0 Terraform Medium Backup The retain_stacks should be enabled to keep the Stack upon deleting the stack instance from the stack group Documentation ROS Stack Without Template92d65c51-5d82-4507-a2a1-d252e9706855 Terraform Medium Build Process Alicloud ROS Stack should have a template defined through the attribute template_url or attribute template_body Documentation OSS Bucket Encryption Using CMK Disabledf20e97f9-4919-43f1-9be9-f203cd339cdd Terraform Medium Encryption OSS Bucket should have encryption enabled using Customer Master Key Documentation SLB Policy With Insecure TLS Version In Usedbfc834a-56e5-4750-b5da-73fda8e73f70 Terraform Medium Encryption SLB Policy should not support insecure versions of TLS protocol Documentation Disk Encryption Disabled39750e32-3fe9-453b-8c33-dd277acdb2cc Terraform Medium Encryption Disks should have encryption enabled Documentation CS Kubernetes Node Pool Auto Repair Disabled81ce9394-013d-4731-8fcc-9d229b474073 Terraform Medium Insecure Configurations Verifies if Alicloud Container Service Node Pool Auto Repair is Enabled. This service periodically checks for failing nodes and repairs them to ensure a smooth running state. Documentation Public Security Group Rule Unknown Portdd706080-b7a8-47dc-81fb-3e8184430ec0 Terraform Medium Networking and Firewall A unknown port, such as port 24 or port 111, is open to the public in either TCP or UDP or ALL protocol/protocols mentioned Documentation Kubernetes Cluster Without Terway as CNI Network Pluginb9b7ada8-3868-4a35-854e-6100a2bb863d Terraform Medium Networking and Firewall Kubernetes Cluster should have Terway as CNI Network Plugin to configure network policies Documentation RDS Instance Retention Period Not Recommendeddc158941-28ce-481d-a7fa-dc80761edf46 Terraform Medium Observability RDS Instance SQL Retention Period should be greater than 180 Documentation Log Retention Is Not Greater Than 90 Daysed6cf6ff-9a1f-491c-9f88-e03c0807f390 Terraform Medium Observability OSS Log Store should have logging enabled for longer than 90 days, for better visibility of resources and objects. Documentation ROS Stack Notifications Disabled9ef08939-ea40-489c-8851-667870b2ef50 Terraform Medium Observability The ROS Stack Notifications should be defined and populated to receive stack related events Documentation Action Trail Logging For All Regions Disabledc065b98e-1515-4991-9dca-b602bd6a2fbb Terraform Medium Observability Action Trail Logging for all regions should be enabled Documentation OSS Bucket Logging Disabled05db341e-de7d-4972-a106-3e2bd5ee53e1 Terraform Medium Observability OSS Bucket should have logging enabled, for better visibility of resources and objects. Documentation No ROS Stack Policy72ceb736-0aee-43ea-a191-3a69ab135681 Terraform Medium Resource Management ROS Stack should have a stack policy in order to protect stack resources from and during update actions Documentation Ram Account Password Policy Not Required Numbers063234c0-91c0-4ab5-bbd0-47ddb5f23786 Terraform Medium Secret Management Ram Account Password Policy should have 'require_numbers' set to true Documentation Ram Account Password Policy Max Password Age Unrecommended2bb13841-7575-439e-8e0a-cccd9ede2fa8 Terraform Medium Secret Management Ram Account Password Policy Password 'max_password_age' should be higher than 0 and lower than 91 Documentation RAM Account Password Policy without Reuse Preventiona8128dd2-89b0-464b-98e9-5d629041dfe0 Terraform Medium Secret Management RAM Account Password Policy 'password_reuse_prevention' should be defined and set to 24 or less Documentation Ram Account Password Policy Not Require At Least one Lowercase Character89143358-cec6-49f5-9392-920c591c669c Terraform Medium Secret Management Ram Account Password Policy should have 'require_lowercase_characters' set to true Documentation RAM Account Password Policy Not Require at Least one Uppercase Character5e0fb613-ba9b-44c3-88f0-b44188466bfd Terraform Medium Secret Management Ram Account Password Policy should have 'require_uppercase_characters' set to true Documentation High KMS Key Rotation Periodcb319d87-b90f-485e-a7e7-f2408380f309 Terraform Medium Secret Management KMS Key should have automatic rotation enabled and the rotation period should not be higher than a year Documentation RAM Account Password Policy Not Required Symbols41a38329-d81b-4be4-aef4-55b2615d3282 Terraform Medium Secret Management RAM account password security should require at least one symbol Documentation OSS Bucket Transfer Acceleration Disabled8f98334a-99aa-4d85-b72a-1399ca010413 Terraform Low Availability OSS Bucket should have transfer acceleration enabled Documentation OSS Bucket Lifecycle Rule Disabled7db8bd7e-9772-478c-9ec5-4bc202c5686f Terraform Low Backup OSS Bucket should have lifecycle rule enabled and set to true Documentation VPC Flow Logs Disabledd2731f3d-a992-44ed-812e-f4f1c2747d71 Terraform Low Observability Every VPC resource should have an associated Flow Log Documentation RDS Instance Log Disconnections Disabledd53f4123-f8d8-4224-8cb3-f920b151cc98 Terraform Low Observability log_disconnections parameter should be set to ON for RDS instances Documentation RDS Instance Log Duration Disableda597e05a-c065-44e7-9cc8-742f572a504a Terraform Low Observability log_duration parameter should be set to ON for RDS instances Documentation RDS Instance Log Connections Disabled140869ea-25f2-40d4-a595-0c0da135114e Terraform Low Observability 'log_connections' parameter should be set to ON for RDS instances Documentation BOM - GCP PDdd7d70aa-a6ec-460d-b5d2-38b40253b16f Terraform Trace Bill Of Materials A list of Persistent Disk resources found. Persistent Disk is Google's local durable storage service, fully integrated with Google Cloud products, Compute Engine and Google Kubernetes Engine. Documentation BOM - GCP PST4b82202a-b18e-4891-a1eb-a0989850bbb3 Terraform Trace Bill Of Materials A list of Pub/Sub Topic resources found. Cloud Pub/Sub is designed to provide reliable, many-to-many, asynchronous messaging between applications. Publisher applications can send messages to a 'topic' and other applications can subscribe to that topic to receive the messages. Documentation BOM - GCP SB2f06d22c-56bd-4f73-8a51-db001fcf2150 Terraform Trace Bill Of Materials A list of Storage Bucket resources found. Buckets are the basic containers that hold your data. Everything that you store in Cloud Storage must be contained in a bucket. Documentation BOM - GCP FIc9d81239-c818-4869-9917-1570c62b81fd Terraform Trace Bill Of Materials A list of Filestore Instance resources found. Filestore instances are fully managed file servers on Google Cloud that can be connected to Compute Engine VMs, GKE clusters, and your on-premises machines. Once provisioned, you can scale the capacity of your instances according to need without any downtime. Documentation BOM - GCP Redisbc75ce52-a60a-4660-b533-bce837a5019b Terraform Trace Bill Of Materials A list of Redis Instance resources found. Memorystore for Redis is a fully managed Redis service for Google Cloud. Applications running on Google Cloud can achieve extreme performance by leveraging the highly scalable, available, secure Redis service without the burden of managing complex Redis deployments. Documentation BOM - GCP Dataflow895ed0d9-6fec-4567-8614-d7a74b599a53 Terraform Trace Bill Of Materials A list of Dataflow resources found. Unified stream and batch data processing that's serverless, fast, and cost-effective. Documentation BOM - AWS DynamoDB23edf35f-7c22-4ff9-87e6-0ca74261cfbf Terraform Trace Bill Of Materials A list of DynamoDB resources found. Amazon DynamoDB is a fully managed, serverless, key-value NoSQL database designed to run high-performance applications at any scale. Documentation BOM - AWS MQfcb1b388-f558-4b7f-9b6e-f4e98abb7380 Terraform Trace Bill Of Materials A list of MQ resources found. Amazon MQ is a managed message broker service for Apache ActiveMQ and RabbitMQ that makes it easy to set up and operate message brokers on AWS. Documentation BOM - AWS RDS12933609-c5bf-44b4-9a41-a6467c3b685b Terraform Trace Bill Of Materials A list of RDS resources found. Amazon Relational Database Service (Amazon RDS) is a collection of managed services that makes it simple to set up, operate, and scale databases in the cloud. Documentation BOM - AWS Elasticache54229498-850b-4f78-b3a7-218d24ef2c37 Terraform Trace Bill Of Materials A list of Elasticache resources found. Amazon ElastiCache is a fully managed, in-memory caching service supporting flexible, real-time use cases. You can use ElastiCache for caching, which accelerates application and database performance, or as a primary data store for use cases that don't require durability like session stores, gaming leaderboards, streaming, and analytics. ElastiCache is compatible with Redis and Memcached. Documentation BOM - AWS SNSeccc4d59-74b9-4974-86f1-74386e0c7f33 Terraform Trace Bill Of Materials A list of SNS resources specified. Amazon Simple Notification Service (Amazon SNS) is a fully managed messaging service for both application-to-application (A2A) and application-to-person (A2P) communication. Documentation BOM - AWS EFSf53f16d6-46a9-4277-9fbe-617b1e24cdca Terraform Trace Bill Of Materials A list of EFS resources found. Amazon Elastic File System (Amazon EFS) automatically grows and shrinks as you add and remove files with no need for management or provisioning. Documentation BOM - AWS Kinesis0e59d33e-bba2-4037-8f88-9765647ca7ad Terraform Trace Bill Of Materials A list of Kinesis resources found. Amazon Kinesis is a real-time streaming service that provides collection, processing, and analysis of video and data streams in real-time Documentation BOM - AWS MSK051f2063-2517-4295-ad8e-ba88c1bf5cfc Terraform Trace Bill Of Materials A list of MSK resources specified. Amazon Managed Streaming for Apache Kafka (Amazon MSK) is a fully managed service that enables you to build and run applications that use Apache Kafka to process streaming data. Documentation BOM - AWS EBS86571149-eef3-4280-a645-01e60df854b0 Terraform Trace Bill Of Materials A list of EBS resources found. Amazon Elastic Block Store (Amazon EBS) is an easy-to-use, scalable, high-performance block-storage service designed for Amazon Elastic Compute Cloud (Amazon EC2). Documentation BOM - AWS S3 Buckets2d16c3fb-35ba-4ec0-b4e4-06ee3cbd4045 Terraform Trace Bill Of Materials A list of S3 resources found. Amazon Simple Storage Service (Amazon S3) is an object storage service that offers industry-leading scalability, data availability, security, and performance. Documentation BOM - AWS SQSbaecd2da-492a-4d59-b9dc-29540a1398e0 Terraform Trace Bill Of Materials A list of SQS resources specified. Amazon Simple Queue Service (SQS) is a fully managed message queuing service that enables you to decouple and scale microservices, distributed systems, and serverless applications. Documentation OSLogin Disabled32ecd6eb-0711-421f-9627-1a28d9eff217 Terraform High Access Control Verifies that the OSLogin is enabled Documentation VM With Full Cloud Accessbc280331-27b9-4acb-a010-018e8098aa5d Terraform High Access Control A VM instance is configured to use the default service account with full access to all Cloud APIs Documentation BigQuery Dataset Is Publice576ce44-dd03-4022-a8c0-3906acca2ab4 Terraform High Access Control BigQuery dataset is anonymously or publicly accessible Documentation Cloud Storage Anonymous or Publicly Accessiblea6cd52a1-3056-4910-96a5-894de9f3f3b3 Terraform High Access Control Cloud Storage Buckets must not be anonymously or publicly accessible, which means the attribute 'members' must not possess 'allUsers' or 'allAuthenticatedUsers' Documentation Cloud Storage Bucket Is Publicly Accessiblec010082c-76e0-4b91-91d9-6e8439e455dd Terraform High Access Control Cloud Storage Bucket is anonymously or publicly accessible Documentation SQL DB Instance Backup Disabledcf3c7631-cd1e-42f3-8801-a561214a6e79 Terraform High Backup Checks if backup configuration is enabled for all Cloud SQL Database instances Documentation KMS Crypto Key is Publicly Accessible16cc87d1-dd47-4f46-b3ce-4dfcac8fd2f5 Terraform High Encryption KMS Crypto Key should not be publicly accessible. In other words, the KMS Crypto Key policy should not set 'allUsers' or 'allAuthenticatedUsers' in the attribute 'member'/'members' Documentation DNSSEC Using RSASHA1ccc3100c-0fdd-4a5e-9908-c10107291860 Terraform High Encryption DNSSEC should not use the RSASHA1 algorithm, which means if, within the 'dnssec_config' block, the 'default_key_specs' block exists with the 'algorithm' field is 'rsasha1' which is bad. Documentation SQL DB Instance With SSL Disabled02474449-71aa-40a1-87ae-e14497747b00 Terraform High Encryption Cloud SQL Database Instance should have SLL enabled Documentation SQL DB Instance Publicly Accessibleb187edca-b81e-4fdc-aff4-aab57db45edb Terraform High Insecure Configurations Cloud SQL instances should not be publicly accessible. Documentation Pod Security Policy Disabled9192e0f9-eca5-4056-9282-ae2a736a4088 Terraform High Insecure Configurations Kubernetes Clusters must have Pod Security Policy controller enabled, which means there must be a 'pod_security_policy_config' with the 'enabled' attribute equal to true Documentation Cluster Labels Disabled65c1bc7a-4835-4ac4-a2b6-13d310b0648d Terraform High Insecure Configurations Kubernetes Clusters must be configured with labels, which means the attribute 'resource_labels' must be defined Documentation Cluster Master Authentication Disabled1baba08e-3c8a-4be7-95eb-dced5833de21 Terraform High Insecure Configurations Kubernetes Engine Clusters must have Master Authentication set to enabled, which means the attribute 'master_auth' must have the subattributes 'username' and 'password' defined and not empty Documentation IP Aliasing Disabledc606ba1d-d736-43eb-ac24-e16108f3a9e0 Terraform High Insecure Configurations Kubernetes Clusters must be created with Alias IP ranges enabled, which means the attribut 'ip_allocation_policy' must be defined and, if defined, the attribute 'networking_mode' must be VPC_NATIVE Documentation Not Proper Email Account In Use9356962e-4a4f-4d06-ac59-dc8008775eaa Terraform High Insecure Configurations Gmail accounts are being used instead of corporate credentials Documentation GKE Basic Authentication Enabled70cdf849-b7d9-4569-b87d-5d82ffd44719 Terraform High Insecure Configurations GCP - Google Kubernetes Engine (GKE) Basic Authentication must be disabled, which means the username and password provided in the master_auth block must be empty Documentation Network Policy Disabled11e7550e-c4b6-472e-adff-c698f157cdd7 Terraform High Insecure Configurations Kubernetes Engine Clusters must have Network Policy enabled, meaning that the attribute 'network_policy.enabled' must be true and the attribute 'addons_config.network_policy_config.disabled' must be false Documentation Private Cluster Disabled6ccb85d7-0420-4907-9380-50313f80946b Terraform High Insecure Configurations Kubernetes Clusters must be created with Private Clusters enabled, meaning the 'private_cluster_config' must be defined and the attributes 'enable_private_nodes' and 'enable_private_endpoint' must be true Documentation GKE Legacy Authorization Enabled5baa92d2-d8ee-4c75-88a4-52d9d8bb8067 Terraform High Insecure Configurations Kubernetes Engine Clusters must have Legacy Authorization set to disabled, which means the attribute 'enable_legacy_abac' must not be true Documentation Client Certificate Disabled73fb21a1-b19a-45b1-b648-b47b1678681e Terraform High Insecure Configurations Kubernetes Clusters must be created with Client Certificate enabled, which means 'master_auth' must have 'client_certificate_config' with the attribute 'issue_client_certificate' equal to true Documentation Cloud Storage Bucket Logging Not Enabledd6cabc3a-d57e-48c2-b341-bf3dd4f4a120 Terraform High Observability Cloud storage bucket should have logging enabled Documentation Stackdriver Monitoring Disabled30e8dfd2-3591-4d19-8d11-79e93106c93d Terraform High Observability Kubernetes Engine Clusters must have Stackdriver Monitoring enabled, which means the attribute 'monitoring_service' must be defined and different than 'none' Documentation IAM Audit Not Properly Configured89fe890f-b480-460c-8b6b-7d8b1468adb4 Terraform High Observability Audit Logging Configuration is defective Documentation Stackdriver Logging Disabled4c7ebcb2-eae2-461e-bc83-456ee2d4f694 Terraform High Observability Kubernetes Engine Clusters must have Stackdriver Logging enabled, which means the attribute 'logging_service' must be defined and different from 'none' Documentation Cloud Storage Bucket Versioning Disablede7e961ac-d17e-4413-84bc-8a1fbe242944 Terraform High Observability Cloud Storage Bucket should have versioning enabled Documentation Node Auto Upgrade Disabledb139213e-7d24-49c2-8025-c18faa21ecaa Terraform High Resource Management Kubernetes nodes must have auto upgrades set to true, which means Node 'auto_upgrade' should be enabled for Kubernetes Clusters Documentation KMS Admin and CryptoKey Roles In Use92e4464a-4139-4d57-8742-b5acc0347680 Terraform Medium Access Control Google Project IAM Policy should not assign a KMS admin role and CryptoKey role to the same member Documentation Google Project IAM Binding Service Account has Token Creator or Account User Role617ef6ff-711e-4bd7-94ae-e965911b1b40 Terraform Medium Access Control Verifies if Google Project IAM Binding Service Account doesn't have an Account User or Token Creator Role associated Documentation Google Project IAM Member Service Account has Token Creator or Account User Rolec68b4e6d-4e01-4ca1-b256-1e18e875785c Terraform Medium Access Control Verifies if Google Poject IAM Member Service Account doesn't have a Account User or Token Creator associated Documentation Google Project IAM Member Service Account Has Admin Role84d36481-fd63-48cb-838e-635c44806ec2 Terraform Medium Access Control Verifies that Google Project IAM Member Service Account doesn't have an Admin Role associated Documentation Google Compute SSL Policy Weak Cipher In Use14a457f0-473d-4d1d-9e37-6d99b355b336 Terraform Medium Encryption This query confirms if Google Compute SSL Policy Weak Chyper Suits is Enabled, to do so we need to check if TLS is TLS_1_2, because other version have Weak Chypers Documentation Disk Encryption Disabledb1d51728-7270-4991-ac2f-fc26e2695b38 Terraform Medium Encryption VM disks for critical VMs must be encrypted with Customer Supplied Encryption Keys (CSEK) or with Customer-managed encryption keys (CMEK), which means the attribute 'disk_encryption_key' must be defined and its sub attributes 'raw_key' or 'kms_key_self_link' must also be defined Documentation Google Container Node Pool Auto Repair Disabledacfdbec6-4a17-471f-b412-169d77553332 Terraform Medium Insecure Configurations Google Container Node Pool Auto Repair should be enabled. This service periodically checks for failing nodes and repairs them to ensure a smooth running state. Documentation Google Project Auto Create Network Disabled59571246-3f62-4965-a96f-c7d97e269351 Terraform Medium Insecure Configurations Verifies if the Google Project Auto Create Network is Disabled Documentation Cloud DNS Without DNSSEC5ef61c88-bbb4-4725-b1df-55d23c9676bb Terraform Medium Insecure Configurations DNSSEC must be enabled for Cloud DNS Documentation OSLogin Is Disabled For VM Instanced0b4d550-c001-46c3-bbdb-d5d75d33f05f Terraform Medium Insecure Configurations Check if any VM instance disables OSLogin Documentation COS Node Image Not Used8a893e46-e267-485a-8690-51f39951de58 Terraform Medium Insecure Configurations The node image should be Container-Optimized OS(COS) Documentation Google Storage Bucket Level Access Disabledbb0db090-5509-4853-a827-75ced0b3caa0 Terraform Medium Insecure Configurations Google Storage Bucket Level Access should be enabled Documentation Shielded VM Disabled1b44e234-3d73-41a8-9954-0b154135280e Terraform Medium Insecure Configurations Compute instances must be launched with Shielded VM enabled, which means the attribute 'shielded_instance_config' must be defined and its sub attributes 'enable_secure_boot', 'enable_vtpm' and 'enable_integrity_monitoring' must be set to true Documentation GKE Using Default Service Account1c8eef02-17b1-4a3e-b01d-dcc3292d2c38 Terraform Medium Insecure Defaults Kubernetes Engine Clusters should not be configured to use the default service account Documentation Using Default Service Account3cb4af0b-056d-4fb1-8b95-fdc4593625ff Terraform Medium Insecure Defaults Instances should not be configured to use the Default Service Account, that has full access to all Cloud APIs, which means the attribute 'service_account' and its sub attribute 'email' must be defined. Additionally, 'email' must not be empty and must also not be a default Google Compute Engine service account. Documentation SSH Access Is Not Restrictedc4dcdcdf-10dd-4bf4-b4a0-8f6239e6aaa0 Terraform Medium Networking and Firewall Google Firewall should not allow SSH access (port 22) from the Internet (public CIDR block) to ensure the principle of least privileges Documentation RDP Access Is Not Restricted678fd659-96f2-454a-a2a0-c2571f83a4a3 Terraform Medium Networking and Firewall Check if the Google compute firewall allows unrestricted RDP access. Allowed ports should not contain RDP port 3389 Documentation Google Compute Network Using Default Firewall Rule40abce54-95b1-478c-8e5f-ea0bf0bb0e33 Terraform Medium Networking and Firewall Google Compute Network should not use default firewall rule Documentation Serial Ports Are Enabled For VM Instances97fa667a-d05b-4f16-9071-58b939f34751 Terraform Medium Networking and Firewall Google Compute Engine VM instances should not enable serial ports. When enabled, anyone can access your VM, if they know the username, project ID, SSH key, instance name and zone Documentation IP Forwarding Enabledf34c0c25-47b4-41eb-9c79-249b4dd47b89 Terraform Medium Networking and Firewall Instances must not have IP forwarding enabled, which means the attribute 'can_ip_forward' must not be true Documentation Google Compute Network Using Firewall Rule that Allows All Ports22ef1d26-80f8-4a6c-8c15-f35aab3cac78 Terraform Medium Networking and Firewall Google Compute Network should not use a firewall rule that allows all ports Documentation Google Compute Subnetwork Logging Disabled40430747-442d-450a-a34f-dc57149f4609 Terraform Medium Observability This query checks if logs are enabled for a Google Compute Subnetwork resource. Documentation Service Account with Improper Privilegescefdad16-0dd5-4ac5-8ed2-a37502c78672 Terraform Medium Resource Management Service account should not have improper privileges like admin, editor, owner, or write roles Documentation Project-wide SSH Keys Are Enabled In VM Instances3e4d5ce6-3280-4027-8010-c26eeea1ec01 Terraform Medium Secret Management VM Instance should block project-wide SSH keys Documentation High Google KMS Crypto Key Rotation Periodd8c57c4e-bf6f-4e32-a2bf-8643532de77b Terraform Medium Secret Management KMS encryption keys should be rotated every 90 days or less. A short lifetime of encryption keys reduces the potential blast radius in case of compromise. Documentation User with IAM Role704fcc44-a58f-4af5-82e2-93f2a58ef918 Terraform Low Best Practices As a best practice, it is better to assign an IAM Role to a group than to a user Documentation Google Compute Network Using Firewall Rule that Allows Port Rangee6f61c37-106b-449f-a5bb-81bfcaceb8b4 Terraform Low Networking and Firewall Google Compute Network should not use a firewall rule that allows port range Documentation Google Compute Subnetwork with Private Google Access Disabledee7b93c1-b3f8-4a3b-9588-146d481814f5 Terraform Low Networking and Firewall Google Compute Subnetwork should have Private Google Access enabled, which means 'private_ip_google_access' should be set to true Documentation Role Assignment Of Guest Users2bc626a8-0751-446f-975d-8139214fc790 Terraform High Access Control There is a role assignment for guest user Documentation Public Storage Account17f75827-0684-48f4-8747-61129c7e4198 Terraform High Access Control Storage Account should not be public to grant the principle of least privileges Documentation Function App Authentication Disablede65a0733-94a0-4826-82f4-df529f4c593f Terraform High Access Control Azure Function App authentication settings should be enabled Documentation Storage Container Is Publicly Accessibledd5230f8-a577-4bbb-b7ac-f2c2fe7d5299 Terraform High Access Control Anonymous, public read access to a container and its blobs are enabled in Azure Blob Storage Documentation Role Assignment Not Limit Guest User Permissions8e75e431-449f-49e9-b56a-c8f1378025cf Terraform High Access Control Role Assignment should limit guest user permissions Documentation Admin User Enabled For Container Registryb897dfbf-322c-45a8-b67c-1e698beeaa51 Terraform High Access Control Admin user is enabled for Container Registry Documentation Geo Redundancy Is Disabled8b042c30-e441-453f-b162-7696982ebc58 Terraform High Backup Make sure that on PostgreSQL Geo Redundant Backups is enabled Documentation App Service Not Using Latest TLS Encryption Versionb7b9d1c7-2d3b-49b4-b867-ebbe68d0b643 Terraform High Encryption Ensure App Service is using the latest version of TLS encryption Documentation MySQL SSL Connection Disabled73e42469-3a86-4f39-ad78-098f325b4e9f Terraform High Encryption Make sure that for MySQL Database Server, 'Enforce SSL connection' is enabled Documentation Function App Not Using Latest TLS Encryption Version45fc717a-bd86-415c-bdd8-677901be1aa6 Terraform High Encryption Ensure Function App is using the latest version of TLS encryption Documentation Storage Account Not Forcing HTTPS12944ec4-1fa0-47be-8b17-42a034f937c2 Terraform High Encryption Storage Accounts should enforce the use of HTTPS Documentation SSL Enforce Disabled0437633b-daa6-4bbc-8526-c0d2443b946e Terraform High Encryption Make sure that for PosgreSQL, the 'Enforce SSL connection' is set to 'ENABLED' Documentation Network Watcher Flow Disabledb90842e5-6779-44d4-9760-972f4c03ba1c Terraform High Insecure Configurations Check if enable field in the resource azurerm_network_watcher_flow_log is false. Documentation Azure Container Registry With No Locksa187ac47-8163-42ce-8a63-c115236be6fb Terraform High Insecure Configurations Azurerm Container Registry should contain associated locks, which means 'azurerm_management_lock.scope' should be associated with 'azurerm_container_registry' Documentation AKS Private Cluster Disabled599318f2-6653-4569-9e21-041d06c63a89 Terraform High Insecure Configurations Azure Kubernetes Service (AKS) API should not be exposed to the internet Documentation Azure App Service Client Certificate Disableda81573f9-3691-4d83-88a0-7d4af63e17a3 Terraform High Insecure Configurations Azure App Service client certificate should be enabled Documentation Redis Not Updated Regularlyb947809d-dd2f-4de9-b724-04d101c515aa Terraform High Insecure Configurations Redis Cache is not configured to be updated regularly with security and operational updates Documentation AD Admin Not Configured For SQL Servera3a055d2-9a2e-4cc9-b9fb-12850a1a3a4b Terraform High Insecure Configurations The Active Directory Administrator is not configured for a SQL server Documentation VM Not Attached To Networkbbf6b3df-4b65-4f87-82cc-da9f30f8c033 Terraform High Insecure Configurations No Network Security Group is attached to the Virtual Machine Documentation Function App FTPS Enforce Disabled9dab0179-433d-4dff-af8f-0091025691df Terraform High Insecure Configurations Azure Function App should only enforce FTPS when 'ftps_state' is enabled Documentation Web App Accepting Traffic Other Than HTTPS11e9a948-c6c3-4a0f-8dcf-b5cf1763cdbe Terraform High Insecure Configurations Web app should only accept HTTPS traffic in Azure Web App Service. Documentation App Service FTPS Enforce Disabled85da374f-b00f-4832-9d44-84a1ca1e89f8 Terraform High Insecure Configurations Azure App Service should only enforce FTPS when 'ftps_state' is enabled Documentation CosmosDB Account IP Range Filter Not Setc2a3efb6-8a58-481c-82f2-bfddf34bb4b7 Terraform High Networking and Firewall The IP range filter should be defined to secure the data stored Documentation MSSQL Server Public Network Access Enabledade36cf4-329f-4830-a83d-9db72c800507 Terraform High Networking and Firewall MSSQL Server public network access should be disabled Documentation Redis Publicly Accessible5089d055-53ff-421b-9482-a5267bdce629 Terraform High Networking and Firewall Firewall rule allowing unrestricted access to Redis from other Azure sources Documentation SSH Is Exposed To The Internet3e3c175e-aadf-4e2b-a464-3fdac5748d24 Terraform High Networking and Firewall Port 22 (SSH) is exposed to the internet Documentation RDP Is Exposed To The Internetefbf6449-5ec5-4cfe-8f15-acc51e0d787c Terraform High Networking and Firewall Port 3389 (Remote Desktop) is exposed to the internet Documentation SQLServer Ingress From Any IP25c0ea09-f1c5-4380-b055-3b83863f2bb8 Terraform High Networking and Firewall Check if all IPs are allowed, check from start 0.0.0.0 to end 255.255.255.255. Documentation Redis Entirely Accessiblefd8da341-6760-4450-b26c-9f6d8850575e Terraform High Networking and Firewall Firewall rule allowing unrestricted access to Redis from the Internet Documentation MySQL Server Public Access Enabledf118890b-2468-42b1-9ce9-af35146b425b Terraform High Networking and Firewall MySQL Server public access should be disabled Documentation Sensitive Port Is Exposed To Entire Network594c198b-4d79-41b8-9b36-fde13348b619 Terraform High Networking and Firewall A sensitive port, such as port 23 or port 110, is open for the whole network in either TCP or UDP protocol Documentation Trusted Microsoft Services Not Enabled5400f379-a347-4bdd-a032-446465fdcc6f Terraform High Networking and Firewall Trusted Microsoft Services should be enabled for Storage Account access Documentation Vault Auditing Disabled38c71c00-c177-4cd7-8d36-cd1007cdb190 Terraform High Observability Ensure that logging for Azure KeyVault is 'Enabled' Documentation App Service Managed Identity Disabledb61cce4b-0cc4-472b-8096-15617a6d769b Terraform High Resource Management Azure App Service should have managed identity enabled Documentation PostgreSQL Server Threat Detection Policy Disabledc407c3cf-c409-4b29-b590-db5f4138d332 Terraform High Resource Management PostgreSQL Server Threat Detection Policy should be enabled Documentation SQL Database Audit Disabled83a229ba-483e-47c6-8db7-dc96969bce5a Terraform High Resource Management Ensure that 'Threat Detection' is enabled for Azure SQL Database Documentation Key Expiration Not Set4d080822-5ee2-49a4-8984-68f3d4c890fc Terraform High Secret Management Make sure that for all keys the expiration date is set Documentation Secret Expiration Not Setdfa20ffa-f476-428f-a490-424b41e91c7f Terraform High Secret Management Make sure that for all secrets the expiration date is set Documentation AKS RBAC Disabled86f92117-eed8-4614-9c6c-b26da20ff37f Terraform Medium Access Control Azure Container Service (AKS) instance should have role-based access control (RBAC) enabled Documentation Role Definition Allows Custom Role Creation3fa5900f-9aac-4982-96b2-a6143d9c99fb Terraform Medium Access Control Role Definition should not allow custom role creation (Microsoft.Authorization/roleDefinitions/write) Documentation Storage Table Allows All ACL Permissions3ac3e75c-6374-4a32-8ba0-6ed69bda404e Terraform Medium Access Control Azure Storage Table should not allow all ACL (Access Control List) permissions - r (read), w (write), d (delete), and l (list). Documentation Storage Share File Allows All ACL Permissions48bbe0fd-57e4-4678-a4a1-119e79c90fc3 Terraform Medium Access Control Azure Storage Share File should not allow all ACL (Access Control List) permissions - r (read), w (write), d (delete), and l (list). Documentation Virtual Network with DDoS Protection Plan disabledb4cc2c52-34a6-4b43-b57c-4bdeb4514a5a Terraform Medium Availability Virtual Network should have DDoS Protection Plan enabled Documentation SQL Server Predictable Admin Account Name2ab6de9a-0136-415c-be92-79d2e4fd750f Terraform Medium Best Practices Azure SQL Server's Admin account login must avoid using names like 'Admin', that are too predictable, which means the attribute 'administrator_login' must be set to a name that is not easy to predict Documentation SQL Server Predictable Active Directory Account Namebcd3fc01-5902-4f2a-b05a-227f9bbf5450 Terraform Medium Best Practices Azure SQL Server must avoid using predictable Active Directory Administrator Account names, like 'Admin', which means the attribute 'login' must be set to a name that is not easy to predict Documentation Security Contact Email34664094-59e0-4524-b69f-deaa1a68cce3 Terraform Medium Best Practices Security Contact Email should be defined Documentation Cosmos DB Account Without Tags56dad03e-e94f-4dd6-93a4-c253a03ff7a0 Terraform Medium Build Process Cosmos DB Account must have a mapping of tags. Documentation Storage Account Not Using Latest TLS Encryption Version8263f146-5e03-43e0-9cfe-db960d56d1e7 Terraform Medium Encryption Ensure Storage Account is using the latest version of TLS encryption Documentation AKS Disk Encryption Set ID Undefinedb17d8bb8-4c08-4785-867e-cb9e62a622aa Terraform Medium Encryption Azure Container Service (AKS) should use Disk Encryption Set ID in supported types of disk Documentation Encryption On Managed Disk Disableda99130ab-4c0e-43aa-97f8-78d4fcb30024 Terraform Medium Encryption Ensure that the encryption is active on the disk Documentation Redis Cache Allows Non SSL Connectionse29a75e6-aba3-4896-b42d-b87818c16b58 Terraform Medium Insecure Configurations Redis Cache resources should not allow non-SSL connections Documentation Function App Client Certificates Unrequired9bb3c639-5edf-458c-8ee5-30c17c7d671d Terraform Medium Insecure Configurations Azure Function App should have 'client_cert_mode' set to required Documentation AKS Network Policy Misconfiguredf5342045-b935-402d-adf1-8dbbd09c0eef Terraform Medium Insecure Configurations Azure Kubernetes Service should have the proper network policy configuration to ensure the principle of least privileges, which means that 'network_profile.network_policy' should be defined Documentation Security Group is Not Configured5c822443-e1ea-46b8-84eb-758ec602e844 Terraform Medium Insecure Configurations Azure Virtual Network subnet must be configured with a Network Security Group, which means the attribute 'security_group' must be defined and not empty Documentation Small Flow Logs Retention Period7750fcca-dd03-4d38-b663-4b70289bcfd4 Terraform Medium Insecure Configurations Flow logs enable capturing information about IP traffic flowing in and out of the network security groups. Network Security Group Flow Logs must be enabled with retention period greater than or equal to 90 days. This is important, because these logs are used to check for anomalies and give information of suspected breaches Documentation Security Center Pricing Tier Is Not Standard819d50fd-1cdf-45c3-9936-be408aaad93e Terraform Medium Insecure Configurations Make sure that the 'Standard' pricing tiers were selected. Documentation Function App Managed Identity Disabledc87749b3-ff10-41f5-9df2-c421e8151759 Terraform Medium Insecure Configurations Azure Function App should have managed identity enabled Documentation Default Network Access is Allowed9be09caf-2ba4-4fa9-9787-a670dc32c639 Terraform Medium Insecure Defaults Default Network Access rule for Storage Accounts must be set to deny, which means the attribute 'default_action' must be 'Deny' Documentation Default Azure Storage Account Network Access Is Too Permissivea5613650-32ec-4975-a305-31af783153ea Terraform Medium Insecure Defaults Default Azure Storage Account network access should be set to Deny Documentation WAF Is Disabled For Azure Application Gateway2e48d91c-50e4-45c8-9312-27b625868a72 Terraform Medium Networking and Firewall Check if Web Application Firewall is disabled or not configured for Azure's Application Gateway. Documentation Network Interfaces IP Forwarding Enabled4216ebac-d74c-4423-b437-35025cb88af5 Terraform Medium Networking and Firewall Network Interfaces IP Forwarding should be disabled Documentation Network Interfaces With Public IPc1573577-e494-4417-8854-7e119368dc8b Terraform Medium Networking and Firewall Network Interfaces should not be exposed with a public IP address. If configured, additional security baselines should be followed (https://docs.microsoft.com/en-us/security/benchmark/azure/baselines/virtual-network-security-baseline, https://docs.microsoft.com/en-us/security/benchmark/azure/baselines/public-ip-security-baseline) Documentation MariaDB Server Public Network Access Enabled7f0a8696-7159-4337-ad0d-8a3ab4a78195 Terraform Medium Networking and Firewall MariaDB Server Public Network Access should be disabled Documentation Sensitive Port Is Exposed To Small Public Networke9dee01f-2505-4df2-b9bf-7804d1fd9082 Terraform Medium Networking and Firewall A sensitive port, such as port 23 or port 110, is open for small public network in either TCP or UDP protocol Documentation Unrestricted SQL Server Accessd7ba74da-2da0-4d4b-83c8-2fd72a3f6c28 Terraform Medium Networking and Firewall Azure SQL Server Accessibility should be set to a minimal address range to grant the principle of least privileges, which means the difference between the values of the 'end_ip_address' and 'start_ip_address' must be less than 256. Additionally, both ips must be different from '0.0.0.0'. Documentation Azure Cognitive Search Public Network Access Enabled4a9e0f00-0765-4f72-a0d4-d31110b78279 Terraform Medium Networking and Firewall Public Network Access should be disabled for Azure Cognitive Search Documentation Sensitive Port Is Exposed To Wide Private Networkc6c7b33d-d7f6-4ab8-8c82-ca0431ecdb7e Terraform Medium Networking and Firewall A sensitive port, such as port 23 or port 110, is open for wide private network in either TCP or UDP protocol Documentation Firewall Rule Allows Too Many Hosts To Access Redis Cachea829b715-cf75-4e92-b645-54c9b739edfb Terraform Medium Networking and Firewall Check if any firewall rule allows too many hosts to access Redis Cache Documentation Small Activity Log Retention Period2b856bf9-8e8c-4005-875f-303a8cba3918 Terraform Medium Observability Ensure that Activity Log Retention is set 365 days or greater Documentation PostgreSQL Log Disconnections Not Set07f7134f-9f37-476e-8664-670c218e4702 Terraform Medium Observability Make sure that for PostgreSQL Database, server parameter 'log_disconnections' is set to 'ON' Documentation Email Alerts Disabled9db38e87-f6aa-4b5e-a1ec-7266df259409 Terraform Medium Observability Make sure that alerts notifications are set to 'On' in the Azure Security Center Contact Documentation PostgreSQL Log Checkpoints Disabled3790d386-be81-4dcf-9850-eaa7df6c10d9 Terraform Medium Observability Make sure that for Postgre SQL Database Server, parameter 'log_checkpoints' is set to 'ON' Documentation Small MSSQL Audit Retention Period9c301481-e6ec-44f7-8a49-8ec63e2969ea Terraform Medium Observability Make sure that for MSSQL Server, the Auditing Retention is greater than 90 days Documentation Small MSSQL Server Audit Retention59acb56b-2b10-4c2c-ba38-f2223c3f5cfc Terraform Medium Observability Make sure for SQL Servers that Auditing Retention is greater than 90 days Documentation Log Retention Is Not Setffb02aca-0d12-475e-b77c-a726f7aeff4b Terraform Medium Observability Make sure that for PostgreSQL Database, server parameter 'log_retention' is set to 'ON' Documentation Small PostgreSQL DB Server Log Retention Period261a83f8-dd72-4e8c-b5e1-ebf06e8fe606 Terraform Medium Observability Check if PostgreSQL Database Server retains logs for less than 3 Days Documentation PostgreSQL Server Without Connection Throttling2b3c671f-1b76-4741-8789-ed1fe0785dc4 Terraform Medium Observability Ensure that Connection Throttling is set for the PostgreSQL server Documentation MSSQL Server Auditing Disabled609839ae-bd81-4375-9910-5bce72ae7b92 Terraform Medium Observability Make sure that for MSSQL Servers, that 'Auditing' is set to 'On' Documentation SQL Server Auditing Disabledf7e296b0-6660-4bc5-8f87-22ac4a815edf Terraform Medium Observability Make sure that for SQL Servers, 'Auditing' is set to 'On' Documentation PostgreSQL Log Connections Not Setc640d783-10c5-4071-b6c1-23507300d333 Terraform Medium Observability Make sure that for PostgreSQL Database, server parameter 'log_connections' is set to 'ON' Documentation PostgreSQL Log Duration Not Set16e0879a-c4ae-4ff8-a67d-a2eed5d67b8f Terraform Medium Observability Make sure that for PostgreSQL Database, server parameter 'log_duration' is set to 'ON' Documentation Azure Active Directory Authenticationa21c8da9-41bf-40cf-941d-330cf0d11fc7 Terraform Low Access Control Azure Active Directory must be used for authentication for Service Fabric Documentation MariaDB Server Geo-redundant Backup Disabled0a70d5f3-1ecd-4c8e-9292-928fc9a8c4f1 Terraform Low Backup MariaDB Server Geo-redundant Backup should be enabled Documentation Key Vault Secrets Content Type Undefinedf8e08a38-fc6e-4915-abbe-a7aadf1d59ef Terraform Low Best Practices Key Vault Secrets should have set Content Type Documentation AKS Uses Azure Policies Add-On Disabled43789711-161b-4708-b5bb-9d1c626f7492 Terraform Low Best Practices Azure Container Service (AKS) should use Azure Policies Add-On Documentation App Service Without Latest PHP Version96fe318e-d631-4156-99fa-9080d57280ae Terraform Low Best Practices Periodically newer versions are released for PHP software either due to security flaws or to include additional functionality. Using the latest PHP version for web apps is recommended in order to take advantage of security fixes, if any, and/or additional functionalities of the newer version. Documentation App Service Without Latest Python Versioncc4aaa9d-1070-461a-b519-04e00f42db8a Terraform Low Best Practices Periodically, newer versions are released for Python software either due to security flaws or to include additional functionality. Using the latest full Python version for web apps is recommended in order to take advantage of security fixes, if any, and/or additional functionalities of the newer version. Documentation PostgreSQL Server Infrastructure Encryption Disabled6425c98b-ca4e-41fe-896a-c78772c131f8 Terraform Low Encryption PostgreSQL Server Infrastructure Encryption should be enabled Documentation App Service HTTP2 Disabled525b53be-62ed-4244-b4df-41aecfcb4071 Terraform Low Insecure Configurations App Service should have 'http2_enabled' enabled Documentation Function App HTTP2 Disabledace823d1-4432-4dee-945b-cdf11a5a6bd0 Terraform Low Insecure Configurations Function App should have 'http2_enabled' enabled Documentation Dashboard Is Enabled61c3cb8b-0715-47e4-b788-86dde40dd2db Terraform Low Insecure Configurations Check if the Kubernetes Dashboard is enabled. Documentation Azure Front Door WAF Disabled835a4f2f-df43-437d-9943-545ccfc55961 Terraform Low Networking and Firewall Azure Front Door WAF should be enabled Documentation App Service Authentication Disabledc7fc1481-2899-4490-bbd8-544a3a61a2f3 Terraform Info Access Control Azure App Service authentication settings should be enabled Documentation SQL Server Alert Email Disabled55975007-f6e7-4134-83c3-298f1fe4b519 Terraform Info Best Practices SQL Server alert email should be enabled Documentation Always Admit Admission Control Plugin Setce30e584-b33f-4c7d-b418-a3d7027f8f60 Kubernetes High Access Control When using kube-apiserver command, the '--enable-admission-plugins' flag should not have 'AlwaysAdmit' plugin Documentation RBAC Wildcard In Rule6b896afb-ca07-467a-b256-1a0077a1c08e Kubernetes High Access Control Roles and ClusterRoles with wildcard RBAC permissions provide excessive rights to the Kubernetes API and should be avoided. The principle of least privilege recommends to specify only the set of needed objects and actions Documentation Basic Auth File Is Set5da47109-f8d6-4585-9e2b-96a8958a12f5 Kubernetes High Access Control When using kube-apiserver command, the 'basic-auth-file' flag should not be set Documentation Node Restriction Admission Control Plugin Not Set33fc6923-6553-4fe6-9d3a-4efa51eb874b Kubernetes High Access Control When using kube-apiserver command, the --enable-admission-plugins flag should have 'NodeRestriction' plugin and the plugin should be correctly configured in AdmissionControl Config file Documentation Client Certificate Authentication Not Setup Properlye0e00aba-5f1c-4981-a542-9a9563c0ee20 Kubernetes High Access Control Client Certificate Authentication should be Setup with a .pem or .crt file Documentation Service Account Lookup Set To Falsea5530bd7-225a-48f9-91bb-f40b04200165 Kubernetes High Access Control When using kube-apiserver command, the '--service-account-lookup' flag should be set to true Documentation Use Service Account Credentials Not Set To True1acd93f1-5a37-45c0-aaac-82ece818be7d Kubernetes High Access Control When using kube-controller-manager commands, the '--use-service-account-credentials' should be set to true Documentation Token Auth File Is Set32ecd76e-7bbf-402e-bf48-8b9485749558 Kubernetes High Access Control When using kube-apiserver command, the 'token-auth-file' flag should not be set Documentation Pod Security Policy Admission Control Plugin Not Setafa36afb-39fe-4d94-b9b6-afb236f7a03d Kubernetes High Build Process When using kube-apiserver command, the '--enable-admission-plugins' flag should have 'PodSecurityPolicy' plugin and the plugin should be correctly configured in AdmissionControl Config file Documentation Service Account Private Key File Not Definedccc98ff7-68a7-436e-9218-185cb0b0b780 Kubernetes High Encryption When using kube-controller-manager commands, the '--service-account-private-key-file' should be defined Documentation Cluster Allows Unsafe Sysctls9127f0d9-2310-42e7-866f-5fd9d20dcbad Kubernetes High Insecure Configurations A Kubernetes Cluster must not allow unsafe sysctls, to prevent a pod from having any influence on any other pod on the node, harming the node's health or gaining CPU or memory resources outside of the resource limits of a pod. This means 'spec.securityContext.sysctls' must not specify unsafe sysctls and the attribute 'allowedUnsafeSysctls' must be undefined. Documentation Tiller (Helm v2) Is Deployed6d173be7-545a-46c6-a81d-2ae52ed1605d Kubernetes High Insecure Configurations Check if Tiller is deployed. Documentation Shared Host PID Namespace302736f4-b16c-41b8-befe-c0baffa0bd9d Kubernetes High Insecure Configurations Container should not share the host process ID namespace Documentation Not Limited Capabilities For Pod Security Policycaa93370-791f-4fc6-814b-ba6ce0cb4032 Kubernetes High Insecure Configurations Limit capabilities for a Pod Security Policy Documentation Container Is Privilegeddd29336b-fe57-445b-a26e-e6aa867ae609 Kubernetes High Insecure Configurations Privileged containers lack essential security restrictions and should be avoided by removing the 'privileged' flag or by changing its value to false Documentation Privilege Escalation Allowed5572cc5e-1e4c-4113-92a6-7a8a3bd25e6d Kubernetes High Insecure Configurations Containers should not run with allowPrivilegeEscalation in order to prevent them from gaining more privileges than their parent process Documentation PSP Allows Containers To Share The Host Network Namespacea33e9173-b674-4dfb-9d82-cf3754816e4b Kubernetes High Insecure Configurations Check if Pod Security Policies allow containers to share the host network namespace. Documentation Tiller Service Is Not Deleted8b862ca9-0fbd-4959-ad72-b6609bdaa22d Kubernetes High Insecure Configurations Check if there is any Tiller Service present Documentation Role Binding To Default Service Account1e749bc9-fde8-471c-af0c-8254efd2dee5 Kubernetes High Insecure Defaults No role nor cluster role should bind to a default service account Documentation Etcd Peer TLS Certificate Files Not Properly Set09bb9e96-8da3-4736-b89a-b36814acca60 Kubernetes High Networking and Firewall When using etcd commands, the '--peer-cert-file' and '--peer-key-file' should be defined Documentation TSL Connection Certificate Not Setupfa750c81-93c2-4fab-9c6d-d3fd3ce3b89f Kubernetes High Networking and Firewall TSL Connection Certificate files should be Setup Documentation Etcd TLS Certificate Files Not Properly Set075ca296-6768-4322-aea2-ba5063b969a9 Kubernetes High Networking and Firewall When using etcd commands, the '--cert-file' and '--key-file' should be defined Documentation Secure Port Set To Zero3d24b204-b73d-42cb-b0bf-1a5438c5f71e Kubernetes High Networking and Firewall When using kube-apiserver command, the --secure-port flag should not be 0 Documentation Etcd TLS Certificate Not Properly Configured895a5a95-3756-4b04-9924-2f3bc93181bd Kubernetes High Networking and Firewall When using kube-apiserver commands, the '--etcd-certfile' and '--etcd-keyfile' flags should be defined Documentation Bind Address Not Properly Set46a2e9ec-6a5f-4faa-9d39-4ea44d5d87a2 Kubernetes High Networking and Firewall When using kube-controller-manager or kube-scheduler commands, the '--bind-address' should not be set to 127.0.0.1 Documentation Tiller Deployment Is Accessible From Within The Clustere17fa86a-6222-4584-a914-56e8f6c87e06 Kubernetes High Networking and Firewall Check if any Tiller Deployment container allows access from within the cluster. Documentation Insecure Port Not Properly Setfa4def8c-1898-4a35-a139-7b76b1acdef0 Kubernetes High Networking and Firewall When using kube-apiserver command, the '--insecure-port' flag should be defined and set to 0 Documentation Kubelet HTTPS Set To Falsecdc8b54e-6b16-4538-a1b0-35849dbe29cf Kubernetes High Networking and Firewall When using kube-apiserver command, the '--kubelet-https' flag should not be set to false Documentation Insecure Bind Address Setb9380fd3-5ffe-4d10-9290-13e18e71eee1 Kubernetes High Networking and Firewall When using kube-apiserver command, the '--insecure-bind-address' flag should not be set Documentation PSP With Unrestricted Access to Host Pathde4421f1-4e35-43b4-9783-737dd4e4a47e Kubernetes High Resource Management PodSecurityPolicy should set 'readOnly' to true in every host path allowed Documentation Auto TLS Set To True98ce8b81-7707-4734-aa39-627c6db3d84b Kubernetes High Secret Management When using etcd commands, the '--auto-tls' should be set to false Documentation Peer Auto TLS Set To Trueae8827e2-4af9-4baa-9998-87539ae0d6f0 Kubernetes High Secret Management When using etcd commands, the '--peer-auto-tls' should be set to false Documentation Authorization Mode RBAC Not Set1aa4a1ae-5dbb-48a1-9aa2-630ea4be208e Kubernetes Medium Access Control When using kube-apiserver command, the 'authorization-mode' flag should have 'RBAC' mode Documentation Permissive Access to Create Pods592ad21d-ad9b-46c6-8d2d-fad09d62a942 Kubernetes Medium Access Control The permission to create pods in a cluster should be restricted because it allows privilege escalation. Documentation Non Kube System Pod With Host Mountaa8f7a35-9923-4cad-bd61-a19b7f6aac91 Kubernetes Medium Access Control A non kube-system workload should not have hostPath mounted Documentation RBAC Roles with Exec Permissionc589f42c-7924-4871-aee2-1cede9bc7cbc Kubernetes Medium Access Control Roles or ClusterRoles with RBAC permissions to run commands in containers via 'kubectl exec' could be abused by attackers to execute malicious code in case of compromise. To prevent this, the 'pods/exec' verb should not be used in production environments Documentation RBAC Roles with Port-Forwarding Permission38fa11ef-dbcc-4da8-9680-7e1fd855b6fb Kubernetes Medium Access Control Roles or ClusterRoles with RBAC permissions to port-forward into pods can open socket-level communication channels to containers. In case of compromise, attackers may abuse this for direct communication that bypasses network security restrictions Documentation RBAC Roles with Attach Permissiond45330fd-f58d-45fb-a682-6481477a0f84 Kubernetes Medium Access Control Roles or ClusterRoles with RBAC permissions to attach to containers via 'kubectl attach' could be abused by attackers to read log output (stdout, stderr) and send input data (stdin) to running processes. Additionally, it would allow a malicious user to attach to a privileged container resulting in a privilege escalation attack. To prevent this, the 'pods/attach' verb should not be used in production environments Documentation Service Account Admission Control Plugin Disabled9587c890-0524-40c2-9ce2-663af7c2f063 Kubernetes Medium Access Control When using kube-apiserver command, the '--disable-admission-plugins' flag should not have 'ServiceAccount' plugin Documentation RBAC Roles with Read Secrets Permissionsb7bca5c4-1dab-4c2c-8cbe-3050b9d59b14 Kubernetes Medium Access Control Roles and ClusterRoles with get/watch/list RBAC permissions on Kubernetes secrets are dangerous and should be avoided. In case of compromise, attackers could abuse these roles to access sensitive data, such as passwords, tokens and keys Documentation Anonymous Auth Is Not Set To False1de5cc51-f376-4638-a940-20f2e85ae238 Kubernetes Medium Access Control When using the kubelet or kube-apiserver command, the 'anonymous-auth' flag should be set to false (--anonymous-auth=false) Documentation RBAC Roles Allow Privilege Escalation8320826e-7a9c-4b0b-9535-578333193432 Kubernetes Medium Access Control Roles or ClusterRoles with RBAC permissions 'bind' or 'escalate' allow subjects to create new bindings with other roles. This is dangerous, as users with these privileges can bind to roles that may exceed their own privileges Documentation Authorization Mode Set To Always Allowf1f4d8da-1ac4-47d0-b1aa-91e69d33f7d5 Kubernetes Medium Access Control When using the kubelet command, the authorization-mode flag should not have 'AlwaysAllow' mode Documentation RBAC Roles with Impersonate Permission9f85c3f6-26fd-4007-938a-2e0cb0100980 Kubernetes Medium Access Control Roles or ClusterRoles with the permission 'impersonate' allow subjects to assume the rights of other users, groups, or service accounts. In case of compromise, attackers may abuse this sudo-like functionality to achieve privilege escalation Documentation Terminated Pod Garbage Collector Threshold Not Properly Set49113af4-29ca-458e-b8d4-724c01a4a24f Kubernetes Medium Availability When using kube-controller-manager commands, the '--terminated-pod-gc-threshold' should be set between 0 and 12501 Documentation Request Timeout Not Properly Setd89a15bb-8dba-4c71-9529-bef6729b9c09 Kubernetes Medium Availability When using kube-apiserver command, the '--request-timeout' flag value should not be too long Documentation Readiness Probe Is Not Configureda659f3b5-9bf0-438a-bd9a-7d3a6427f1e3 Kubernetes Medium Availability Check if Readiness Probe is not configured. Documentation Root Containers Admittede3aa0612-4351-4a0d-983f-aefea25cf203 Kubernetes Medium Best Practices Containers must not be allowed to run with root privileges, which means the attributes 'privileged','allowPrivilegeEscalation' and 'readOnlyRootFilesystem' must be set to false, 'runAsUser.rule' must be set to 'MustRunAsNonRoot', and adding the root group must be forbidden Documentation Container Running With Low UID02323c00-cdc3-4fdc-a310-4f2b3e7a1660 Kubernetes Medium Best Practices Check if containers are running with low UID, which might cause conflicts with the host's user table. Documentation Container Running As Rootcf34805e-3872-4c08-bf92-6ff7bb0cfadb Kubernetes Medium Best Practices Containers should only run as non-root user. This limits the exploitability of security misconfigurations and restricts an attacker's possibilities in case of compromise Documentation Incorrect Volume Claim Access Mode ReadWriteOnce3878dc92-8e5d-47cf-9cdd-7590f71d21b9 Kubernetes Medium Build Process Kubernetes Stateful Sets must have one Volume Claim template with the access mode 'ReadWriteOnce' Documentation Always Pull Images Admission Control Plugin Not Seta77f4d07-c6e0-4a48-8b35-0eeb51576f4f Kubernetes Medium Build Process When using kube-apiserver command, the '--enable-admission-plugins' flag should have 'AlwaysPullImages' plugin and the plugin should be correctly configured in AdmissionControl Config file Documentation Weak TLS Cipher Suites510d5810-9a30-443a-817d-5c1fa527b110 Kubernetes Medium Encryption TLS Connection should use strong Cipher Suites Documentation Encryption Provider Not Properly Configured10efce34-5af6-4d83-b414-9e096d5a06a9 Kubernetes Medium Encryption The EncryptionConfiguration should be configured to have at least one 'aescbc', 'kms' or 'secretbox' provider Documentation Encryption Provider Config Is Not Definedcbd2db69-0b21-4c14-8a40-7710a50571a9 Kubernetes Medium Encryption When using kube-apiserver commands, the '--encryption-provider-config' flag should be defined and the encryption should be correctly configured in Encryption Configuration file Documentation Root CA File Not Defined05fb986f-ac73-4ebb-a5b2-7faafa93d882 Kubernetes Medium Encryption When using kube-controller-manager commands, the '--root-ca-file' should be defined Documentation Using Unrecommended Namespace611ab018-c4aa-4ba2-b0f6-a448337509a6 Kubernetes Medium Insecure Configurations Namespaces like 'default', 'kube-system' or 'kube-public' should not be used Documentation PSP Allows Privilege Escalation87554eef-154d-411d-bdce-9dbd91e56851 Kubernetes Medium Insecure Configurations PodSecurityPolicy should not allow privilege escalation Documentation Kubelet Protect Kernel Defaults Set To False6cf42c97-facd-4fda-b8af-ea4529123355 Kubernetes Medium Insecure Configurations --protect-kernel-defaults should be set to true Documentation Containers With Sys Admin Capabilities235236ee-ad78-4065-bd29-61b061f28ce0 Kubernetes Medium Insecure Configurations Containers should not have CAP_SYS_ADMIN Linux capability Documentation NET_RAW Capabilities Disabled for PSP2270987f-bb51-479f-b8be-3ca73e5ad648 Kubernetes Medium Insecure Configurations Containers need to have NET_RAW or All as drop capabilities Documentation Security Context Deny Admission Control Plugin Not Set6a68bebe-c021-492e-8ddb-55b0567fb768 Kubernetes Medium Insecure Configurations When using kube-apiserver command, the '--enable-admission-plugins' flag should have 'SecurityContextDeny' plugin and the plugin should be correctly configured in AdmissionControl Config file when 'PodSecurityPolicy' plugin is not set Documentation Seccomp Profile Is Not Configuredf377b83e-bd07-4f48-a591-60c82b14a78b Kubernetes Medium Insecure Configurations Containers should be configured with a secure Seccomp profile to restrict potentially dangerous syscalls Documentation Workload Mounting With Sensitive OS Directory5308a7a8-06f8-45ac-bf10-791fe21de46e Kubernetes Medium Insecure Configurations Workload is mounting a volume with sensitive OS Directory Documentation Authorization Mode Node Not Set4d7ee40f-fc5d-427d-8cac-dffbe22d42d1 Kubernetes Medium Insecure Configurations When using kube-apiserver command, the 'authorization-mode' flag should have 'Node' mode Documentation PSP Set To Privilegedc48e57d3-d642-4e0b-90db-37f807b41b91 Kubernetes Medium Insecure Configurations Do not allow pod to request execution as privileged. Documentation NET_RAW Capabilities Not Being Droppeddbbc6705-d541-43b0-b166-dd4be8208b54 Kubernetes Medium Insecure Configurations Containers should drop 'ALL' or at least 'NET_RAW' capabilities Documentation PSP Allows Sharing Host PID91dacd0e-d189-4a9c-8272-5999a3cc32d9 Kubernetes Medium Insecure Configurations Pod Security Policy allows containers to share the host process ID namespace Documentation Ingress Controller Exposes Workload69bbc5e3-0818-4150-89cc-1e989b48f23b Kubernetes Medium Insecure Configurations Ingress Controllers should not expose workload in order to avoid vulnerabilities and DoS attacks Documentation PSP With Added Capabilities7307579a-3abb-46ad-9ce5-2a915634d5c8 Kubernetes Medium Insecure Configurations PodSecurityPolicy should not have added capabilities Documentation Not Limited Capabilities For Container2f1a0619-b12b-48a0-825f-993bb6f01d58 Kubernetes Medium Insecure Configurations Limit the capabilities for a Container. Documentation Container Runs Unmaskedf922827f-aab6-447c-832a-e1ff63312bd3 Kubernetes Medium Insecure Configurations Check if a container has full access (unmasked) to the host\u2019s /proc command, which would allow to retrieve sensitive information and possibly change the kernel parameters in runtime. Documentation PSP Allows Sharing Host IPC80f93444-b240-4ebb-a4c6-5c40b76c04ea Kubernetes Medium Insecure Configurations Pod Security Policy allows containers to share the host IPC namespace Documentation Containers With Added Capabilities19ebaa28-fc86-4a58-bcfa-015c9e22fe40 Kubernetes Medium Insecure Configurations Containers should not have extra capabilities allowed Documentation Service Account Token Automount Not Disabled48471392-d4d0-47c0-b135-cdec95eb3eef Kubernetes Medium Insecure Defaults Service Account Tokens are automatically mounted even if not necessary Documentation Service Account Name Undefined Or Empty591ade62-d6b0-4580-b1ae-209f80ba1cd9 Kubernetes Medium Insecure Defaults A Kubernetes Pod should have a Service Account defined so to restrict Kubernetes API access, which means the attribute 'serviceAccountName' should be defined and not empty. Documentation Service With External Load Balancer26763a1c-5dda-4772-b507-5fca7fb5f165 Kubernetes Medium Networking and Firewall Service has an external load balancer, which may cause accessibility from other networks and the Internet Documentation Pod Misconfigured Network Policy0401f71b-9c1e-4821-ab15-a955caa621be Kubernetes Medium Networking and Firewall Check if any pod is not being targeted by a proper network policy. Documentation Kubelet Streaming Connection Timeout Disableded89b97d-04e9-4fd4-919f-ee5b27e555e9 Kubernetes Medium Networking and Firewall The flag --streaming-connection-idle-timeout should not be set to 0 Documentation Kubelet Not Managing Ip Tables5f89001f-6dd9-49ff-9b15-d8cd71b617f4 Kubernetes Medium Networking and Firewall Kubelet argument --make-iptables-util-chains should be true Documentation Network Policy Is Not Targeting Any Pod85ab1c5b-014e-4352-b5f8-d7dea3bb4fd3 Kubernetes Medium Networking and Firewall Check if any network policy is not targeting any pod. Documentation CNI Plugin Does Not Support Network Policies03aabc8c-35d6-481e-9c85-20139cf72d23 Kubernetes Medium Networking and Firewall Ensure the use of CNI Plugin that support Network Policies. If the CNI Plugin in use does not support Network Policies it may not be possible to effectively restrict traffic in the cluster Documentation Kubelet Read Only Port Is Not Set To Zero2940d48a-dc5e-4178-a3f8-bfbd80720b41 Kubernetes Medium Networking and Firewall When using the kubelet command, the read-only port should be set to zero (--read-only-port=0) Documentation Audit Log Path Not Set73e251f0-363d-4e53-86e2-0a93592437eb Kubernetes Medium Observability When using kube-apiserver command, the 'audit-log-path' flag should be defined Documentation Audit Policy File Not Defined13a49a2e-488e-4309-a7c0-d6b05577a5fb Kubernetes Medium Observability When using kube-apiserver command, the '--audit-policy-file' flag should be defined Documentation Memory Limits Not Definedb14d1bc4-a208-45db-92f0-e21f8e2588e9 Kubernetes Medium Resource Management Memory limits should be defined for each container. This prevents potential resource exhaustion by ensuring that containers consume not more than the designated amount of memory Documentation CPU Limits Not Set4ac0e2b7-d2d2-4af7-8799-e8de6721ccda Kubernetes Medium Resource Management CPU limits should be set because if the system has CPU time free, a container is guaranteed to be allocated as much CPU as it requests Documentation Memory Requests Not Defined229588ef-8fde-40c8-8756-f4f2b5825ded Kubernetes Medium Resource Management Memory requests should be defined for each container. This allows the kubelet to reserve the requested amount of system resources and prevents over-provisioning on individual nodes Documentation Shared Host Network Namespace6b6bdfb3-c3ae-44cb-88e4-7405c1ba2c8a Kubernetes Medium Resource Management Container should not share the host network namespace Documentation Volume Mount With OS Directory Write Permissionsb7652612-de4e-4466-a0bf-1cd81f0c6063 Kubernetes Medium Resource Management Containers can mount sensitive folders from the hosts, giving them potentially dangerous access to critical host configurations and binaries. Documentation Shared Host IPC Namespacecd290efd-6c82-4e9d-a698-be12ae31d536 Kubernetes Medium Resource Management Container should not share the host IPC namespace Documentation CPU Requests Not Setca469dd4-c736-448f-8ac1-30a642705e0a Kubernetes Medium Resource Management CPU requests should be set to ensure the sum of the resource requests of the scheduled Containers is less than the capacity of the node Documentation Rotate Kubelet Server Certificate Not Active1c621b8e-2c6a-44f5-bd6a-fb0fb7ba33e2 Kubernetes Medium Secret Management The RotateKubeletServerCertificate argument should be true Documentation Etcd Client Certificate Authentication Set To False9391103a-d8d7-4671-ac5d-606ba7ccb0ac Kubernetes Medium Secret Management When using etcd commands, the '--client-cert-auth' flag should be defined Documentation Shared Service Accountc1032cf7-3628-44e2-bd53-38c17cf31b6b Kubernetes Medium Secret Management A Service Account token is shared between workloads Documentation Kubelet Client Certificate Or Key Not Set36a27826-1bf5-49da-aeb0-a60a30c0e834 Kubernetes Medium Secret Management When using kube-apiserver command, the 'kubelet-client-key' and 'kubelet-client-certificate' flags should be set Documentation Not Unique Certificate Authoritycb7e695d-6a85-495c-b15f-23aed2519303 Kubernetes Medium Secret Management Certificate Authority should be unique for etcd Documentation Kubelet Certificate Authority Not Setec18a0d3-0069-4a58-a7fb-fbfe0b4bbbe0 Kubernetes Medium Secret Management When using kube-apiserver command, the 'kubelet-certificate-authority' flag should be set Documentation Etcd Client Certificate File Not Defined3f5ff8a7-5ad6-4d02-86f5-666307da1b20 Kubernetes Medium Secret Management When using kube-apiserver commands, the '--etcd-cafile' flag should be defined Documentation Service Account Key File Not Properly Setdab4ec72-ce2e-4732-b7c3-1757dcce01a1 Kubernetes Medium Secret Management When using kube-apiserver command, the '--service-account-key-file' flag should be defined Documentation Kubelet Client Periodic Certificate Switch Disabled52d70f2e-3257-474c-b3dc-8ad9ba6a061a Kubernetes Medium Secret Management Kubelet argument --rotate-certificates should be true Documentation Etcd Peer Client Certificate Authentication Set To Falseb7d0181d-0a9b-4611-9d1c-1ad4f0b620ff Kubernetes Medium Secret Management When using etcd commands, the '--peer-client-cert-auth' flag should be set to true Documentation ServiceAccount Allows Access Secrets056ac60e-fe07-4acc-9b34-8e1d51716ab9 Kubernetes Medium Secret Management Roles and ClusterRoles when binded, should not use get, list or watch as verbs Documentation Docker Daemon Socket is Exposed to Containersa6f34658-fdfb-4154-9536-56d516f65828 Kubernetes Low Access Control Sees if Docker Daemon Socket is not exposed to Containers Documentation Missing AppArmor Profile8b36775e-183d-4d46-b0f7-96a6f34a723f Kubernetes Low Access Control Containers should be configured with an AppArmor profile to enforce fine-grained access control over low-level system resources Documentation Cluster Admin Rolebinding With Superuser Permissions249328b8-5f0f-409f-b1dd-029f07882e11 Kubernetes Low Access Control Ensure that the cluster-admin role is only used where required (RBAC) Documentation Event Rate Limit Admission Control Plugin Not Sete0099af2-fe17-411f-9991-0de28fe15f3c Kubernetes Low Availability When using kube-apiserver command, the --enable-admission-plugins flag should have 'EventRateLimit' plugin and the plugin should be correctly configured in AdmissionControl Config file Documentation HPA Targeted Deployments With Configured Replica Count5744cbb8-5946-4b75-a196-ade44449525b Kubernetes Low Availability Deployments targeted by HorizontalPodAutoscaler should not have a statically configured replica count set Documentation HPA Targets Invalid Object2f652c42-619d-4361-b361-9f599688f8ca Kubernetes Low Availability The Horizontal Pod Autoscaler must target a valid object Documentation Deployment Without PodDisruptionBudgetb23e9b98-0cb6-4fc9-b257-1f3270442678 Kubernetes Low Availability Deployments should be assigned with a PodDisruptionBudget to ensure high availability Documentation Liveness Probe Is Not Definedade74944-a674-4e00-859e-c6eab5bde441 Kubernetes Low Availability In case of an unresponsive container, a Liveness Probe can help your application become more available since it restarts the container. However, it can lead to cascading failures. Define one if you really need it Documentation StatefulSet Without PodDisruptionBudget1db3a5a5-bf75-44e5-9e44-c56cfc8b1ac5 Kubernetes Low Availability StatefulSets should be assigned with a PodDisruptionBudget to ensure high availability Documentation StatefulSet Without Service Namebb241e61-77c3-4b97-9575-c0f8a1e008d0 Kubernetes Low Availability StatefulSets should have an existing headless 'serviceName'. The headless service labels should also be implemented on StatefulSets labels. Documentation Metadata Label Is Invalid1123031a-f921-4c5b-bd86-ef354ecfd37a Kubernetes Low Best Practices Check if any label in the metadata is invalid. Documentation No Drop Capabilities for Containers268ca686-7fb7-4ae9-b129-955a2a89064e Kubernetes Low Best Practices Sees if Kubernetes Drop Capabilities exists to ensure containers security context Documentation Object Is Using A Deprecated API Version94b76ea5-e074-4ca2-8a03-c5a606e30645 Kubernetes Low Best Practices Kubernetes APIs evolve over time and are sometimes removed with newer releases. To prevent incompatibilities when upgrading Kubernetes, deprecated APIs should be replaced with newer and more stable API versions. Documentation Root Container Not Mounted Read-onlya9c2f49d-0671-4fc9-9ece-f4e261e128d0 Kubernetes Low Build Process Check if the root container filesystem is not being mounted read-only. Documentation StatefulSet Requests Storage8cf4671a-cf3d-46fc-8389-21e7405063a2 Kubernetes Low Build Process A StatefulSet requests volume storage. Documentation Image Policy Webhook Admission Control Plugin Not Set14abda69-8e91-4acb-9931-76e2bee90284 Kubernetes Low Build Process When using kube-apiserver command, the --enable-admission-plugins flag should have 'ImagePolicyWebhook' plugin and the plugin should be correctly configured in AdmissionControl Config file Documentation Namespace Lifecycle Admission Control Plugin Disabled1ffe7bf7-563b-4b3d-a71d-ba6bd8d49b37 Kubernetes Low Build Process When using kube-apiserver command, the '--disable-admission-plugins' flag should not have 'NamespaceLifecycle' plugin Documentation Image Pull Policy Of The Container Is Not Set To Alwayscaa3479d-885d-4882-9aac-95e5e78ef5c2 Kubernetes Low Insecure Configurations Image Pull Policy of the container must be defined and set to Always Documentation Pod or Container Without LimitRange4a20ebac-1060-4c81-95d1-1f7f620e983b Kubernetes Low Insecure Configurations Each namespace should have a LimitRange policy associated to ensure that resource allocations of Pods, Containers and PersistentVolumeClaims do not exceed the defined boundaries Documentation Pod or Container Without ResourceQuota48a5beba-e4c0-4584-a2aa-e6894e4cf424 Kubernetes Low Insecure Configurations Each namespace should have a ResourceQuota policy associated to limit the total amount of resources Pods, Containers and PersistentVolumeClaims can consume Documentation Kubelet Hostname Override Is Setbf36b900-b5ef-4828-adb7-70eb543b7cfb Kubernetes Low Insecure Configurations Hostnames should not be overrided Documentation Pod or Container Without Security Contexta97a340a-0063-418e-b3a1-3028941d0995 Kubernetes Low Insecure Configurations A security context defines privilege and access control settings for a Pod or Container Documentation Dashboard Is Enabledd2ad057f-0928-41ef-a83c-f59203bb855b Kubernetes Low Insecure Configurations If not needed, disabling the dashboard can prevent from being used as an attack vector Documentation Image Without Digest7c81d34c-8e5a-402b-9798-9f442630e678 Kubernetes Low Insecure Configurations Images should be specified together with their digests to ensure integrity Documentation Service Does Not Target Pod3ca03a61-3249-4c16-8427-6f8e47dda729 Kubernetes Low Insecure Configurations Service should Target a Pod Documentation Workload Host Port Not Specified2b1836f1-dcce-416e-8e16-da8c71920633 Kubernetes Low Networking and Firewall Verifies if Kubernetes workload's host port is specified Documentation Service Type is NodePort845acfbe-3e10-4b8e-b656-3b404d36dfb2 Kubernetes Low Networking and Firewall Service type should not be NodePort Documentation Audit Policy Not Cover Key Security Concerns1828a670-5957-4bc5-9974-47da228f75e2 Kubernetes Low Observability Audit Policy should cover key security concerns about the sensitive data logged in Kubernetes audit policies Documentation Audit Log Maxbackup Not Properly Set768aab52-2504-4a2f-a3e3-329d5a679848 Kubernetes Low Observability When using kube-apiserver command, the '--audit-log-maxbackup' flag should be defined and set to 10 or more files Documentation Audit Log Maxsize Not Properly Set35c0a471-f7c8-4993-aa2c-503a3c712a66 Kubernetes Low Observability When using kube-apiserver command, the '--audit-log-maxsize' flag should be defined and set to 100 or more MegaBytes Documentation Profiling Not Set To False2f491173-6375-4a84-b28e-a4e2b9a58a69 Kubernetes Low Observability When using kube-apiserver or kube-controller-manager or kube-scheduler command, the '--profiling' flag should be defined and set to false Documentation Audit Log Maxage Not Properly Setda9f3aa8-fbfb-472f-b5a1-576127944218 Kubernetes Low Observability When using kube-apiserver command, the '--audit-log-maxage' flag should be defined and set to 30 or more days Documentation Kubelet Event QPS Not Properly Set1a07a446-8e61-4e4d-bc16-b0781fcb8211 Kubernetes Low Observability When using the kubelet command, the '--event-qps' should be set to 0 Documentation CronJob Deadline Not Configured192fe40b-b1c3-448a-aba2-6cc19a300fe3 Kubernetes Low Resource Management Cronjobs must have a configured deadline, which means the attribute 'startingDeadlineSeconds' must be defined Documentation Container CPU Requests Not Equal To It's Limits9d43040e-e703-4e16-8bfe-8d4da10fa7e6 Kubernetes Low Resource Management A Pod's Containers must have the same CPU requests as limits set, which is recommended to avoid resource DDOS of the node during spikes. This means the 'requests.cpu' must equal 'limits.cpu', and both be defined. Documentation Container Requests Not Equal To It's Limitsaee3c7d2-a811-4201-90c7-11c028be9a46 Kubernetes Low Resource Management Containers must have the same resource requests set as limits. This is recommended to avoid resource DDoS of the node during spikes and means that 'requests.memory' and 'requests.cpu' must equal 'limits.memory' and 'limits.cpu', respectively Documentation StatefulSet Has No PodAntiAffinityd740d048-8ed3-49d3-b77b-6f072f3b669e Kubernetes Low Resource Management Check if StatefulSet resources don't have a podAntiAffinity policy, which prevents multiple pods from being scheduled on the same node. Documentation Deployment Has No PodAntiAffinitya31b7b82-d994-48c4-bd21-3bab6c31827a Kubernetes Low Resource Management Check if Deployment resources don't have a podAntiAffinity policy, which prevents multiple pods from being scheduled on the same node. Documentation Container Memory Requests Not Equal To It's Limitsaafa7d94-62de-4fbf-8838-b69ee217b0e6 Kubernetes Low Resource Management A Pod's Containers must have the same Memory requests as limits set, which is recommended to avoid resource DDOS of the node during spikes. This means the 'requests.memory' must equal 'limits.memory', and both be defined. Documentation Secrets As Environment Variables3d658f8b-d988-41a0-a841-40043121de1e Kubernetes Low Secret Management Container should not use secrets as environment variables Documentation Invalid Image Tag583053b7-e632-46f0-b989-f81ff8045385 Kubernetes Low Supply-Chain Image tag must be defined and not be empty or equal to latest. Documentation Ensure Administrative Boundaries Between Resourcese84eaf4d-2f45-47b2-abe8-e581b06deb66 Kubernetes Info Access Control As a best practice, ensure that is made the correct use of namespaces to adequately administer your resources. Kubernetes Authorization plugins can also be used to create policies that segregate user access to namespaces. Documentation Using Kubernetes Native Secret Managementb9c83569-459b-4110-8f79-6305aa33cb37 Kubernetes Info Secret Management Kubernetes External Secret Storage and Management System usage should be considered if you have more complex secret management needs, rather than using Kubernetes Secrets directly. Additionally, ensure that access to secrets is carefully limited Documentation BOM - GCP PD268c65a8-58ad-43e4-9019-1a9bbc56749f GoogleDeploymentManager Trace Bill Of Materials A list of Persistent Disk resources found. Persistent Disk is Google's local durable storage service, fully integrated with Google Cloud products, Compute Engine and Google Kubernetes Engine. Documentation BOM - GCP PST9ed08714-b2f3-4c6d-8fb0-ac0b74ad71d8 GoogleDeploymentManager Trace Bill Of Materials A list of Pub/Sub Topic resources found. Cloud Pub/Sub is designed to provide reliable, many-to-many, asynchronous messaging between applications. Publisher applications can send messages to a 'topic' and other applications can subscribe to that topic to receive the messages. Documentation BOM - GCP SBc7781feb-a955-4f9f-b9cf-0d7c6f54bb59 GoogleDeploymentManager Trace Bill Of Materials A list of Storage Bucket resources found. Buckets are the basic containers that hold your data. Everything that you store in Cloud Storage must be contained in a bucket. Documentation Cloud Storage Anonymous or Publicly Accessible63ae3638-a38c-4ff4-b616-6e1f72a31a6a GoogleDeploymentManager High Access Control Cloud Storage Buckets must not be anonymously or publicly accessible, which means the subattribute 'entity' from attributes 'acl' and 'defaultObjectAcl' must not be 'allUsers' or 'allAuthenticatedUsers' Documentation BigQuery Dataset Is Public83103dff-d57f-42a8-bd81-40abab64c1a7 GoogleDeploymentManager High Access Control BigQuery dataset is anonymously or publicly accessible. Attribute access.specialGroup should not contain 'allAuthenticatedUsers' Documentation Cloud Storage Bucket Is Publicly Accessible77c1fa3f-83dc-4c9d-bfed-e1d0cc8fd9dc GoogleDeploymentManager High Access Control Cloud Storage Bucket is anonymously or publicly accessible Documentation SQL DB Instance Backup Disableda5bf1a1c-92c7-401c-b4c6-ebdc8b686c01 GoogleDeploymentManager High Backup Checks if backup configuration is enabled for all Cloud SQL Database instances Documentation DNSSEC Using RSASHA16d7b121a-a2ed-4e37-bd2f-80d9df1dfd35 GoogleDeploymentManager High Encryption DNSSEC should not use the RSASHA1 algorithm Documentation SQL DB Instance With SSL Disabled660360d3-9ca7-46d1-b147-3acc4002953f GoogleDeploymentManager High Encryption Cloud SQL Database Instance should have SLL enabled Documentation Cluster Labels Disabled8810968b-4b15-421d-918b-d91eb4bb8d1d GoogleDeploymentManager High Insecure Configurations Kubernetes Clusters must be configured with labels, which means the attribute 'resourceLabels' must be defined Documentation Cluster Master Authentication Disabled7ef7d141-9fbb-4679-a977-fd0883436906 GoogleDeploymentManager High Insecure Configurations Kubernetes Engine Clusters must have Master Authentication set to enabled, which means the attribute 'masterAuth' must have the subattributes 'username' and 'password' defined and not empty Documentation IP Aliasing Disabled28727987-e398-49b8-aef1-8a3e7789d111 GoogleDeploymentManager High Insecure Configurations Kubernetes Clusters must be created with Alias IP ranges enabled, which means the attribute 'ipAllocationPolicy' must be defined and the subattribute 'useIpAliases' must be set to 'true'. Documentation Not Proper Email Account In Usea21b8df3-c840-4b3d-a41a-10fb2afda171 GoogleDeploymentManager High Insecure Configurations Gmail accounts are being used instead of corporate credentials Documentation MySQL Instance With Local Infile Onc759d6f2-4dd3-4160-82d3-89202ef10d87 GoogleDeploymentManager High Insecure Configurations MySQL Instance should not have Local Infile On Documentation Network Policy Disabledc47f90e8-4a19-43f0-8413-cc434d286c4e GoogleDeploymentManager High Insecure Configurations Kubernetes Engine Clusters must have Network Policy enabled, meaning that the attribute 'networkPolicy.enabled' must be true and the attribute 'addonsConfig.networkPolicyConfig.disabled' must be false Documentation Private Cluster Disabled48c61fbd-09c9-46cc-a521-012e0c325412 GoogleDeploymentManager High Insecure Configurations Kubernetes Clusters must be created with Private Clusters enabled, meaning the 'privateClusterConfig' must be defined and the attributes 'enablePrivateEndpoint' and 'enablePrivateNodes' must be true. Documentation GKE Legacy Authorization Enableddf58d46c-783b-43e0-bdd0-d99164f712ee GoogleDeploymentManager High Insecure Configurations Kubernetes Engine Clusters must have Legacy Authorization set to disabled, which means the attribute 'legacyAbac.enabled' must be false. Documentation Client Certificate Disableddd690686-2bf9-4012-a821-f61912dd77be GoogleDeploymentManager High Insecure Configurations Kubernetes Clusters must be created with Client Certificate enabled, which means 'masterAuth' must have 'clientCertificateConfig' with the attribute 'issueClientCertificate' equal to true Documentation GKE Master Authorized Networks Disabled62c8cf50-87f0-4295-a974-8184ed78fe02 GoogleDeploymentManager High Networking and Firewall Master authorized networks must be enabled in GKE clusters Documentation Compute Instance Is Publicly Accessible8212e2d7-e683-49bc-bf78-d6799075c5a7 GoogleDeploymentManager High Networking and Firewall Compute instances shouldn't be accessible from the Internet. Documentation Stackdriver Monitoring Disabledbbfc97ab-e92a-4a7b-954c-e88cec815011 GoogleDeploymentManager High Observability Kubernetes Engine Clusters must have Stackdriver Monitoring enabled, which means the attribute 'monitoringService' must be defined and different than 'none' Documentation Stackdriver Logging Disabled95601b9a-7fe8-4aee-9b58-d36fd9382dfc GoogleDeploymentManager High Observability Kubernetes Engine Clusters must have Stackdriver Logging enabled, which means the attribute 'loggingService' must be defined and different from 'none' Documentation Cloud Storage Bucket Versioning Disabledad0875c1-0b39-4890-9149-173158ba3bba GoogleDeploymentManager High Observability Cloud Storage Bucket should have versioning enabled Documentation Node Auto Upgrade Disableddc5c5fee-6c53-43b0-ab11-4c660e064aaf GoogleDeploymentManager High Resource Management Kubernetes nodes must have auto upgrades set to true, which means the attribute 'nodePools' must be defined and the subattribute 'managment' must be defined and have the attribute 'autoUpgrade' set to true Documentation Disk Encryption Disabledfc040fb6-4c23-4c0d-b12a-39edac35debb GoogleDeploymentManager Medium Encryption VM disks for critical VMs must be encrypted with Customer Supplied Encryption Keys (CSEK) or with Customer-managed encryption keys (CMEK), which means the attribute 'diskEncryptionKey' must be defined and its sub attributes 'rawKey' or 'kmsKeyName' must also be defined Documentation Cloud DNS Without DNSSEC313d6deb-3b67-4948-b41d-35b699c2492e GoogleDeploymentManager Medium Insecure Configurations DNSSEC must be enabled for Cloud DNS Documentation OSLogin Is Disabled In VM Instancee66e1b71-c810-4b4e-a737-0ab59e7f5e41 GoogleDeploymentManager Medium Insecure Configurations VM instance should have OSLogin enabled Documentation COS Node Image Not Useddbe058d7-b82e-430b-8426-992b2e4677e7 GoogleDeploymentManager Medium Insecure Configurations The node image should be Container-Optimized OS(COS) Documentation Google Storage Bucket Level Access Disabled1239f54b-33de-482a-8132-faebe288e6a6 GoogleDeploymentManager Medium Insecure Configurations Google Storage Bucket Level Access should be enabled Documentation Shielded VM Disabled9038b526-4c19-4928-bca2-c03d503bdb79 GoogleDeploymentManager Medium Insecure Configurations Compute instances must be launched with Shielded VM enabled, which means the attribute 'shieldedInstanceConfig' must be defined and its sub attributes 'enableSecureBoot', 'enableVtpm' and 'enableIntegrityMonitoring' must be set to true Documentation SSH Access Is Not Restricteddee21308-2a7a-49de-8ff7-c9b87e188575 GoogleDeploymentManager Medium Networking and Firewall Google Firewall should not allow SSH access (port 22) from the Internet (public CIDR block) to ensure the principle of least privileges Documentation RDP Access Is Not Restricted50cb6c3b-c878-4b88-b50e-d1421bada9e8 GoogleDeploymentManager Medium Networking and Firewall Check if the Google compute firewall allows unrestricted RDP access. Allowed ports should not contain RDP port 3389 Documentation IP Forwarding Enabled7c98538a-81c6-444b-bf04-e60bc3ceeec0 GoogleDeploymentManager Medium Networking and Firewall Instances must not have IP forwarding enabled, which means the attribute 'canIpForward' must not be true Documentation Bucket Without Versioning227c2f58-70c6-4432-8e9a-a89c1a548cf5 GoogleDeploymentManager Medium Observability Bucket should have versioning enabled Documentation Project-wide SSH Keys Are Enabled In VM Instances6e2b1ec1-1eca-4eb7-9d4d-2882680b4811 GoogleDeploymentManager Medium Secret Management VM Instance should block project-wide SSH keys Documentation Volume Has Sensitive Host Directory1c1325ff-831d-43a1-973e-839ae57dfcc0 DockerCompose High Build Process Container has sensitive host directory mounted as a volume Documentation Volume Mounted In Multiple Containersbaa452f0-1f21-4a25-ace5-844e7a5f410d DockerCompose High Build Process Volume mounts should not be shared, which means that 'propagation' should not be set to 'shared', 'rshared', 'slave', or 'rslave' Documentation Docker Socket Mounted In Containerd6355c88-1e8d-49e9-b2f2-f8a1ca12c75b DockerCompose High Build Process Docker socket docker.sock should not be mounted on host. If the docker socket is mounted, it can allow its processes to execute docker commands. Documentation No New Privileges Not Set27fcc7d6-c49b-46e0-98f1-6c082a6a2750 DockerCompose High Resource Management Ensuring the process does not gain any new privileges lessens the risk associated with many operations. Documentation Privileged Containers Enabledae5b6871-7f45-42e0-bb4c-ab300c4d2026 DockerCompose High Resource Management Privileged containers should be used with extreme caution, they have all of the capabilities that the linux kernel offers for docker. Documentation Healthcheck Not Set698ed579-b239-4f8f-a388-baa4bcb13ef8 DockerCompose Medium Availability Check containers periodically to see if they are running properly. Documentation Restart Policy On Failure Not Set To 52fc99041-ddad-49d5-853f-e35e70a48391 DockerCompose Medium Build Process Attribute 'restart:on-failure' should be set to 5. Restart policies in general should be used, and 5 retries is the recommended by CIS. Documentation Cgroup Not Default4d9f44c6-2f4a-4317-9bb5-267adbea0232 DockerCompose Medium Build Process Control groups restrict the access processes and containers have to system resources such as CPU, RAM, IOPS and network. Not having a cgroup well configured may prove to be a security fault. Documentation Privileged Ports Mapped In Containerbc2908f3-f73c-40a9-8793-c1b7d5544f79 DockerCompose Medium Networking and Firewall Privileged ports (1 to 1023) should not be mapped. Also you should drop net_bind_service linux capability from the container unless you absolutely need to use priviledged ports. Documentation Networks Not Setce14a68b-1668-41a0-ab7d-facd9f784742 DockerCompose Medium Networking and Firewall Setting networks in services ensures you are not using dockers default bridge (docker0), which shares traffic bewteen all containers. Documentation Container Traffic Not Bound To Host Interface451d79dc-0588-476a-ad03-3c7f0320abb3 DockerCompose Medium Networking and Firewall Incoming container traffic should be bound to a specific host interface Documentation Security Opt Not Set610e266e-6c12-4bca-9925-1ed0cd29742b DockerCompose Medium Resource Management Attribute 'security_opt' should be defined. Documentation Shared Host User Namespace8af7162d-6c98-482f-868e-0d33fb675ca8 DockerCompose Medium Resource Management The host's user namespace should not be shared. Documentation Host Namespace is Shared4f31dd9f-2cc3-4751-9b53-67e4af83dac0 DockerCompose Medium Resource Management The hosts process namespace should not be shared by containers Documentation Shared Host Network Namespace071a71ff-f868-47a4-ac0b-3c59e4ab5443 DockerCompose Medium Resource Management Container should not share the host network namespace Documentation Memory Not Limitedbb9ac4f7-e13b-423d-a010-c74a1bfbe492 DockerCompose Medium Resource Management Memory limits should be defined for each container. This prevents potential resource exhaustion by ensuring that containers consume not more than the designated amount of memory Documentation Shared Host IPC Namespacebaa3890f-bed7-46f5-ab8f-1da8fc91c729 DockerCompose Medium Resource Management Container should not share the host IPC namespace Documentation Default Seccomp Profile Disabled404fde2c-bc4b-4371-9747-7054132ac953 DockerCompose Medium Resource Management Seccomp offers a whitelist of common system calls, blocking all others. Having less kernel exposed to an app then increases security. Documentation Pids Limit Not Set221e0658-cb2a-44e3-b08a-db96a341d6fa DockerCompose Medium Resource Management 'pids_limit' should be set and different than -1 Documentation Container Capabilities Unrestrictedce76b7d0-9e77-464d-b86f-c5c48e03e22d DockerCompose Low Resource Management Some capabilities are not needed in certain (or any) containers. Make sure that you only add capabilities that your container needs. Drop unnecessary capabilities as well. Documentation Cpus Not Limited6b610c50-99fb-4ef0-a5f3-e312fd945bc3 DockerCompose Low Resource Management CPU limits should be set because if the system has CPU time free, a container is guaranteed to be allocated as much CPU as it requests Documentation"},{"location":"queries/ansible-queries/","title":"Ansible","text":""},{"location":"queries/ansible-queries/#ansible_queries_list","title":"Ansible Queries List","text":"<p>This page contains all queries from Ansible.</p>"},{"location":"queries/ansible-queries/#aws","title":"AWS","text":"<p>Bellow are listed queries related with Ansible AWS:</p> Query Severity Category Description Help S3 Bucket Allows List Action From All Principalsd395a950-12ce-4314-a742-ac5a785ab44e High Access Control S3 Buckets must not allow List Action From All Principals, as to prevent leaking private information to the entire internet or allow unauthorized data tampering / deletion. This means the 'Effect' must not be 'Allow' when the 'Action' is List, for all Principals. Documentation S3 Bucket With All Permissions6a6d7e56-c913-4549-b5c5-5221e624d2ec High Access Control S3 Buckets should not have all permissions, as to prevent leaking private information to the entire internet or allow unauthorized data tampering / deletion. This means the 'Effect' must not be 'Allow' when the 'Action' is '*', for all Principals. Documentation S3 Bucket Access to Any Principal3ab1f27d-52cc-4943-af1d-43c1939e739a High Access Control Checks if the S3 bucket is accessible for all users Documentation S3 Bucket ACL Allows Read to Any Authenticated User75480b31-f349-4b9a-861f-bce19588e674 High Access Control S3 Buckets should not be readable to any authenticated user Documentation S3 Bucket Allows Put Action From All Principalsa0f1bfe0-741e-473f-b3b2-13e66f856fab High Access Control S3 Buckets must not allow Put Action From All Principals, as to prevent leaking private information to the entire internet or allow unauthorized data tampering / deletion. This means the 'Effect' must not be 'Allow' when the 'Action' is Put, for all Principals. Documentation IAM Policies With Full Privilegese401d614-8026-4f4b-9af9-75d1197461ba High Access Control IAM policies shouldn't allow full administrative privileges (for all resources) Documentation SNS Topic is Publicly Accessible905f4741-f965-45c1-98db-f7a00a0e5c73 High Access Control SNS Topic Policy should not allow any principal to access Documentation IAM Policy Grants Full Permissionsb5ed026d-a772-4f07-97f9-664ba0b116f8 High Access Control IAM policy should not grant full permissions to resources from the get-go, instead of granting permissions gradually as necessary. Documentation Authentication Without MFAeee107f9-b3d8-45d3-b9c6-43b5a7263ce1 High Access Control Users should authenticate with MFA (Multi-factor Authentication) to ensure an extra layer of protection when authenticating Documentation SQS Queue Exposed86b0efa7-4901-4edd-a37a-c034bec6645a High Access Control Checks if the SQS Queue is exposed Documentation S3 Bucket Allows Get Action From All Principals53bce6a8-5492-4b1b-81cf-664385f0c4bf High Access Control S3 Buckets must not allow Get Action From All Principals, as to prevent leaking private information to the entire internet or allow unauthorized data tampering / deletion. This means the 'Effect' must not be 'Allow' when the 'Action' is Get, for all Principals. Documentation ECS Service Admin Role Is Present7db727c1-1720-468e-b80e-06697f71e09e High Access Control ECS Services must not have Admin roles, which means the attribute 'role' must not be an admin role Documentation S3 Bucket ACL Allows Read to All Usersa1ef9d2e-4163-40cb-bd92-04f0d602a15d High Access Control S3 Buckets should not be readable to all users Documentation S3 Bucket Allows Delete Action From All Principals6fa44721-ef21-41c6-8665-330d59461163 High Access Control S3 Buckets must not allow Delete Action From All Principals, as to prevent leaking private information to the entire internet or allow unauthorized data tampering / deletion. This means the 'Effect' must not be 'Allow' when the 'Action' is Delete, for all Principals. Documentation S3 Bucket SSE Disabled309edc5b-5a59-42b4-a357-d4d098311fd4 High Encryption If algorithm is AES256 then the master key is null, empty or undefined, otherwise the master key is required Documentation ELB Using Insecure Protocols730a5951-2760-407a-b032-dd629b55c23a High Encryption ELB Predefined or Custom Security Policies must not use insecure protocols, to reduce the risk of the SSL connection between the client and the load balancer being exploited. That means the 'SslPolicy' of 'listeners' must not coincide with any of a predefined list of insecure protocols. Documentation User Data Contains Encoded Private Keyc09f4d3e-27d2-4d46-9453-abbe9687a64e High Encryption User Data should not contain a base64 encoded private key. If so, anyone can decode the private key easily Documentation Redshift Not Encrypted6a647814-def5-4b85-88f5-897c19f509cd High Encryption AWS Redshift Cluster should be encrypted. Check if 'encrypted' field is false or undefined (default is false) Documentation EFS Without KMSbd77554e-f138-40c5-91b2-2a09f878608e High Encryption Amazon Elastic Filesystem should have filesystem encryption enabled using KMS CMK customer-managed keys instead of AWS managed-keys Documentation Cloudfront Viewer Protocol Policy Allows HTTPa6d27cf7-61dc-4bde-ae08-3b353b609f76 High Encryption Checks if the connection between CloudFront and the viewer is encrypted Documentation Secure Ciphers Disabled218413a0-c716-4b94-9e08-0bb70d854709 High Encryption Check if secure ciphers aren't used in CloudFront Documentation Launch Configuration Is Not Encrypted66477506-6abb-49ed-803d-3fa174cd5f6a High Encryption Launch Configurations should have the data in the volumes encrypted. To encrypt the data, the 'encrypted' parameter should be set to true in each volume Documentation DB Instance Storage Not Encrypted7dfb316c-a6c2-454d-b8a2-97f147b0c0ff High Encryption AWS DB Instance should have its storage encrypted by setting the parameter to 'true'. The storage_encrypted default value is 'false'. Documentation Kinesis Not Encrypted With KMSf2ea6481-1d31-4d40-946a-520dc6321dd7 High Encryption AWS Kinesis Streams and metadata should be protected with KMS Documentation ELB Using Weak Ciphers2034fb37-bc23-4ca0-8d95-2b9f15829ab5 High Encryption ELB Predefined or Custom Security Policies must not use weak ciphers, to reduce the risk of the SSL connection between the client and the load balancer being exploited. That means the 'SslPolicy' of 'listeners' must not coincide with any of a predefined list of weak ciphers. Documentation IAM Database Auth Not Enabled0ed012a4-9199-43d2-b9e4-9bd049a48aa4 High Encryption IAM Database Auth Enabled should be configured to true when using compatible engine and version Documentation User Data Shell Script Is Encoded1e2341ba-a5cf-4f0a-a5f6-47e90c68ea89 High Encryption User Data Shell Script must be encoded Documentation CA Certificate Identifier Is Outdated5eccd62d-8b4d-46d3-83ea-1879f3cbd3ce High Encryption The CA certificate Identifier must be 'rds-ca-2019'. Documentation Redis Not Compliant9f34885e-c08f-4d13-a7d1-cf190c5bd268 High Encryption Check if the redis version is compliant with the necessary AWS PCI DSS requirements Documentation ECS Task Definition Container With Plaintext Password7fdc2bf3-6bc0-4cb3-84c5-cfd041c0f892 High Encryption It's not recommended to use plaintext environment variables for sensitive information, such as credential data. Documentation AMI Not Encrypted97707503-a22c-4cd7-b7c0-f088fa7cf830 High Encryption AWS AMI Encryption is not enabled Documentation S3 Bucket Without Server-side-encryption594f54e7-f744-45ab-93e4-c6dbaf6cd571 High Encryption AWS S3 Storage should be protected with SSE (Server-Side Encryption) Documentation EFS Not Encrypted727c4fd4-d604-4df6-a179-7713d3c85e20 High Encryption Elastic File System (EFS) must be encrypted Documentation CloudFront Without Minimum Protocol TLS 1.2d0c13053-d2c8-44a6-95da-d592996e9e67 High Insecure Configurations CloudFront Minimum Protocol version should be at least TLS 1.2 Documentation EC2 Group Has Public Interface5330b503-3319-44ff-9b1c-00ee873f728a High Insecure Configurations The CIDR IP should not be a public interface Documentation Redshift Publicly Accessible5c6b727b-1382-4629-8ba9-abd1365e5610 High Insecure Configurations AWS Redshift Clusters must not be publicly accessible. Check if 'publicly_accessible' field is true (default is false) Documentation DB Instance Publicly Accessiblec09e3ca5-f08a-4717-9c87-3919c5e6d209 High Insecure Configurations RDS must not be defined with public interface, which means the field 'publicly_accessible' should not be set to 'true' (default is 'false'). Documentation S3 Bucket with Unsecured CORS Rule3505094c-f77c-4ba0-95da-f83db712f86c High Insecure Configurations If the CORS (Cross-Origin Resource Sharing) rule is defined in an S3 bucket, it should be secure Documentation ECS Task Definition Network Mode Not Recommended01aec7c2-3e4d-4274-ae47-2b8fea22fd1f High Insecure Configurations Network_Mode should be 'awsvpc' in ecs_task_definition. AWS VPCs provides the controls to facilitate a formal process for approving and testing all network connections and changes to the firewall and router configurations Documentation Root Account Has Active Access Keyse71d0bc7-d9e8-4e6e-ae90-0a4206db6f40 High Insecure Configurations The AWS Root Account must not have active access keys associated, which means if there are access keys associated to the Root Account, they must be inactive. Documentation KMS Key With Vulnerable Policy5b9d237a-57d5-4177-be0e-71434b0fef47 High Insecure Configurations Checks if the policy is vulnerable and needs updating. Documentation Batch Job Definition With Privileged Container Propertiesdefe5b18-978d-4722-9325-4d1975d3699f High Insecure Configurations Batch Job Definition should not have Privileged Container Properties Documentation Vulnerable Default SSL Certificatefb8f8929-afeb-4c46-99f0-a6cf410f7df4 High Insecure Defaults CloudFront web distributions should use custom (and not default) SSL certificates. Custom SSL certificates allow only defined users to access content by using an alternate domain name instead of the default one. Documentation Public Port Wide71ea648a-d31a-4b5a-a589-5674243f1c33 High Networking and Firewall AWS Security Group should not have public port wide Documentation Unknown Port Exposed To Internet722b0f24-5a64-4cca-aa96-cfc26b7e3a5b High Networking and Firewall AWS Security Group should not have an unknown port exposed to the entire Internet Documentation ALB Listening on HTTPf81d63d2-c5d7-43a4-a5b5-66717a41c895 High Networking and Firewall AWS Application Load Balancer (alb) should not listen on HTTP Documentation HTTP Port Open To Interneta14ad534-acbe-4a8e-9404-2f7e1045646e High Networking and Firewall The HTTP port is open to the internet in a Security Group Documentation DB Security Group Open To Large Scopeea0ed1c7-9aef-4464-b7c7-94c762da3640 High Networking and Firewall The IP address in a DB Security Group must not have more than 256 hosts. Documentation Security Group With Unrestricted Access To SSH57ced4b9-6ba4-487b-8843-b65562b90c77 High Networking and Firewall 'SSH' (TCP:22) should not be public in AWS Security Group Documentation DB Security Group With Public Scope0956aedf-6a7a-478b-ab56-63e2b19923ad High Networking and Firewall The IP address in a DB Security Group should not be '0.0.0.0/0' (IPv4) or '::/0' (IPv6). If so, any IP can access it Documentation Unrestricted Security Group Ingress83c5fa4c-e098-48fc-84ee-0a537287ddd2 High Networking and Firewall Security groups allow ingress from 0.0.0.0/0 Documentation RDS Associated with Public Subnet16732649-4ff6-4cd2-8746-e72c13fae4b8 High Networking and Firewall RDS should not run in public subnet Documentation EC2 Instance Has Public IPa8b0c58b-cd25-4b53-9ad0-55bca0be0bc1 High Networking and Firewall EC2 Instance should not have a public IP address. Documentation Default Security Groups With Unrestricted Traffic8010e17a-00e9-4635-a692-90d6bcec68bd High Networking and Firewall Check if default security group does not restrict all inbound and outbound traffic. Documentation Remote Desktop Port Open To Interneteda7301d-1f3e-47cf-8d4e-976debc64341 High Networking and Firewall The Remote Desktop port is open to the internet in a Security Group Documentation Security Group Ingress Not Restrictedea6bc7a6-d696-4dcf-a788-17fa03c17c81 High Networking and Firewall AWS Security Group should restrict ingress access Documentation Route53 Record Undefined445dce51-7e53-4e50-80ef-7f94f14169e4 High Networking and Firewall Route53 Record should have a list of records Documentation CMK Rotation Disabledaf96d737-0818-4162-8c41-40d969bd65d1 High Observability Customer Master Keys (CMK) must have rotation enabled, which means the attribute 'enable_key_rotation' must be set to 'true' when the key is enabled. Documentation CloudTrail Logging Disabledd4a73c49-cbaa-4c6f-80ee-d6ef5a3a26f5 High Observability Checks if logging is enabled for CloudTrail. Documentation Cross-Account IAM Assume Role Policy Without ExternalId or MFAaf167837-9636-4086-b815-c239186b9dda Medium Access Control Cross-Account IAM Assume Role Policy should require external ID or MFA to protect cross-account access Documentation ECR Repository Is Publicly Accessiblefb5a5df7-6d74-4243-ab82-ff779a958bfd Medium Access Control Amazon ECR image repositories shouldn't have public access Documentation S3 Bucket With Public Accessc3e073c1-f65e-4d18-bd67-4a8f20ad1ab9 Medium Access Control S3 Bucket allows public access Documentation Public Lambda via API Gateway5e92d816-2177-4083-85b4-f61b4f7176d9 Medium Access Control Allowing to run lambda function using public API Gateway Documentation IAM Access Key Is Exposed7f79f858-fbe8-4186-8a2c-dfd0d958a40f Medium Access Control Check if IAM Access Key is active for some user besides 'root' Documentation Certificate Has Expired5a443297-19d4-4381-9e5b-24faf947ec22 Medium Access Control Expired SSL/TLS certificates should be removed Documentation API Gateway Without Configured Authorizerb16cdb37-ce15-4ab2-8401-d42b05d123fc Medium Access Control API Gateway REST API should have an API Gateway Authorizer Documentation SES Policy With Allowed IAM Actions8ed0bfce-f780-46d4-b086-21c3628f09ad Medium Access Control SES policy should not allow IAM actions to all principals Documentation Lambda Permission Principal Is Wildcard1d972c56-8ec2-48c1-a578-887adb09c57a Medium Access Control Lambda Permission Principal should not contain a wildcard. Documentation IAM Policies Attached To Usereafe4bc3-1042-4f88-b988-1939e64bf060 Medium Access Control IAM policies should be attached only to groups or roles Documentation SQS Policy With Public Accessd994585f-defb-4b51-b6d2-c70f020ceb10 Medium Access Control Checks for dangerous permissions in Action statements in an SQS Queue Policy. This is deemed a potential security risk as it would allow various attacks to the queue Documentation AMI Shared With Multiple Accountsa19b2942-142e-4e2b-93b7-6cf6a6c8d90f Medium Access Control Limits access to AWS AMIs by checking if more than one account is using the same image Documentation SQS Policy Allows All Actionsed9b3beb-92cf-44d9-a9d2-171eeba569d4 Medium Access Control SQS policy allows ALL (*) actions Documentation Auto Scaling Group With No Associated ELB050f085f-a8db-4072-9010-2cca235cc02f Medium Availability AWS Auto Scaling Groups must have associated ELBs to ensure high availability and improve application performance. This means the attribute 'load_balancers' must be defined and not empty. Documentation ECS Service Without Running Tasksf5c45127-1d28-4b49-a692-0b97da1c3a84 Medium Availability ECS Service should have at least 1 task running Documentation CMK Is Unusable133fee21-37ef-45df-a563-4d07edc169f4 Medium Availability AWS Key Management Service (KMS) must only possess usable Customer Master Keys (CMK), which means the CMKs must have the attribute 'enabled' set to true and the attribute 'pending_window' must be undefined. Documentation RDS With Backup Disablede69890e6-fce5-461d-98ad-cb98318dfc96 Medium Backup Make sure the AWS RDS configuration has automatic backup configured. If the retention period is equal to 0 there is no backup Documentation Stack Retention Disabled17d5ba1d-7667-4729-b1a6-b11fde3db7f7 Medium Backup Make sure that retain_stack is enabled to keep the Stack and it's associated resources during resource destruction Documentation IAM Password Without Uppercase Letter83957b81-39c1-4191-8e12-671d2ce14354 Medium Best Practices IAM password should have at least one uppercase letter Documentation Misconfigured Password Policy Expiration3f2cf811-88fa-4eda-be45-7a191a18aba9 Medium Best Practices No password expiration policy Documentation Password Without Reuse Prevention6f5f5444-1422-495f-81ef-24cefd61ed2c Medium Best Practices Password policy <code>password_reuse_prevention</code> doesn't exist or is equal to 0 Documentation IAM Password Without Lowercase Letter8e3063f4-b511-45c3-b030-f3b0c9131951 Medium Best Practices IAM Password should have at least one lowercase letter Documentation IAM Password Without Number9cf25d62-0b96-42c8-b66d-998cd6ee5bb8 Medium Best Practices IAM user resource Login Profile Password should have at least one number Documentation IAM Password Without Minimum Length8bc2168c-1723-4eeb-a6f3-a1ba614b9a6d Medium Best Practices IAM password should have the required minimum length Documentation Stack Without Template32d31f1f-0f83-4721-b7ec-1e6948c60145 Medium Build Process AWS CloudFormation should have a template defined through the attribute template, template_url or attribute template_body Documentation CodeBuild Not Encrypteda1423864-2fbc-4f46-bfe1-fbbf125c71c9 Medium Encryption CodeBuild Project should be encrypted Documentation Config Rule For Encrypted Volumes Disabled7674a686-e4b1-4a95-83d4-1fd53c623d84 Medium Encryption Check if AWS config rules do not identify Encrypted Volumes as a source. Documentation EBS Volume Encryption Disabled4b6012e7-7176-46e4-8108-e441785eae57 Medium Encryption EBS volumes should be encrypted Documentation SQS With SSE Disablede1e7b278-2a8b-49bd-a26e-66a7f70b17eb Medium Encryption Amazon Simple Queue Service (SQS) queue should protect the contents of their messages using Server-Side Encryption (SSE) Documentation Memcached Disabled2d55ef88-b616-4890-b822-47f280763e89 Medium Encryption Check if the Memcached is disabled on the ElastiCache Documentation ECR Image Tag Not Immutable60bfbb8a-c72f-467f-a6dd-a46b7d612789 Medium Insecure Configurations ECR should have an image tag be immutable. This prevents image tags from being overwritten. Documentation Instance With No VPC61d1a2d0-4db8-405a-913d-5d2ce49dff6f Medium Insecure Configurations EC2 Instances should be configured under a VPC network. AWS VPCs provide the controls to facilitate a formal process for approving and testing all network connections and changes to the firewall and router configurations. Documentation AWS Password Policy With Unchangeable Passwordse28ceb92-d588-4166-aac5-766c8f5b7472 Medium Insecure Configurations Unchangeable passwords in AWS password policy Documentation Certificate RSA Key Bytes Lower Than 256d5ec2080-340a-4259-b885-f833c4ea6a31 Medium Insecure Configurations The certificate should use a RSA key with a length equal to or higher than 256 bytes Documentation API Gateway Without SSL Certificateb47b98ab-e481-4a82-8bb1-1ab39fd36e33 Medium Insecure Configurations SSL Client Certificate should be enabled Documentation Lambda Function Without Tags265d9725-2fb8-42a2-bc57-3279c5db82d5 Medium Insecure Configurations AWS Lambda Functions must have associated tags. Documentation SQL Analysis Services Port 2383 (TCP) Is Publicly Accessible7af1c447-c014-4f05-bd8b-ebe3a15734ac Medium Networking and Firewall Check if port 2383 on TCP is publicly accessible by checking the CIDR block range that can access it. Documentation API Gateway without WAFf5f38943-664b-4acc-ab11-f292fa10ed0b Medium Networking and Firewall API Gateway should have WAF (Web Application Firewall) enabled Documentation API Gateway Endpoint Config is Not Private559439b2-3e9c-4739-ac46-17e3b24ec215 Medium Networking and Firewall The API Endpoint type in API Gateway should be set to PRIVATE so it's not exposed to the public internet Documentation API Gateway With CloudWatch Logging Disabled72a931c2-12f5-40d1-93cc-47bff2f7aa2a Medium Observability AWS CloudWatch Logs for APIs is not enabled Documentation Stack Notifications Disabledd39761d7-94ab-45b0-ab5e-27c44e381d58 Medium Observability AWS CloudFormation should have stack notifications enabled to be notified when an event occurs Documentation API Gateway X-Ray Disabled2059155b-27fd-441e-b616-6966c468561f Medium Observability API Gateway should have X-Ray Tracing enabled Documentation CloudTrail Not Integrated With CloudWatchebb2118a-03bc-4d53-ab43-d8750f5cb8d3 Medium Observability CloudTrail should be integrated with CloudWatch Documentation Configuration Aggregator to All Regions Disableda2fdf451-89dd-451e-af92-bf6c0f4bab96 Medium Observability AWS Config Configuration Aggregator All Regions must be set to True Documentation S3 Bucket Logging Disabledc3b9f7b0-f5a0-49ec-9cbc-f1e346b7274d Medium Observability Server Access Logging should be enabled on S3 Buckets so that all changes are logged and trackable Documentation S3 Bucket Without Versioning9232306a-f839-40aa-b3ef-b352001da9a5 Medium Observability S3 bucket should have versioning enabled Documentation CloudTrail Multi Region Disabled6ad087d7-a509-4b20-b853-9ef6f5ebaa98 Medium Observability CloudTrail multi region should be enabled, which means attribute 'is_multi_region_trail' should be set to true Documentation CloudFront Logging Disabledd31cb911-bf5b-4eb6-9fc3-16780c77c7bd Medium Observability AWS CloudFront distributions should have logging enabled to collect all viewer requests, which means the attribute 'logging' should be defined with 'enabled' set to true Documentation CloudWatch Without Retention Period Specifiede24e18d9-4c2b-4649-b3d0-18c088145e24 Medium Observability AWS CloudWatch should have CloudWatch Logs enabled in order to monitor, store, and access log events Documentation CloudTrail SNS Topic Name Undefined5ba316a9-c466-4ec1-8d5b-bc6107dc9a92 Medium Observability Check if SNS topic name is set for CloudTrail Documentation No Stack Policyffe0fd52-7a8b-4a5c-8fc7-49844418e6c9 Medium Resource Management AWS CloudFormation Stack should have a stack policy in order to protect stack resources from update actions Documentation Hardcoded AWS Access Key In Lambdaf34508b9-f574-4330-b42d-88c44cced645 Medium Secret Management Lambda access/secret keys should not be hardcoded Documentation Hardcoded AWS Access Keyc2f15af3-66a0-4176-a56e-e4711e502e5c Medium Secret Management AWS Access Key should not be hardcoded Documentation IAM Group Without Usersf509931b-bbb0-443c-bd9b-10e92ecf2193 Low Access Control IAM Group should have at least one user associated Documentation IAM Policy Grants 'AssumeRole' Permission Across All Services12a7a7ce-39d6-49dd-923d-aeb4564eb66c Low Access Control IAM Policy should not grant 'AssumeRole' permission across all services. Documentation EC2 Instance Using Default Security Group8d03993b-8384-419b-a681-d1f55149397c Low Access Control EC2 instances should not use default security group(s) Documentation IAM Role Allows All Principals To Assumebabdedcf-d859-43da-9a7b-6d72e661a8fd Low Access Control IAM role allows all services or principals to assume it Documentation Automatic Minor Upgrades Disabled857f8808-e96a-4ba8-a9b7-f2d4ec6cad94 Low Best Practices RDS instance should have automatic minor upgrades enabled, which means the attribute 'auto_minor_version_upgrade' must be set to true. Documentation CDN Configuration Is Missingb25398a2-0625-4e61-8e4d-a1bb23905bf6 Low Best Practices Content Delivery Network (CDN) service is used within an AWS account to secure and accelerate the delivery of websites. The use of a CDN can provide a layer of security between your origin content and the destination. Documentation Lambda Permission Misconfigured3ddf3417-424d-420d-8275-0724dc426520 Low Best Practices Lambda permission may be misconfigured if the action field is not filled in by 'lambda:InvokeFunction' Documentation EFS Without Tagsb8a9852c-9943-4973-b8d5-77dae9352851 Low Build Process Amazon Elastic Filesystem should have filesystem tags associated Documentation CloudTrail Log Files Not Encrypted With KMSf5587077-3f57-4370-9b4e-4eb5b1bac85b Low Encryption Logs delivered by CloudTrail should be encrypted using KMS to increase security of your CloudTrail Documentation RDS Using Default Port2cb674f6-32f9-40be-97f2-62c0dc38f0d5 Low Networking and Firewall RDS should not use the default port (an attacker can easily guess the port). For engines related to Aurora, MariaDB or MySQL, the default port is 3306. PostgreSQL default port is 5432, Oracle default port is 1521 and SQL Server default port is 1433 Documentation ElastiCache Without VPC5527dcfc-94f9-4bf6-b7d4-1b78850cf41f Low Networking and Firewall ElastiCache should be launched in a Virtual Private Cloud (VPC) Documentation CloudFront Without WAF22c80725-e390-4055-8d14-a872230f6607 Low Networking and Firewall All AWS CloudFront distributions should be integrated with the Web Application Firewall (AWS WAF) service Documentation ElastiCache Using Default Port7cc6c791-5f68-4816-a564-b9b699f9d26e Low Networking and Firewall ElastiCache should not use the default port (an attacker can easily guess the port). For engine set to Redis, the default port is 6379. The Memcached default port is 11211 Documentation EC2 Instance Using Default VPC8833f180-96f1-46f4-9147-849aafa56029 Low Networking and Firewall EC2 Instances should not be configured under a default VPC network Documentation Redshift Using Default Porte01de151-a7bd-4db4-b49b-3c4775a5e881 Low Networking and Firewall Redshift should not use the default port (5439) because an attacker can easily guess the port Documentation CloudTrail Log File Validation Disabled4d8681a2-3d30-4c89-8070-08acd142748e Low Observability CloudTrail log file validation should be enabled to determine whether a log file has not been tampered Documentation Lambda Functions Without X-Ray Tracing71397b34-1d50-4ee1-97cb-c96c34676f74 Low Observability AWS Lambda functions should have TracingConfig enabled. For this, property 'tracing_mode' should have the value 'Active' Documentation EC2 Not EBS Optimized338b6cab-961d-4998-bb49-e5b6a11c9a5c Info Best Practices It's considered a best practice for an EC2 instance to use an EBS optimized instance. This provides the best performance for your EBS volumes by minimizing contention between Amazon EBS I/O and other traffic from your instance Documentation"},{"location":"queries/ansible-queries/#gcp","title":"GCP","text":"<p>Bellow are listed queries related with Ansible GCP:</p> Query Severity Category Description Help VM With Full Cloud Accessbc20bbc6-0697-4568-9a73-85af1dd97bdd High Access Control A VM instance is configured to use the default service account with full access to all Cloud APIs Documentation BigQuery Dataset Is Public2263b286-2fe9-4747-a0ae-8b4768a2bbd2 High Access Control BigQuery dataset is anonymously or publicly accessible Documentation Cloud Storage Anonymous or Publicly Accessible086031e1-9d4a-4249-acb3-5bfe4c363db2 High Access Control Cloud Storage Buckets must not be anonymously or publicly accessible, which means the attribute 'entity' must not be 'allUsers' or 'allAuthenticatedUsers' Documentation SQL DB Instance Backup Disabled0c82eae2-aca0-401f-93e4-fb37a0f9e5e8 High Backup Checks if backup configuration is enabled for all Cloud SQL Database instances Documentation DNSSEC Using RSASHA16cf4c3a7-ceb0-4475-8892-3745b84be24a High Encryption DNSSEC should not use the RSASHA1 algorithm Documentation SQL DB Instance With SSL Disabledd0f7da39-a2d5-4c78-bb85-4b7f338b3cbb High Encryption Cloud SQL Database Instance should have SLL enabled Documentation Cloud SQL Instance With Cross DB Ownership Chaining On9e0c33ed-97f3-4ed6-8be9-bcbf3f65439f High Insecure Configurations GCP SQL Instance should not have Cross DB Ownership Chaining On Documentation SQL DB Instance Publicly Accessible7d7054c0-3a52-4e9b-b9ff-cbfe16a2378b High Insecure Configurations Cloud SQL instances should not be publicly accessible. Documentation Cluster Labels Disabledfbe9b2d0-a2b7-47a1-a534-03775f3013f7 High Insecure Configurations Kubernetes Clusters must be configured with labels, which means the attribute 'resource_labels' must be defined Documentation Cluster Master Authentication Disabled9df7f78f-ebe3-432e-ac3b-b67189c15518 High Insecure Configurations Kubernetes Engine Clusters must have Master Authentication set to enabled, which means the attribute 'master_auth' must have the subattributes 'username' and 'password' defined and not empty Documentation IP Aliasing Disableded672a9f-fbf0-44d8-a47d-779501b0db05 High Insecure Configurations Kubernetes Clusters must be created with Alias IP ranges enabled, which means the attribute 'ip_allocation_policy' must be defined and the subattribute 'use_ip_aliases' must be set to 'yes'. Documentation GKE Basic Authentication Enabled344bf8ab-9308-462b-a6b2-697432e40ba1 High Insecure Configurations GCP - Google Kubernetes Engine (GKE) Basic Authentication must be disabled, which means the username and password provided in the master_auth block must be empty Documentation Cloud SQL Instance With Contained Database Authentication On6d34aff3-fdd2-460c-8190-756a3b4969e8 High Insecure Configurations SQL Instance should not have Contained Database Authentication On Documentation MySQL Instance With Local Infile Ona7b520bb-2509-4fb0-be05-bc38f54c7a4c High Insecure Configurations MySQL Instance should not have Local Infile On Documentation Network Policy Disabled98e04ca0-34f5-4c74-8fec-d2e611ce2790 High Insecure Configurations Kubernetes Engine Clusters must have Network Policy enabled, meaning that the attribute 'network_policy.enabled' must be true and the attribute 'addons_config.network_policy_config.disabled' must be false Documentation Private Cluster Disabled3b30e3d6-c99b-4318-b38f-b99db74578b5 High Insecure Configurations Kubernetes Clusters must be created with Private Clusters enabled, meaning the 'private_cluster_config' must be defined and the attributes 'enable_private_endpoint' and 'enable_private_nodes' must be true. Documentation GKE Legacy Authorization Enabled300a9964-b086-41f7-9378-b6de3ba1c32b High Insecure Configurations Kubernetes Engine Clusters must have Legacy Authorization set to disabled, which means the attribute 'legacy_abac.enabled' must be false. Documentation Client Certificate Disabled20180133-a0d0-4745-bfe0-94049fbb12a9 High Insecure Configurations Kubernetes Clusters must be created with Client Certificate enabled, which means 'master_auth' must have 'client_certificate_config' with the attribute 'issue_client_certificate' equal to true Documentation PostgreSQL Misconfigured Logging Duration Flagaed98a2a-e680-497a-8886-277cea0f4514 High Insecure Configurations PostgreSQL database 'log_min_duration_statement' flag isn't set to '-1' Documentation GKE Master Authorized Networks Disabledd43366c5-80b0-45de-bbe8-2338f4ab0a83 High Networking and Firewall Master authorized networks must be enabled in GKE clusters Documentation Compute Instance Is Publicly Accessible829f1c60-2bab-44c6-8a21-5cd9d39a2c82 High Networking and Firewall Compute instances shouldn't be accessible from the Internet. Documentation Cloud Storage Bucket Logging Not Enabled507df964-ad97-4035-ab14-94a82eabdfdd High Observability Cloud storage bucket should have logging enabled Documentation Stackdriver Monitoring Disabled20dcd953-a8b8-4892-9026-9afa6d05a525 High Observability Kubernetes Engine Clusters must have Stackdriver Monitoring enabled, which means the attribute 'monitoring_service' must be defined and different than 'none' Documentation PostgreSQL Logging Of Temporary Files Disabledd6fae5b6-ada9-46c0-8b36-3108a2a2f77b High Observability PostgreSQL database 'log_temp_files' flag isn't set to '0' Documentation Stackdriver Logging Disabled19c9e2a0-fc33-4264-bba1-e3682661e8f7 High Observability Kubernetes Engine Clusters must have Stackdriver Logging enabled, which means the attribute 'logging_service' must be defined and different from 'none' Documentation Cloud Storage Bucket Versioning Disabled7814ddda-e758-4a56-8be3-289a81ded929 High Observability Cloud Storage Bucket should have versioning enabled Documentation PostgreSQL Log Connections Disabledd7a5616f-0a3f-4d43-bc2b-29d1a183e317 High Observability PostgreSQL database instance should have a 'log_connections' flag with its value set to 'on' Documentation Node Auto Upgrade Disabledd6e10477-2e19-4bcd-b8a8-19c65b89ccdf High Resource Management Kubernetes nodes must have auto upgrades set to true, which means Node 'auto_upgrade' should be enabled for Kubernetes Clusters Documentation Google Compute SSL Policy Weak Cipher In Useb28bcd2f-c309-490e-ab7c-35fc4023eb26 Medium Encryption This query confirms if Google Compute SSL Policy Weak Chyper Suits is Enabled, to do so we need to check if TLS is TLS_1_2, because other version have Weak Chypers Documentation Disk Encryption Disabled092bae86-6105-4802-99d2-99cd7e7431f3 Medium Encryption VM disks for critical VMs must be encrypted with Customer Supplied Encryption Keys (CSEK) or with Customer-managed encryption keys (CMEK), which means the attribute 'disk_encryption_key' must be defined and its sub attributes 'raw_key' or 'kms_key_self_link' must also be defined Documentation Google Container Node Pool Auto Repair Disabledd58c6f24-3763-4269-9f5b-86b2569a003b Medium Insecure Configurations Google Container Node Pool Auto Repair should be enabled. This service periodically checks for failing nodes and repairs them to ensure a smooth running state. Documentation OSLogin Is Disabled In VM Instance66dae697-507b-4aef-be18-eec5bd707f33 Medium Insecure Configurations VM instance should have OSLogin enabled Documentation Cloud DNS Without DNSSEC80b15fb1-6207-40f4-a803-6915ae619a03 Medium Insecure Configurations DNSSEC must be enabled for Cloud DNS Documentation Using Default Service Account2775e169-e708-42a9-9305-b58aadd2c4dd Medium Insecure Configurations Instances must not be configured to use the Default Service Account, that has full access to all Cloud APIs, which means the attribute 'service_account_email' must be defined. Additionally, it must not be empty and must also not be a default Google Compute Engine service account. Documentation COS Node Image Not Usedbe41f891-96b1-4b9d-b74f-b922a918c778 Medium Insecure Configurations The node image should be Container-Optimized OS(COS) Documentation Shielded VM Disabled18d3a83d-4414-49dc-90ea-f0387b2856cc Medium Insecure Configurations Compute instances must be launched with Shielded VM enabled, which means the attribute 'shielded_instance_config' must be defined and its sub attributes 'enable_secure_boot', 'enable_vtpm' and 'enable_integrity_monitoring' must be set to true Documentation GKE Using Default Service Accountdc126833-125a-40fb-905a-ce5f2afde240 Medium Insecure Defaults Kubernetes Engine Clusters should not be configured to use the default service account Documentation SSH Access Is Not Restrictedb2fbf1df-76dd-4d78-a6c0-e538f4a9b016 Medium Networking and Firewall Google Firewall should not allow SSH access (port 22) from the Internet (public CIDR block) to ensure the principle of least privileges Documentation RDP Access Is Not Restricted75418eb9-39ec-465f-913c-6f2b6a80dc77 Medium Networking and Firewall Check if the Google compute firewall allows unrestricted RDP access. Allowed ports should not contain RDP port 3389 Documentation Google Compute Network Using Default Firewall Rule29b8224a-60e9-4011-8ac2-7916a659841f Medium Networking and Firewall Google Compute Network should not use default firewall rule Documentation IP Forwarding Enabled11bd3554-cd56-4257-8e25-7aaf30cf8f5f Medium Networking and Firewall Instances must not have IP forwarding enabled, which means the attribute 'can_ip_forward' must not be true Documentation Serial Ports Are Enabled For VM Instancesc6fc6f29-dc04-46b6-99ba-683c01aff350 Medium Networking and Firewall Google Compute Engine VM instances should not enable serial ports. When enabled, anyone can access your VM, if they know the username, project ID, SSH key, instance name and zone Documentation Google Compute Network Using Firewall Rule that Allows All Ports3602d273-3290-47b2-80fa-720162b1a8af Medium Networking and Firewall Google Compute Network should not use a firewall rule that allows all ports Documentation PostgreSQL Misconfigured Log Messages Flag28a757fc-3d8f-424a-90c0-4233363b2711 Medium Observability PostgreSQL database 'log_min_messages' flag isn't set to a valid value Documentation PostgreSQL log_checkpoints Flag Not Set To ON89afe3f0-4681-4ce3-89ed-896cebd4277c Medium Observability PostgreSQL database instance should have a 'log_checkpoints' flag with its value set to 'on' Documentation Project-wide SSH Keys Are Enabled In VM Instances099b4411-d11e-4537-a0fc-146b19762a79 Medium Secret Management VM Instance should block project-wide SSH keys Documentation High Google KMS Crypto Key Rotation Periodf9b7086b-deb8-4034-9330-d7fd38f1b8de Medium Secret Management KMS encryption keys should be rotated every 90 days or less. A short lifetime of encryption keys reduces the potential blast radius in case of compromise. Documentation Google Compute Network Using Firewall Rule that Allows Port Range7289eebd-a477-4064-8ad4-3c044bd70b00 Low Networking and Firewall Google Compute Network should not use a firewall rule that allows port range Documentation Google Compute Subnetwork with Private Google Access Disabled6a4080ae-79bd-42f6-a924-8f534c1c018b Low Networking and Firewall Google Compute Subnetwork should have Private Google Access enabled, which means 'private_ip_google_access' should be set to yes Documentation"},{"location":"queries/ansible-queries/#azure","title":"AZURE","text":"<p>Bellow are listed queries related with Ansible AZURE:</p> Query Severity Category Description Help Public Storage Account35e2f133-a395-40de-a79d-b260d973d1bd High Access Control Storage Account should not be public to grant the principle of least privileges Documentation Storage Container Is Publicly Accessible4d3817db-dd35-4de4-a80d-3867157e7f7f High Access Control Anonymous, public read access to a container and its blobs are enabled in Azure Blob Storage Documentation Admin User Enabled For Container Registry29f35127-98e6-43af-8ec1-201b79f99604 High Access Control Admin user is enabled for Container Registry Documentation MySQL SSL Connection Disabled2a901825-0f3b-4655-a0fe-e0470e50f8e6 High Encryption Make sure that for MySQL Database Server, 'Enforce SSL connection' is enabled Documentation Storage Account Not Forcing HTTPS2c99a474-2a3c-4c17-8294-53ffa5ed0522 High Encryption Storage Accounts should enforce the use of HTTPS Documentation SSL Enforce Disabled961ce567-a16d-4d7d-9027-f0ec2628a555 High Encryption Make sure that for PosgreSQL, the 'Enforce SSL connection' is set to 'ENABLED' Documentation Azure Container Registry With No Locks581dae78-307d-45d5-aae4-fe2b0db267a5 High Insecure Configurations Azurerm Container Registry should contain associated locks, which means 'azure_rm_lock.managed_resource_id' or 'azure_rm_lock.resource_group' association should be defined Documentation AD Admin Not Configured For SQL Serverb176e927-bbe2-44a6-a9c3-041417137e5f High Insecure Configurations The Active Directory Administrator is not configured for a SQL server Documentation VM Not Attached To Network1e5f5307-3e01-438d-8da6-985307ed25ce High Insecure Configurations No Network Security Group is attached to the Virtual Machine Documentation Web App Accepting Traffic Other Than HTTPSeb8c2560-8bee-4248-9d0d-e80c8641dd91 High Insecure Configurations Web app should only accept HTTPS traffic in Azure Web App Service. Documentation CosmosDB Account IP Range Filter Not Sete8c80448-31d8-4755-85fc-6dbab69c2717 High Networking and Firewall The IP range filter should be defined to secure the data stored Documentation Redis Publicly Accessible0632d0db-9190-450a-8bb3-c283bffea445 High Networking and Firewall Firewall rule allowing unrestricted access to Redis from other Azure sources Documentation SQLServer Ingress From Any IPf4e9ff70-0f3b-4c50-a713-26cbe7ec4039 High Networking and Firewall Check if all IPs are allowed, check from start 0.0.0.0 to end 255.255.255.255. Documentation Redis Entirely Accessible0d0c12b9-edce-4510-9065-13f6a758750c High Networking and Firewall Firewall rule allowing unrestricted access to Redis from the Internet Documentation Sensitive Port Is Exposed To Entire Network0ac9abbc-6d7a-41cf-af23-2e57ddb3dbfc High Networking and Firewall A sensitive port, such as port 23 or port 110, is open for the whole network in either TCP or UDP protocol Documentation Trusted Microsoft Services Not Enabled1bc398a8-d274-47de-a4c8-6ac867b353de High Networking and Firewall Trusted Microsoft Services should be enabled for Storage Account access Documentation AKS RBAC Disabled149fa56c-4404-4f90-9e25-d34b676d5b39 Medium Access Control Azure Container Service (AKS) instance should have role-based access control (RBAC) enabled Documentation Role Definition Allows Custom Role Creation5c80db8e-03f5-43a2-b4af-1f3f87018157 Medium Access Control Role Definition should not allow custom role creation (Microsoft.Authorization/roleDefinitions/write) Documentation Key Vault Soft Delete Is Disabled881696a8-68c5-4073-85bc-7c38a3deb854 Medium Backup Make sure Soft Delete is enabled for Key Vault Documentation SQL Server Predictable Admin Account Name663062e9-473d-4e87-99bc-6f3684b3df40 Medium Best Practices Azure SQL Server's Admin account login must avoid using names like 'Admin', that are too predictable, which means the attribute 'admin_username' must be set to a name that is not easy to predict Documentation SQL Server Predictable Active Directory Account Name530e8291-2f22-4bab-b7ea-306f1bc2a308 Medium Best Practices Azure SQL Server must avoid using predictable Active Directory Administrator Account names, like 'Admin', which means the attribute 'ad_user' must be set to a name that is not easy to predict Documentation Cosmos DB Account Without Tags23a4dc83-4959-4d99-8056-8e051a82bc1e Medium Build Process Cosmos DB Account must have a mapping of tags. Documentation Storage Account Not Using Latest TLS Encryption Versionc62746cf-92d5-4649-9acf-7d48d086f2ee Medium Encryption Ensure Storage Account is using the latest version of TLS encryption Documentation Redis Cache Allows Non SSL Connections869e7fb4-30f0-4bdb-b360-ad548f337f2f Medium Insecure Configurations Redis Cache resources should not allow non-SSL connections Documentation AKS Network Policy Misconfigured8c3bedf1-c570-4c3b-b414-d068cd39a00c Medium Insecure Configurations Azure Kubernetes Service should have the proper network policy configuration to ensure the principle of least privileges, which means that 'network_profile.network_policy' should be defined Documentation Security Group is Not Configuredda4f2739-174f-4cdd-b9ef-dc3f14b5931f Medium Insecure Configurations Azure Virtual Network subnet must be configured with a Network Security Group, which means the attribute 'security_group' must be defined and not empty Documentation Default Network Access is Allowed974e6fe7-63fd-4fa4-aa72-77b21a4a959d Medium Insecure Defaults Default Network Access rule for Storage Accounts must be set to deny, which means the attribute 'default_action' must be 'Deny' Documentation WAF Is Disabled For Azure Application Gateway2fc5ab5a-c5eb-4ae4-b687-0f16fe77c255 Medium Networking and Firewall Check if Web Application Firewall is disabled or not configured for Azure's Application Gateway. Documentation Unrestricted SQL Server Access3f23c96c-f9f5-488d-9b17-605b8da5842f Medium Networking and Firewall Azure SQL Server Accessibility should be set to a minimal address range to grant the principle of least privileges, which means the difference between the values of the 'end_ip_address' and 'start_ip_address' should be less than 256. Additionally, both ips should be different from '0.0.0.0' Documentation Firewall Rule Allows Too Many Hosts To Access Redis Cache69f72007-502e-457b-bd2d-5012e31ac049 Medium Networking and Firewall Check if any firewall rule allows too many hosts to access Redis Cache. Documentation Small Activity Log Retention Period37fafbea-dedb-4e0d-852e-d16ee0589326 Medium Observability Ensure that Activity Log Retention is set 365 days or greater Documentation PostgreSQL Log Disconnections Not Set054d07b5-941b-4c28-8eef-18989dc62323 Medium Observability Make sure that for PostgreSQL Database, server parameter 'log_disconnections' is set to 'ON' Documentation PostgreSQL Log Checkpoints Disabled7ab33ac0-e4a3-418f-a673-50da4e34df21 Medium Observability Make sure that for Postgre SQL Database Server, parameter 'log_checkpoints' is set to 'ON' Documentation Log Retention Is Not Set0461b4fd-21ef-4687-929e-484ee4796785 Medium Observability Make sure that for PostgreSQL Database, server parameter 'log_retention' is set to 'ON' Documentation Monitoring Log Profile Without All Activities89f84a1e-75f8-47c5-83b5-bee8e2de4168 Medium Observability Monitoring log profile captures all the activities (Action, Write, Delete) Documentation PostgreSQL Server Without Connection Throttlinga9becca7-892a-4af7-b9e1-44bf20a4cd9a Medium Observability Ensure that Connection Throttling is set for the PostgreSQL server Documentation AKS Monitoring Logging Disabledd5e83b32-56dd-4247-8c2e-074f43b38a5e Medium Observability Azure Container Service (AKS) instance should have logging enabled to Azure Monitoring Documentation PostgreSQL Log Connections Not Set7b47138f-ec0e-47dc-8516-e7728fe3cc17 Medium Observability Make sure that for PostgreSQL Database, server parameter 'log_connections' is set to 'ON' Documentation PostgreSQL Log Duration Not Set729ebb15-8060-40f7-9017-cb72676a5487 Medium Observability Make sure that for PostgreSQL Database, server parameter 'log_duration' is set to 'ON' Documentation"},{"location":"queries/azureresourcemanager-queries/","title":"Azure Resource Manager","text":""},{"location":"queries/azureresourcemanager-queries/#azureresourcemanager_queries_list","title":"AzureResourceManager Queries List","text":"<p>This page contains all queries from AzureResourceManager.</p> Query Severity Category Description Help Key Vault Not Recoverable7c25f361-7c66-44bf-9b69-022acd5eb4bd High Backup Key Vault should have 'enableSoftDelete' and 'enablePurgeProtection' set to true Documentation Secret Without Expiration Datecff9c3f7-e8f0-455f-9fb4-5f72326da96e High Best Practices All Secrets must have an expiration date defined Documentation Azure Instance Using Basic Authentication6797f581-0433-4768-ae3e-7ceb2f8b138e High Best Practices Azure Instances should use SSH Key instead of basic authentication Documentation Azure Managed Disk Without Encryption350f3955-b5be-436f-afaa-3d2be2fa6cdd High Encryption Azure Disk Encryption should be enabled Documentation Storage Account Allows Unsecure Transfer1367dd13-2c90-4020-80b7-e4339a3dc2c4 High Encryption 'Microsoft.Storage/storageAccounts' should force the use of HTTPS Documentation Web App Not Using TLS Last Versionb5c851d5-00f1-43dc-a8de-3218fd6f71be High Encryption Resources of type 'Microsoft.Web/sites' should define 'properties.siteConfig.minTlsVersion' with '1.2' Documentation Website Not Forcing HTTPS488847ff-6031-487c-bf42-98fd6ac5c9a0 High Insecure Configurations 'Microsoft.Web/sites' should force the use of HTTPS Documentation MySQL Server SSL Enforcement Disabled90120147-f2e7-4fda-bb21-6fa9109afd63 High Networking and Firewall 'Microsoft.DBforMySQL/servers' should enforce SSL Documentation Website with Client Certificate Auth Disabled92302b47-b0cc-46cb-a28f-5610ecda140b High Networking and Firewall 'Microsoft.Web/sites' should have client certificate authentication enabled Documentation SQL Database Server Firewall Allows All IPS6a3201a5-1630-494b-b294-3129d06b0eca High Networking and Firewall SQL Database Server Firewall endIpAddress should not be '255.255.255.255' when startIpAddress is '0.0.0.0' since this allows all IPS Documentation Network Security Group With Unrestricted Access To RDP59cb3da7-f206-4ae6-b827-7abf0a9cab9d High Networking and Firewall Port 3389 (Remote Desktop) is exposed to the Internet Documentation Network Security Group With Unrestricted Access To SSH2ade1579-4b2c-4590-bebb-f99bf597f612 High Networking and Firewall Port 22 (SSH) is exposed to the Internet Documentation PostgreSQL Database Server SSL Disabledbf500309-da53-4dd3-bcf7-95f7974545a5 High Networking and Firewall Microsoft.DBforPostgreSQL/servers sslEnforcement property should be set to 'Enabled' Documentation Storage Blob Service Container With Public Accessa0ab985d-660b-41f7-ac81-70957ee8e627 High Networking and Firewall Storage Blob Service Container should not publicly accessible Documentation Trusted Microsoft Services Not Enablede25b56cd-a4d6-498f-ab92-e6296a082097 High Networking and Firewall Trusted Microsoft Services should be enabled for Storage Account access Documentation AKS Cluster RBAC Disabled9307a2ed-35c2-413d-94de-a1a0682c2158 Medium Access Control Microsoft.ContainerService/managedClusters should have enableRBAC set to true Documentation Role Definitions Allow Custom Subscription Role Creation8fa9ceea-881f-4ef0-b0b8-728f589699a7 Medium Access Control Role Definitions should not allow custom subscription role creation (actions set to '*' or 'Microsoft.Authorization/roleDefinitions/write') Documentation SQL Server Database With Alerts Disabled574e8d82-1db2-4b9c-b526-e320ede9a9ff Medium Best Practices All Alerts should be enabled in SQL Database Server SecurityAlerts Policy Properties Documentation AKS Cluster Network Policy Not Configured25c0228e-4444-459b-a2df-93c7df40b7ed Medium Insecure Configurations Azure Kubernetes Service must have a network policy defined. Documentation AKS With Authorized IP Ranges Disabled2583fab1-953b-4fae-bd02-4a136a6c21f9 Medium Networking and Firewall Azure Kubernetes Service must have an authorized IP range for API Services enabled Documentation Standard Price Is Not Selected2081c7d6-2851-4cce-bda5-cb49d462da42 Medium Networking and Firewall Azure Security Center provides more features for standard pricing mode, so it must be activated. Documentation PostgreSQL Database Server Log Checkpoints Disabledf9112910-c7bb-4864-9f5e-2059ba413bb7 Medium Networking and Firewall Microsoft.DBforPostgreSQL/servers/configurations should have 'log_checkpoint' property set to 'on' Documentation PostgreSQL Database Server Log Connections Disablede69bda39-e1e2-47ca-b9ee-b6531b23aedd Medium Networking and Firewall Microsoft.DBforPostgreSQL/servers/configurations should have 'log_connections' property set to 'on' Documentation PostgresSQL Database Server Connection Throttling Disableda6d774b6-d9ea-4bf4-8433-217bf15d2fb8 Medium Networking and Firewall Microsoft.DBforPostgreSQL/servers/configurations should have 'connection_throttling' property set to 'on' Documentation Unrecommended Log Profile Retention Policy25684eac-daaa-4c2c-94b4-8d2dbb627909 Medium Observability Log Profile Retention Policy should be enabled and the recommended number of days for the retention should be higher than 365 or 0 (0 will retain the events indefinitely) Documentation Storage Logging For Read Write And Delete Requests Disabled43f6e60c-9cdb-4e77-864d-a66595d26518 Medium Observability Storage Logging should be enabled for read, write and delete methods Documentation AKS Logging To Azure Monitoring Is Disabled9b09dee1-f09b-4013-91d2-158fa4695f4b Medium Observability Azure Kubernetes Service should have logging to Azure Monitoring enabled. Documentation Log Profile Incorrect Category4d522e7b-f938-4d51-a3b1-974ada528bd3 Medium Observability Log Profile Categories should be set to 'Write', 'Delete', and/or 'Action' Documentation Unrecommended Network Watcher Flow Log Retention Policy564b70f8-41cd-4690-aff8-bb53add86bc9 Medium Observability Network Watcher Flow Log Retention Policy should be enabled and the recommended number of days for the retention should be higher than 90 Documentation SQL Server Database Without Auditinge055285c-bc01-48b4-8aa5-8a54acdd29df Medium Observability Every 'Microsoft.Sql/servers/databases' resource should have Auditing Enabled Documentation SQL Server Database With Unrecommended Retention Daysc09cdac2-7670-458a-bf6c-efad6880973a Medium Observability SQL Server Database Auditing Settings should keep the audit logs in the storage account for at least 90 days Documentation Hardcoded SecureString Parameter Default Value4d2cf896-c053-4be5-9c95-8b4771112f29 Medium Secret Management Secure parameters should not have hardcoded default value Documentation Website Azure Active Directory Disablede9c133e5-c2dd-4b7b-8fff-40f2de367b56 Low Access Control WebApp should have Azure Active Directory  enabled with 'identity.type' set to 'SystemAssigned' or 'userAssignedIdentities' set to 'true' Documentation Phone Number Not Set For Security Contacts3e9fcc67-1f64-405f-b2f9-0a6be17598f0 Low Best Practices Microsoft.Security securityContacts should have a phone number defined Documentation AKS Dashboard Is Enabledc62d3b92-9a11-4ffd-b7b7-6faaae83faed Low Insecure Configurations Azure Kubernetes Service should have the Kubernetes dashboard disabled. Documentation Website with 'Http20Enabled' Disabled70111098-7f85-48f0-b1b4-e4261cf5f61b Low Networking and Firewall 'Microsoft.Web/sites' should have 'Http20Enabled' enabled Documentation Storage Account Allows Default Network Access9073f073-5d60-4b46-b569-0d6baa80ed95 Low Networking and Firewall 'Microsoft.Storage/storageAccounts' should force the use of HTTPS Documentation App Service Authentication Is Not Set83130a07-235b-4a80-918b-a370e53f0bd9 Info Access Control Azure App Service should have App Service Authentication set Documentation Account Admins Not Notified By Emaila8852cc0-fd4b-4fc7-9372-1e43fad0732e Info Best Practices Account admins should be notified by email in the event of security alerts Documentation SQL Alert Policy Without Emails89b79fe5-49bd-4d39-84ce-55f5fc6f7764 Info Best Practices SQL Database Server should contain emails to be notified in the event of a Security Alert Documentation Email Notifications Disabled79c2c2c0-eb00-47c0-ac16-f8b0e2c81c92 Info Networking and Firewall Email notifications about new security alerts, should be set to 'On', and be sent to persons with specific RBAC roles on the subscription Documentation"},{"location":"queries/buildah-queries/","title":"Buildah queries","text":""},{"location":"queries/buildah-queries/#buildah_queries_list","title":"Buildah Queries List","text":"<p>This page contains all queries from Buildah.</p> Query Severity Category Description Help Run Using apta1bc27c6-7115-48d8-bf9d-5a7e836845ba Medium Supply-Chain apt is discouraged by the linux distributions as an unattended tool as its interface may suffer changes between versions. Better use the more stable apt-get and apt-cache Documentation"},{"location":"queries/cloudformation-queries/","title":"CloudFormation","text":""},{"location":"queries/cloudformation-queries/#cloudformation_queries_list","title":"CloudFormation Queries List","text":"<p>This page contains all queries from CloudFormation.</p>"},{"location":"queries/cloudformation-queries/#aws","title":"AWS","text":"<p>Bellow are listed queries related with CloudFormation AWS:</p> Query Severity Category Description Help Lambda Functions With Full Privilegesa0ae0a4e-712b-4115-8112-51b9eeed9d69 High Access Control AWS Lambda Functions should not have roles with policies granting full administrative privileges. Documentation S3 Bucket Allows Public Policy860ba89b-b8de-4e72-af54-d6aee4138a69 High Access Control S3 bucket allows public policy Documentation S3 Bucket With All Permissions4ae8af91-5108-42cb-9471-3bdbe596eac9 High Access Control S3 Buckets should not have all permissions, as to prevent leaking private information to the entire internet or allow unauthorized data tampering / deletion. This means the 'Effect' must not be 'Allow' when the 'Action' is '*', for all Principals. Documentation S3 Bucket Access to Any Principal7772bb8c-c0f3-42d4-8e4e-f1b8939ad085 High Access Control The S3 Bucket should not be associated with a policy statement that grants access to any principal Documentation S3 Bucket ACL Allows Read Or Write to All Users07dda8de-d90d-469e-9b37-1aca53526ced High Access Control S3 Buckets should not be readable and writable to all users Documentation S3 Bucket ACL Allows Read to Any Authenticated User835d5497-a526-4aea-a23f-98a9afd1635f High Access Control S3 Buckets should not be readable to any authenticated user Documentation IAM Policies With Full Privileges953b3cdb-ce13-428a-aa12-318726506661 High Access Control IAM policies shouldn't allow full administrative privileges (for all resources) Documentation SNS Topic is Publicly Accessibleae53ce91-42b5-46bf-a84f-9a13366a4f13 High Access Control SNS Topic Policy should not allow any principal to access Documentation MSK Broker Is Publicly Accessible0ce1ba20-8ba8-4364-836f-40c24b8cb0ab High Access Control Public AWS MSK allows anyone to interact with the Apache Kafka broker, therefore increasing the opportunity for malicious activity. To prevent such a scenario, it is recommended for AWS MSK to not be publicly accessible Documentation IAM Policy Grants Full Permissionsf62aa827-4ade-4dc4-89e4-1433d384a368 High Access Control IAM policy should not grant full permissions to resources from the get-go, instead of granting permissions gradually as necessary. Documentation S3 Bucket Allows Restore Actions From All Principals456b00a3-1072-4149-9740-6b8bb60251b0 High Access Control S3 Buckets must not allow Restore Actions From All Principals, as to prevent leaking private information to the entire internet or allow unauthorized data tampering / deletion. This means the 'Effect' must not be 'Allow' when the 'Action' is Restore, for all Principals. Documentation S3 Bucket Allows Put Action From All Principalsf6397a20-4cf1-4540-a997-1d363c25ef58 High Access Control S3 Buckets must not allow Put Action From All Principals, as to prevent leaking private information to the entire internet or allow unauthorized data tampering / deletion. This means the 'Effect' must not be 'Allow' when the 'Action' is Put, for all Principals. Documentation S3 Bucket Allows Get Action From All Principalsf97b7d23-568f-4bcc-9ac9-02df0d57fbba High Access Control S3 Buckets must not allow Get Action From All Principals, as to prevent leaking private information to the entire internet or allow unauthorized data tampering / deletion. This means the 'Effect' must not be 'Allow' when the 'Action' is Get, for all Principals. Documentation S3 Bucket Allows List Action From All Principalsfaa8fddf-c0aa-4b2d-84ff-e993e233ebe9 High Access Control S3 Buckets must not allow List Action From All Principals, as to prevent leaking private information to the entire internet or allow unauthorized data tampering / deletion. This means the 'Effect' must not be 'Allow' when the 'Action' is List, for all Principals. Documentation ECS Service Admin Role Is Present01986452-bdd8-4aaa-b5df-d6bf61d616ff High Access Control ECS Services must not have Admin roles, which means the attribute 'role' must not be an admin role Documentation S3 Bucket Allows Delete Action From All Principalsacc78859-765e-4011-a229-a65ea57db252 High Access Control S3 Buckets must not allow Delete Action From All Principals, as to prevent leaking private information to the entire internet or allow unauthorized data tampering / deletion. This means the 'Effect' must not be 'Allow' when the 'Action' is Delete, for all Principals. Documentation S3 Bucket ACL Allows Read to All Users219f4c95-aa50-44e0-97de-cf71f4641170 High Access Control S3 Buckets should not be readable to all users Documentation ElastiCache With Disabled at Rest Encryptione4ee3903-9225-4b6a-bdfb-e62dbadef821 High Encryption Ensure AWS ElastiCache Redis clusters have encryption for data at rest enabled Documentation SageMaker Data Encryption Disabled709e6da6-fa1f-44cc-8f17-7f25f96dadbe High Encryption Amazon SageMaker's Notebook Instance must have its Data Encryption enabled, which means the attribute 'KmsKeyId' must be defined not empty or null. Documentation S3 Bucket SSE Disabled64ab651b-f5b2-4af0-8c89-ddd03c4d0e61 High Encryption If algorithm is AES256 then the master key is null, empty or undefined, otherwise the master key is required Documentation Connection Between CloudFront Origin Not Encrypteda5366a50-932f-4085-896b-41402714a388 High Encryption Checks if the connection between the CloudFront and the origin server is encrypted Documentation ELB Using Insecure Protocols61a94903-3cd3-4780-88ec-fc918819b9c8 High Encryption ELB Predefined or Custom Security Policies must not use insecure protocols, to reduce the risk of the SSL connection between the client and the load balancer being exploited. That means the ELB Listeners must not have Policies that posses Protocols that coincide with any of a predefined list of insecure protocols. Documentation User Data Contains Encoded Private Key568cc372-ca64-420d-9015-ee347d00d288 High Encryption User Data should not contain a base64 encoded private key. If so, anyone can decode the private key easily Documentation S3 Bucket Without Server-side-encryptionb2e8752c-3497-4255-98d2-e4ae5b46bbf5 High Encryption S3 Buckets should have server-side encryption at rest enabled to protect sensitive data Documentation Redshift Not Encrypted3b316b05-564c-44a7-9c3f-405bb95e211e High Encryption AWS Redshift Cluster should be encrypted. Check if 'Encrypted' field is false or undefined (default is false) Documentation EFS Without KMS6d087495-2a42-4735-abf7-02ef5660a7e6 High Encryption Amazon Elastic Filesystem should have filesystem encryption enabled using KMS CMK customer-managed keys instead of AWS managed-keys Documentation Secure Ciphers Disabledbe96849c-3df6-49c2-bc16-778a7be2519c High Encryption Check if secure ciphers aren't used in CloudFront Documentation ELB Using Weak Ciphers809f77f8-d10e-4842-a84f-3be7b6ff1190 High Encryption ELB Predefined or Custom Security Policies must not use weak ciphers, to reduce the risk of the SSL connection between the client and the load balancer being exploited. That means the ELB Listeners must not have Policies that posses Ciphers that coincide with any of a predefined list of weak ciphers. Documentation CMK Unencrypted Storageffee2785-c347-451e-89f3-11aeb08e5c84 High Encryption Ensure that storage is encrypted. Documentation RDS Storage Not Encrypted5beacce3-4020-4a3d-9e1d-a36f953df630 High Encryption RDS Storage should be encrypted, which means the attribute 'StorageEncrypted' should be set to 'true' Documentation DynamoDB With Aws Owned CMKc8dee387-a2e6-4a73-a942-183c975549ac High Encryption AWS DynamoDb should be encrypted using AWS Managed CMK, instead of AWS-owned CMK. To verify this, SSEEnabled must be verified if false for AWS-owned CMK or true for AWS-Managed CMK. Default value is false. Documentation ElastiCache With Disabled Transit Encryption3b02569b-fc6f-4153-b3a3-ba91022fed68 High Encryption Ensure AWS ElastiCache Redis clusters have encryption for data at transit enabled Documentation ELB Without Secure Protocol80908a75-586b-4c61-ab04-490f4f4525b8 High Encryption Check if the ELB is setup with SSL or HTTPS for secure communication Documentation CloudFormation Specifying Credentials Not Safe9ecb6b21-18bc-4aa7-bd07-db20f1c746db High Encryption Specifying credentials in the template itself is probably not safe to do. Documentation IAM Database Auth Not Enabled9fcd0a0a-9b6f-4670-a215-d94e6bf3f184 High Encryption IAM Database Auth Enabled should be configured to true when using compatible engine and version Documentation User Data Shell Script Is Encoded48c3bc58-6959-4f27-b647-4fedeace23be High Encryption User Data Shell Script must be encoded Documentation Redshift Cluster Without KMS CMKde76a0d6-66d5-45c9-9022-f05545b85c78 High Encryption AWS Redshift Cluster should have KMS CMK defined Documentation Cloudfront Viewer Protocol Policy Allows HTTP31733ee2-fef0-4e87-9778-65da22a8ecf1 High Encryption Checks if the connection between CloudFront and the viewer is encrypted Documentation MSK Cluster Encryption Disableda976d63f-af0e-46e8-b714-8c1a9c4bf768 High Encryption Ensure MSK Cluster encryption in rest and transit is enabled Documentation API Gateway Cache Encrypted Disabled37cca703-b74c-48ba-ac81-595b53398e9b High Encryption 'API::Gateway::Deployment' should have 'CacheDataEncrypted' enabled when 'CachingEnabled' is set to true Documentation ECS Task Definition Container With Plaintext Passwordf9b10cdb-eaab-4e39-9793-e12b94a582ad High Encryption It's not recommended to use plaintext environment variables for sensitive information, such as credential data. Documentation S3 Bucket Without SSL In Write Actions38c64e76-c71e-4d92-a337-60174d1de1c9 High Encryption S3 Buckets should enforce encryption of data transfers using Secure Sockets Layer (SSL) Documentation ECS Cluster Not Encrypted At Rest6c131358-c54d-419b-9dd6-1f7dd41d180c High Encryption Ensure that AWS ECS clusters are encrypted. Data encryption at rest, prevents unauthorized users from accessing sensitive data on your AWS ECS clusters and associated cache storage systems. Documentation Kinesis SSE Not Configured7f65be75-90ab-4036-8c2a-410aef7bb650 High Encryption AWS Kinesis Stream should have SSE (Server Side Encryption) defined Documentation EFS Not Encrypted2ff8e83c-90e1-4d68-a300-6d652112e622 High Encryption Elastic File System (EFS) must be encrypted Documentation CloudFront Without Minimum Protocol TLS 1.2dc17ee4b-ddf2-4e23-96e8-7a36abad1303 High Insecure Configurations CloudFront Minimum Protocol version should be at least TLS 1.2 Documentation Redshift Publicly Accessiblebdf8dcb4-75df-4370-92c4-606e4ae6c4d3 High Insecure Configurations AWS Redshift Clusters must not be publicly accessible, which means the attribute 'PubliclyAccessible' must be set to false Documentation DB Instance Publicly Accessiblede38e1d5-54cb-4111-a868-6f7722695007 High Insecure Configurations RDS must not be defined with public interface, which means the attribute 'PubliclyAccessible' must be set to false. Documentation S3 Bucket With Unsecured CORS Rule3609d27c-3698-483a-9402-13af6ae80583 High Insecure Configurations If the CORS (Cross-Origin Resource Sharing) rule is defined in an S3 bucket, it should be secure Documentation API Gateway Without Security Policy8275fab0-68ec-4705-bbf4-86975edb170e High Insecure Configurations API Gateway should have a Security Policy defined and use TLS 1.2. Documentation ECS Task Definition Network Mode Not Recommended027a4b7a-8a59-4938-a04f-ed532512cf45 High Insecure Configurations Network_Mode should be 'awsvpc' in ecs_task_definition. AWS VPCs provides the controls to facilitate a formal process for approving and testing all network connections and changes to the firewall and router configurations Documentation S3 Static Website Host Enabled90501b1b-cded-4cc1-9e8b-206b85cda317 High Insecure Configurations Checks if any static websites are hosted on buckets. Even static websites can be a liability when poorly configured. Documentation Root Account Has Active Access Keys4c137350-7307-4803-8c04-17c09a7a9fcf High Insecure Configurations The AWS Root Account must not have active access keys associated, which means if there are access keys associated to the Root Account, they must be inactive. Documentation S3 Bucket Without Restriction Of Public Bucket350cd468-0e2c-44ef-9d22-cfb73a62523c High Insecure Configurations S3 bucket without restriction of public bucket Documentation KMS Key With Vulnerable Policyda905474-7454-43c0-b8d2-5756ab951aba High Insecure Configurations Checks if the policy is vulnerable and needs updating. Documentation Batch Job Definition With Privileged Container Properties76ddf32c-85b1-4808-8935-7eef8030ab36 High Insecure Configurations Batch Job Definition should not have Privileged Container Properties Documentation Vulnerable Default SSL Certificateb4d9c12b-bfba-4aeb-9cb8-2358546d8041 High Insecure Defaults CloudFront web distributions should use custom (and not default) SSL certificates. Custom SSL certificates allow only defined users to access content by using an alternate domain name instead of the default one. Documentation Permissive Web ACL Default Action6d64f311-3da6-45f3-80f1-14db9771ea40 High Insecure Defaults WebAcl DefaultAction should not be ALLOW Documentation Security Group With Unrestricted Access To SSH6e856af2-62d7-4ba2-adc1-73b62cef9cc1 High Networking and Firewall 'SSH' (TCP:22) should not be public in AWS Security Group Documentation Security Group Unrestricted Access To RDP3ae83918-7ec7-4cb8-80db-b91ef0f94002 High Networking and Firewall Security Groups does not allow 0.0.0.0/0 for rdp (port:3389) Documentation Unknown Port Exposed To Internet829ce3b8-065c-41a3-ad57-e0accfea82d2 High Networking and Firewall AWS Security Group should not have an unknown port exposed to the entire Internet Documentation ALB Listening on HTTP275a3217-ca37-40c1-a6cf-bb57d245ab32 High Networking and Firewall AWS Application Load Balancer (alb) should not listen on HTTP Documentation EC2 Network ACL Overlapping Ports77b6f1e2-bde4-4a6a-ae7e-a40659ff1576 High Networking and Firewall NetworkACL Entries are reusing or overlapping ports which may create ineffective rules Documentation Security Groups With Meta IPadcd0082-e90b-4b63-862b-21899f6e6a48 High Networking and Firewall Security Groups allows 0.0.0.0/0 for all ports and protocols. Documentation DB Security Group Open To Large Scope0104165b-02d5-426f-abc9-91fb48189899 High Networking and Firewall The IP address in a DB Security Group must not have more than 256 hosts. Documentation EC2 Instance Subnet Has Public IP Mapping On Launchb3de4e4c-14be-4159-b99d-9ad194365e4c High Networking and Firewall EC2 Instance Subnet should not have MapPublicIpOnLaunch set to true Documentation EKS node group remote access73d59e76-a12c-4b74-a3d8-d3e1e19c25b3 High Networking and Firewall Ensure Amazon EKS Node group has implict SSH access Documentation Fully Open Ingresse415f8d3-fc2b-4f52-88ab-1129e8c8d3f5 High Networking and Firewall ECS Service's security group should not allow unrestricted access to all ports from all IPv4 addresses Documentation DB Security Group With Public Scope9564406d-e761-4e61-b8d7-5926e3ab8e79 High Networking and Firewall The IP address in a DB Security Group should not be '0.0.0.0/0' (IPv4) or '::/0' (IPv6). If so, any IP can access it Documentation HTTP Port Open To Internetddfc4eaa-af23-409f-b96c-bf5c45dc4daa High Networking and Firewall The HTTP port is open to the internet in a Security Group Documentation Unrestricted Security Group Ingress4a1e6b34-1008-4e61-a5f2-1f7c276f8d14 High Networking and Firewall AWS Security Group Ingress CIDR should not be open to the world Documentation Security Groups With Exposed Admin Portscdbb0467-2957-4a77-9992-7b55b29df7b7 High Networking and Firewall Security Groups should not have ports open in (20, 21, 22, 23, 115, 137, 138, 139, 2049, 3389) Documentation RDS Associated with Public Subnet4e88adee-a8eb-4605-a78d-9fb1096e3091 High Networking and Firewall RDS should not run in public subnet Documentation Default Security Groups With Unrestricted Trafficea33fcf7-394b-4d11-a228-985c5d08f205 High Networking and Firewall Check if default security group does not restrict all inbound and outbound traffic. Documentation SageMaker Notebook Not Placed In VPC9c7028d9-04c2-45be-b8b2-1188ccaefb36 High Networking and Firewall SageMaker Notebook must be placed in a VPC Documentation EC2 Sensitive Port Is Publicly Exposed494b03d3-bf40-4464-8524-7c56ad0700ed High Networking and Firewall The EC2 instance has a sensitive port connection exposed to the entire network Documentation ELB Sensitive Port Is Exposed To Entire Network78055456-f670-4d2e-94d5-392d1cf4f5e4 High Networking and Firewall The load balancer of the application with a sensitive port connection is exposed to the entire internet. Documentation Security Groups Allows Unrestricted Outbound Traffic66f2d8f9-a911-4ced-ae27-34f09690bb2c High Networking and Firewall No security group should allow unrestricted egress access Documentation Remote Desktop Port Open To Internetc9846969-d066-431f-9b34-8c4abafe422a High Networking and Firewall The Remote Desktop port is open to the internet in a Security Group Documentation EC2 Public Instance Exposed Through Subnetc44c95fc-ae92-4bb8-bdf8-bb9bc412004a High Networking and Firewall EC2 instances with public IP addresses shouldn't allow for unrestricted traffic to their subnets Documentation Route53 Record Undefined24d932e1-91f0-46ea-836f-fdbd81694151 High Networking and Firewall Route53 HostedZone must have the Record Set defined. Documentation CMK Rotation Disabled1c07bfaf-663c-4f6f-b22b-8e2d481e4df5 High Observability Customer Master Keys (CMK) must have rotation enabled, which means the attribute 'EnableKeyRotation' must be set to 'true' when the key is enabled. Documentation S3 Bucket CloudTrail Logging Disabledc3ce69fd-e3df-49c6-be78-1db3f802261c High Observability Server Access Logging should be enabled on S3 Buckets so that all changes are logged and trackable when the Service used is CloudTrail Documentation CloudTrail Logging Disabled5c0b06d5-b7a4-484c-aeb0-75a836269ff0 High Observability Checks if logging is enabled for CloudTrail. Documentation Cross-Account IAM Assume Role Policy Without ExternalId or MFA85138beb-ce7c-4ca3-a09f-e8fbcc57ddd7 Medium Access Control Cross-Account IAM Assume Role Policy should require external ID or MFA to protect cross-account access Documentation ECR Repository Is Publicly Accessible75be209d-1948-41f6-a8c8-e22dd0121134 Medium Access Control Amazon ECR image repositories shouldn't have public access Documentation IAM Policy On Usere4239438-e639-44aa-adb8-866e400e3ade Medium Access Control IAM policies should be applied to groups and not to users Documentation Elasticsearch Without IAM Authentication5c666ed9-b586-49ab-9873-c495a833b705 Medium Access Control AWS Elasticsearch should ensure IAM Authentication Documentation S3 Bucket Allows Public ACL48f100d9-f499-4c6d-b2b8-deafe47ffb26 Medium Access Control S3 bucket allows public ACL Documentation Public Lambda via API Gateway57b12981-3816-4c31-b190-a1e614361dd2 Medium Access Control Allowing to run lambda function using public API Gateway Documentation API Gateway Method Does Not Contains An API Key3641d5b4-d339-4bc2-bfb9-208fe8d3477f Medium Access Control An API Key should be required on a method request. Documentation KMS Allows Wildcard Principalf6049677-ec4a-43af-8779-5190b6d03cba Medium Access Control KMS Should not allow Principal parameter to be set as * Documentation API Gateway Without Configured Authorizer7fd0d461-5b8c-4815-898c-f2b4b117eb28 Medium Access Control API Gateway REST API should have an API Gateway Authorizer Documentation IoT Policy Allows Action as Wildcard4d32780f-43a4-424a-a06d-943c543576a5 Medium Access Control IoT Policy should not allow Action to be set as * Documentation Neptune Cluster With IAM Database Authentication Disableda3aa0087-8228-4e7e-b202-dc9036972d02 Medium Access Control Neptune Cluster should have IAM Database Authentication enabled Documentation Empty Roles For ECS Cluster Task Definitions7f384a5f-b5a2-4d84-8ca3-ee0a5247becb Medium Access Control Check if any ECS cluster has not defined proper roles for services' task definitions. Documentation IoT Policy Allows Wildcard Resourcebe5b230d-4371-4a28-a441-85dc760e2aa3 Medium Access Control IoT Policy should not allow Resource to be set as * Documentation Lambda Permission Principal Is Wildcard1d6e16f1-5d8a-4379-bfb3-2dadd38ed5a7 Medium Access Control Lambda Permission Principal should not contain a wildcard. Documentation SQS Queue Policy Allows NotAction4fbfee74-8186-40d5-a24e-4baa76a855de Medium Access Control AWS SQS Queue Policy should not allow NotAction since the actions specified in this element are the only actions in that are limited Documentation IAM Policies Attached To Useredc95c10-7366-4f30-9b4b-f995c84eceb5 Medium Access Control IAM policies should be attached only to groups or roles Documentation SQS Policy With Public Access9b6a3f5b-5fd6-40ee-9bc0-ed604911212d Medium Access Control Checks for dangerous permissions in Action statements in an SQS Queue Policy. This is deemed a potential security risk as it would allow various attacks to the queue Documentation EC2 Network ACL Ineffective Denied Traffic2623d682-dccb-44cd-99d0-54d9fd62f8f2 Medium Access Control Ineffective deny rules. A deny rule should be applied to all IP addresses. Documentation SNS Topic Publicity Has Allow and NotAction Simultaneously818f38ed-8446-4132-9c03-474d49e10195 Medium Access Control SNS topic Publicity should not have 'Effect: Allow' and argument 'NotAction' at the same time. If it has 'Effect: Allow', the argument stated should be 'Action'. Documentation EC2 Instance Has No IAM Rolef914357d-8386-4d56-9ba6-456e5723f9a6 Medium Access Control Check if an EC2 instance refers to an IAM profile, which represents an IAM Role. Documentation SQS Queue Policy Allows NotPrincipal4a8fc9a2-2b2f-4b3f-aa8d-401425872034 Medium Access Control Checks if an SQS Queue policy has an Allow and a NotPrincipal. AWS strongly recommends against using <code>NotPrincipal</code> in the same policy statement as <code>\"Effect\": \"Allow\"</code>. Documentation EBS Volume Not Attached To Instances1819ac03-542b-4026-976b-f37addd59f3b Medium Availability EBS Volumes that are unattached to instances may contain sensitive data Documentation Auto Scaling Group With No Associated ELBad21e616-5026-4b9d-990d-5b007bfe679c Medium Availability AWS Auto Scaling Groups must have associated ELBs to ensure high availability and improve application performance. This means the attribute 'LoadBalancerNames' must be defined and not empty. Documentation ECS Service Without Running Tasks79d745f0-d5f3-46db-9504-bef73e9fd528 Medium Availability ECS Service should have at least 1 task running Documentation ElastiCache Nodes Not Created Across Multi AZcfdef2e5-1fe4-4ef4-bea8-c56e08963150 Medium Availability ElastiCache Nodes should be created across multi az, which means 'AZMode' should be set to 'cross-az' in multi nodes cluster Documentation CMK Is Unusable2844c749-bd78-4cd1-90e8-b179df827602 Medium Availability AWS Key Management Service (KMS) must only possess usable Customer Master Keys (CMK), which means the CMKs must have the attribute 'Enabled' set to true and the attribute 'PendingWindowInDays' must be undefined. Documentation RDS Multi-AZ Deployment Disabled2b1d4935-9acf-48a7-8466-10d18bf51a69 Medium Backup AWS RDS Instance should have a multi-az deployment Documentation RDS With Backup Disabled8c415f6f-7b90-4a27-a44a-51047e1506f9 Medium Backup Make sure the AWS RDS configuration has automatic backup configured. If the retention period is equal to 0 there is no backup Documentation Low RDS Backup Retention Periode649a218-d099-4550-86a4-1231e1fcb60d Medium Backup AWS RDS backup retention policy should be at least 7 days Documentation Stack Retention Disabledfe974ae9-858e-4991-bbd5-e040a834679f Medium Backup Make sure that retain_stack is enabled to keep the Stack and it's associated resources during resource destruction Documentation IAM Password Without Uppercase Letter445020f6-b69e-4484-847f-02d4b7768902 Medium Best Practices IAM password should have at least one uppercase letter Documentation IAM Password Without Lowercase Letterf4cf35d6-da92-48de-ab70-57be2b2e6497 Medium Best Practices IAM Password should have at least one lowercase letter Documentation IAM Password Without Number839f238f-2e3a-4a72-b945-8abdf91af955 Medium Best Practices IAM user resource Login Profile Password should have at least one number Documentation IAM User Without Password Reseta964d6e3-8e1e-4d93-8120-61fa640dd55a Medium Best Practices IAM User Login Profile should exist and have PasswordResetRequired property set to true Documentation Cognito UserPool Without MFA74a18d1a-cf02-4a31-8791-ed0967ad7fdc Medium Best Practices AWS Cognito UserPool should have MFA (Multi-Factor Authentication) defined to users Documentation IAM Password Without Symbold72a7869-e8b9-4e12-bcd2-e8be10b39fa7 Medium Best Practices IAM password should have the required symbols Documentation IAM Managed Policy Applied to a User0e5872b4-19a0-4165-8b2f-56d9e14b909f Medium Best Practices Make sure that any managed IAM policies are implemented in a group and not in a user. Documentation ECS No Load Balancer Attachedfb2b0ecf-1492-491a-a70d-ba1df579175d Medium Best Practices Amazon ECS service should be configured to use Load Balancing to distribute traffic evenly across the tasks, which means there must exist at least one LoadBalancer. Documentation IAM Password Without Minimum Lengthb1b20ae3-8fa7-4af5-a74d-a2145920fcb1 Medium Best Practices IAM password should have the required minimum length Documentation API Gateway With Invalid Compressiond6653eee-2d4d-4e6a-976f-6794a497999a Medium Encryption API Gateway should have valid compression, which means attribute 'MinimumCompressionSize' should be set and its value should be greater than -1 and smaller than 10485760. Documentation KMS Key Rotation Disabled235ca980-eb71-48f4-9030-df0c371029eb Medium Encryption EnableKeyRotation should not be false or undefined Documentation Neptune Database Cluster Encryption Disabledbf4473f1-c8a2-4b1b-8134-bd32efabab93 Medium Encryption Neptune database cluster storage should have encryption enabled Documentation CodeBuild Not Encryptedd7467bb6-3ed1-4c82-8095-5e7a818d0aad Medium Encryption CodeBuild Project should be encrypted, which means 'EncryptionKey' should be defined Documentation Default KMS Key Usagee52395b4-250b-4c60-81d5-2e58c1d37abc Medium Encryption When <code>StorageEncrypted</code> is set to true, <code>KmsKeyId</code> should be defined, to avoid the use of the default KMS Key Documentation SageMaker EndPoint Config Should Specify KmsKeyId Attribute44034eda-1c3f-486a-831d-e09a7dd94354 Medium Encryption KmsKeyId attribute should be defined Documentation ElasticSearch Not Encrypted At Rest86a248ab-0e01-4564-a82a-878303e253bb Medium Encryption Check if ElasticSearch encryption is disabled at Rest Documentation Unscanned ECR Image9025b2b3-e554-4842-ba87-db7aeec36d35 Medium Encryption Checks if the ECR Image has been scanned Documentation RDS Storage Encryption Disabled65844ba3-03a1-40a8-b3dd-919f122e8c95 Medium Encryption RDS DBCluster should have storage encrypted set to true Documentation Config Rule For Encrypted Volumes Disabled1b6322d9-c755-4f8c-b804-32c19250f2d9 Medium Encryption Check if AWS config rules do not identify Encrypted Volumes as a source. Documentation IAM Group Inline Policiesa58d1a2d-4078-4b80-855b-84cc3f7f4540 Medium Encryption IAM Groups should not use inline policies and instead use managed policies. If a group is deleted, the inline policy is also deleted Documentation Workspace Without Encryption89827c57-5a8a-49eb-9731-976a606d70db Medium Encryption Workspaces should have encryption enabled Documentation AmazonMQ Broker Encryption Disabled316278b3-87ac-444c-8f8f-a733a28da60f Medium Encryption AmazonMQ Broker should have Encryption Options defined Documentation ElasticSearch Encryption With KMS Disabledd926aa95-0a04-4abc-b20c-acf54afe38a1 Medium Encryption Check if any ElasticSearch domain isn't encrypted with KMS. Documentation EMR Security Configuration Encryption Disabled5b033ec8-f079-4323-b5c8-99d4620433a9 Medium Encryption EMR SecurityConfiguration should enable and properly configure encryption at rest and in transit. Documentation EBS Volume Encryption Disabled80b7ac3f-d2b7-4577-9b10-df7913497162 Medium Encryption EBS volumes should be encrypted Documentation Alexa Skill Plaintext Client Secret Exposed3c3b7a58-b018-4d07-9444-d9ee7156e111 Medium Encryption Alexa skills' client secrets should not be defined as a plaintext string. It should either use 'AWS Systems Manager Parameter Store' or 'AWS Secrets Manager' to retrieve sensitive information Documentation SQS With SSE Disabled12726829-93ed-4d51-9cbe-13423f4299e1 Medium Encryption Amazon Simple Queue Service (SQS) queue should protect the contents of their messages using Server-Side Encryption (SSE) Documentation Memcached Disableddd0971a6-09c3-4168-8474-a7ef8fbfd99d Medium Encryption Check if the Memcached is disabled on the ElastiCache Documentation ECR Image Tag Not Immutable33f41d31-86b1-46a4-81f7-9c9a671f59ac Medium Insecure Configurations ECR should have an image tag be immutable. This prevents image tags from being overwritten. Documentation IAM User Has Too Many Access Keys48677914-6fdf-40ec-80c4-2b0e94079f54 Medium Insecure Configurations Any IAM User should not have more than one access key since it increases the risk of unauthorized access and compromise credentials Documentation Inline Policies Are Attached To ECS Service9e8c89b3-7997-4d15-93e4-7911b9db99fd Medium Insecure Configurations Check if any ECS service has inline policies attached, which are embedded directly into an entity (user, group,...), instead of the equivalent recommended managed policies. Documentation API Gateway With Open Access1056dfbb-5802-4762-bf2b-8b9b9684b1b0 Medium Insecure Configurations API Gateway Method should restrict the authorization type, except for the HTTP OPTIONS method. Documentation Instance With No VPC8a6d36cd-0bc6-42b7-92c4-67acc8576861 Medium Insecure Configurations EC2 Instances should be configured under a VPC network. AWS VPCs provide the controls to facilitate a formal process for approving and testing all network connections and changes to the firewall and router configurations. Documentation Lambda Functions Without Unique IAM Rolesae03f542-1423-402f-9cef-c834e7ee9583 Medium Insecure Configurations AWS Lambda Functions should not share IAM roles to ensure they will have the minimum privileges needed to perform the required tasks Documentation GitHub Repository Set To Public5906092d-5f74-490d-9a03-78febe0f65e1 Medium Insecure Configurations Repositories must be set to private, which means the attribute 'visibility' must be set to 'private' and/or the attribute 'private' must be set to true (the attribute 'visibility' overrides 'private') Documentation EMR Cluster Without Security Configuration48af92a5-c89b-4936-bc62-1086fe2bab23 Medium Insecure Configurations EMR Cluster should have security configuration defined. Documentation SageMaker Enabling Internet Access88d55d94-315d-4564-beee-d2d725feab11 Medium Insecure Configurations SageMaker must have disabled internet access and root access for Creating Notebook Instances. Documentation API Gateway Without SSL Certificateed4c48b8-eccc-4881-95c1-09fdae23db25 Medium Insecure Configurations SSL Client Certificate should be enabled Documentation MQ Broker Is Publicly Accessible68b6a789-82f8-4cfd-85de-e95332fe6a61 Medium Insecure Configurations Check if any MQ Broker is not publicly accessible Documentation Lambda Function Without Tags8df8e857-bd59-44fa-9f4c-d77594b95b46 Medium Insecure Configurations AWS Lambda Functions must have associated tags. Documentation IAM User LoginProfile Password Is In Plaintext06adef8c-c284-4de7-aad2-af43b07a8ca1 Medium Insecure Configurations IAM User LoginProfile Password must not be a plaintext string Documentation RouterTable with Default Routing4f0908b9-eb66-433f-9145-134274e1e944 Medium Insecure Defaults NAT gateways are recommended, and not the default route which permits all traffic, in Route Tables. Documentation S3 Bucket Should Have Bucket Policy37fa8188-738b-42c8-bf82-6334ea567738 Medium Insecure Defaults Checks if S3 Bucket has the same name as a Bucket Policy, if it has, S3 Bucket has a Bucket Policy associated Documentation Security Group Egress With All Protocolsee464fc2-54a6-4e22-b10a-c6dcd2474d0c Medium Networking and Firewall AWS Security Group Egress should not specify all protocols to prevent allow traffic on all ports Documentation API Gateway without WAFfcbf9019-566c-4832-a65c-af00d8137d2b Medium Networking and Firewall API Gateway should have WAF (Web Application Firewall) enabled Documentation ELB With Security Group Without Outbound Rules01d5a458-a6c4-452a-ac50-054d59275b7c Medium Networking and Firewall An AWS Elastic Load Balancer (ELB) shouldn\u00b4t have security groups without outbound rules Documentation ELB With Security Group Without Inbound Rulese200a6f3-c589-49ec-9143-7421d4a2c845 Medium Networking and Firewall An AWS Elastic Load Balancer (ELB) shouldn\u00b4t have security groups without outbound rules Documentation Security Groups Without VPC Attached493d9591-6249-47bf-8dc0-5c10161cc558 Medium Networking and Firewall Security Groups must have a VPC. Documentation VPC Without Network Firewall3e293410-d5b8-411f-85fd-7d26294f20c9 Medium Networking and Firewall VPC should have a Network Firewall associated Documentation Security Group Ingress With All Protocols1a427b25-2e9e-4298-9530-0499a55e736b Medium Networking and Firewall AWS Security Group Ingress should not specify all protocols to prevent allow traffic on all ports Documentation API Gateway Endpoint Config is Not Private4a8daf95-709d-4a36-9132-d3e19878fa34 Medium Networking and Firewall The API Endpoint type in API Gateway should be set to PRIVATE so it's not exposed to the public internet Documentation Security Group Ingress With Port Range87482183-a8e7-4e42-a566-7a23ec231c16 Medium Networking and Firewall AWS Security Group Ingress should have a single port Documentation GameLift Fleet EC2 InboundPermissions With Port Range43356255-495d-4148-ad8d-f6af5eac09dd Medium Networking and Firewall AWS GameLift Fleet EC2InboundPermissions should have a single port Documentation TCP/UDP Protocol Network ACL Entry Allows All Portsf57f849c-883b-4cb7-85e7-f7b199dff163 Medium Networking and Firewall TCP/UDP protocol AWS Network ACL Entry should not allow all ports Documentation EC2 Permissive Network ACL Protocols03879981-efa2-47a0-a818-c843e1441b88 Medium Networking and Firewall To avoid opening all ports for Allow rules, EC2 NetworkACL Entry Protocol should be either 6 (for TCP), 17 (for UDP), 1 (for ICMP), or 58 (for ICMPv6, which must include an IPv6 CIDR block, ICMP type, and code). Documentation Security Group Egress With Port Rangedae9c373-8287-462f-8746-6f93dad93610 Medium Networking and Firewall AWS Security Group Egress should have a single port Documentation ALB Is Not Integrated With WAF105ba098-1e34-48cd-b0f2-a8a43a51bf9b Medium Networking and Firewall All Application Load Balancers (ALB) must be protected with Web Application Firewall (WAF) service Documentation Security Group Egress CIDR Open To World1cc2fbd7-816c-4fbf-ad6d-38a4afa4312a Medium Networking and Firewall AWS Security Group Egress CIDR should not be open to the world Documentation API Gateway Deployment Without Access Log Setting06ec63e3-9f72-4fe2-a218-2eb9200b8db5 Medium Observability API Gateway Deployment should have access log setting defined when connected to an API Gateway Stage. Documentation API Gateway V2 Stage Access Logging Settings Not Defined80d45af4-4920-4236-a56e-b7ef419d1941 Medium Observability API Gateway V2 Stage should have Access Logging Settings defined. Documentation Stack Notifications Disabled837e033c-4717-40bd-807e-6abaa30161b7 Medium Observability AWS CloudFormation should have stack notifications enabled to be notified when an event occurs Documentation API Gateway X-Ray Disabled4ab10c48-bedb-4deb-8f3b-ff12783b61de Medium Observability API Gateway should have X-Ray Tracing enabled Documentation MSK Cluster Logging Disabledfc7c2c15-f5d0-4b80-adb2-c89019f8f62b Medium Observability Ensure MSK Cluster Logging is enabled Documentation CloudWatch Logging Disabled0f0fb06b-0f2f-4374-8588-f2c7c348c7a0 Medium Observability Check if CloudWatch logging is disabled for Route53 hosted zones Documentation CloudTrail Not Integrated With CloudWatch65d07da5-9af5-44df-8983-52d2e6f24c44 Medium Observability CloudTrail should be integrated with CloudWatch Documentation Configuration Aggregator to All Regions Disabled9f3cf08e-72a2-4eb1-8007-e3b1b0e10d4d Medium Observability AWS Config Configuration Aggregator All Regions must be set to True Documentation CloudWatch Metrics Disabled5d3c1807-acb3-4bb0-be4e-0440230feeaf Medium Observability Checks if CloudWatch Metrics is Enabled Documentation ELBv2 ALB Access Log Disabledc62e8b7d-1fdf-4050-ac4c-76ba9e1d9621 Medium Observability ELBv2 ALBs should have access log enabled to capture detailed information about requests sent to your load balancer. Documentation S3 Bucket Logging Disabled4552b71f-0a2a-4bc4-92dd-ed7ec1b4674c Medium Observability Server Access Logging should be enabled on S3 Buckets so that all changes are logged and trackable Documentation S3 Bucket Without Versioninga227ec01-f97a-4084-91a4-47b350c1db54 Medium Observability S3 bucket should have versioning enabled Documentation Redshift Cluster Logging Disabled3de2d4ff-fe53-4fc9-95d3-2f8a69bf90d6 Medium Observability Make sure Logging is enabled for Redshift Cluster Documentation CloudTrail Multi Region Disabled058ac855-989f-4378-ba4d-52d004020da7 Medium Observability CloudTrail multi region should be enabled, which means attribute 'IsMultiRegionTrail' should be set to true Documentation MQ Broker Logging Disablede519ed6a-8328-4b69-8eb7-8fa549ac3050 Medium Observability Check if MQ Brokers don't have logging enabled in any of the two options possible (audit and general). Documentation CloudFront Logging Disabledde77cd9f-0e8b-46cc-b4a4-b6b436838642 Medium Observability AWS CloudFront distributions should have logging enabled to collect all viewer requests, which means the attribute 'DistributionConfig.Logging' should be defined Documentation ELB Access Log Disabledee12ad32-2863-4c0f-b13f-28272d115028 Medium Observability ELB should have access log enabled Documentation CloudTrail SNS Topic Name Undefined3e09413f-471e-40f3-8626-990c79ae63f3 Medium Observability Check if SNS topic name is set for CloudTrail Documentation GuardDuty Detector Disableda25cd877-375c-4121-a640-730929936fac Medium Observability Make sure that Amazon GuardDuty is Enabled Documentation ElasticSearch Without Slow Logs086ea2eb-14a6-4fd4-914b-38e0bc8703e8 Medium Observability Ensure that AWS Elasticsearch enables support for slow logs Documentation SNS Topic Without KmsMasterKeyId9d13b150-a2ab-42a1-b6f4-142e41f81e52 Medium Secret Management KmsMasterKeyId attribute should not be undefined Documentation Directory Service Microsoft AD Password Set to Plaintext or Default Ref06b9f52a-8cd5-459b-bdc6-21a22521e1be Medium Secret Management Directory Service Microsoft AD password must not be a plaintext string or a Ref to a Parameter with a Default value. Documentation DocDB Cluster Master Password In Plaintext39423ce4-9011-46cd-b6b1-009edcd9385d Medium Secret Management DocDB DB Cluster master user password must not be in a plain text string or referenced in a parameter as a default value. Documentation DMS Endpoint MongoDB Settings Password Exposedf988a17f-1139-46a3-8928-f27eafd8b024 Medium Secret Management DMS Endpoint MongoDbSettings Password must not be a plaintext string or a Ref to a Parameter with a Default value. Documentation Amplify App OAuth Token Exposed03b38885-8f4e-480c-a0e4-12c1affd15db Medium Secret Management Amplify App OAuth Token must not be a plaintext string or a Ref to a Parameter with a Default value. Documentation High Access Key Rotation Period800fa019-49dd-421b-9042-7331fdd83fa2 Medium Secret Management ConfigRule should enforce access keys to be rotated within 90 days. Documentation Amplify App Basic Auth Config Password Exposed71493c8b-3014-404c-9802-078b74496fb7 Medium Secret Management Amplify App BasicAuthConfig Password must not be a plaintext string or a Ref to a Parameter with a Default value. Documentation Hardcoded AWS Access Key In Lambda2564172f-c92b-4261-9acd-464aed511696 Medium Secret Management Lambda access/secret keys should not be hardcoded Documentation EBS Volume Without KmsKeyIdb7063015-6c31-4658-a8e7-14f98f37fd42 Medium Secret Management EBS Volume should specify a KmsKeyId value Documentation Secrets Manager Should Specify KmsKeyIdc8ae9ba9-c2f7-4e5c-b32e-a4b7712d4d22 Medium Secret Management Secrets Manager Secret should explicitly specify KmsKeyId, this will allow the secret to be shared cross-account Documentation Amplify Branch Basic Auth Config Password Exposeddfb56e5d-ee68-446e-b32a-657b62befe69 Medium Secret Management Amplify Branch BasicAuthConfig Password must not be a plaintext string or a Ref to a Parameter with a Default value. Documentation Directory Service Simple AD Password Exposed6685d912-d81f-4cfa-95ad-e316ea31c989 Medium Secret Management DirectoryService SimpleAD password must not be a plaintext string or a Ref to a Parameter with a Default value. Documentation RefreshToken Is Exposed5b48c507-0d1f-41b0-a630-76817c6b4189 Medium Secret Management Alexa ASK Skill AuthenticationConfiguration RefreshToken should not be a plaintext string Documentation Amplify App Access Token Exposed73980e43-f399-4fcc-a373-658228f7adf7 Medium Secret Management Amplify App Access Token must not be in a plain text string or referenced in a parameter as a default value. Documentation DMS Endpoint Password Exposed5f700072-b7ce-4e84-b3f3-497bf1c24a4d Medium Secret Management DMS Endpoint password must not be a plaintext string or a Ref to a Parameter with a Default value. Documentation IAM Group Without Users8f957abd-9703-413d-87d3-c578950a753c Low Access Control IAM Group should have at least one user associated Documentation IAM User With No Group06933df4-0ea7-461c-b9b5-104d27390e0e Low Access Control A IAM user should belong to a group Documentation Support Has No Role Associatedd71b5fd7-9020-4b2d-9ec8-b3839faa2744 Low Access Control Check if any AWS Support policy does not have any role and users and group associated, which means that is not being managed. Documentation IAM Policy Grants 'AssumeRole' Permission Across All Servicese835bd0d-65da-49f7-b6d1-b646da8727e6 Low Access Control IAM Policy should not grant 'AssumeRole' permission across all services. Documentation EC2 Instance Using Default Security Group08b81bb3-0985-4023-8602-b606ad81d279 Low Access Control EC2 instances should not use default security group(s) Documentation IAM Role Allows All Principals To Assumef80e3aa7-7b34-4185-954e-440a6894dde6 Low Access Control IAM role allows all services or principals to assume it Documentation VPC Attached With Too Many Gateways97e94d17-e2c7-4109-a53b-6536ac1bb64e Low Availability The number of gateways attached should not approach or go beyond the limit of 3, in a particular VPC Documentation RDS DB Instance With Deletion Protection Disabled2c161e58-cb52-454f-abea-6470c37b5e6e Low Backup RDS DBInstance should have deletion protection set to true Documentation IAM Access Analyzer Not Enabled8d29754a-2a18-460d-a1ba-9509f8d359da Low Best Practices IAM Access Analyzer should be enabled and configured to continuously monitor resource permissions Documentation Automatic Minor Upgrades Disabledf0104061-8bfc-4b45-8a7d-630eb502f281 Low Best Practices RDS instance should have automatic minor upgrades enabled, which means the attribute 'AutoMinorVersionUpgrade' must be set to true. Documentation CDN Configuration Is Missinge4f54ff4-d352-40e8-a096-5141073c37a2 Low Best Practices Content Delivery Network (CDN) service is used within an AWS account to secure and accelerate the delivery of websites. The use of a CDN can provide a layer of security between your origin content and the destination. Documentation Security Group Ingress Has CIDR Not Recommendeda3e4e39a-e5fc-4ee9-8cf5-700febfa86dd Low Best Practices AWS Security Group Ingress CIDR should not be /32 in case of IPV4 or /128 in case of IPV6 Documentation IAM Policies Without Groups5e7acff5-095b-40ac-9073-ac2e4ad8a512 Low Best Practices IAM policy should not apply directly to users, should be with a group Documentation Geo Restriction Disabled7f8843f0-9ea5-42b4-a02b-753055113195 Low Best Practices Geo Restriction feature should be enabled, to restrict or allow users in specific locations accessing web application content Documentation Lambda Permission Misconfigured9b83114b-b2a1-4534-990d-06da015e47aa Low Best Practices Lambda permission may be misconfigured if the action field is not filled in by 'lambda:InvokeFunction' Documentation DynamoDB With Not Recommented Table Billing Modec333e906-8d8b-4275-b999-78b6318f8dc6 Low Build Process Checks if DynamoDB Table Billing Mode is set to either PAY_PER_REQUEST or PROVISIONED Documentation EFS Without Tags08e39832-5e42-4304-98a0-aa5b43393162 Low Build Process Amazon Elastic Filesystem should have filesystem tags associated Documentation CloudTrail Log Files Not Encrypted With KMS050a9ba8-d1cb-4c61-a5e8-8805a70d3b85 Low Encryption Logs delivered by CloudTrail should be encrypted using KMS to increase security of your CloudTrail Documentation S3 Bucket Without Ignore Public ACL6c8d51af-218d-4bfb-94a9-94eabaa0703a Low Insecure Configurations S3 bucket without ignore public ACL Documentation API Gateway Cache Cluster Disabled52790cad-d60d-41d5-8483-146f9f21208d Low Insecure Configurations AWS API Gateway should have cache clustering enabled Documentation Wildcard In ACM Certificate Domain Namecc8b294f-006f-4f8f-b5bb-0a9140c33131 Low Insecure Configurations ACM Certificate should not use wildcards (*) in the domain name Documentation Lambda Function Without Dead Letter Queuec2eae442-d3ba-4cb1-84ca-1db4f80eae3d Low Insecure Configurations AWS Lambda Function should be configured for a Dead Letter Queue(DLQ) Documentation RDS Using Default Port1fe9d958-ddce-4228-a124-05265a959a8b Low Networking and Firewall RDS should not use the default port (an attacker can easily guess the port). For engines related to Aurora, MariaDB or MySQL, the default port is 3306. PostgreSQL default port is 5432, Oracle default port is 1521 and SQL Server default port is 1433 Documentation EMR Without VPCbf89373a-be40-4c04-99f5-746742dfd7f3 Low Networking and Firewall Elastic MapReduce Cluster (EMR) should be launched in a Virtual Private Cloud (VPC) Documentation ElastiCache Without VPCba766c53-fe71-4bbb-be35-b6803f2ef13e Low Networking and Firewall ElastiCache should be launched in a Virtual Private Cloud (VPC) Documentation EC2 Network ACL Duplicate Rule045ddb54-cfc5-4abb-9e05-e427b2bc96fe Low Networking and Firewall A Network ACL's rule numbers cannot be repeated unless one is egress and the other is ingress Documentation CloudFront Without WAF0f139403-303f-467c-96bd-e717e6cfd62d Low Networking and Firewall All AWS CloudFront distributions should be integrated with the Web Application Firewall (AWS WAF) service Documentation ElastiCache Using Default Port323db967-c68e-44e6-916c-a777f95af34b Low Networking and Firewall ElastiCache should not use the default port (an attacker can easily guess the port). For engine set to Redis, the default port is 6379. The Memcached default port is 11211 Documentation EC2 Instance Using Default VPCe42a3ef0-5325-4667-84bf-075ba1c9d58e Low Networking and Firewall EC2 Instances should not be configured under a default VPC network Documentation Redshift Using Default Porta478af30-8c3a-404d-aa64-0b673cee509a Low Networking and Firewall Redshift should not use the default port (5439) because an attacker can easily guess the port Documentation Shield Advanced Not In Usead7444cf-817a-4765-a79e-2145f7981faf Low Networking and Firewall AWS Shield Advanced should be used for Amazon Route 53 hosted zone, AWS Global Accelerator accelerator, Elastic IP Address, Elastic Load Balancing, and Amazon CloudFront Distribution to protect these resources against robust DDoS attacks Documentation CloudTrail Log File Validation Disabled2a3560fe-52ca-4443-b34f-bf0ed5eb74c8 Low Observability CloudTrail log file validation should be enabled to determine whether a log file has not been tampered Documentation API Gateway Deployment Without API Gateway UsagePlan Associated783860a3-6dca-4c8b-81d0-7b62769ccbca Low Observability API Gateway Deployment should have API Gateway UsagePlan defined and associated. Documentation VPC FlowLogs Disabledf6d299d2-21eb-41cc-b1e1-fe12d857500b Low Observability Every VPC resource should have an associated Flow Log Documentation Lambda Functions Without X-Ray Tracing9488c451-074e-4cd3-aee3-7db6104f542c Low Observability AWS Lambda functions should have TracingConfig enabled. For this, property 'tracingConfig.mode' should have the value 'Active' Documentation ECS Task Definition HealthCheck Missingd24389b4-b209-4ff0-8345-dc7a4569dcdd Low Observability Amazon ECS must have the HealthCheck property defined to give more control over monitoring the health of tasks Documentation API Gateway Stage Without API Gateway UsagePlan Associated7f8f1b60-43df-4c28-aa21-fb836dbd8071 Low Resource Management API Gateway Stage should have API Gateway UsagePlan defined and associated. Documentation VPC Without Attached Subnet3b3b4411-ad1f-40e7-b257-a78a6bb9673a Low Resource Management VPCs without attached subnets may indicate that they are not being used Documentation SDB Domain Declared As A Resource6ea57c8b-f9c0-4ec7-bae3-bd75a9dee27d Low Resource Management SimpleDB Domain resource should not be declared Documentation ECS Task Definition Invalid CPU or Memoryf4c9b5f5-68b8-491f-9e48-4f96644a1d51 Low Resource Management In ECS Task Definition of FARGATE launch type if you specify an invalid CPU or Memory value, you will receive an error Documentation Security Group Rule Without Description5e6c9c68-8a82-408e-8749-ddad78cbb9c5 Info Best Practices It's considered a best practice for AWS Security Group to have a description Documentation EC2 Not EBS Optimized8dd0ff1f-0da4-48df-9bb3-7f338ae36a40 Info Best Practices It's considered a best practice for an EC2 instance to use an EBS optimized instance. This provides the best performance for your EBS volumes by minimizing contention between Amazon EBS I/O and other traffic from your instance Documentation"},{"location":"queries/cloudformation-queries/#aws_bom","title":"AWS_BOM","text":"<p>Bellow are listed queries related with CloudFormation AWS_BOM:</p> Query Severity Category Description Help BOM - AWS DynamoDB4e67c0ae-38a0-47f4-a50c-f0c9b75826df Trace Bill Of Materials A list of DynamoDB resources found. Amazon DynamoDB is a fully managed, serverless, key-value NoSQL database designed to run high-performance applications at any scale. Documentation BOM - AWS MQ209189f3-c879-48a7-9703-fbcfa96d0cef Trace Bill Of Materials A list of MQ resources found. Amazon MQ is a managed message broker service for Apache ActiveMQ and RabbitMQ that makes it easy to set up and operate message brokers on AWS. Documentation BOM - AWS Cassandra124b173b-e06d-48a6-8acd-f889443d97a4 Trace Bill Of Materials A list of Cassandra resources found. Amazon Cassandra is an open-source NoSQL database designed to store data for applications that require fast read and write performance Documentation BOM - AWS RDS6ef03ff6-a2bd-483c-851f-631f248bc0ea Trace Bill Of Materials A list of RDS resources found. Amazon Relational Database Service (Amazon RDS) is a collection of managed services that makes it simple to set up, operate, and scale databases in the cloud. Documentation BOM - AWS Elasticachec689f51b-9203-43b3-9d8b-caed123f706c Trace Bill Of Materials A list of Elasticache resources found. Amazon ElastiCache is a fully managed, in-memory caching service supporting flexible, real-time use cases. You can use ElastiCache for caching, which accelerates application and database performance, or as a primary data store for use cases that don't require durability like session stores, gaming leaderboards, streaming, and analytics. ElastiCache is compatible with Redis and Memcached. Documentation BOM - AWS SNS42e7dca3-8cce-4325-8df0-108888259136 Trace Bill Of Materials A list of SNS resources specified. Amazon Simple Notification Service (Amazon SNS) is a fully managed messaging service for both application-to-application (A2A) and application-to-person (A2P) communication. Documentation BOM - AWS EFSef05a925-8568-4054-8ff1-f5ba82631c16 Trace Bill Of Materials A list of EFS resources found. Amazon Elastic File System (Amazon EFS) automatically grows and shrinks as you add and remove files with no need for management or provisioning. Documentation BOM - AWS Kinesisd53323be-dde6-4457-9a43-42df737e71d2 Trace Bill Of Materials A list of Kinesis resources found. Amazon Kinesis is a real-time streaming service that provides collection, processing, and analysis of video and data streams in real-time Documentation BOM - AWS MSK2730c169-51d7-4ae7-99b5-584379eff1bb Trace Bill Of Materials A list of MSK resources specified. Amazon Managed Streaming for Apache Kafka (Amazon MSK) is a fully managed service that enables you to build and run applications that use Apache Kafka to process streaming data. Documentation BOM - AWS EBS0b0556ea-9cd9-476f-862e-20679dda752b Trace Bill Of Materials A list of EBS resources found. Amazon Elastic Block Store (Amazon EBS) is an easy-to-use, scalable, high-performance block-storage service designed for Amazon Elastic Compute Cloud (Amazon EC2). Documentation BOM - AWS S3 Bucketsb5d6a2e0-8f15-4664-bd5b-68ec5c9bab83 Trace Bill Of Materials A list of S3 resources found. Amazon Simple Storage Service (Amazon S3) is an object storage service that offers industry-leading scalability, data availability, security, and performance. Documentation BOM - AWS SQS59a849c2-1127-4023-85a5-ef906dcd458c Trace Bill Of Materials A list of SQS resources specified. Amazon Simple Queue Service (SQS) is a fully managed message queuing service that enables you to decouple and scale microservices, distributed systems, and serverless applications. Documentation"},{"location":"queries/cloudformation-queries/#aws_sam","title":"AWS_SAM","text":"<p>Bellow are listed queries related with CloudFormation AWS_SAM:</p> Query Severity Category Description Help Serverless Function Environment Variables Not Encrypteda7f8ac28-eed1-483d-87c8-4c325f022572 High Encryption AWS Serverless Function should encrypt environment variables Documentation Serverless API Without Content Encodinga2f2800e-614b-4bc8-89e6-fec8afd24800 Medium Encryption AWS Serverless API should enable Content Encoding through the attribute 'MinimumCompressionSize'. This value should be greater than -1 and smaller than 10485760 Documentation Serverless Function Without Unique IAM Role4ba74f01-aba5-4be2-83bc-be79ff1a3b92 Medium Insecure Configurations AWS Serverless Function should not share IAM Role to ensure it will have the minimum privileges needed to perform the required tasks Documentation Serverless Function Without Tagsa71ecabe-03b6-456a-b3bc-d1a39aa20c98 Medium Insecure Configurations AWS Serverless Function should have associated tags Documentation Serverless API Endpoint Config Not Private6b5b0313-771b-4319-ad7a-122ee78700ef Medium Networking and Firewall AWS Serverless API should set API Endpoint Config type to 'PRIVATE'. This way, it's not exposed to the public internet Documentation Serverless API Access Logging Setting Undefined0a994e04-c6dc-471d-817e-d37451d18a3b Medium Observability AWS Serverless API/AWS Serverless HTTP API should have Access Logging Setting(s) defined Documentation Serverless API X-Ray Tracing Disabledc757c6a3-ac87-4b9d-b28d-e5a5add6a315 Medium Observability AWS Serverless API should have X-Ray Tracing enabled Documentation Serverless API Cache Cluster Disabled60a05ede-0a68-4d0d-a58f-f538cf55ff79 Low Insecure Configurations AWS Serverless API should have cache clustering enabled Documentation Serverless Function Without Dead Letter Queuecb2f612b-ed42-4ff5-9fb9-255c73d39a18 Low Insecure Configurations AWS Serverless Function should be configured for a Dead Letter Queue(DLQ) Documentation Serverless Function Without X-Ray Tracingdc1ab429-1481-4540-9b1d-280e3f15f1f8 Low Observability AWS Serverless Function should have Tracing enabled. For this, property 'Tracing' should have the value 'Active' Documentation"},{"location":"queries/common-queries/","title":"Common","text":""},{"location":"queries/common-queries/#common_queries_list","title":"Common Queries List","text":"<p>This page contains all queries from Common.</p> Query Severity Category Description Help Passwords And Secretsa88baa34-e2ad-44ea-ad6f-8cac87bc7c71 High Secret Management Query to find passwords and secrets in infrastructure code. Documentation"},{"location":"queries/crossplane-queries/","title":"Crossplane queries","text":""},{"location":"queries/crossplane-queries/#crossplane_queries_list","title":"Crossplane Queries List","text":"<p>This page contains all queries from Crossplane.</p>"},{"location":"queries/crossplane-queries/#aws","title":"AWS","text":"<p>Bellow are listed queries related with Crossplane AWS:</p> Query Severity Category Description Help EFS Without KMSbdecd6db-2600-47dd-a10c-72c97cf17ae9 High Encryption Amazon Elastic Filesystem should have filesystem encryption enabled using KMS CMK customer-managed keys instead of AWS managed-keys Documentation DB Instance Storage Not Encryptede50eb68a-a4af-4048-8bbe-8ec324421469 High Encryption RDS Instance should have its storage encrypted by setting the parameter to 'true'. The storageEncrypted default value is 'false'. Documentation ELB Using Weak Ciphersa507daa5-0795-4380-960b-dd7bb7c56661 High Encryption ELB Predefined or Custom Security Policies must not use weak ciphers, to reduce the risk of the SSL connection between the client and the load balancer being exploited. That means the 'sslPolicy' of 'Listener' must not coincide with any of a predefined list of weak ciphers. Documentation EFS Not Encrypted72840c35-3876-48be-900d-f21b2f0c2ea1 High Encryption Elastic File System (EFS) must be encrypted Documentation CloudFront Without Minimum Protocol TLS 1.2255b0fcc-9f82-41fe-9229-01b163e3376b High Insecure Configurations CloudFront Minimum Protocol version should be at least TLS 1.2 Documentation DB Security Group Has Public Interfacedd667399-8d9d-4a8d-bbb4-e49ab53b2f52 High Insecure Configurations The CIDR IP should not be a public interface Documentation Neptune Database Cluster Encryption Disabled83bf5aca-138a-498e-b9cd-ad5bc5e117b4 Medium Encryption Neptune database cluster storage should have encryption enabled Documentation SQS With SSE Disabled9296f1cc-7a40-45de-bd41-f31745488a0e Medium Encryption Amazon Simple Queue Service (SQS) queue should protect the contents of their messages using Server-Side Encryption (SSE) Documentation CloudFront Logging Disabled7b590235-1ff4-421b-b9ff-5227134be9bb Medium Observability AWS CloudFront distributions should have logging enabled to collect all viewer requests, which means the attribute 'logging' must be defined with 'enabled' set to true Documentation CloudWatch Without Retention Period Specified934613fe-b12c-4e5a-95f5-c1dcdffac1ff Medium Observability AWS CloudWatch should have CloudWatch Logs enabled in order to monitor, store, and access log events Documentation CloudFront Without WAF6d19ce0f-b3d8-4128-ac3d-1064e0f00494 Low Networking and Firewall All AWS CloudFront distributions should be integrated with the Web Application Firewall (AWS WAF) service Documentation"},{"location":"queries/crossplane-queries/#gcp","title":"GCP","text":"<p>Bellow are listed queries related with Crossplane GCP:</p> Query Severity Category Description Help Cloud Storage Bucket Logging Not Enabled6c2d627c-de0f-45fb-b33d-dad9bffbb421 High Observability Cloud storage bucket should have logging enabled Documentation Google Container Node Pool Auto Repair Disabledb4f65d13-a609-4dc1-af7c-63d2e08bffe9 Medium Insecure Configurations Google Container Node Pool Auto Repair should be enabled. This service periodically checks for failing nodes and repairs them to ensure a smooth running state. Documentation"},{"location":"queries/crossplane-queries/#azure","title":"AZURE","text":"<p>Bellow are listed queries related with Crossplane AZURE:</p> Query Severity Category Description Help AKS RBAC Disabledb2418936-cd47-4ea2-8346-623c0bdb87bd Medium Access Control Azure Container Service (AKS) instance should have role-based access control (RBAC) enabled Documentation Redis Cache Allows Non SSL Connections6c7cfec3-c686-4ed2-bf58-a1ec054b63fc Medium Encryption Redis Cache resource should not allow non-SSL connections. Documentation"},{"location":"queries/dockercompose-queries/","title":"Docker Compose","text":""},{"location":"queries/dockercompose-queries/#dockercompose_queries_list","title":"DockerCompose Queries List","text":"<p>This page contains all queries from DockerCompose.</p> Query Severity Category Description Help Volume Has Sensitive Host Directory1c1325ff-831d-43a1-973e-839ae57dfcc0 High Build Process Container has sensitive host directory mounted as a volume Documentation Volume Mounted In Multiple Containersbaa452f0-1f21-4a25-ace5-844e7a5f410d High Build Process Volume mounts should not be shared, which means that 'propagation' should not be set to 'shared', 'rshared', 'slave', or 'rslave' Documentation Docker Socket Mounted In Containerd6355c88-1e8d-49e9-b2f2-f8a1ca12c75b High Build Process Docker socket docker.sock should not be mounted on host. If the docker socket is mounted, it can allow its processes to execute docker commands. Documentation No New Privileges Not Set27fcc7d6-c49b-46e0-98f1-6c082a6a2750 High Resource Management Ensuring the process does not gain any new privileges lessens the risk associated with many operations. Documentation Privileged Containers Enabledae5b6871-7f45-42e0-bb4c-ab300c4d2026 High Resource Management Privileged containers should be used with extreme caution, they have all of the capabilities that the linux kernel offers for docker. Documentation Healthcheck Not Set698ed579-b239-4f8f-a388-baa4bcb13ef8 Medium Availability Check containers periodically to see if they are running properly. Documentation Restart Policy On Failure Not Set To 52fc99041-ddad-49d5-853f-e35e70a48391 Medium Build Process Attribute 'restart:on-failure' should be set to 5. Restart policies in general should be used, and 5 retries is the recommended by CIS. Documentation Cgroup Not Default4d9f44c6-2f4a-4317-9bb5-267adbea0232 Medium Build Process Control groups restrict the access processes and containers have to system resources such as CPU, RAM, IOPS and network. Not having a cgroup well configured may prove to be a security fault. Documentation Privileged Ports Mapped In Containerbc2908f3-f73c-40a9-8793-c1b7d5544f79 Medium Networking and Firewall Privileged ports (1 to 1023) should not be mapped. Also you should drop net_bind_service linux capability from the container unless you absolutely need to use priviledged ports. Documentation Networks Not Setce14a68b-1668-41a0-ab7d-facd9f784742 Medium Networking and Firewall Setting networks in services ensures you are not using dockers default bridge (docker0), which shares traffic bewteen all containers. Documentation Container Traffic Not Bound To Host Interface451d79dc-0588-476a-ad03-3c7f0320abb3 Medium Networking and Firewall Incoming container traffic should be bound to a specific host interface Documentation Security Opt Not Set610e266e-6c12-4bca-9925-1ed0cd29742b Medium Resource Management Attribute 'security_opt' should be defined. Documentation Shared Host User Namespace8af7162d-6c98-482f-868e-0d33fb675ca8 Medium Resource Management The host's user namespace should not be shared. Documentation Host Namespace is Shared4f31dd9f-2cc3-4751-9b53-67e4af83dac0 Medium Resource Management The hosts process namespace should not be shared by containers Documentation Shared Host Network Namespace071a71ff-f868-47a4-ac0b-3c59e4ab5443 Medium Resource Management Container should not share the host network namespace Documentation Memory Not Limitedbb9ac4f7-e13b-423d-a010-c74a1bfbe492 Medium Resource Management Memory limits should be defined for each container. This prevents potential resource exhaustion by ensuring that containers consume not more than the designated amount of memory Documentation Shared Host IPC Namespacebaa3890f-bed7-46f5-ab8f-1da8fc91c729 Medium Resource Management Container should not share the host IPC namespace Documentation Default Seccomp Profile Disabled404fde2c-bc4b-4371-9747-7054132ac953 Medium Resource Management Seccomp offers a whitelist of common system calls, blocking all others. Having less kernel exposed to an app then increases security. Documentation Pids Limit Not Set221e0658-cb2a-44e3-b08a-db96a341d6fa Medium Resource Management 'pids_limit' should be set and different than -1 Documentation Container Capabilities Unrestrictedce76b7d0-9e77-464d-b86f-c5c48e03e22d Low Resource Management Some capabilities are not needed in certain (or any) containers. Make sure that you only add capabilities that your container needs. Drop unnecessary capabilities as well. Documentation Cpus Not Limited6b610c50-99fb-4ef0-a5f3-e312fd945bc3 Low Resource Management CPU limits should be set because if the system has CPU time free, a container is guaranteed to be allocated as much CPU as it requests Documentation"},{"location":"queries/dockerfile-queries/","title":"Dockerfile","text":""},{"location":"queries/dockerfile-queries/#dockerfile_queries_list","title":"Dockerfile Queries List","text":"<p>This page contains all queries from Dockerfile.</p> Query Severity Category Description Help UNIX Ports Out Of Range71bf8cf8-f0a1-42fa-b9d2-d10525e0a38e High Availability Exposing UNIX ports out of range from 0 to 65535 Documentation Multiple ENTRYPOINT Instructions Listed6938958b-3f1a-451c-909b-baeee14bdc97 High Build Process There can only be one ENTRYPOINT instruction in a Dockerfile. Only the last ENTRYPOINT instruction in the Dockerfile will have an effect Documentation Copy With More Than Two Arguments Not Ending With Slash6db6e0c2-32a3-4a2e-93b5-72c35f4119db High Build Process When a COPY command has more than two arguments, the last one should end with a slash Documentation COPY '--from' References Current FROM Aliascdddb86f-95f6-4fc4-b5a1-483d9afceb2b High Build Process COPY '--from' should not mention the current FROM alias, since it is impossible to copy from itself Documentation Missing User Instructionfd54f200-402c-4333-a5a4-36ef6709af2f High Build Process A user should be specified in the dockerfile, otherwise the image will run as root Documentation Same Alias In Different Fromsf2daed12-c802-49cd-afed-fe41d0b82fed High Build Process Different FROMS cant have the same alias defined Documentation WORKDIR Path Not Absolute6b376af8-cfe8-49ab-a08d-f32de23661a4 High Build Process For clarity and reliability, you should always use absolute paths for your WORKDIR Documentation Run Using Sudo8ada6e80-0ade-439e-b176-0b28f6bce35a High Insecure Configurations Avoid RUN with sudo command as it leads to unpredictable behavior Documentation Vulnerable OpenSSL Version5fa731ea-e844-47a6-a1e8-abc25e95847e High Supply-Chain OpenSSL versions from 3.0.0 to 3.0.5 are affected by a critical vulnerability Documentation Last User Is 'root'67fd0c4a-68cf-46d7-8c41-bc9fba7e40ae Medium Best Practices Leaving the last user as root can cause security risks. Change to another user after running the commands the need privileges Documentation Changing Default Shell Using RUN Command8a301064-c291-4b20-adcb-403fe7fd95fd Medium Best Practices Using the command RUN to override the default shell instead of the SHELL command leads to inefficiencies. It also does not make sense since Docker provides the SHELL command for this exact purpose. Documentation Multiple CMD Instructions Listed41c195f4-fc31-4a5c-8a1b-90605538d49f Medium Build Process There can only be one CMD instruction in a Dockerfile. If you list more than one CMD then only the last CMD will take effect Documentation Update Instruction Alone9bae49be-0aa3-4de5-bab2-4c3a069e40cd Medium Build Process Instruction 'RUN  update' should always be followed by ' install' in the same RUN statement Documentation Not Using JSON In CMD And ENTRYPOINT Argumentsb86987e1-6397-4619-81d5-8807f2387c79 Medium Build Process Ensure that we are using JSON in the CMD and ENTRYPOINT Arguments Documentation RUN Instruction Using 'cd' Instead of WORKDIRf4a6bcd3-e231-4acf-993c-aa027be50d2e Medium Build Process When using RUN command 'cd' should only be used for full path. For relative path make use of WORKDIR command instead. Documentation Shell Running A Pipe Without Pipefail Flagefbf148a-67e9-42d2-ac47-02fa1c0d0b22 Medium Insecure Defaults Check if shell commands with pipes (except Powershell) have the pipefail flag set (-o). Documentation Missing Flag From Dnf Install7ebd323c-31b7-4e5b-b26f-de5e9e477af8 Medium Supply-Chain The '-y' or '--assumeyes' flag should be added when invoking dnf install. If omitted, it can cause the command to fail during the build process, because dnf would expect manual input. Documentation Unpinned Package Version in Pip Install02d9c71f-3ee8-4986-9c27-1a20d0d19bfc Medium Supply-Chain Package version pinning reduces the range of versions that can be installed, reducing the chances of failure due to unanticipated changes Documentation Missing Dnf Clean All295acb63-9246-4b21-b441-7c1f1fb62dc0 Medium Supply-Chain Cached package data should be cleaned after installation to reduce image size Documentation Gem Install Without Version22cd11f7-9c6c-4f6e-84c0-02058120b341 Medium Supply-Chain Instead of 'gem install ' we should use 'gem install :' Documentation Unpinned Package Version in Apk Addd3499f6d-1651-41bb-a9a7-de925fea487b Medium Supply-Chain Package version pinning reduces the range of versions that can be installed, reducing the chances of failure due to unanticipated changes Documentation Add Instead of Copy9513a694-aa0d-41d8-be61-3271e056f36b Medium Supply-Chain Using ADD to load external installation scripts could lead to an evil web server leveraging this and loading a malicious script. Documentation Pip install Keeping Cached Packagesf2f903fb-b977-461e-98d7-b3e2185c6118 Medium Supply-Chain When installing packages with pip, the '--no-cache-dir' flag should be set to make Docker images smaller Documentation Image Version Not Explicit9efb0b2d-89c9-41a3-91ca-dcc0aec911fd Medium Supply-Chain Always tag the version of an image explicitly Documentation Missing Zypper Clean38300d1a-feb2-4a48-936a-d1ef1cd24313 Medium Supply-Chain Reduce layer and image size by deleting unneeded caches after running zypper Documentation Using Platform Flag with FROM Commandb16e8501-ef3c-44e1-a543-a093238099c9 Medium Supply-Chain Don't use '--platform' flag with FROM Documentation Run Using 'wget' and 'curl'fc775e75-fcfb-4c98-b2f2-910c5858b359 Medium Supply-Chain Shouldn't use both 'wget' and 'curl' since they are two tools that have the same effect Documentation Yum Clean All Missing00481784-25aa-4a55-8633-3136dfcf4f37 Medium Supply-Chain Need to use 'yum clean all' after using a 'yum install' command to clean package cached data and reduce image size Documentation Missing Version Specification In dnf install93d88cf7-f078-46a8-8ddc-178e03aeacf1 Medium Supply-Chain Specifying a package version allows to reduce failures due to unanticipated changes in required packages. Documentation Missing Zypper Non-interactive Switch45e1fca5-f90e-465d-825f-c2cb63fa3944 Medium Supply-Chain Omitting the non-interactive switch causes the command to fail during the build process, because zypper would expect manual input Documentation Yum Install Allows Manual Input6e19193a-8753-436d-8a09-76dcff91bb03 Medium Supply-Chain Need to use -y to avoid manual input 'yum install -y ' Documentation Apt Get Install Pin Version Not Defined965a08d7-ef86-4f14-8792-4a3b2098937e Medium Supply-Chain When installing a package, its pin version should be defined Documentation NPM Install Command Without Pinned Versione36d8880-3f78-4546-b9a1-12f0745ca0d5 Medium Supply-Chain Check if packages installed by npm are pinning a specific version. Documentation Image Version Using 'latest'f45ea400-6bbe-4501-9fc7-1c3d75c32067 Medium Supply-Chain When building images, always tag them with useful tags which codify version information, intended destination (prod or test, for instance), stability, or other information that is useful when deploying the application in different environments. Do not rely on the automatically-created latest tag Documentation Run Using aptb84a0b47-2e99-4c9f-8933-98bcabe2b94d Medium Supply-Chain apt is discouraged by the linux distributions as an unattended tool as its interface may suffer changes between versions. Better use the more stable apt-get and apt-cache Documentation Zypper Install Without Version562952e4-0348-4dea-9826-44f3a2c6117b Medium Supply-Chain Not specifying the package version can cause failures due to unanticipated changes in required packages Documentation Yum install Without Version6452c424-1d92-4deb-bb18-a03e95d579c4 Medium Supply-Chain Not specifying the package version can cause failures due to unanticipated changes in required packages Documentation APT-GET Missing '-y' To Avoid Manual Input77783205-c4ca-4f80-bb80-c777f267c547 Medium Supply-Chain Check if apt-get calls use the flag -y to avoid user manual input. Documentation Multiple RUN, ADD, COPY, Instructions Listed0008c003-79aa-42d8-95b8-1c2fe37dbfe6 Low Best Practices Multiple commands (RUN, COPY, ADD) should be grouped in order to reduce the number of layers. Documentation MAINTAINER Instruction Being Used99614418-f82b-4852-a9ae-5051402b741c Low Best Practices The MAINTAINER instruction sets the Author field of the generated images. The LABEL instruction is a much more flexible version of this and you should use it instead, as it enables setting any metadata you require, and can be viewed easily Documentation Chown Flag Existsaa93e17f-b6db-4162-9334-c70334e7ac28 Low Best Practices It is considered a best practice for every executable in a container to be owned by the root user even if it is executed by a non-root user, only execution permissions are required on the file, not ownership Documentation Curl or Wget Instead of Add4b410d24-1cbe-4430-a632-62c9a931cf1c Low Best Practices Use of Curl or Wget should be done instead of Add to fetch packages from remote URLs due to the use of Add being strongly discouraged Documentation Exposing Port 22 (SSH)5907595b-5b6d-4142-b173-dbb0e73fbff8 Low Best Practices Expose only the ports that your application needs and avoid exposing ports like SSH (22) Documentation Using Unnamed Build Stages68a51e22-ae5a-4d48-8e87-b01a323605c9 Low Build Process This query is used to ensure that build stages are named. This way even if the Dockerfile is re-ordered, the COPY instruction doesn\u2019t break. Documentation Healthcheck Instruction Missingb03a748a-542d-44f4-bb86-9199ab4fd2d5 Low Insecure Configurations Ensure that HEALTHCHECK is being used. The HEALTHCHECK instruction tells Docker how to test a container to check that it is still working Documentation Apk Add Using Local Cache Pathae9c56a6-3ed1-4ac0-9b54-31267f51151d Info Supply-Chain When installing packages, use the '--no-cache' switch to avoid the need to use '--update' and remove '/var/cache/apk/*' Documentation Run Utilities And POSIX Commands9b6b0f38-92a2-41f9-b881-3a1083d99f1b Info Supply-Chain Some POSIX commands and interactive utilities shouldn't run inside a Docker Container Documentation APT-GET Not Avoiding Additional Packages7384dfb2-fcd1-4fbf-91cd-6c44c318c33c Info Supply-Chain Check if any apt-get installs don't use '--no-install-recommends' flag to avoid installing additional packages. Documentation Apt Get Install Lists Were Not Deleteddf746b39-6564-4fed-bf85-e9c44382303c Info Supply-Chain After using apt-get install, it is needed to delete apt-get lists Documentation"},{"location":"queries/googledeploymentmanager-queries/","title":"Google Deployment Manager","text":""},{"location":"queries/googledeploymentmanager-queries/#googledeploymentmanager_queries_list","title":"GoogleDeploymentManager Queries List","text":"<p>This page contains all queries from GoogleDeploymentManager.</p>"},{"location":"queries/googledeploymentmanager-queries/#gcp_bom","title":"GCP_BOM","text":"<p>Bellow are listed queries related with GoogleDeploymentManager GCP_BOM:</p> Query Severity Category Description Help BOM - GCP PD268c65a8-58ad-43e4-9019-1a9bbc56749f Trace Bill Of Materials A list of Persistent Disk resources found. Persistent Disk is Google's local durable storage service, fully integrated with Google Cloud products, Compute Engine and Google Kubernetes Engine. Documentation BOM - GCP PST9ed08714-b2f3-4c6d-8fb0-ac0b74ad71d8 Trace Bill Of Materials A list of Pub/Sub Topic resources found. Cloud Pub/Sub is designed to provide reliable, many-to-many, asynchronous messaging between applications. Publisher applications can send messages to a 'topic' and other applications can subscribe to that topic to receive the messages. Documentation BOM - GCP SBc7781feb-a955-4f9f-b9cf-0d7c6f54bb59 Trace Bill Of Materials A list of Storage Bucket resources found. Buckets are the basic containers that hold your data. Everything that you store in Cloud Storage must be contained in a bucket. Documentation"},{"location":"queries/googledeploymentmanager-queries/#gcp","title":"GCP","text":"<p>Bellow are listed queries related with GoogleDeploymentManager GCP:</p> Query Severity Category Description Help Cloud Storage Anonymous or Publicly Accessible63ae3638-a38c-4ff4-b616-6e1f72a31a6a High Access Control Cloud Storage Buckets must not be anonymously or publicly accessible, which means the subattribute 'entity' from attributes 'acl' and 'defaultObjectAcl' must not be 'allUsers' or 'allAuthenticatedUsers' Documentation BigQuery Dataset Is Public83103dff-d57f-42a8-bd81-40abab64c1a7 High Access Control BigQuery dataset is anonymously or publicly accessible. Attribute access.specialGroup should not contain 'allAuthenticatedUsers' Documentation Cloud Storage Bucket Is Publicly Accessible77c1fa3f-83dc-4c9d-bfed-e1d0cc8fd9dc High Access Control Cloud Storage Bucket is anonymously or publicly accessible Documentation SQL DB Instance Backup Disableda5bf1a1c-92c7-401c-b4c6-ebdc8b686c01 High Backup Checks if backup configuration is enabled for all Cloud SQL Database instances Documentation DNSSEC Using RSASHA16d7b121a-a2ed-4e37-bd2f-80d9df1dfd35 High Encryption DNSSEC should not use the RSASHA1 algorithm Documentation SQL DB Instance With SSL Disabled660360d3-9ca7-46d1-b147-3acc4002953f High Encryption Cloud SQL Database Instance should have SLL enabled Documentation Cluster Labels Disabled8810968b-4b15-421d-918b-d91eb4bb8d1d High Insecure Configurations Kubernetes Clusters must be configured with labels, which means the attribute 'resourceLabels' must be defined Documentation Cluster Master Authentication Disabled7ef7d141-9fbb-4679-a977-fd0883436906 High Insecure Configurations Kubernetes Engine Clusters must have Master Authentication set to enabled, which means the attribute 'masterAuth' must have the subattributes 'username' and 'password' defined and not empty Documentation IP Aliasing Disabled28727987-e398-49b8-aef1-8a3e7789d111 High Insecure Configurations Kubernetes Clusters must be created with Alias IP ranges enabled, which means the attribute 'ipAllocationPolicy' must be defined and the subattribute 'useIpAliases' must be set to 'true'. Documentation Not Proper Email Account In Usea21b8df3-c840-4b3d-a41a-10fb2afda171 High Insecure Configurations Gmail accounts are being used instead of corporate credentials Documentation MySQL Instance With Local Infile Onc759d6f2-4dd3-4160-82d3-89202ef10d87 High Insecure Configurations MySQL Instance should not have Local Infile On Documentation Network Policy Disabledc47f90e8-4a19-43f0-8413-cc434d286c4e High Insecure Configurations Kubernetes Engine Clusters must have Network Policy enabled, meaning that the attribute 'networkPolicy.enabled' must be true and the attribute 'addonsConfig.networkPolicyConfig.disabled' must be false Documentation Private Cluster Disabled48c61fbd-09c9-46cc-a521-012e0c325412 High Insecure Configurations Kubernetes Clusters must be created with Private Clusters enabled, meaning the 'privateClusterConfig' must be defined and the attributes 'enablePrivateEndpoint' and 'enablePrivateNodes' must be true. Documentation GKE Legacy Authorization Enableddf58d46c-783b-43e0-bdd0-d99164f712ee High Insecure Configurations Kubernetes Engine Clusters must have Legacy Authorization set to disabled, which means the attribute 'legacyAbac.enabled' must be false. Documentation Client Certificate Disableddd690686-2bf9-4012-a821-f61912dd77be High Insecure Configurations Kubernetes Clusters must be created with Client Certificate enabled, which means 'masterAuth' must have 'clientCertificateConfig' with the attribute 'issueClientCertificate' equal to true Documentation GKE Master Authorized Networks Disabled62c8cf50-87f0-4295-a974-8184ed78fe02 High Networking and Firewall Master authorized networks must be enabled in GKE clusters Documentation Compute Instance Is Publicly Accessible8212e2d7-e683-49bc-bf78-d6799075c5a7 High Networking and Firewall Compute instances shouldn't be accessible from the Internet. Documentation Stackdriver Monitoring Disabledbbfc97ab-e92a-4a7b-954c-e88cec815011 High Observability Kubernetes Engine Clusters must have Stackdriver Monitoring enabled, which means the attribute 'monitoringService' must be defined and different than 'none' Documentation Stackdriver Logging Disabled95601b9a-7fe8-4aee-9b58-d36fd9382dfc High Observability Kubernetes Engine Clusters must have Stackdriver Logging enabled, which means the attribute 'loggingService' must be defined and different from 'none' Documentation Cloud Storage Bucket Versioning Disabledad0875c1-0b39-4890-9149-173158ba3bba High Observability Cloud Storage Bucket should have versioning enabled Documentation Node Auto Upgrade Disableddc5c5fee-6c53-43b0-ab11-4c660e064aaf High Resource Management Kubernetes nodes must have auto upgrades set to true, which means the attribute 'nodePools' must be defined and the subattribute 'managment' must be defined and have the attribute 'autoUpgrade' set to true Documentation Disk Encryption Disabledfc040fb6-4c23-4c0d-b12a-39edac35debb Medium Encryption VM disks for critical VMs must be encrypted with Customer Supplied Encryption Keys (CSEK) or with Customer-managed encryption keys (CMEK), which means the attribute 'diskEncryptionKey' must be defined and its sub attributes 'rawKey' or 'kmsKeyName' must also be defined Documentation Cloud DNS Without DNSSEC313d6deb-3b67-4948-b41d-35b699c2492e Medium Insecure Configurations DNSSEC must be enabled for Cloud DNS Documentation OSLogin Is Disabled In VM Instancee66e1b71-c810-4b4e-a737-0ab59e7f5e41 Medium Insecure Configurations VM instance should have OSLogin enabled Documentation COS Node Image Not Useddbe058d7-b82e-430b-8426-992b2e4677e7 Medium Insecure Configurations The node image should be Container-Optimized OS(COS) Documentation Google Storage Bucket Level Access Disabled1239f54b-33de-482a-8132-faebe288e6a6 Medium Insecure Configurations Google Storage Bucket Level Access should be enabled Documentation Shielded VM Disabled9038b526-4c19-4928-bca2-c03d503bdb79 Medium Insecure Configurations Compute instances must be launched with Shielded VM enabled, which means the attribute 'shieldedInstanceConfig' must be defined and its sub attributes 'enableSecureBoot', 'enableVtpm' and 'enableIntegrityMonitoring' must be set to true Documentation SSH Access Is Not Restricteddee21308-2a7a-49de-8ff7-c9b87e188575 Medium Networking and Firewall Google Firewall should not allow SSH access (port 22) from the Internet (public CIDR block) to ensure the principle of least privileges Documentation RDP Access Is Not Restricted50cb6c3b-c878-4b88-b50e-d1421bada9e8 Medium Networking and Firewall Check if the Google compute firewall allows unrestricted RDP access. Allowed ports should not contain RDP port 3389 Documentation IP Forwarding Enabled7c98538a-81c6-444b-bf04-e60bc3ceeec0 Medium Networking and Firewall Instances must not have IP forwarding enabled, which means the attribute 'canIpForward' must not be true Documentation Bucket Without Versioning227c2f58-70c6-4432-8e9a-a89c1a548cf5 Medium Observability Bucket should have versioning enabled Documentation Project-wide SSH Keys Are Enabled In VM Instances6e2b1ec1-1eca-4eb7-9d4d-2882680b4811 Medium Secret Management VM Instance should block project-wide SSH keys Documentation"},{"location":"queries/grpc-queries/","title":"gRPC","text":""},{"location":"queries/grpc-queries/#grpc_queries_list","title":"GRPC Queries List","text":"<p>This page contains all queries from GRPC.</p> Query Severity Category Description Help Enum Name Not CamelCasedaaace5f-c0dc-4835-b526-7a116b7f4b4e Low Best Practices All Enum Names should follow CamelCase and start with Capital Letter Documentation"},{"location":"queries/knative-queries/","title":"Knative queries","text":""},{"location":"queries/knative-queries/#knative_queries_list","title":"Knative Queries List","text":"<p>This page contains all queries from Knative.</p> Query Severity Category Description Help Serving Revision Spec Without Timeout Secondse8bb41e4-2f24-4e84-8bea-8c7c070cf93d Info Insecure Configurations Serving Revision Spec should have Timeout Seconds defined to avoid Denial of Service Documentation"},{"location":"queries/kubernetes-queries/","title":"Kubernetes","text":""},{"location":"queries/kubernetes-queries/#kubernetes_queries_list","title":"Kubernetes Queries List","text":"<p>This page contains all queries from Kubernetes.</p> Query Severity Category Description Help Always Admit Admission Control Plugin Setce30e584-b33f-4c7d-b418-a3d7027f8f60 High Access Control When using kube-apiserver command, the '--enable-admission-plugins' flag should not have 'AlwaysAdmit' plugin Documentation RBAC Wildcard In Rule6b896afb-ca07-467a-b256-1a0077a1c08e High Access Control Roles and ClusterRoles with wildcard RBAC permissions provide excessive rights to the Kubernetes API and should be avoided. The principle of least privilege recommends to specify only the set of needed objects and actions Documentation Basic Auth File Is Set5da47109-f8d6-4585-9e2b-96a8958a12f5 High Access Control When using kube-apiserver command, the 'basic-auth-file' flag should not be set Documentation Node Restriction Admission Control Plugin Not Set33fc6923-6553-4fe6-9d3a-4efa51eb874b High Access Control When using kube-apiserver command, the --enable-admission-plugins flag should have 'NodeRestriction' plugin and the plugin should be correctly configured in AdmissionControl Config file Documentation Client Certificate Authentication Not Setup Properlye0e00aba-5f1c-4981-a542-9a9563c0ee20 High Access Control Client Certificate Authentication should be Setup with a .pem or .crt file Documentation Service Account Lookup Set To Falsea5530bd7-225a-48f9-91bb-f40b04200165 High Access Control When using kube-apiserver command, the '--service-account-lookup' flag should be set to true Documentation Use Service Account Credentials Not Set To True1acd93f1-5a37-45c0-aaac-82ece818be7d High Access Control When using kube-controller-manager commands, the '--use-service-account-credentials' should be set to true Documentation Token Auth File Is Set32ecd76e-7bbf-402e-bf48-8b9485749558 High Access Control When using kube-apiserver command, the 'token-auth-file' flag should not be set Documentation Pod Security Policy Admission Control Plugin Not Setafa36afb-39fe-4d94-b9b6-afb236f7a03d High Build Process When using kube-apiserver command, the '--enable-admission-plugins' flag should have 'PodSecurityPolicy' plugin and the plugin should be correctly configured in AdmissionControl Config file Documentation Service Account Private Key File Not Definedccc98ff7-68a7-436e-9218-185cb0b0b780 High Encryption When using kube-controller-manager commands, the '--service-account-private-key-file' should be defined Documentation Cluster Allows Unsafe Sysctls9127f0d9-2310-42e7-866f-5fd9d20dcbad High Insecure Configurations A Kubernetes Cluster must not allow unsafe sysctls, to prevent a pod from having any influence on any other pod on the node, harming the node's health or gaining CPU or memory resources outside of the resource limits of a pod. This means 'spec.securityContext.sysctls' must not specify unsafe sysctls and the attribute 'allowedUnsafeSysctls' must be undefined. Documentation Tiller (Helm v2) Is Deployed6d173be7-545a-46c6-a81d-2ae52ed1605d High Insecure Configurations Check if Tiller is deployed. Documentation Shared Host PID Namespace302736f4-b16c-41b8-befe-c0baffa0bd9d High Insecure Configurations Container should not share the host process ID namespace Documentation Not Limited Capabilities For Pod Security Policycaa93370-791f-4fc6-814b-ba6ce0cb4032 High Insecure Configurations Limit capabilities for a Pod Security Policy Documentation Container Is Privilegeddd29336b-fe57-445b-a26e-e6aa867ae609 High Insecure Configurations Privileged containers lack essential security restrictions and should be avoided by removing the 'privileged' flag or by changing its value to false Documentation Privilege Escalation Allowed5572cc5e-1e4c-4113-92a6-7a8a3bd25e6d High Insecure Configurations Containers should not run with allowPrivilegeEscalation in order to prevent them from gaining more privileges than their parent process Documentation PSP Allows Containers To Share The Host Network Namespacea33e9173-b674-4dfb-9d82-cf3754816e4b High Insecure Configurations Check if Pod Security Policies allow containers to share the host network namespace. Documentation Tiller Service Is Not Deleted8b862ca9-0fbd-4959-ad72-b6609bdaa22d High Insecure Configurations Check if there is any Tiller Service present Documentation Role Binding To Default Service Account1e749bc9-fde8-471c-af0c-8254efd2dee5 High Insecure Defaults No role nor cluster role should bind to a default service account Documentation Etcd Peer TLS Certificate Files Not Properly Set09bb9e96-8da3-4736-b89a-b36814acca60 High Networking and Firewall When using etcd commands, the '--peer-cert-file' and '--peer-key-file' should be defined Documentation TSL Connection Certificate Not Setupfa750c81-93c2-4fab-9c6d-d3fd3ce3b89f High Networking and Firewall TSL Connection Certificate files should be Setup Documentation Etcd TLS Certificate Files Not Properly Set075ca296-6768-4322-aea2-ba5063b969a9 High Networking and Firewall When using etcd commands, the '--cert-file' and '--key-file' should be defined Documentation Secure Port Set To Zero3d24b204-b73d-42cb-b0bf-1a5438c5f71e High Networking and Firewall When using kube-apiserver command, the --secure-port flag should not be 0 Documentation Etcd TLS Certificate Not Properly Configured895a5a95-3756-4b04-9924-2f3bc93181bd High Networking and Firewall When using kube-apiserver commands, the '--etcd-certfile' and '--etcd-keyfile' flags should be defined Documentation Bind Address Not Properly Set46a2e9ec-6a5f-4faa-9d39-4ea44d5d87a2 High Networking and Firewall When using kube-controller-manager or kube-scheduler commands, the '--bind-address' should not be set to 127.0.0.1 Documentation Tiller Deployment Is Accessible From Within The Clustere17fa86a-6222-4584-a914-56e8f6c87e06 High Networking and Firewall Check if any Tiller Deployment container allows access from within the cluster. Documentation Insecure Port Not Properly Setfa4def8c-1898-4a35-a139-7b76b1acdef0 High Networking and Firewall When using kube-apiserver command, the '--insecure-port' flag should be defined and set to 0 Documentation Kubelet HTTPS Set To Falsecdc8b54e-6b16-4538-a1b0-35849dbe29cf High Networking and Firewall When using kube-apiserver command, the '--kubelet-https' flag should not be set to false Documentation Insecure Bind Address Setb9380fd3-5ffe-4d10-9290-13e18e71eee1 High Networking and Firewall When using kube-apiserver command, the '--insecure-bind-address' flag should not be set Documentation PSP With Unrestricted Access to Host Pathde4421f1-4e35-43b4-9783-737dd4e4a47e High Resource Management PodSecurityPolicy should set 'readOnly' to true in every host path allowed Documentation Auto TLS Set To True98ce8b81-7707-4734-aa39-627c6db3d84b High Secret Management When using etcd commands, the '--auto-tls' should be set to false Documentation Peer Auto TLS Set To Trueae8827e2-4af9-4baa-9998-87539ae0d6f0 High Secret Management When using etcd commands, the '--peer-auto-tls' should be set to false Documentation Authorization Mode RBAC Not Set1aa4a1ae-5dbb-48a1-9aa2-630ea4be208e Medium Access Control When using kube-apiserver command, the 'authorization-mode' flag should have 'RBAC' mode Documentation Permissive Access to Create Pods592ad21d-ad9b-46c6-8d2d-fad09d62a942 Medium Access Control The permission to create pods in a cluster should be restricted because it allows privilege escalation. Documentation Non Kube System Pod With Host Mountaa8f7a35-9923-4cad-bd61-a19b7f6aac91 Medium Access Control A non kube-system workload should not have hostPath mounted Documentation RBAC Roles with Exec Permissionc589f42c-7924-4871-aee2-1cede9bc7cbc Medium Access Control Roles or ClusterRoles with RBAC permissions to run commands in containers via 'kubectl exec' could be abused by attackers to execute malicious code in case of compromise. To prevent this, the 'pods/exec' verb should not be used in production environments Documentation RBAC Roles with Port-Forwarding Permission38fa11ef-dbcc-4da8-9680-7e1fd855b6fb Medium Access Control Roles or ClusterRoles with RBAC permissions to port-forward into pods can open socket-level communication channels to containers. In case of compromise, attackers may abuse this for direct communication that bypasses network security restrictions Documentation RBAC Roles with Attach Permissiond45330fd-f58d-45fb-a682-6481477a0f84 Medium Access Control Roles or ClusterRoles with RBAC permissions to attach to containers via 'kubectl attach' could be abused by attackers to read log output (stdout, stderr) and send input data (stdin) to running processes. Additionally, it would allow a malicious user to attach to a privileged container resulting in a privilege escalation attack. To prevent this, the 'pods/attach' verb should not be used in production environments Documentation Service Account Admission Control Plugin Disabled9587c890-0524-40c2-9ce2-663af7c2f063 Medium Access Control When using kube-apiserver command, the '--disable-admission-plugins' flag should not have 'ServiceAccount' plugin Documentation RBAC Roles with Read Secrets Permissionsb7bca5c4-1dab-4c2c-8cbe-3050b9d59b14 Medium Access Control Roles and ClusterRoles with get/watch/list RBAC permissions on Kubernetes secrets are dangerous and should be avoided. In case of compromise, attackers could abuse these roles to access sensitive data, such as passwords, tokens and keys Documentation Anonymous Auth Is Not Set To False1de5cc51-f376-4638-a940-20f2e85ae238 Medium Access Control When using the kubelet or kube-apiserver command, the 'anonymous-auth' flag should be set to false (--anonymous-auth=false) Documentation RBAC Roles Allow Privilege Escalation8320826e-7a9c-4b0b-9535-578333193432 Medium Access Control Roles or ClusterRoles with RBAC permissions 'bind' or 'escalate' allow subjects to create new bindings with other roles. This is dangerous, as users with these privileges can bind to roles that may exceed their own privileges Documentation Authorization Mode Set To Always Allowf1f4d8da-1ac4-47d0-b1aa-91e69d33f7d5 Medium Access Control When using the kubelet command, the authorization-mode flag should not have 'AlwaysAllow' mode Documentation RBAC Roles with Impersonate Permission9f85c3f6-26fd-4007-938a-2e0cb0100980 Medium Access Control Roles or ClusterRoles with the permission 'impersonate' allow subjects to assume the rights of other users, groups, or service accounts. In case of compromise, attackers may abuse this sudo-like functionality to achieve privilege escalation Documentation Terminated Pod Garbage Collector Threshold Not Properly Set49113af4-29ca-458e-b8d4-724c01a4a24f Medium Availability When using kube-controller-manager commands, the '--terminated-pod-gc-threshold' should be set between 0 and 12501 Documentation Request Timeout Not Properly Setd89a15bb-8dba-4c71-9529-bef6729b9c09 Medium Availability When using kube-apiserver command, the '--request-timeout' flag value should not be too long Documentation Readiness Probe Is Not Configureda659f3b5-9bf0-438a-bd9a-7d3a6427f1e3 Medium Availability Check if Readiness Probe is not configured. Documentation Root Containers Admittede3aa0612-4351-4a0d-983f-aefea25cf203 Medium Best Practices Containers must not be allowed to run with root privileges, which means the attributes 'privileged','allowPrivilegeEscalation' and 'readOnlyRootFilesystem' must be set to false, 'runAsUser.rule' must be set to 'MustRunAsNonRoot', and adding the root group must be forbidden Documentation Container Running With Low UID02323c00-cdc3-4fdc-a310-4f2b3e7a1660 Medium Best Practices Check if containers are running with low UID, which might cause conflicts with the host's user table. Documentation Container Running As Rootcf34805e-3872-4c08-bf92-6ff7bb0cfadb Medium Best Practices Containers should only run as non-root user. This limits the exploitability of security misconfigurations and restricts an attacker's possibilities in case of compromise Documentation Incorrect Volume Claim Access Mode ReadWriteOnce3878dc92-8e5d-47cf-9cdd-7590f71d21b9 Medium Build Process Kubernetes Stateful Sets must have one Volume Claim template with the access mode 'ReadWriteOnce' Documentation Always Pull Images Admission Control Plugin Not Seta77f4d07-c6e0-4a48-8b35-0eeb51576f4f Medium Build Process When using kube-apiserver command, the '--enable-admission-plugins' flag should have 'AlwaysPullImages' plugin and the plugin should be correctly configured in AdmissionControl Config file Documentation Weak TLS Cipher Suites510d5810-9a30-443a-817d-5c1fa527b110 Medium Encryption TLS Connection should use strong Cipher Suites Documentation Encryption Provider Not Properly Configured10efce34-5af6-4d83-b414-9e096d5a06a9 Medium Encryption The EncryptionConfiguration should be configured to have at least one 'aescbc', 'kms' or 'secretbox' provider Documentation Encryption Provider Config Is Not Definedcbd2db69-0b21-4c14-8a40-7710a50571a9 Medium Encryption When using kube-apiserver commands, the '--encryption-provider-config' flag should be defined and the encryption should be correctly configured in Encryption Configuration file Documentation Root CA File Not Defined05fb986f-ac73-4ebb-a5b2-7faafa93d882 Medium Encryption When using kube-controller-manager commands, the '--root-ca-file' should be defined Documentation Using Unrecommended Namespace611ab018-c4aa-4ba2-b0f6-a448337509a6 Medium Insecure Configurations Namespaces like 'default', 'kube-system' or 'kube-public' should not be used Documentation PSP Allows Privilege Escalation87554eef-154d-411d-bdce-9dbd91e56851 Medium Insecure Configurations PodSecurityPolicy should not allow privilege escalation Documentation Kubelet Protect Kernel Defaults Set To False6cf42c97-facd-4fda-b8af-ea4529123355 Medium Insecure Configurations --protect-kernel-defaults should be set to true Documentation Containers With Sys Admin Capabilities235236ee-ad78-4065-bd29-61b061f28ce0 Medium Insecure Configurations Containers should not have CAP_SYS_ADMIN Linux capability Documentation NET_RAW Capabilities Disabled for PSP2270987f-bb51-479f-b8be-3ca73e5ad648 Medium Insecure Configurations Containers need to have NET_RAW or All as drop capabilities Documentation Security Context Deny Admission Control Plugin Not Set6a68bebe-c021-492e-8ddb-55b0567fb768 Medium Insecure Configurations When using kube-apiserver command, the '--enable-admission-plugins' flag should have 'SecurityContextDeny' plugin and the plugin should be correctly configured in AdmissionControl Config file when 'PodSecurityPolicy' plugin is not set Documentation Seccomp Profile Is Not Configuredf377b83e-bd07-4f48-a591-60c82b14a78b Medium Insecure Configurations Containers should be configured with a secure Seccomp profile to restrict potentially dangerous syscalls Documentation Workload Mounting With Sensitive OS Directory5308a7a8-06f8-45ac-bf10-791fe21de46e Medium Insecure Configurations Workload is mounting a volume with sensitive OS Directory Documentation Authorization Mode Node Not Set4d7ee40f-fc5d-427d-8cac-dffbe22d42d1 Medium Insecure Configurations When using kube-apiserver command, the 'authorization-mode' flag should have 'Node' mode Documentation PSP Set To Privilegedc48e57d3-d642-4e0b-90db-37f807b41b91 Medium Insecure Configurations Do not allow pod to request execution as privileged. Documentation NET_RAW Capabilities Not Being Droppeddbbc6705-d541-43b0-b166-dd4be8208b54 Medium Insecure Configurations Containers should drop 'ALL' or at least 'NET_RAW' capabilities Documentation PSP Allows Sharing Host PID91dacd0e-d189-4a9c-8272-5999a3cc32d9 Medium Insecure Configurations Pod Security Policy allows containers to share the host process ID namespace Documentation Ingress Controller Exposes Workload69bbc5e3-0818-4150-89cc-1e989b48f23b Medium Insecure Configurations Ingress Controllers should not expose workload in order to avoid vulnerabilities and DoS attacks Documentation PSP With Added Capabilities7307579a-3abb-46ad-9ce5-2a915634d5c8 Medium Insecure Configurations PodSecurityPolicy should not have added capabilities Documentation Not Limited Capabilities For Container2f1a0619-b12b-48a0-825f-993bb6f01d58 Medium Insecure Configurations Limit the capabilities for a Container. Documentation Container Runs Unmaskedf922827f-aab6-447c-832a-e1ff63312bd3 Medium Insecure Configurations Check if a container has full access (unmasked) to the host\u2019s /proc command, which would allow to retrieve sensitive information and possibly change the kernel parameters in runtime. Documentation PSP Allows Sharing Host IPC80f93444-b240-4ebb-a4c6-5c40b76c04ea Medium Insecure Configurations Pod Security Policy allows containers to share the host IPC namespace Documentation Containers With Added Capabilities19ebaa28-fc86-4a58-bcfa-015c9e22fe40 Medium Insecure Configurations Containers should not have extra capabilities allowed Documentation Service Account Token Automount Not Disabled48471392-d4d0-47c0-b135-cdec95eb3eef Medium Insecure Defaults Service Account Tokens are automatically mounted even if not necessary Documentation Service Account Name Undefined Or Empty591ade62-d6b0-4580-b1ae-209f80ba1cd9 Medium Insecure Defaults A Kubernetes Pod should have a Service Account defined so to restrict Kubernetes API access, which means the attribute 'serviceAccountName' should be defined and not empty. Documentation Service With External Load Balancer26763a1c-5dda-4772-b507-5fca7fb5f165 Medium Networking and Firewall Service has an external load balancer, which may cause accessibility from other networks and the Internet Documentation Pod Misconfigured Network Policy0401f71b-9c1e-4821-ab15-a955caa621be Medium Networking and Firewall Check if any pod is not being targeted by a proper network policy. Documentation Kubelet Streaming Connection Timeout Disableded89b97d-04e9-4fd4-919f-ee5b27e555e9 Medium Networking and Firewall The flag --streaming-connection-idle-timeout should not be set to 0 Documentation Kubelet Not Managing Ip Tables5f89001f-6dd9-49ff-9b15-d8cd71b617f4 Medium Networking and Firewall Kubelet argument --make-iptables-util-chains should be true Documentation Network Policy Is Not Targeting Any Pod85ab1c5b-014e-4352-b5f8-d7dea3bb4fd3 Medium Networking and Firewall Check if any network policy is not targeting any pod. Documentation CNI Plugin Does Not Support Network Policies03aabc8c-35d6-481e-9c85-20139cf72d23 Medium Networking and Firewall Ensure the use of CNI Plugin that support Network Policies. If the CNI Plugin in use does not support Network Policies it may not be possible to effectively restrict traffic in the cluster Documentation Kubelet Read Only Port Is Not Set To Zero2940d48a-dc5e-4178-a3f8-bfbd80720b41 Medium Networking and Firewall When using the kubelet command, the read-only port should be set to zero (--read-only-port=0) Documentation Audit Log Path Not Set73e251f0-363d-4e53-86e2-0a93592437eb Medium Observability When using kube-apiserver command, the 'audit-log-path' flag should be defined Documentation Audit Policy File Not Defined13a49a2e-488e-4309-a7c0-d6b05577a5fb Medium Observability When using kube-apiserver command, the '--audit-policy-file' flag should be defined Documentation Memory Limits Not Definedb14d1bc4-a208-45db-92f0-e21f8e2588e9 Medium Resource Management Memory limits should be defined for each container. This prevents potential resource exhaustion by ensuring that containers consume not more than the designated amount of memory Documentation CPU Limits Not Set4ac0e2b7-d2d2-4af7-8799-e8de6721ccda Medium Resource Management CPU limits should be set because if the system has CPU time free, a container is guaranteed to be allocated as much CPU as it requests Documentation Memory Requests Not Defined229588ef-8fde-40c8-8756-f4f2b5825ded Medium Resource Management Memory requests should be defined for each container. This allows the kubelet to reserve the requested amount of system resources and prevents over-provisioning on individual nodes Documentation Shared Host Network Namespace6b6bdfb3-c3ae-44cb-88e4-7405c1ba2c8a Medium Resource Management Container should not share the host network namespace Documentation Volume Mount With OS Directory Write Permissionsb7652612-de4e-4466-a0bf-1cd81f0c6063 Medium Resource Management Containers can mount sensitive folders from the hosts, giving them potentially dangerous access to critical host configurations and binaries. Documentation Shared Host IPC Namespacecd290efd-6c82-4e9d-a698-be12ae31d536 Medium Resource Management Container should not share the host IPC namespace Documentation CPU Requests Not Setca469dd4-c736-448f-8ac1-30a642705e0a Medium Resource Management CPU requests should be set to ensure the sum of the resource requests of the scheduled Containers is less than the capacity of the node Documentation Rotate Kubelet Server Certificate Not Active1c621b8e-2c6a-44f5-bd6a-fb0fb7ba33e2 Medium Secret Management The RotateKubeletServerCertificate argument should be true Documentation Etcd Client Certificate Authentication Set To False9391103a-d8d7-4671-ac5d-606ba7ccb0ac Medium Secret Management When using etcd commands, the '--client-cert-auth' flag should be defined Documentation Shared Service Accountc1032cf7-3628-44e2-bd53-38c17cf31b6b Medium Secret Management A Service Account token is shared between workloads Documentation Kubelet Client Certificate Or Key Not Set36a27826-1bf5-49da-aeb0-a60a30c0e834 Medium Secret Management When using kube-apiserver command, the 'kubelet-client-key' and 'kubelet-client-certificate' flags should be set Documentation Not Unique Certificate Authoritycb7e695d-6a85-495c-b15f-23aed2519303 Medium Secret Management Certificate Authority should be unique for etcd Documentation Kubelet Certificate Authority Not Setec18a0d3-0069-4a58-a7fb-fbfe0b4bbbe0 Medium Secret Management When using kube-apiserver command, the 'kubelet-certificate-authority' flag should be set Documentation Etcd Client Certificate File Not Defined3f5ff8a7-5ad6-4d02-86f5-666307da1b20 Medium Secret Management When using kube-apiserver commands, the '--etcd-cafile' flag should be defined Documentation Service Account Key File Not Properly Setdab4ec72-ce2e-4732-b7c3-1757dcce01a1 Medium Secret Management When using kube-apiserver command, the '--service-account-key-file' flag should be defined Documentation Kubelet Client Periodic Certificate Switch Disabled52d70f2e-3257-474c-b3dc-8ad9ba6a061a Medium Secret Management Kubelet argument --rotate-certificates should be true Documentation Etcd Peer Client Certificate Authentication Set To Falseb7d0181d-0a9b-4611-9d1c-1ad4f0b620ff Medium Secret Management When using etcd commands, the '--peer-client-cert-auth' flag should be set to true Documentation ServiceAccount Allows Access Secrets056ac60e-fe07-4acc-9b34-8e1d51716ab9 Medium Secret Management Roles and ClusterRoles when binded, should not use get, list or watch as verbs Documentation Docker Daemon Socket is Exposed to Containersa6f34658-fdfb-4154-9536-56d516f65828 Low Access Control Sees if Docker Daemon Socket is not exposed to Containers Documentation Missing AppArmor Profile8b36775e-183d-4d46-b0f7-96a6f34a723f Low Access Control Containers should be configured with an AppArmor profile to enforce fine-grained access control over low-level system resources Documentation Cluster Admin Rolebinding With Superuser Permissions249328b8-5f0f-409f-b1dd-029f07882e11 Low Access Control Ensure that the cluster-admin role is only used where required (RBAC) Documentation Event Rate Limit Admission Control Plugin Not Sete0099af2-fe17-411f-9991-0de28fe15f3c Low Availability When using kube-apiserver command, the --enable-admission-plugins flag should have 'EventRateLimit' plugin and the plugin should be correctly configured in AdmissionControl Config file Documentation HPA Targeted Deployments With Configured Replica Count5744cbb8-5946-4b75-a196-ade44449525b Low Availability Deployments targeted by HorizontalPodAutoscaler should not have a statically configured replica count set Documentation HPA Targets Invalid Object2f652c42-619d-4361-b361-9f599688f8ca Low Availability The Horizontal Pod Autoscaler must target a valid object Documentation Deployment Without PodDisruptionBudgetb23e9b98-0cb6-4fc9-b257-1f3270442678 Low Availability Deployments should be assigned with a PodDisruptionBudget to ensure high availability Documentation Liveness Probe Is Not Definedade74944-a674-4e00-859e-c6eab5bde441 Low Availability In case of an unresponsive container, a Liveness Probe can help your application become more available since it restarts the container. However, it can lead to cascading failures. Define one if you really need it Documentation StatefulSet Without PodDisruptionBudget1db3a5a5-bf75-44e5-9e44-c56cfc8b1ac5 Low Availability StatefulSets should be assigned with a PodDisruptionBudget to ensure high availability Documentation StatefulSet Without Service Namebb241e61-77c3-4b97-9575-c0f8a1e008d0 Low Availability StatefulSets should have an existing headless 'serviceName'. The headless service labels should also be implemented on StatefulSets labels. Documentation Metadata Label Is Invalid1123031a-f921-4c5b-bd86-ef354ecfd37a Low Best Practices Check if any label in the metadata is invalid. Documentation No Drop Capabilities for Containers268ca686-7fb7-4ae9-b129-955a2a89064e Low Best Practices Sees if Kubernetes Drop Capabilities exists to ensure containers security context Documentation Object Is Using A Deprecated API Version94b76ea5-e074-4ca2-8a03-c5a606e30645 Low Best Practices Kubernetes APIs evolve over time and are sometimes removed with newer releases. To prevent incompatibilities when upgrading Kubernetes, deprecated APIs should be replaced with newer and more stable API versions. Documentation Root Container Not Mounted Read-onlya9c2f49d-0671-4fc9-9ece-f4e261e128d0 Low Build Process Check if the root container filesystem is not being mounted read-only. Documentation StatefulSet Requests Storage8cf4671a-cf3d-46fc-8389-21e7405063a2 Low Build Process A StatefulSet requests volume storage. Documentation Image Policy Webhook Admission Control Plugin Not Set14abda69-8e91-4acb-9931-76e2bee90284 Low Build Process When using kube-apiserver command, the --enable-admission-plugins flag should have 'ImagePolicyWebhook' plugin and the plugin should be correctly configured in AdmissionControl Config file Documentation Namespace Lifecycle Admission Control Plugin Disabled1ffe7bf7-563b-4b3d-a71d-ba6bd8d49b37 Low Build Process When using kube-apiserver command, the '--disable-admission-plugins' flag should not have 'NamespaceLifecycle' plugin Documentation Image Pull Policy Of The Container Is Not Set To Alwayscaa3479d-885d-4882-9aac-95e5e78ef5c2 Low Insecure Configurations Image Pull Policy of the container must be defined and set to Always Documentation Pod or Container Without LimitRange4a20ebac-1060-4c81-95d1-1f7f620e983b Low Insecure Configurations Each namespace should have a LimitRange policy associated to ensure that resource allocations of Pods, Containers and PersistentVolumeClaims do not exceed the defined boundaries Documentation Pod or Container Without ResourceQuota48a5beba-e4c0-4584-a2aa-e6894e4cf424 Low Insecure Configurations Each namespace should have a ResourceQuota policy associated to limit the total amount of resources Pods, Containers and PersistentVolumeClaims can consume Documentation Kubelet Hostname Override Is Setbf36b900-b5ef-4828-adb7-70eb543b7cfb Low Insecure Configurations Hostnames should not be overrided Documentation Pod or Container Without Security Contexta97a340a-0063-418e-b3a1-3028941d0995 Low Insecure Configurations A security context defines privilege and access control settings for a Pod or Container Documentation Dashboard Is Enabledd2ad057f-0928-41ef-a83c-f59203bb855b Low Insecure Configurations If not needed, disabling the dashboard can prevent from being used as an attack vector Documentation Image Without Digest7c81d34c-8e5a-402b-9798-9f442630e678 Low Insecure Configurations Images should be specified together with their digests to ensure integrity Documentation Service Does Not Target Pod3ca03a61-3249-4c16-8427-6f8e47dda729 Low Insecure Configurations Service should Target a Pod Documentation Workload Host Port Not Specified2b1836f1-dcce-416e-8e16-da8c71920633 Low Networking and Firewall Verifies if Kubernetes workload's host port is specified Documentation Service Type is NodePort845acfbe-3e10-4b8e-b656-3b404d36dfb2 Low Networking and Firewall Service type should not be NodePort Documentation Audit Policy Not Cover Key Security Concerns1828a670-5957-4bc5-9974-47da228f75e2 Low Observability Audit Policy should cover key security concerns about the sensitive data logged in Kubernetes audit policies Documentation Audit Log Maxbackup Not Properly Set768aab52-2504-4a2f-a3e3-329d5a679848 Low Observability When using kube-apiserver command, the '--audit-log-maxbackup' flag should be defined and set to 10 or more files Documentation Audit Log Maxsize Not Properly Set35c0a471-f7c8-4993-aa2c-503a3c712a66 Low Observability When using kube-apiserver command, the '--audit-log-maxsize' flag should be defined and set to 100 or more MegaBytes Documentation Profiling Not Set To False2f491173-6375-4a84-b28e-a4e2b9a58a69 Low Observability When using kube-apiserver or kube-controller-manager or kube-scheduler command, the '--profiling' flag should be defined and set to false Documentation Audit Log Maxage Not Properly Setda9f3aa8-fbfb-472f-b5a1-576127944218 Low Observability When using kube-apiserver command, the '--audit-log-maxage' flag should be defined and set to 30 or more days Documentation Kubelet Event QPS Not Properly Set1a07a446-8e61-4e4d-bc16-b0781fcb8211 Low Observability When using the kubelet command, the '--event-qps' should be set to 0 Documentation CronJob Deadline Not Configured192fe40b-b1c3-448a-aba2-6cc19a300fe3 Low Resource Management Cronjobs must have a configured deadline, which means the attribute 'startingDeadlineSeconds' must be defined Documentation Container CPU Requests Not Equal To It's Limits9d43040e-e703-4e16-8bfe-8d4da10fa7e6 Low Resource Management A Pod's Containers must have the same CPU requests as limits set, which is recommended to avoid resource DDOS of the node during spikes. This means the 'requests.cpu' must equal 'limits.cpu', and both be defined. Documentation Container Requests Not Equal To It's Limitsaee3c7d2-a811-4201-90c7-11c028be9a46 Low Resource Management Containers must have the same resource requests set as limits. This is recommended to avoid resource DDoS of the node during spikes and means that 'requests.memory' and 'requests.cpu' must equal 'limits.memory' and 'limits.cpu', respectively Documentation StatefulSet Has No PodAntiAffinityd740d048-8ed3-49d3-b77b-6f072f3b669e Low Resource Management Check if StatefulSet resources don't have a podAntiAffinity policy, which prevents multiple pods from being scheduled on the same node. Documentation Deployment Has No PodAntiAffinitya31b7b82-d994-48c4-bd21-3bab6c31827a Low Resource Management Check if Deployment resources don't have a podAntiAffinity policy, which prevents multiple pods from being scheduled on the same node. Documentation Container Memory Requests Not Equal To It's Limitsaafa7d94-62de-4fbf-8838-b69ee217b0e6 Low Resource Management A Pod's Containers must have the same Memory requests as limits set, which is recommended to avoid resource DDOS of the node during spikes. This means the 'requests.memory' must equal 'limits.memory', and both be defined. Documentation Secrets As Environment Variables3d658f8b-d988-41a0-a841-40043121de1e Low Secret Management Container should not use secrets as environment variables Documentation Invalid Image Tag583053b7-e632-46f0-b989-f81ff8045385 Low Supply-Chain Image tag must be defined and not be empty or equal to latest. Documentation Ensure Administrative Boundaries Between Resourcese84eaf4d-2f45-47b2-abe8-e581b06deb66 Info Access Control As a best practice, ensure that is made the correct use of namespaces to adequately administer your resources. Kubernetes Authorization plugins can also be used to create policies that segregate user access to namespaces. Documentation Using Kubernetes Native Secret Managementb9c83569-459b-4110-8f79-6305aa33cb37 Info Secret Management Kubernetes External Secret Storage and Management System usage should be considered if you have more complex secret management needs, rather than using Kubernetes Secrets directly. Additionally, ensure that access to secrets is carefully limited Documentation"},{"location":"queries/openapi-queries/","title":"OpenAPI","text":""},{"location":"queries/openapi-queries/#openapi_queries_list","title":"OpenAPI Queries List","text":"<p>This page contains all queries from OpenAPI.</p>"},{"location":"queries/openapi-queries/#20","title":"2.0","text":"<p>Bellow are listed queries related with OpenAPI 2.0:</p> Query Severity Category Description Help Security Definitions Undefined or Emptye3f026e8-fdb4-4d5a-bcfd-bd94452073fe High Access Control Security Definitions Object should be set and not empty Documentation Non OAuth2 Security Requirement Defining OAuth2 Scopesba239cb9-f342-4c20-812d-7b5a2aa6969e High Structure and Semantics If the security scheme is not of type 'oauth2', the array value must be empty Documentation Security Requirement Not Defined In Security Definitiona599b0d1-ff89-4cb8-9ece-9951854c06f6 High Structure and Semantics All security requirement objects must be defined in 'securityDefinitions' Documentation Implicit Flow in OAuth2 (v2)e9817ad8-a8c9-4038-8a2f-db0e6e7b284b Medium Access Control There is a 'securityDefinition' using implicit flow on OAuth2, which is deprecated Documentation Global Security Using Password Flow2da46be4-4317-4650-9285-56d7103c4f93 Medium Access Control Security should not use 'password' Flow in OAuth2 authentication Documentation Security Definitions Allows Password Flow773116aa-2e6d-416f-bd85-f0301cc05d76 Medium Access Control Security Definition Object should not allow 'password' Flow in OAuth2 authentication Documentation Operation Using Password Flow2e44e632-d617-43cb-b294-6bfe72a08938 Medium Access Control Operation Object should not use 'password' Flow in OAuth2 authentication Documentation Invalid OAuth2 Authorization URL (v2)33d96c65-977d-4c33-943f-440baca49185 Medium Access Control The field authorizationUrl on implicit or authorizationCode fields from OAuth must be a valid URL Documentation Invalid OAuth2 Token URL (v2)274f910a-0665-4f08-b66d-7058fe927dba Medium Access Control OAuth2 security definition flow requires a valid URL in the tokenUrl field Documentation Schemes Uses HTTPa46928f1-43d7-4671-94e0-2dd99746f389 Medium Encryption Schemes should use 'https' protocol instead of 'http'. Scheme using 'http' allows for clear text credentials Documentation Global Schemes Uses HTTPf30ee711-0082-4480-85ab-31d922d9a2b2 Medium Encryption Global Schemes should use 'https' protocol instead of 'http' Documentation Path Scheme Accepts HTTP (v2)a6847dc6-f4ea-45ac-a81f-93291ae6c573 Medium Encryption The Scheme list of Operation Object should only allow 'HTTPS' protocol to ensure an encrypted connection Documentation Operation Object Without 'consumes'0c79e50e-b3cf-490c-b8f6-587c644d4d0c Medium Insecure Configurations Operation Object should have 'consumes' feild defined for 'POST', 'PUT' and 'PATCH' operations Documentation Operation Object Without 'produces'be3e170e-1572-461e-a8b6-d963def581ec Medium Insecure Configurations Operation Object should have 'produces' feild defined for 'GET'operation Documentation Operation Using Basic Authceefb058-8065-418f-9c4c-584a78c7e104 Low Access Control Operation Object should not use basic authentication Documentation Operation Using Implicit Flowf42dfe7e-787d-4478-a75e-a5f3d8a2269e Low Access Control Operation Object should not use implicit flow Documentation Undefined Scope 'securityDefinition' On Global 'security' Field9aa6e95c-d964-4239-a3a8-9f37a3c5a31f Low Access Control Using an scope on global security field that is undefined on 'securityDefinitions' can be defined by an attacker Documentation Security Definitions Using Basic Auth221015a8-aa2a-43f5-b00b-ad7d2b1d47a8 Low Access Control Security Definition Object should not use basic authentication Documentation Undefined Scope 'securityDefinition' On 'security' Field On Operations3847280c-9193-40bc-8009-76168e822ce2 Low Access Control Using an scope on security of operations that is undefined on 'securityDefinitions' can be defined by an attacker Documentation Operation Summary Too Longd47940ca-5970-45cc-bdd1-4d81398cee1f Low Best Practices Operation summary should be short (less than 120 characters) Documentation Global Schema Definition Not Being Used6d2e0790-cc3d-4c74-b973-d4e8b09f4455 Info Best Practices All global schemas definitions should be in use Documentation Global Parameter Definition Not Being Usedb30981fa-a12e-49c7-a5bb-eeafb61d0f0f Info Best Practices All global parameters definitions  should be in use Documentation Schema with 'additionalProperties' set as Boolean3a01790c-ebee-4da6-8fd3-e78657383b75 Info Best Practices The value of 'additionalProperties' should be set as object instead of boolean, since swagger 2.0 does not support boolean value for it Documentation Unknown Prefix (v2)3b615f00-c443-4ba9-acc4-7c308716917d Info Best Practices The media type prefix should be set as 'application', 'audio', 'font', 'example', 'image', 'message', 'model', 'multipart', 'text' or 'video' Documentation Global Responses Definition Not Being Used0b76d993-ee52-43e0-8b39-3787d2ddabf1 Info Best Practices All global responses definitions should be in use Documentation Invalid Media Type Value (v2)f985a7d2-d404-4a7f-9814-f645f791e46e Info Best Practices The Media Type value should match the following format: /[+suffix][;parameters] Documentation Constraining Enum Propertybe1d8733-3731-40c7-a845-734741c6871d Info Best Practices There is a constraining keyword in a property which is already restricted by enum values Documentation Body Parameter With Wrong Propertyc38d630d-a415-4e3e-bac2-65475979ba88 Info Structure and Semantics The Body Parameter Object should only have the following properties defined - 'name', 'in', 'description', 'required', and 'schema' Documentation BasePath With Wrong Formatb4803607-ed72-4d60-99e2-3fa6edf471c6 Info Structure and Semantics The 'basePath' value format must match the pattern '^/' Documentation Parameter JSON Reference Does Not Exists (v2)fb889ae9-2d16-40b5-b41f-9da716c5abc1 Info Structure and Semantics Parameter reference should exist on parameters definition field Documentation Parameter Object With Incorrect Ref (v2)2596545e-1757-4ff7-a15a-8a9a180a42f3 Info Structure and Semantics Parameter Object reference must always point to '#/parameters' Documentation Object Without Required Property (v2)5e5ecb9d-04b5-4e4f-b5a5-6ee04279b275 Info Structure and Semantics OpenAPI Object should contain all of its required fields Documentation Schema JSON Reference Does Not Exists (v2)98295b32-ec09-4b5b-89a9-39853197f914 Info Structure and Semantics Schema reference should exists on definitions field Documentation Responses JSON Reference Does Not Exists (v2)e9db5fb4-6a84-4abb-b4af-3b94fbdace6d Info Structure and Semantics Responses reference should exist on responses definition field Documentation Schema Object Incorrect Ref (v2)0220e1c5-65d1-49dd-b7c2-cef6d6cb5283 Info Structure and Semantics Schema Object reference must always point to '#/definitions' Documentation Property Not Unique750b40be-4bac-4f59-bdc4-1ca0e6c3450e Info Structure and Semantics Every defined property must be unique throughout the whole API Documentation Operation Example Mismatch Produces MimeType2cf35b40-ded3-43d6-9633-c8dcc8bcc822 Info Structure and Semantics Example should match one of MimeTypes on 'produces'. It is important to know that, if a 'produces' is declared on operation it will override global 'produces' Documentation Multi 'collectionformat' Not Valid For 'in' Parameter750f6448-27c0-49f8-a153-b81735c1e19c Info Structure and Semantics When 'collectionformat' is defined as 'multi', 'in' field must be 'query' or 'formData' Documentation Parameter File Type Not In 'formData'c3cab8c4-6c52-47a9-942b-c27f26fbd7d2 Info Structure and Semantics The In field of Parameter Object must be 'formData' when type is 'file' Documentation Host With Invalid Pattern3d7d7b6c-fb0a-475e-8a28-c125e30d15f0 Info Structure and Semantics Host field should be an IP or a valid host name Documentation Response Object With Incorrect Ref (v2)bccfa089-89e4-47e0-a0e5-185fe6902220 Info Structure and Semantics Response Object reference must always point to '#/responses' Documentation Multiple Body Parameters In The Same Operationb90033cf-ad9f-4fb9-acd1-1b9d6d278c87 Info Structure and Semantics Only one body parameter is allowed on operation's parameters type field Documentation Operation Object Parameters With 'body' And 'formatData' locationseb3f9744-d24e-4614-b1ff-2a9514eca21c Info Structure and Semantics Operation object parameters should not have both 'body' and 'formatData' locations Documentation Unknown Property (v2)429b2106-ba37-43ba-9727-7f699cc611e1 Info Structure and Semantics All properties defined in OpenAPI objects should be known Documentation File Parameter With Wrong Consumes Property7f91992f-b4c8-43bf-9bf9-fae9ecdb6e3a Info Structure and Semantics Operations file parameters consumes must be 'multipart/form-data', 'application/x-www-form-urlencoded' or both Documentation Non Body Parameter Without Schema73c3bc54-3cc6-4c0a-b30a-e19f2abfc951 Info Structure and Semantics The Body Parameter Object should have the attribute 'schema' defined Documentation Body Parameter Without Schemaed48229d-d43e-4da7-b453-5f98d964a57a Info Structure and Semantics The Body Parameter Object should have the attribute 'schema' defined Documentation"},{"location":"queries/openapi-queries/#shared_v2v3","title":"SHARED (V2/V3)","text":"<p>Bellow are listed queries related with OpenAPI SHARED (V2/V3):</p> Query Severity Category Description Help Global Security Field Has An Empty Array (v2)da31d54b-ad54-41dc-95eb-8b3828629213 High Access Control Security object need to have defined rules in its array and rules should be defined on securityScheme Documentation Global Security Field Has An Empty Array (v3)d674aea4-ba8b-454b-bb97-88a772ea33f0 High Access Control Security object need to have defined rules in its array and rules should be defined on securityScheme Documentation No Global And Operation Security Defined (v2)586abcee-9653-462d-ad7b-2638a32bd6e6 High Access Control All paths should have security scheme, if it is omitted, global security field should be defined Documentation No Global And Operation Security Defined (v3)96729c6b-7400-4d9e-9807-17f00cdde4d2 High Access Control All paths should have security scheme, if it is omitted, global security field should be defined Documentation Security Field On Operations Has An Empty Array (v2)5d29effc-5d68-481f-9721-d74e5919226b High Access Control Security object for operations, if defined, must define a security scheme, otherwise it should be considered an error Documentation Security Field On Operations Has An Empty Array (v3)663c442d-f918-4f62-b096-0bf5dcbeb655 High Access Control Security object for operations, if defined, must define a security scheme, otherwise it should be considered an error Documentation Cleartext API Key In Operation Security (v2)99733b39-6413-4ed8-8acf-dc7cdc9b4e51 High Access Control API Keys should not be sent as cleartext over an unencrypted channel Documentation Cleartext API Key In Operation Security (v3)d90d4e40-44c1-4125-87a0-e072c3e195b5 High Access Control API Keys should not be sent as cleartext over an unencrypted channel Documentation Global security field has an empty object (v2)292919fb-7b26-4454-bee9-ce29094768dd High Access Control Global security definition must not have empty objects Documentation Global security field has an empty object (v3)543e38f4-1eee-479e-8eb0-15257013aa0a High Access Control Global security definition must not have empty objects Documentation Global Security Field Is Undefined (v2)74703c89-0ea2-49ab-a7db-bf04f19f5a57 High Access Control Global security field should be defined to prevent API to have insecure paths and have this rules defined on securityDefinitions Documentation Global Security Field Is Undefined (v3)8af270ce-298b-4405-9922-82a10aee7a4f High Access Control Global security field should be defined to prevent API to have insecure paths and have this rules defined on securitySchemes Documentation Security Field On Operations Has An Empty Object Definition (v2)74581e3b-1d55-4323-a139-5959a7b3abc5 High Access Control Security object for operations should not be empty object or has any empty object definition Documentation Security Field On Operations Has An Empty Object Definition (v3)baade968-7467-41e4-bf22-83ca222f5800 High Access Control Security object for operations should not be empty object or has any empty object definition Documentation Array Without Maximum Number of Items (v2)99eb2c95-2040-4104-9e7c-e16f7474d218 High Insecure Configurations Array schema/parameter should have the field 'maxItems' set Documentation Array Without Maximum Number of Items (v3)6998389e-66b2-473d-8d05-c8d71ac4d04d High Insecure Configurations Array schema should have the field 'maxItems' set Documentation Array Items Has No Type (v2)8697a1a4-82c6-4603-8ac8-57529756744e High Insecure Configurations Schema/Parameter array items type should be defined Documentation Array Items Has No Type (v3)be0e0df7-f3d9-42a1-9b6f-d425f94872c4 High Insecure Configurations Schema array items type should be defined Documentation API Key Exposed In Global Security (v2)533a0d13-6e89-4551-ae33-bce14e5849c1 Medium Access Control API Keys should not be transported over network Documentation API Key Exposed In Global Security (v3)aecee30b-8ea1-4776-a99c-d6d600f0862f Medium Access Control API Keys should not be transported over network Documentation Cleartext API Key In Global Security (v2)70d3873e-d537-46e5-ac3b-4e48fbdd29b4 Medium Access Control API Keys should not be sent as cleartext over an unencrypted channel Documentation Cleartext API Key In Global Security (v3)9c238c97-1991-4c0b-9c7d-6c7912e1dc7c Medium Access Control API Keys should not be sent as cleartext over an unencrypted channel Documentation JSON Object Schema Without Properties (v2)3d28f751-bc18-4f83-ace0-216b6086410b Medium Insecure Configurations Schema of the JSON object should have properties defined and 'additionalProperties' set to false. Documentation JSON Object Schema Without Properties (v3)9d967a2b-9d64-41a6-abea-dfc4960299bd Medium Insecure Configurations Schema of the JSON object should have properties defined and 'additionalProperties' set to false. Documentation String Schema with Broad Pattern (v2)e4a019f0-9af3-49c8-bf68-1939a6ff240d Medium Insecure Configurations String schema should restrict the pattern Documentation String Schema with Broad Pattern (v3)8c81d6c0-716b-49ec-afa5-2d62da4e3f3c Medium Insecure Configurations String schema should restrict the pattern Documentation JSON Object Schema Without Type (v2)62d52544-82ef-4b75-8308-cad49d50212b Medium Insecure Configurations Schema of the JSON object should have 'type' defined. Documentation JSON Object Schema Without Type (v3)e2ffa504-d22a-4c94-b6c5-f661849d2db7 Medium Insecure Configurations Schema of the JSON object should have 'type' defined. Documentation Numeric Schema Without Maximum (v2)203eee11-15b6-4d47-b888-4c7f534967ee Medium Insecure Configurations Numeric schema (type set to 'integer' or 'number') should have 'maximum' defined. Documentation Numeric Schema Without Maximum (v3)2ea04bef-c769-409e-9179-ee3a50b5c0ac Medium Insecure Configurations Numeric schema (type set to 'integer' or 'number') should have 'maximum' defined. Documentation Schema Object is Empty (v2)967575e5-eb44-4c24-aadb-7e33608ed30a Medium Insecure Configurations The Schema Object should not be empty to avoid accepting any JSON values Documentation Schema Object is Empty (v3)500ce696-d501-41dd-86eb-eceb011a386f Medium Insecure Configurations The Schema Object should not be empty to avoid accepting any JSON values Documentation Numeric Schema Without Minimum (v2)efd1dfc8-da91-4909-a3f3-c23abc5ec799 Medium Insecure Configurations Numeric schema (type set to 'integer' or 'number') should have 'minimum' defined. Documentation Numeric Schema Without Minimum (v3)181bd815-767e-4e95-a24d-bb3c87328e19 Medium Insecure Configurations Numeric schema (type set to 'integer' or 'number') should have 'minimum' defined. Documentation Maximum Length Undefined (v2)2ec86e48-ab90-4cb6-a131-0502afd1f442 Medium Insecure Configurations String schema/parameter/header should have 'maxLength' defined. Documentation Maximum Length Undefined (v3)8c8261c2-19a9-4ef7-ad37-b8bc7bdd4d85 Medium Insecure Configurations String schema should have 'maxLength' defined. Documentation Pattern Undefined (v2)afde15cf-9444-4126-8c62-41cd79db1d1d Medium Insecure Configurations String schema/parameter/header should have 'pattern' defined. Documentation Pattern Undefined (v3)00b78adf-b83f-419c-8ed8-c6018441dd3a Medium Insecure Configurations String schema should have 'pattern' defined. Documentation Numeric Schema Without Format (v2)3ed8fc82-c2bb-49e0-811f-c53923674c49 Medium Insecure Configurations Numeric schema (type set to 'integer' or 'number') should have 'format' defined. Documentation Numeric Schema Without Format (v3)fbf699b5-ef74-4542-9cf1-f6eeac379373 Medium Insecure Configurations Numeric schema (type set to 'integer' or 'number') should have 'format' defined. Documentation Success Response Code Undefined for Put Operation (v2)965a043f-5f3c-4d0a-be72-d9ce12fdb4d6 Medium Networking and Firewall Put should define at least one success response (200, 201, 202 or 204) Documentation Success Response Code Undefined for Put Operation (v3)60b5f56b-66ff-4e1c-9b62-5753e16825bc Medium Networking and Firewall Put should define at least one success response (200, 201, 202 or 204) Documentation Response on operations that should have a body has undefined schema (v2)31afbcb7-70e0-48bb-a31a-3374f95cf859 Medium Networking and Firewall If a response is not head or its code is not 204 or 304, it should have a schema defined Documentation Response on operations that should have a body has undefined schema (v3)a92be1d5-d762-484a-86d6-8cd0907ba100 Medium Networking and Firewall If a response is not head or its code is not 204 or 304, it should have a schema defined Documentation Success Response Code Undefined for Delete Operation (v2)ad432855-b7fb-4429-92a3-93b5ce34f0b1 Medium Networking and Firewall Delete should define at least one success response (200, 201, 202 or 204) Documentation Success Response Code Undefined for Delete Operation (v3)3b497874-ae59-46dd-8d72-1868a3b8f150 Medium Networking and Firewall Delete should define at least one success response (200, 201, 202 or 204) Documentation Success Response Code Undefined for Patch Operation (v2)f36e87cc-a209-4f37-8571-66833e4aead7 Medium Networking and Firewall Patch should define at least one success response (200, 201, 202 or 204) Documentation Success Response Code Undefined for Patch Operation (v3)1908a8ee-927d-4166-8f18-241152170cc1 Medium Networking and Firewall Patch should define at least one success response (200, 201, 202 or 204) Documentation Default Response Undefined On Operations (v2)5f34c7ae-4f3f-4cbb-8fe3-a11d6961062f Medium Networking and Firewall Operations responses should have a default response defined Documentation Default Response Undefined On Operations (v3)86e3702f-c868-44b2-b61d-ea5316c18110 Medium Networking and Firewall Operations responses should have a default response defined Documentation Success Response Code Undefined for Post Operation (v2)9fedee41-2e6d-4091-b011-4a16b4c18c70 Medium Networking and Firewall Post should define at least one success response (200, 201, 202 or 204) Documentation Success Response Code Undefined for Post Operation (v3)f368dd2d-9344-4146-a05b-7c6faa1269ad Medium Networking and Firewall Post should define at least one success response (200, 201, 202 or 204) Documentation Response Code Missing (v2)6e96ed39-bf45-4089-99ba-f1fe7cf6966f Medium Networking and Firewall 500, 429 and 400 responses should be defined for all operations, except head operation. 415 response should be defined for the post, put, and patch operations. 404 response should be defined for the get, put, head, delete operations. 200 response should be defined for options operation. 401 and 403 response should be defined for all operations when the security field is defined. Documentation Response Code Missing (v3)6c35d2c6-09f2-4e5c-a094-e0e91327071d Medium Networking and Firewall 500, 429 and 400 responses should be defined for all operations, except head operation. 415 response should be defined for the post, put, and patch operations. 404 response should be defined for the get, put, head, delete operations. 200 response should be defined for options operation. 401 and 403 response should be defined for all operations when the security field is defined. Documentation Success Response Code Undefined for Get Operation (v2)9b633f3b-c94b-4fbb-a65b-1a4e9134fb63 Medium Networking and Firewall Get should define at least one success response (200 or 202) Documentation Success Response Code Undefined for Get Operation (v3)b2f275be-7d64-4064-b418-be6b431363a7 Medium Networking and Firewall Get should define at least one success response (200 or 202) Documentation Success Response Code Undefined for Head Operation (v2)4f0b30e3-a498-4dd7-b3f2-f4b6471a8d5a Medium Networking and Firewall Head should define at least one success response (200 or 202) Documentation Success Response Code Undefined for Head Operation (v3)3b066059-f411-4554-ac8d-96f32bff90da Medium Networking and Firewall Head should define at least one success response (200 or 202) Documentation Response on operations that should not have a body has declared content (v2)268defd2-2839-4e15-8cbc-de86eb38c231 Medium Networking and Firewall If a response is head or its code is 204 or 304, it shouldn't have a schema defined Documentation Response on operations that should not have a body has declared content (v3)12a7210b-f4b4-47d0-acac-0a819e2a0ca3 Medium Networking and Firewall If a response is head or its code is 204 or 304, it shouldn't have a content defined Documentation API Key Exposed In Operation Security (v2)392599e4-a4e2-403d-bc56-3fe05755782d Low Access Control API Keys should not be transported over network Documentation API Key Exposed In Operation Security (v3)281b8071-6226-4a43-911d-fec246d422c2 Low Access Control API Keys should not be transported over network Documentation Invalid Format (v2)caf1793e-95dd-4b18-8d90-8f3c0ab5bddf Low Insecure Configurations The format should be valid for the type defined. For integer type must be int32 or int64 and number type must be float or double Documentation Invalid Format (v3)d929c031-078f-4241-b802-e224656ad890 Low Insecure Configurations The format should be valid for the type defined. For integer type must be int32 or int64 and number type must be float or double Documentation Path Without Operation (v2)609cd557-66b4-41fa-8edd-2abc6c7cfd08 Info Best Practices Path object should have at least one operation object defined Documentation Path Without Operation (v3)84c826c9-1893-4b34-8cdd-db97645b4bf3 Info Best Practices Path object should have at least one operation object defined Documentation Invalid License URL (v2)de2b4910-8484-46d6-a055-dc1e793ee3ff Info Best Practices License Object URL should be a valid URL Documentation Invalid License URL (v3)9239c289-9e4c-4d92-8be1-9d506057c971 Info Best Practices License Object URL should be a valid URL Documentation Header Parameter Named as 'Content-Type' (v2)51978067-3b22-4c29-aaf3-96bf0bc28897 Info Best Practices The header Parameter should not be named as 'Content-Type'. If so, it will be ignored. Documentation Header Parameter Named as 'Content-Type' (v3)72d259ca-9741-48dd-9f62-eb11f2936b37 Info Best Practices The header Parameter should not be named as 'Content-Type'. If so, it will be ignored. Documentation Invalid Schema External Documentation URL (v2)f7fa95b7-d819-484c-9a2b-665dd1bba25e Info Best Practices Schema External Documentation URL should be a valid URL Documentation Invalid Schema External Documentation URL (v3)6952a7e0-6e48-4285-bbc1-27c64e60f888 Info Best Practices Schema External Documentation URL should be a valid URL Documentation Required Property With Default Value (v2)f7ab6c83-ef89-40e1-8a99-32e2599fb665 Info Best Practices Required properties receive value from requests, which makes unnecessary declare a default value Documentation Required Property With Default Value (v3)013bdb4b-9246-4248-b0c3-7fb0fee42a29 Info Best Practices Required properties receive value from requests, which makes unnecessary declare a default value Documentation Header Parameter Named as 'Authorization' (v2)e2e00c97-7171-4fb4-b461-d631df9a711c Info Best Practices The header Parameter should not be named as 'Authorization'. If so, it will be ignored. Documentation Header Parameter Named as 'Authorization' (v3)8c84f75e-5048-4926-a4cb-33e7b3431300 Info Best Practices The header Parameter should not be named as 'Authorization'. If so, it will be ignored. Documentation Invalid Contact Email (v2)d83bebc8-4e5e-4241-b783-cba9fb5a1c9a Info Best Practices Contact Object Email should be a valid email Documentation Invalid Contact Email (v3)b1a7fcb0-2afe-4d5c-a6a1-4e6311fc29e7 Info Best Practices Contact Object Email should be a valid email Documentation Invalid Operation External Documentation URL (v2)25635c31-ee32-4708-88e5-fced87516f51 Info Best Practices Operation External Documentation URL should be a valid URL Documentation Invalid Operation External Documentation URL (v3)5ea61624-3733-4a3a-8ca4-b96fec9c5aeb Info Best Practices Operation External Documentation URL should be a valid URL Documentation Object Using Enum With Keyword (v2)7f15962a-d862-451c-ac9b-84ec13747aa6 Info Best Practices Schema/Parameter/Header Object properties should not contain 'enum' and schema keywords Documentation Object Using Enum With Keyword (v3)2e9b6612-8f69-42e0-a5b8-ed17739c2f3a Info Best Practices Schema Object properties should not contain 'enum' and schema keywords Documentation JSON '$ref' alongside other properties (v2)f34c1c68-4773-4df0-a103-6e2ca32e585f Info Best Practices Each field on Open API specification which accepts '$ref', infers that field is using a reference object, which has only '$ref' key Documentation JSON '$ref' alongside other properties (v3)96beb800-566f-49a9-a0ea-dbdf4bc80429 Info Best Practices Each field on Open API specification which accepts '$ref', infers that field is using a reference object, which has only '$ref' key Documentation Invalid Global External Documentation URL (v2)46d3b74d-9fe9-45bf-9e9e-efb7f701ee28 Info Best Practices Global External Documentation URL should be a valid URL Documentation Invalid Global External Documentation URL (v3)b2d9dbf6-539c-4374-a1fd-210ddf5563a8 Info Best Practices Global External Documentation URL should be a valid URL Documentation Header Response Name Is Invalid (v2)86733e01-a435-4bd5-a8b0-5108be9dc1e4 Info Best Practices The Header Response should not be named as 'Content-Type', 'Authorization' or 'Accept'. If so, it will be ignored. Documentation Header Response Name Is Invalid (v3)d4e43db5-54d8-4dda-b3c2-0dc6f31a46bd Info Best Practices The Header Response should not be named as 'Content-Type', 'Authorization' or 'Accept'. If so, it will be ignored. Documentation Example Not Compliant With Schema Type (v2)448db771-06ea-4dee-b48c-1689cbfb4b43 Info Best Practices Examples values and fields should be compliant with the schema type Documentation Example Not Compliant With Schema Type (v3)881a6e71-c2a7-4fe2-b9c3-dfcf08895331 Info Best Practices Examples values and fields should be compliant with the schema type Documentation Header Parameter Named as 'Accept' (v2)3ddd74cc-6582-486c-8b0c-2b48cb38e0a3 Info Best Practices The header Parameter should not be named as 'Accept'. If so, it will be ignored. Documentation Header Parameter Named as 'Accept' (v3)f2702af5-6016-46cb-bbc8-84c766032095 Info Best Practices The header Parameter should not be named as 'Accept'. If so, it will be ignored. Documentation Invalid Contact URL (v2)c7000383-16d0-4509-8cd3-585e5ea2e2f2 Info Best Practices Contact Object URL should be a valid URL Documentation Invalid Contact URL (v3)332cf2ad-380d-4b90-b436-46f8e635cf38 Info Best Practices Contact Object URL should be a valid URL Documentation Operation Without Successful HTTP Status Code (v2)a1ee6ebe-3877-42ec-b9a6-e524e7d06aa2 Info Best Practices Operation Object should have at least one successful HTTP status code defined Documentation Operation Without Successful HTTP Status Code (v3)48e9e1fe-cf79-45b5-93e6-8b55ae5dadfd Info Best Practices Operation Object should have at least one successful HTTP status code defined Documentation Invalid Tag External Documentation URL (v2)b4a7d925-738b-4219-99d9-87d6ee262a03 Info Best Practices Tag External Documentation URL should be a valid URL Documentation Invalid Tag External Documentation URL (v3)5aea1d7e-b834-4749-b143-2c7ec3bd5922 Info Best Practices Tag External Documentation URL should be a valid URL Documentation Template Path With No Corresponding Path Parameter (v2)e7656d8d-7288-4bbe-b07b-22b389be75ce Info Structure and Semantics The template path must have a corresponding path parameter for a given operation Documentation Template Path With No Corresponding Path Parameter (v3)561710b1-b845-4562-95ce-2397a05ccef4 Info Structure and Semantics The template path must have a corresponding path parameter for a given operation Documentation Default Invalid (v2)78dfd8f0-a6ee-48ec-af8c-e4d9b3292a07 Info Structure and Semantics The field 'default' of Schema/Parameter/Header Object should be consistent with the schema's/parameter's/header's type Documentation Default Invalid (v3)a96bbc06-8cde-4295-ad3c-ee343a7f658e Info Structure and Semantics The field 'default' of Schema Object should be consistent with the schema's type Documentation Schema Enum Invalid (v2)8fe6d18a-ad4c-4397-8884-e3a9da57f4c9 Info Structure and Semantics The field 'enum' of Schema Object should be consistent with the schema's type Documentation Schema Enum Invalid (v3)03856cb2-e46c-4daf-bfbf-214ec93c882b Info Structure and Semantics The field 'enum' of Schema Object should be consistent with the schema's type Documentation Responses With Wrong HTTP Status Code (v2)069a5378-2091-43f0-aa3b-ee8f20996e99 Info Structure and Semantics HTTP Responses status code should be in range of [200-599] Documentation Responses With Wrong HTTP Status Code (v3)d86655c0-92f6-4ffc-b4d5-5b5775804c27 Info Structure and Semantics HTTP Responses status code should be in range of [200-599] Documentation Schema Has A Required Property Undefined (v2)811762c8-2e99-4f70-88f9-a63875a953b1 Info Structure and Semantics Schema Object should not be have a required property that is not defined on properties Documentation Schema Has A Required Property Undefined (v3)2bd608ae-8a1f-457f-b710-c237883cb313 Info Structure and Semantics Schema Object should not be have a required property that is not defined on properties Documentation Parameters Name In Combination Not Unique (v2)ab871897-ec02-4835-9818-702536ee1dda Info Structure and Semantics Parameters properties 'name' and 'in' should have unique combinations Documentation Parameters Name In Combination Not Unique (v3)f5b2e6af-76f5-496d-8482-8f898c5fdb4a Info Structure and Semantics Parameters properties 'name' and 'in' should have unique combinations Documentation Items Undefined (v2)3e4d34d2-36cf-4449-976d-6c256db8fc49 Info Structure and Semantics Schema/Parameter items should be defined when the schema/parameter is set to an array. Documentation Items Undefined (v3)a8e859da-4a43-4e7f-94b8-25d6e3bf8e90 Info Structure and Semantics Schema/Parameter items should be defined when the schema/parameter is set to an array. Documentation Path Parameter With No Corresponding Template Path (v2)194ef1f8-360e-4c14-8ed2-e83e2bafa142 Info Structure and Semantics The path parameter must have a corresponding template path for a given operation Documentation Path Parameter With No Corresponding Template Path (v3)69d7aefd-149d-47b8-8d89-1c2181a8067b Info Structure and Semantics The path parameter must have a corresponding template path for a given operation Documentation OperationId Not Unique (v2)21245007-91c4-40e5-964e-40c85d1e5aa6 Info Structure and Semantics OperationId should be unique when defined Documentation OperationId Not Unique (v3)c254adc4-ef25-46e1-8270-b7944adb4198 Info Structure and Semantics OperationId should be unique when defined Documentation Schema Object With Circular Ref (v2)cbff2508-85c9-4448-a8b3-770070edf5ca Info Structure and Semantics Schema Object should not reference it self in 'allOf', 'oneOf', 'anyOf' and 'not' properties Documentation Schema Object With Circular Ref (v3)1a1aea94-745b-40a7-b860-0702ea6ee636 Info Structure and Semantics Schema Object should not reference it self in 'allOf', 'oneOf', 'anyOf' and 'not' properties Documentation Schema Discriminator Not Required (v2)be6a3722-af60-438c-b1b9-2a03e2958ab7 Info Structure and Semantics The discriminator property in the Schema Object should be a required property Documentation Schema Discriminator Not Required (v3)b481d46c-9c61-480f-86d9-af07146dc4a4 Info Structure and Semantics The discriminator property in the Schema Object should be a required property Documentation Path Is Ambiguous (v2)b2468463-3ac4-4930-890c-f35b2bf4485d Info Structure and Semantics All path should be unique, if has more than one operation, all operations should be part of same Path Object Documentation Path Is Ambiguous (v3)237402e2-c2f0-46c9-9cf5-286160cf7bfc Info Structure and Semantics All path should be unique, if has more than one operation, all operations should be part of same Path Object Documentation Path Parameter Not Required (v2)ccd0613f-cb77-4684-a892-183bd2674d12 Info Structure and Semantics The property 'required' determines whether the parameter is mandatory. If the parameter location is 'path', this property is required and its value must be true. Documentation Path Parameter Not Required (v3)0de50145-e845-47f4-9a15-23bcf2125710 Info Structure and Semantics The property 'required' determines whether the parameter is mandatory. If the parameter location is 'path', this property is required and its value must be true. Documentation Property 'allowEmptyValue' Improperly Defined (v2)0bc1477d-0922-478b-ae16-674a7634a1a8 Info Structure and Semantics Property 'allowEmptyValue' should be only defined for query parameters and formData parameters Documentation Property 'allowEmptyValue' Improperly Defined (v3)4bcbcd52-3028-469f-bc14-02c7dbba2df2 Info Structure and Semantics Property 'allowEmptyValue' should be only defined for query parameters and formData parameters Documentation Responses Object Is Empty (v2)6172e7ab-d2b7-45f8-a7db-1603931d8ba3 Info Structure and Semantics Responses Object should not be empty Documentation Responses Object Is Empty (v3)990eaf09-d6f1-4c3c-b174-a517b1de8917 Info Structure and Semantics Responses Object should not be empty Documentation Schema Object Properties With Duplicated Keys (v2)ded017bf-fb13-4f8d-868b-84aebcc572ad Info Structure and Semantics Schema Object Property key should be unique through out the fields 'properties', 'allOf', 'additionalProperties' Documentation Schema Object Properties With Duplicated Keys (v3)10c61e4b-eed5-49cf-9c7d-d4bf02e9edfa Info Structure and Semantics Schema Object Property key should be unique through out the fields 'properties', 'allOf', 'additionalProperties' Documentation Path Template is Empty (v2)c201b7ad-6173-4598-a407-5edb04a1bcd7 Info Structure and Semantics All path templates should not be empty Documentation Path Template is Empty (v3)ae13a37d-943b-47a7-a970-83c8598bcca3 Info Structure and Semantics All path templates should not be empty Documentation Schema Discriminator Property Not String (v2)949376f1-f560-4c6d-a016-63424ca931bb Info Structure and Semantics Schema discriminator property should be a string Documentation Schema Discriminator Property Not String (v3)dadc2f36-1f5a-46c0-8289-75e626583123 Info Structure and Semantics Schema discriminator property should be a string Documentation Non-Array Schema With Items (v2)9d47956b-29cd-43b1-9e6e-b39a4d484353 Info Structure and Semantics Non-Array Schema should not have 'items' defined Documentation Non-Array Schema With Items (v3)20cb3159-b219-496b-8dac-54ae3ab2021a Info Structure and Semantics Non-Array Schema should not have 'items' defined Documentation Paths Object is Empty (v2)3e6c7b1c-8a8d-43ab-98b9-65159f44db4a Info Structure and Semantics Paths object may be empty due to ACL constraints, meaning they are not exposed Documentation Paths Object is Empty (v3)815021c8-a50c-46d9-b192-24f71072c400 Info Structure and Semantics Paths object may be empty due to ACL constraints, meaning they are not exposed Documentation Property Defining Minimum Greater Than Maximum (v2)b5102ea9-6527-4bb7-94fc-9b4076150e55 Info Structure and Semantics Property defining minimum has greater value than maximum defined Documentation Property Defining Minimum Greater Than Maximum (v3)ab2af219-cd08-4233-b5a1-a788aac88b51 Info Structure and Semantics Property defining minimum has greater value than maximum defined Documentation Parameter Objects Headers With Duplicated Name (v2)bd2cbef5-62c4-40f1-af07-4b7f9ced6616 Info Structure and Semantics Parameter Objects should not have duplicate names for 'header' location, since HTTP headers are not case sensitive. Documentation Parameter Objects Headers With Duplicated Name (v3)05505192-ba2c-4a81-9b25-dcdbcc973746 Info Structure and Semantics Parameter Objects should not have duplicate names for 'header' location, since HTTP headers are not case sensitive. Documentation Type Has Invalid Keyword (v2)492c6cbb-f3f8-4807-aa4f-42b8b1c46b59 Info Structure and Semantics Schema/Parameter/Header Object define type should not use a keyword of another type Documentation Type Has Invalid Keyword (v3)a9228976-10cf-4b5f-b902-9e962aad037a Info Structure and Semantics Schema Object define type should not use a keyword of another type Documentation Properties Missing Required Property (v2)71beb6ab-8b70-4816-a9ac-a0ff1fb22a62 Info Structure and Semantics Schema Object should have all required properties defined Documentation Properties Missing Required Property (v3)3fb03214-25d4-4bd4-867c-c2d8d708a483 Info Structure and Semantics Schema Object should have all required properties defined Documentation Schema Discriminator Mismatch Defined Properties (v2)addc0eab-27f6-4c26-8526-d2ccd3732662 Info Structure and Semantics Schema discriminator values should match defined properties. Documentation Schema Discriminator Mismatch Defined Properties (v3)40d3df21-c170-4dbe-9c02-4289b51f994f Info Structure and Semantics Schema discriminator values should match defined properties. Documentation"},{"location":"queries/openapi-queries/#30","title":"3.0","text":"<p>Bellow are listed queries related with OpenAPI 3.0:</p> Query Severity Category Description Help Cleartext Credentials With Basic Authentication For Operation86b1fa30-9790-4980-994d-a27e0f6f27c1 High Access Control Cleartext credentials over unencrypted channel should not be accepted for the operation Documentation Field 'securityScheme' On Components Is Undefined8db5544e-4874-4baa-9322-e9f75a2d219e High Access Control Components' securityScheme field must have a valid scheme Documentation Implicit Flow in OAuth2 (v3)4a1f3d75-ab73-41b2-83e7-06a93dc3a75a Medium Access Control There is a 'securityScheme' using implicit flow on OAuth2, which is deprecated Documentation Security Scheme HTTP Unknown Scheme06764426-3c56-407e-981f-caa25db1c149 Medium Access Control Security Scheme HTTP scheme should be registered in the IANA Authentication Scheme registry Documentation OAuth2 With Implicit Flow39cb32f2-3a42-4af0-8037-82a7a9654b6c Medium Access Control OAuth2 implicit flow is vulnerable to access token leakage and access token replay Documentation Security Scheme Using HTTP Digesta4247b11-890b-45df-bf42-350a7a3af9be Medium Access Control Security Scheme HTTP should not be using digest authentication Documentation Invalid OAuth2 Authorization URL (v3)52c0d841-60d6-4a81-88dd-c35fef36d315 Medium Access Control The field authorizationUrl on implicit or authorizationCode fields from OAuth must be a valid URL Documentation Invalid OAuth2 Token URL (v3)3ba0cca1-b815-47bf-ac62-1e584eb64a05 Medium Access Control OAuth2 security scheme flow requires a valid URL in the tokenUrl field Documentation OAuth2 With Password Flow3979b0a4-532c-4ea7-86e4-34c090eaa4f2 Medium Access Control OAuth2 password flow insecurely exposes the credentials of the resource owner to the client Documentation Security Scheme Using HTTP Negotiatef525cc92-9050-4c41-a75c-890dc6f64449 Medium Access Control Security Scheme HTTP should not be using negotiate authentication Documentation Security Scheme Using HTTP Basic68e5fcac-390c-4939-a373-6074b7be7c71 Medium Access Control Security Scheme HTTP should not be using basic authentication Documentation Path Server Object Uses HTTP (v3)9670f240-7b4d-4955-bd93-edaa9fa38b58 Medium Encryption The property 'url' in the Path Server Object should only allow 'HTTPS' protocols to ensure an encrypted connection Documentation Global Server Object Uses HTTP2d8c175a-6d90-412b-8b0e-e034ea49a1fe Medium Encryption Global server object URL should use 'https' protocol instead of 'http' Documentation Parameter Object Without Schema8fe1846f-52cc-4413-ace9-1933d7d23672 Medium Insecure Configurations The Parameter Object should have the attribute 'schema' defined Documentation Additional Properties Too Permissive9f88c88d-824d-4d9a-b985-e22977046042 Medium Insecure Configurations Objects should not accept 'additionalProperties' if it is possible Documentation Media Type Object Without Schemaf79b9d26-e945-44e7-98a1-b93f0f7a68a0 Medium Insecure Configurations The Media Type Object should have the attribute 'schema' defined Documentation Additional Properties Too Restrictivea19c3bbd-c056-40d7-9e1c-eeb0634e320d Medium Insecure Configurations Objects should accept 'additionalProperties' if it is allOf or an object with anyOf or oneOf Documentation Success Response Code Undefined for Trace Operation105e20dd-8449-4d71-95c6-d5dac96639af Medium Networking and Firewall Trace should define the '200' successful code Documentation Header Object Without Schema50de3b5b-6465-4e06-a9b0-b4c2ba34326b Medium Networking and Firewall The header object should have schema defined Documentation Security Scheme Using Oauth 1.01bc3205c-0d60-44e6-84f3-44fbf4dac5b3 Low Access Control Oauth 1.0 is deprecated, OAuth2 should be used instead Documentation Global Security Scheme Using Basic Authentication77276d82-4f45-4cf1-8e2b-4d345b936228 Low Access Control A security scheme is allowing basic authentication credentials to be transported over network Documentation Undefined Scope 'securityScheme' On Global 'security' Field23a9e2d9-8738-4556-a71c-2802b6ffa022 Low Access Control Using an scope on global security field that is undefined on 'securityScheme' can be defined by an attacker Documentation API Key Exposed In Global Security Scheme40e1d1bf-11a9-4f63-a3a2-a8b84c602839 Low Access Control API Keys should not be transported over network Documentation Undefined Scope 'securityScheme' On 'security' Field On Operations462d6a1d-fed9-4d75-bb9e-3de902f35e6e Low Access Control Using an scope on security of operations that is undefined on 'securityScheme' can be defined by an attacker Documentation Property 'allowReserved' of Encoding Object Ignored4190dda7-af03-4cf0-a128-70ac1661ca09 Info Best Practices Property 'allowReserved' of the encoding object should be defined when the media type of the request body is 'application/x-www-form-urlencoded'. If not, it will be ignored. Documentation Components Header Definition Is Unuseda68da022-e95a-4bc2-97d3-481e0bd6d446 Info Best Practices Components headers definitions should be referenced or removed from Open API definition Documentation Components Schema Definition Is Unused962fa01e-b791-4dcc-b04a-4a3e7389be5e Info Best Practices Components schemas definitions should be referenced or removed from Open API definition Documentation Components Callback Definition Is Unusedd15db953-a553-4b8a-9a14-a3d62ea3d79d Info Best Practices Components callbacks definitions should be referenced or removed from Open API definition Documentation Unknown Prefix (v3)a5375be3-521c-43bb-9eab-e2432e368ee4 Info Best Practices The media type prefix should be set as 'application', 'audio', 'font', 'example', 'image', 'message', 'model', 'multipart', 'text' or 'video' Documentation Property 'style' of Encoding Object Ignoredd3ea644a-9a5c-4fee-941f-f8a6786c0470 Info Best Practices Property 'style' of the encoding object should be defined when the media type of the request body is 'application/x-www-form-urlencoded'. If not, it will be ignored. Documentation Components Request Body Definition Is Unused6b76f589-9713-44ab-97f5-59a3dba1a285 Info Best Practices Components request bodies definitions should be referenced or removed from Open API definition Documentation Components Link Definition Is Unusedc19779a9-5774-4d2f-a3a1-a99831730375 Info Best Practices Components links definitions should be referenced or removed from Open API definition Documentation Encoding Header 'Content-Type' Improperly Defined4cd8de87-b595-48b6-ab3c-1904567135ab Info Best Practices Encoding Map Key should not define a 'Content-Type' in the 'headers' field. If so, it will be ignored. Documentation Components Parameter Definition Is Unused698a464e-bb3e-4ba8-ab5e-e6599b7644a0 Info Best Practices Components parameters definitions should be referenced or removed from Open API definition Documentation Property 'allowEmptyValue' Ignored59c2f769-7cc2-49c8-a3de-4e211135cfab Info Best Practices Property 'allowEmptyValue' is ignored in the following cases: {\"sytle\": \"simple\", \"explode\": false}, {\"sytle\": \"simple\", \"explode\": true}, {\"sytle\": \"spaceDelimited\", \"explode\": false}, {\"sytle\": \"pipeDelimited\", \"explode\": false}, and {\"sytle\": \"deepObject\", \"explode\": true} Documentation Invalid Media Type Value (v3)cf4a5f45-a27b-49df-843a-9911dbfe71d4 Info Best Practices The Media Type value should match the following format: /[+suffix][;parameters] Documentation Components Response Definition Is Unused9c3ea128-7e9a-4b4c-8a32-75ad17a2d3ae Info Best Practices Components responses definitions should be referenced or removed from Open API definition Documentation Property 'explode' of Encoding Object Ignoreda4dd69b8-49fa-45d2-a060-c76655405b05 Info Best Practices Property 'explode' of the encoding object should be defined when the media type of the request body is 'application/x-www-form-urlencoded'. If not, it will be ignored. Documentation Components Example Definition Is Unusedb05bb927-2df5-43cc-8d7b-6825c0e71625 Info Best Practices Components examples definitions should be referenced or removed from Open API definition Documentation Server URL Uses Undefined Variables8d0921d6-4131-461f-a253-99e873f8f77e Info Structure and Semantics Any variable used in the Service URL should be defined in the Service Object through 'variables'. Documentation Request Body With Incorrect Ref0f6cd0ab-c366-4595-84fc-fbd8b9901e4d Info Structure and Semantics Request Body reference must always point to '#/components/RequestBodies' Documentation Parameter JSON Reference Does Not Exists (v3)2e275f16-b627-4d3f-ae73-a6153a23ae8f Info Structure and Semantics Parameter reference should exists on components field Documentation Parameter Object Content With Multiple Entries8bfed1c6-2d59-4924-bc7f-9b9d793ed0df Info Structure and Semantics The map content property of the parameter object should only contain one entry Documentation Parameter Object With Incorrect Ref (v3)d40f27e6-15fb-4b56-90f8-fc0ff0291c51 Info Structure and Semantics Parameter Object reference must always point to '#/components/parameters' Documentation Server Object Variable Not Used8aee4754-970d-4c5f-8142-a49dfe388b1a Info Structure and Semantics Every defined Server Variable Object should be used in a Service URL. Documentation Example JSON Reference Does Not Exists6a2c219f-da5e-4745-941e-5ea8cde23356 Info Structure and Semantics Example reference should exists on components field Documentation Header Object With Incorrect Ref2d6646f4-2946-420f-8c14-3232d49ae0cb Info Structure and Semantics Header Object reference must always point to '#/components/headers' Documentation Security Field Undefinedab1263c2-81df-46f0-9f2c-0b62fdb68419 Info Structure and Semantics Security field should be defined in '#/components/securitySchemes' Documentation Object Without Required Property (v3)d172a060-8569-4412-8045-3560ebd477e8 Info Structure and Semantics OpenAPI Object should contain all of its required fields Documentation Parameter Object With Undefined Type46facedc-f243-4108-ab33-583b807d50b0 Info Structure and Semantics A Parameter Object must contain either a 'schema' property, or a 'content' property Documentation Invalid Content Type For Multiple Files Upload26f06397-36d8-4ce7-b993-17711261d777 Info Structure and Semantics Content Type should be set to 'multipart/form-data' in case of uploading an arbitrary number of files (array) Documentation Server URL Not Absolutea0bf7382-5d5a-4224-924c-3db8466026c9 Info Structure and Semantics The Server URL should be an absolute URL Documentation Property 'allowReserved' Improperly Defined7f203940-39c4-4ea7-91ee-7aba16bca9e2 Info Structure and Semantics Property 'allowReserved' should be only defined for query parameters Documentation Empty Array5915c20f-dffa-4cee-b5d4-f457ddc0151a Info Structure and Semantics All array fields should not be empty Documentation Schema JSON Reference Does Not Exists (v3)015eac96-6313-43c0-84e5-81b1374fa637 Info Structure and Semantics Schema reference should exists on components field Documentation Callback JSON Reference Does Not Existsf29904c8-6041-4bca-b043-dfa0546b8079 Info Structure and Semantics Callback reference should exists on components field Documentation Response JSON Reference Does Not Exists (v3)7a01dfbd-da62-4165-aed7-71349ad42ab4 Info Structure and Semantics Response reference should exists on components field Documentation Schema Object Incorrect Ref (v3)4cac7ace-b0fb-477d-830d-65395d9109d9 Info Structure and Semantics Schema Object reference must always point to '#/components/schemas' Documentation Request Body JSON Reference Does Not Existsca02f4e8-d3ae-4832-b7db-bb037516d9e7 Info Structure and Semantics Request Body reference should exists on components field Documentation Servers Array Undefinedc66ebeaa-676c-40dc-a3ff-3e49395dcd5e Info Structure and Semantics The Servers array should have at least one server defined. If not, the default value would be a Server Object with a URL value of '/'. Documentation Schema With Both ReadOnly And WriteOnlyd2361d58-361c-49f0-9e50-b957fd608b29 Info Structure and Semantics Schema should not have both 'writeOnly' and 'readOnly' set to true Documentation Link Object OperationId Does Not Target Operation Objectc5bb7461-aa57-470b-a714-3bc3d74f4669 Info Structure and Semantics Link object 'OperationId' should target an existing operation object in the OpenAPI definition Documentation Components Object Fixed Field Key Improperly Named151331e2-11f4-4bb6-bd35-9a005e695087 Info Structure and Semantics Components object fixed fields (schemas, responses, parameters, examples, requestBodies, headers, securitySchemes, links, and callbacks) should use keys that match the following REGEX: <code>^[a-zA-Z0-9\\.\\-_]+$</code> Documentation Encoding Map Key Mismatch Schema Defined Propertiescd7a52cf-8d7f-4cfe-bbeb-6306d23f576b Info Structure and Semantics Encoding Map Key should be set in schema defined properties Documentation Security Requirement Object With Wrong Scopes37140f7f-724a-4c87-a536-e9cee1d61533 Info Structure and Semantics Security Requirement Object should only have scopes defined for security schemes of type 'oauth2' and 'openIdConnect' Documentation Response Object With Incorrect Ref (v3)b3871dd8-9333-4d6c-bd52-67eb898b71ab Info Structure and Semantics Response Object reference must always point to '#/components/responses' Documentation Parameter Object With Schema And Content31dd6fc0-f274-493b-9614-e063086c19fc Info Structure and Semantics A Parameter Object must contain either a 'schema' property, or a 'content' property, but not both since they are mutually exclusive Documentation Callback Object With Incorrect Refba066cda-e808-450d-92b6-f29109754d45 Info Structure and Semantics Callback Object reference must always point to '#/components/callbacks' Documentation Link Object Incorrect Refb9db8a10-020c-49ca-88c6-780e5fdb4328 Info Structure and Semantics Link object reference must always point to '#/components/links' Documentation Unknown Property (v3)fb7d81e7-4150-48c4-b914-92fc05da6a2f Info Structure and Semantics All properties defined in OpenAPI objects should be known Documentation Link JSON Reference Does Not Exists801f0c6a-a834-4467-89c6-ddecffb46b5a Info Structure and Semantics Link reference should exists on components field Documentation Security Operation Field Undefined20a482d5-c5d9-4a7a-b7a4-60d0805047b4 Info Structure and Semantics Security operation field should be defined in '#/components/securitySchemes' Documentation Example JSON Reference Outside Components Examplesbac56e3c-1f71-4a74-8ae6-2fba07efcddb Info Structure and Semantics Reference to examples should point to #/components/examples Documentation Header JSON Reference Does Not Exists376c9390-7e9e-4cb8-a067-fd31c05451fd Info Structure and Semantics Header reference should exists on components field Documentation Request Body Object With Incorrect Media Type58f06434-a88c-4f74-826c-db7e10cc7def Info Structure and Semantics The field 'content' of the request body object should be set to 'multipart' or 'application/x-www-form-urlencoded' when field 'encoding' is set. Documentation Link Object With Both 'operationId' And 'operationRef'60fb6621-9f02-473b-9424-ba9a825747d3 Info Structure and Semantics Link object 'OperationId' should not have both 'operationId' and 'operationRef' defined since they are mutually exclusive. Documentation"},{"location":"queries/pulumi-queries/","title":"Pulumi queries","text":""},{"location":"queries/pulumi-queries/#pulumi_queries_list","title":"Pulumi Queries List","text":"<p>This page contains all queries from Pulumi.</p>"},{"location":"queries/pulumi-queries/#aws","title":"AWS","text":"<p>Bellow are listed queries related with Pulumi AWS:</p> Query Severity Category Description Help ElastiCache Nodes Not Created Across Multi AZ9b18fc19-7fb8-49b1-8452-9c757c70f926 Medium Availability ElastiCache Nodes should be created across multi az, which means 'AZMode' should be set to 'cross-az' in multi nodes cluster Documentation ElastiCache Redis Cluster Without Backupe93bbe63-a631-4c0f-b6ef-700d48441ff2 Medium Backup ElastiCache Redis cluster should have 'snapshotRetentionLimit' higher than 0 Documentation IAM Password Without Lowercase Letterde92dd34-1b88-43e8-b825-6e02d73c4549 Medium Best Practices IAM Password should have at least one lowercase letter Documentation IAM Password Without Minimum Length9850d621-7485-44f7-8bdd-b3cf426315cf Medium Best Practices IAM password should have the required minimum length Documentation DynamoDB Table Not Encryptedb6a7e0ae-aed8-4a19-a993-a95760bf8836 Medium Encryption AWS DynamoDB Tables should have serverSideEncryption enabled Documentation API Gateway Without SSL Certificatef27791a5-e2ae-4905-8910-6f995c576d09 Medium Insecure Configurations SSL Client Certificate should be defined Documentation API Gateway Access Logging Disabledbf4b48b9-fc1f-4552-984a-4becdb5bf503 Medium Observability API Gateway should have Access Log Settings defined Documentation EC2 Not EBS Optimizedd991e4ae-42ab-429b-ab43-d5e5fa9ca633 Info Best Practices It's considered a best practice for an EC2 instance to use an EBS optimized instance. This provides the best performance for your EBS volumes by minimizing contention between Amazon EBS I/O and other traffic from your instance Documentation DynamoDB Table Point In Time Recovery Disabled327b0729-4c5c-4c44-8b5c-e476cd9c7290 Info Best Practices It's considered a best practice to have point in time recovery enabled for DynamoDB Table Documentation EC2 Instance Monitoring Disableddaa581ef-731c-4121-832d-cf078f67759d Info Observability EC2 Instance should have detailed monitoring enabled. With detailed monitoring enabled data is available in 1-minute periods Documentation"},{"location":"queries/pulumi-queries/#kubernetes","title":"KUBERNETES","text":"<p>Bellow are listed queries related with Pulumi KUBERNETES:</p> Query Severity Category Description Help PSP Set To Privilegedee305555-6b1d-4055-94cf-e22131143c34 Medium Insecure Configurations Do not allow pod to request execution as privileged. Documentation Missing App Armor Config95588189-1abd-4df1-9588-b0a5034f9e87 Low Access Control Containers should be configured with AppArmor for any application to reduce its potential attack Documentation"},{"location":"queries/pulumi-queries/#gcp","title":"GCP","text":"<p>Bellow are listed queries related with Pulumi GCP:</p> Query Severity Category Description Help Cloud Storage Bucket Logging Not Enabled48f7e44d-d1d1-44c2-b336-9f11b65c4fb0 High Observability Cloud storage bucket should have logging enabled Documentation Google Compute SSL Policy Weak Cipher In Use965e8830-2bec-4b9b-a7f0-24dbc200a68f Medium Encryption This query confirms if Google Compute SSL Policy Weak Chyper Suits is Enabled, to do so we need to check if TLS is TLS_1_2, because other version have Weak Chypers Documentation"},{"location":"queries/pulumi-queries/#azure","title":"AZURE","text":"<p>Bellow are listed queries related with Pulumi AZURE:</p> Query Severity Category Description Help Storage Account Not Forcing HTTPScb8e4bf0-903d-45c6-a278-9a947d82a27b High Encryption Storage Accounts should enforce the use of HTTPS Documentation Redis Cache Allows Non SSL Connections49e30ac8-f58e-4222-b488-3dcb90158ec1 Medium Encryption Redis Cache resource should not allow non-SSL connections. Documentation"},{"location":"queries/serverlessfw-queries/","title":"Serverlessfw queries","text":""},{"location":"queries/serverlessfw-queries/#serverlessfw_queries_list","title":"ServerlessFW Queries List","text":"<p>This page contains all queries from ServerlessFW.</p> Query Severity Category Description Help Serverless Role With Full Privileges59ebb4f3-2a6c-46dc-b4f0-cc5418dcddcd High Access Control Roles defined in Serverless files should not have policies granting full administrative privileges. Documentation Serverless Function Environment Variables Not Encrypted4495bc5d-4d1e-4a26-ae92-152d18195648 High Encryption Serverless Function should encrypt environment variables Documentation Serverless API Without Content Encodingd5d1fe08-89db-440c-8725-b93223387309 Medium Encryption Serverless should have API Gateway with Content Encoding enabled through the attribute 'minimumCompressionSize'. This value should be greater than -1 and smaller than 10485760 Documentation Serverless Function Without Unique IAM Role165aae3b-a56a-48f3-b76d-d2b5083f5b8f Medium Insecure Configurations Serverless Function should not share IAM Role to ensure it will have the minimum privileges needed to perform the required tasks Documentation Serverless Function Without Tagsf99d3482-fa8c-4f79-bad9-35212dded164 Medium Insecure Configurations Serverless Function should be have associated tags Documentation Serverless API Endpoint Config Not Private4d424558-c6d1-453c-be98-9a7f877abd9a Medium Networking and Firewall Serverless should have endpointType set to 'PRIVATE'. This way, it's not exposed to the public internet Documentation Serverless API Access Logging Setting Undefineda4d32883-aac7-42e1-b403-9415af0f3846 Medium Observability Serverless FW API should have HTTP Access Logging enabled Documentation Serverless API X-Ray Tracing Disabled434945e5-4dfd-41b1-aba1-47075ccd9265 Medium Observability Serverless API Gateway should have X-Ray Tracing enabled Documentation Serverless Function Without Dead Letter Queuedec7bc85-d156-4f64-9a33-96ed3d9f3fed Low Insecure Configurations Serverless Function should be configured for a Dead Letter Queue(DLQ). A Dead Letter Queue(DLQ) can be set up in 'onError' config parameter Documentation Serverless Function Without X-Ray Tracing0d7ef70f-e176-44e6-bdba-add3e429788d Low Observability Serverless Function should have Tracing enabled. For this, property 'tracing' should have the value 'Active' Documentation"},{"location":"queries/terraform-queries/","title":"Terraform","text":""},{"location":"queries/terraform-queries/#terraform_queries_list","title":"Terraform Queries List","text":"<p>This page contains all queries from Terraform.</p>"},{"location":"queries/terraform-queries/#aws","title":"AWS","text":"<p>Bellow are listed queries related with Terraform AWS:</p> Query Severity Category Description Help S3 Bucket Allows List Action From All Principals66c6f96f-2d9e-417e-a998-9058aeeecd44 High Access Control S3 Buckets must not allow List Action From All Principals, as to prevent leaking private information to the entire internet or allow unauthorized data tampering / deletion. This means the 'Effect' must not be 'Allow' when the 'Action' is List, for all Principals. Documentation S3 Bucket Allows Public Policy1a4bc881-9f69-4d44-8c9a-d37d08f54c50 High Access Control S3 bucket allows public policy Documentation S3 Bucket With All Permissionsa4966c4f-9141-48b8-a564-ffe9959945bc High Access Control S3 Buckets should not have all permissions, as to prevent leaking private information to the entire internet or allow unauthorized data tampering / deletion. This means the 'Effect' must not be 'Allow' when the 'Action' is '*', for all Principals. Documentation SSO Policy with full privileges132a8c31-9837-4203-9fd1-15ca210c7b73 High Access Control SSO policies should be configured to grant limited administrative privileges, rather than full access to all resources. This approach allows for better security and control over the resources being accessed. Documentation S3 Bucket Access to Any Principal7af43613-6bb9-4a0e-8c4d-1314b799425e High Access Control S3 Buckets must not allow Actions From All Principals, as to prevent leaking private information to the entire internet or allow unauthorized data tampering / deletion. This means the 'Effect' must not be 'Allow' when there are All Principals Documentation S3 Bucket ACL Allows Read Or Write to All Users38c5ee0d-7f22-4260-ab72-5073048df100 High Access Control S3 Buckets should not be readable and writable to all users Documentation S3 Bucket ACL Allows Read to Any Authenticated User57b9893d-33b1-4419-bcea-a717ea87e139 High Access Control S3 Buckets should not be readable to any authenticated user Documentation IAM Role With Full Privilegesb1ffa705-19a3-4b73-b9d0-0c97d0663842 High Access Control IAM role policy that allow full administrative privileges (for all resources) Documentation S3 Bucket Allows Put Action From All Principalsd24c0755-c028-44b1-b503-8e719c898832 High Access Control S3 Buckets must not allow Put Action From All Principals, as to prevent leaking private information to the entire internet or allow unauthorized data tampering / deletion. This means the 'Effect' must not be 'Allow' when the 'Action' is Put, for all Principals. Documentation IAM Policies With Full Privileges2f37c4a3-58b9-4afe-8a87-d7f1d2286f84 High Access Control IAM policies shouldn't allow full administrative privileges (for all resources) Documentation SNS Topic is Publicly Accessibleb26d2b7e-60f6-413d-a3a1-a57db24aa2b3 High Access Control SNS Topic Policy should not allow any principal to access Documentation EFS With Vulnerable Policyfae52418-bb8b-4ac2-b287-0b9082d6a3fd High Access Control EFS (Elastic File System) policy should avoid wildcard in 'Action' and 'Principal'. Documentation MSK Broker Is Publicly Accessible54378d69-dd7c-4b08-a43e-80d563396857 High Access Control Public AWS MSK allows anyone to interact with the Apache Kafka broker, therefore increasing the opportunity for malicious activity. To prevent such a scenario, it is recommended for AWS MSK to not be publicly accessible Documentation S3 Bucket ACL Grants WRITE_ACP Permission64a222aa-7793-4e40-915f-4b302c76e4d4 High Access Control S3 Buckets should not allow WRITE_ACP permission to the S3 Bucket Access Control List in order to prevent AWS accounts or IAM users to modify access control permissions to the bucket. Documentation IAM Policy Grants Full Permissions575a2155-6af1-4026-b1af-d5bc8fe2a904 High Access Control IAM policy should not grant full permissions to resources from the get-go, instead of granting permissions gradually as necessary. Documentation Authentication Without MFA3ddfa124-6407-4845-a501-179f90c65097 High Access Control Users should authenticate with MFA (Multi-factor Authentication) to ensure an extra layer of protection when authenticating Documentation Neptune Cluster Instance is Publicly Accessible9ba198e0-fef4-464a-8a4d-75ea55300de7 High Access Control Neptune Cluster Instance should not be publicly accessible Documentation SQS Queue Exposedabb06e5f-ef9a-4a99-98c6-376d396bfcdf High Access Control Checks if the SQS Queue is exposed Documentation S3 Bucket Allows Get Action From All Principals1df37f4b-7197-45ce-83f8-9994d2fcf885 High Access Control S3 Buckets must not allow Get Action From All Principals, as to prevent leaking private information to the entire internet or allow unauthorized data tampering / deletion. This means the 'Effect' must not be 'Allow' when the 'Action' is Get, for all Principals. Documentation ECS Service Admin Role Is Present3206240f-2e87-4e58-8d24-3e19e7c83d7c High Access Control ECS Services must not have Admin roles, which means the attribute 'iam_role' must not be an admin role Documentation S3 Bucket Allows Delete Action From All Principalsffdf4b37-7703-4dfe-a682-9d2e99bc6c09 High Access Control S3 Buckets must not allow Delete Action From All Principals, as to prevent leaking private information to the entire internet or allow unauthorized data tampering / deletion. This means the 'Effect' must not be 'Allow' when the 'Action' is Delete, for all Principals. Documentation DOCDB Cluster Not Encryptedbc1f9009-84a0-490f-ae09-3e0ea6d74ad6 High Encryption AWS DOCDB Cluster storage should be encrypted Documentation DAX Cluster Not Encryptedf11aec39-858f-4b6f-b946-0a1bf46c0c87 High Encryption AWS DAX Cluster should have server-side encryption at rest Documentation EBS Default Encryption Disabled3d3f6270-546b-443c-adb4-bb6fb2187ca6 High Encryption EBS Encryption should be enabled Documentation S3 Bucket SSE Disabled6726dcc0-5ff5-459d-b473-a780bef7665c High Encryption If algorithm is AES256 then the master key is null, empty or undefined, otherwise the master key is required Documentation ELB Using Insecure Protocols126c1788-23c2-4a10-906c-ef179f4f96ec High Encryption ELB Predefined or Custom Security Policies must not use insecure protocols, to reduce the risk of the SSL connection between the client and the load balancer being exploited. That means the 'name' of 'policy_attributes' must not coincide with any of a predefined list of insecure protocols. Documentation User Data Contains Encoded Private Key443488f5-c734-460b-a36d-5b3f330174dc High Encryption User Data should not contain a base64 encoded private key. If so, anyone can decode the private key easily Documentation CodeBuild Project Encrypted With AWS Managed Key3deec14b-03d2-4d27-9670-7d79322e3340 High Encryption CodeBuild Project should be encrypted with customer-managed KMS keys instead of AWS managed keys Documentation EBS Volume Snapshot Not Encryptede6b4b943-6883-47a9-9739-7ada9568f8ca High Encryption The value on AWS EBS Volume Snapshot Encryptation must be true Documentation Redshift Not Encryptedcfdcabb0-fc06-427c-865b-c59f13e898ce High Encryption AWS Redshift Cluster should be encrypted. Check if 'encrypted' field is false or undefined (default is false) Documentation Workspaces Workspace Volume Not Encryptedb9033580-6886-401a-8631-5f19f5bb24c7 High Encryption AWS Workspaces Workspace data stored in volumes should be encrypted Documentation EFS Without KMS25d251f3-f348-4f95-845c-1090e41a615c High Encryption Amazon Elastic Filesystem should have filesystem encryption enabled using KMS CMK customer-managed keys instead of AWS managed-keys Documentation Secure Ciphers Disabled5c0003fb-9aa0-42c1-9da3-eb0e332bef21 High Encryption Check if secure ciphers aren't used in CloudFront Documentation API Gateway Method Settings Cache Not Encryptedb7c9a40c-23e4-4a2d-8d39-a3352f10f288 High Encryption API Gateway Method Settings Cache should be encrypted Documentation Launch Configuration Is Not Encrypted4de9de27-254e-424f-bd70-4c1e95790838 High Encryption Launch Configurations should have the data in the volumes encrypted. To encrypt the data, the 'encrypted' parameter should be set to true in each volume Documentation DB Instance Storage Not Encrypted08bd0760-8752-44e1-9779-7bb369b2b4e4 High Encryption AWS DB Instance should have its storage encrypted by setting the parameter to 'true'. The storage_encrypted default value is 'false'. Documentation S3 Bucket Object Not Encrypted5fb49a69-8d46-4495-a2f8-9c8c622b2b6e High Encryption S3 Bucket Object should have server-side encryption enabled Documentation Glue Security Configuration Encryption Disabledad5b4e97-2850-4adf-be17-1d293e0b85ee High Encryption Glue Security Configuration Encryption should have 'cloudwatch_encryption', 'job_bookmarks_encryption' and 's3_encryption' enabled Documentation Kinesis Not Encrypted With KMS862fe4bf-3eec-4767-a517-40f378886b88 High Encryption AWS Kinesis Streams and metadata should be protected with KMS Documentation ELB Using Weak Ciphers4a800e14-c94a-442d-9067-5a2e9f6c0a4c High Encryption ELB Predefined or Custom Security Policies must not use weak ciphers, to reduce the risk of the SSL connection between the client and the load balancer being exploited. That means the 'name' of 'policy_attributes' must not coincide with any of a predefined list of weak ciphers. Documentation Athena Database Not Encryptedb2315cae-b110-4426-81e0-80bb8640cdd3 High Encryption AWS Athena Database data in S3 should be encrypted Documentation Sagemaker Notebook Instance Without KMSf3674e0c-f6be-43fa-b71c-bf346d1aed99 High Encryption AWS SageMaker should encrypt model artifacts at rest using Amazon S3 server-side encryption with an AWS KMS Documentation RDS Storage Not Encrypted3199c26c-7871-4cb3-99c2-10a59244ce7f High Encryption RDS Storage should be encrypted, which means the attribute 'storage_encrypted' should be set to 'true' Documentation RDS Database Cluster not Encrypted656880aa-1388-488f-a6d4-8f73c23149b2 High Encryption RDS Database Cluster Encryption should be enabled Documentation IAM Database Auth Not Enabled88fd05e0-ac0e-43d2-ba6d-fc0ba60ae1a6 High Encryption IAM Database Auth Enabled should be configured to true when using compatible engine and version Documentation User Data Shell Script Is Encoded9cf718ce-46f9-430e-89ec-c456f8b469ee High Encryption User Data Shell Script must be encoded Documentation CA Certificate Identifier Is Outdated9f40c07e-699e-4410-8856-3ba0f2e3a2dd High Encryption The CA certificate Identifier must be 'rds-ca-2019'. Documentation ECS Task Definition Volume Not Encrypted4d46ff3b-7160-41d1-a310-71d6d370b08f High Encryption AWS ECS Task Definition EFS data in transit between AWS ECS host and AWS EFS server should be encrypted Documentation Redis Not Compliant254c932d-e3bf-44b2-bc9d-eb5fdb09f8d4 High Encryption Check if the redis version is compliant with the necessary AWS PCI DSS requirements Documentation Cloudfront Viewer Protocol Policy Allows HTTP55af1353-2f62-4fa0-a8e1-a210ca2708f5 High Encryption Checks if the connection between CloudFront and the viewer is encrypted Documentation MSK Cluster Encryption Disabled6db52fa6-d4da-4608-908a-89f0c59e743e High Encryption Ensure MSK Cluster encryption in rest and transit is enabled Documentation ECS Task Definition Container With Plaintext Passwordd40210ea-64b9-4cce-a4fb-e8604f3c062c High Encryption It's not recommended to use plaintext environment variables for sensitive information, such as credential data. Documentation AMI Not Encrypted8bbb242f-6e38-4127-86d4-d8f0b2687ae2 High Encryption AWS AMI Encryption is not enabled Documentation Athena Workgroup Not Encryptedd364984a-a222-4b5f-a8b0-e23ab19ebff3 High Encryption Athena Workgroup query results should be encrypted, for all queries that run in the workgroup Documentation Glue Data Catalog Encryption Disabled01d50b14-e933-4c99-b314-6d08cd37ad35 High Encryption Glue Data Catalog Encryption Settings should have 'connection_password_encryption' and 'encryption_at_rest' enabled Documentation EKS Cluster Encryption Disabled63ebcb19-2739-4d3f-aa5c-e8bbb9b85281 High Encryption EKS Cluster should be encrypted Documentation Kinesis SSE Not Configured5c6dd5e7-1fe0-4cae-8f81-4c122717cef3 High Encryption AWS Kinesis Server data at rest should have Server Side Encryption (SSE) enabled Documentation Sagemaker Endpoint Configuration Encryption Disabled58b35504-0287-4154-bf69-02c0573deab8 High Encryption Sagemaker endpoint configuration should encrypt data Documentation EFS Not Encrypted48207659-729f-4b5c-9402-f884257d794f High Encryption Elastic File System (EFS) must be encrypted Documentation DOCDB Cluster Without KMS4766d3ea-241c-4ee6-93ff-c380c996bd1a High Encryption AWS DOCDB Cluster should be encrypted with a KMS encryption key Documentation CloudFront Without Minimum Protocol TLS 1.200e5e55e-c2ff-46b3-a757-a7a1cd802456 High Insecure Configurations CloudFront Minimum Protocol version should be at least TLS 1.2 Documentation DB Security Group Has Public Interfacef0d8781f-99bf-4958-9917-d39283b168a0 High Insecure Configurations The CIDR IP should not be a public interface Documentation Redshift Publicly Accessibleaf173fde-95ea-4584-b904-bb3923ac4bda High Insecure Configurations AWS Redshift Clusters must not be publicly accessible. Check if 'publicly_accessible' field is true or undefined (default is true) Documentation DB Instance Publicly Accessible35113e6f-2c6b-414d-beec-7a9482d3b2d1 High Insecure Configurations RDS must not be defined with public interface, which means the field 'publicly_accessible' should not be set to 'true' (default is 'false'). Documentation S3 Bucket with Unsecured CORS Rule98a8f708-121b-455b-ae2f-da3fb59d17e1 High Insecure Configurations If the CORS (Cross-Origin Resource Sharing) rule is defined in an S3 bucket, it should be secure Documentation Lambda Function With Privileged Role1b3af2f9-af8c-4dfc-a0f1-a03adb70deb2 High Insecure Configurations It is not advisable for AWS Lambda Functions to have privileged permissions. Documentation API Gateway Without Security Policy4e1cc5d3-2811-4fb2-861c-ee9b3cb7f90b High Insecure Configurations API Gateway should have a Security Policy defined and use TLS 1.2. Documentation ECS Task Definition Network Mode Not Recommended9f4a9409-9c60-4671-be96-9716dbf63db1 High Insecure Configurations Network_Mode should be 'awsvpc' in ecs_task_definition. AWS VPCs provides the controls to facilitate a formal process for approving and testing all network connections and changes to the firewall and router configurations Documentation IAM User Policy Without MFAb5681959-6c09-4f55-b42b-c40fa12d03ec High Insecure Configurations Check if the root user is authenticated with MFA Documentation S3 Static Website Host Enabled42bb6b7f-6d54-4428-b707-666f669d94fb High Insecure Configurations Checks if any static websites are hosted on buckets. Even static websites can be a liability when poorly configured. Documentation Root Account Has Active Access Keys970d224d-b42a-416b-81f9-8f4dfe70c4bc High Insecure Configurations The AWS Root Account must not have active access keys associated, which means if there are access keys associated to the Root Account, they must be inactive. Documentation No Password Policy Enabledb592ffd4-0577-44b6-bd35-8c5ee81b5918 High Insecure Configurations IAM password policies should be set through the password minimum length and reset password attributes Documentation S3 Bucket Without Restriction Of Public Bucket1ec253ab-c220-4d63-b2de-5b40e0af9293 High Insecure Configurations S3 bucket without restriction of public bucket Documentation KMS Key With Vulnerable Policy7ebc9038-0bde-479a-acc4-6ed7b6758899 High Insecure Configurations Checks if the policy is vulnerable and needs updating. Documentation Batch Job Definition With Privileged Container Properties66cd88ac-9ddf-424a-b77e-e55e17630bee High Insecure Configurations Batch Job Definition should not have Privileged Container Properties Documentation S3 Bucket Without Enabled MFA Deletec5b31ab9-0f26-4a49-b8aa-4cc064392f4d High Insecure Configurations S3 bucket without MFA Delete Enabled. MFA delete cannot be enabled through Terraform, it can be done by adding a MFA device (https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_mfa_enable.html) and enabling versioning and MFA delete by using AWS CLI: 'aws s3api put-bucket-versioning --versioning-configuration=Status=Enabled,MFADelete=Enabled --bucket= --mfa='. Please, also notice that MFA delete can not be used with lifecycle configurations Documentation Vulnerable Default SSL Certificate3a1e94df-6847-4c0e-a3b6-6c6af4e128ef High Insecure Defaults CloudFront web distributions should use custom (and not default) SSL certificates. Custom SSL certificates allow only defined users to access content by using an alternate domain name instead of the default one. Documentation Network ACL With Unrestricted Access To SSH3af7f2fd-06e6-4dab-b996-2912bea19ba4 High Networking and Firewall 'SSH' (TCP:22) should not be public in AWS Network ACL Documentation EKS node group remote access disabledba40ace1-a047-483c-8a8d-bc2d3a67a82d High Networking and Firewall EKS node group remote access is disabled when 'SourceSecurityGroups' is missing Documentation VPC Peering Route Table with Unrestricted CIDRb3a41501-f712-4c4f-81e5-db9a7dc0e34e High Networking and Firewall VPC Peering Route Table should restrict CIDR Documentation Unknown Port Exposed To Internet590d878b-abdc-428f-895a-e2b68a0e1998 High Networking and Firewall AWS Security Group should not have an unknown port exposed to the entire Internet Documentation ALB Listening on HTTPde7f5e83-da88-4046-871f-ea18504b1d43 High Networking and Firewall AWS Application Load Balancer (alb) should not listen on HTTP Documentation EKS Cluster Has Public Access CIDRs61cf9883-1752-4768-b18c-0d57f2737709 High Networking and Firewall Amazon EKS public endpoint is enables and accessible to all: 0.0.0.0/0\" Documentation DB Security Group Open To Large Scope4f615f3e-fb9c-4fad-8b70-2e9f781806ce High Networking and Firewall The IP address in a DB Security Group must not have more than 256 hosts. Documentation Security Group With Unrestricted Access To SSH65905cec-d691-4320-b320-2000436cb696 High Networking and Firewall 'SSH' (TCP:22) should not be public in AWS Security Group Documentation VPC Default Security Group Accepts All Traffic9a4ef195-74b9-4c58-b8ed-2b2fe4353a75 High Networking and Firewall Default Security Group attached to every VPC should restrict all traffic Documentation DB Security Group With Public Scope1e0ef61b-ad85-4518-a3d3-85eaad164885 High Networking and Firewall The IP address in a DB Security Group should not be '0.0.0.0/0' (IPv4) or '::/0' (IPv6). If so, any IP can access it Documentation HTTP Port Open To Internetffac8a12-322e-42c1-b9b9-81ff85c39ef7 High Networking and Firewall The HTTP port is open to the internet in a Security Group Documentation Unrestricted Security Group Ingress4728cd65-a20c-49da-8b31-9c08b423e4db High Networking and Firewall Security groups allow ingress from 0.0.0.0:0 and/or ::/0 Documentation RDS Associated with Public Subnet2f737336-b18a-4602-8ea0-b200312e1ac1 High Networking and Firewall RDS should not run in public subnet Documentation EC2 Instance Has Public IP5a2486aa-facf-477d-a5c1-b010789459ce High Networking and Firewall EC2 Instance should not have a public IP address. Documentation Default Security Groups With Unrestricted Traffic46883ce1-dc3e-4b17-9195-c6a601624c73 High Networking and Firewall Check if default security group does not restrict all inbound and outbound traffic. Documentation Sensitive Port Is Exposed To Entire Network381c3f2a-ef6f-4eff-99f7-b169cda3422c High Networking and Firewall A sensitive port, such as port 23 or port 110, is open for the whole network in either TCP or UDP protocol Documentation Network ACL With Unrestricted Access To RDPa20be318-cac7-457b-911d-04cc6e812c25 High Networking and Firewall 'RDP' (TCP:3389) should not be public in AWS Network ACL Documentation Remote Desktop Port Open To Internet151187cb-0efc-481c-babd-ad24e3c9bc22 High Networking and Firewall The Remote Desktop port is open to the internet in a Security Group Documentation Route53 Record Undefined25db74bf-fa3b-44da-934e-8c3e005c0453 High Networking and Firewall Check if Record is set Documentation CloudWatch Root Account Use Missing8b1b1e67-6248-4dca-bbad-93486bb181c0 High Observability Ensure a log metric filter and alarm exist for root acount usage Documentation KMS Key With No Deletion Window0b530315-0ea4-497f-b34c-4ff86268f59d High Observability AWS KMS Key should have a valid deletion window Documentation CMK Rotation Disabled22fbfeac-7b5a-421a-8a27-7a2178bb910b High Observability Customer Master Keys (CMK) must have rotation enabled, which means the attribute 'enable_key_rotation' must be set to 'true' when the key is enabled. Documentation CloudWatch Unauthorized Access Alarm Missing4c18a45b-4ab1-4790-9f83-399ac695f1e5 High Observability Ensure a log metric filter and alarm exist for unauthorized API calls Documentation CloudTrail Logging Disabled4bb76f17-3d63-4529-bdca-2b454529d774 High Observability Checks if logging is enabled for CloudTrail. Documentation CloudTrail Log Files S3 Bucket with Logging Disabledee9e50e8-b2ed-4176-ad42-8fc0cf7593f4 High Observability CloudTrail Log Files S3 Bucket should have 'logging' enabled Documentation CloudTrail Log Files S3 Bucket is Publicly Accessiblebd0088a5-c133-4b20-b129-ec9968b16ef3 High Observability CloudTrail Log Files S3 Bucket should not be publicly accessible Documentation CloudWatch IAM Policy Changes Alarm Missingeaaba502-2f94-411a-a3c2-83d63cc1776d High Observability Ensure a log metric filter and alarm exist for IAM policy changes Documentation CloudWatch Console Sign-in Without MFA Alarm Missing44ceb4fa-0897-4fd2-b676-30e7a58f2933 High Observability Ensure a log metric filter and alarm exist for management console sign-in without MFA Documentation Cross-Account IAM Assume Role Policy Without ExternalId or MFA09c35abf-5852-4622-ac7a-b987b331232e Medium Access Control Cross-Account IAM Assume Role Policy should require external ID or MFA to protect cross-account access Documentation Role With Privilege Escalation By Actions 'lambda:UpdateFunctionCode'c583f0f9-7dfd-476b-a056-f47c62b47b46 Medium Access Control Role with privilege escalation by actions 'lambda:UpdateFunctionCode' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation User With Privilege Escalation By Actions 'iam:AttachGroupPolicy'6d23d87e-1c5b-4308-b224-92624300f29b Medium Access Control User with privilege escalation by actions 'iam:AttachGroupPolicy' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation User With Privilege Escalation By Actions 'iam:PutGroupPolicy'8bfbf7ab-d5e8-4100-8618-798956e101e0 Medium Access Control User with privilege escalation by actions 'iam:PutGroupPolicy' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation Group With Privilege Escalation By Actions 'glue:UpdateDevEndpoint'8f3c16b3-354d-45db-8ad5-5066778a9485 Medium Access Control Group with privilege escalation by actions 'glue:UpdateDevEndpoint' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation Role With Privilege Escalation By Actions 'iam:CreatePolicyVersion'ee49557d-750c-4cc1-aa95-94ab36cbefde Medium Access Control Role with privilege escalation by actions 'iam:CreatePolicyVersion' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation ECR Repository Is Publicly Accessiblee86e26fc-489e-44f0-9bcd-97305e4ba69a Medium Access Control Amazon ECR image repositories shouldn't have public access Documentation Group With Privilege Escalation By Actions 'iam:PutGroupPolicy'e77c89f6-9c85-49ea-b95b-5f960fe5be92 Medium Access Control Group with privilege escalation by actions 'iam:PutGroupPolicy' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation Elasticsearch Domain With Vulnerable Policy16c4216a-50d3-4785-bfb2-4adb5144a8ba Medium Access Control Elasticsearch Domain policy should avoid wildcard in 'Action' and 'Principal'. Documentation User With Privilege Escalation By Actions 'iam:UpdateLoginProfile'6deb34e2-5d9c-499a-801b-ea6d9eda894f Medium Access Control User with privilege escalation by actions 'iam:UpdateLoginProfile' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation Group With Privilege Escalation By Actions 'iam:AddUserToGroup'970ed7a2-0aca-4425-acf1-0453c9ecbca1 Medium Access Control Group with privilege escalation by actions 'iam:AddUserToGroup' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation Group With Privilege Escalation By Actions 'iam:UpdateLoginProfile'ad296c0d-8131-4d6b-b030-1b0e73a99ad3 Medium Access Control Group with privilege escalation by actions 'iam:UpdateLoginProfile' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation Lambda With Vulnerable Policyad9dabc7-7839-4bae-a957-aa9120013f39 Medium Access Control The attribute 'action' should not have wildcard Documentation User With Privilege Escalation By Actions 'iam:SetDefaultPolicyVersion'43a41523-386a-4cb1-becb-42af6b414433 Medium Access Control User with privilege escalation by actions 'iam:SetDefaultPolicyVersion' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation Group With Privilege Escalation By Actions 'ec2:RunInstances' And 'iam:PassRole'15e6ad8c-f420-49a6-bafb-074f5eb1ec74 Medium Access Control Group with privilege escalation by actions 'ec2:RunInstances' and 'iam:PassRole' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation Role With Privilege Escalation By Actions 'iam:CreateLoginProfile'9a205ba3-0dd1-42eb-8d54-2ffec836b51a Medium Access Control Role with privilege escalation by actions 'iam:CreateLoginProfile' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation Elasticsearch Without IAM Authenticatione7530c3c-b7cf-4149-8db9-d037a0b5268e Medium Access Control AWS Elasticsearch should ensure IAM Authentication Documentation User With Privilege Escalation By Actions 'iam:AttachUserPolicy'70cb518c-d990-46f6-bc05-44a5041493d6 Medium Access Control User with privilege escalation by actions 'iam:AttachUserPolicy' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation Policy Without Principalbbe3dd3d-fea9-4b68-a785-cfabe2bbbc54 Medium Access Control All policies, except IAM identity-based policies, should have the 'Principal' element defined Documentation IAM User With Access To Console9ec311bf-dfd9-421f-8498-0b063c8bc552 Medium Access Control AWS IAM Users should not have access to console Documentation User With Privilege Escalation By Actions 'cloudformation:CreateStack' And 'iam:PassRole'19ffbe31-9d72-4379-9768-431195eae328 Medium Access Control User with privilege escalation by actions 'cloudformation:CreateStack' and 'iam:PassRole' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation User With Privilege Escalation By Actions 'glue:CreateDevEndpoint' And 'iam:PassRole'94fbe150-27e3-4eba-9ca6-af32865e4503 Medium Access Control User with privilege escalation by actions 'glue:CreateDevEndpoint' and 'iam:PassRole' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation S3 Bucket Allows Public ACLd0cc8694-fcad-43ff-ac86-32331d7e867f Medium Access Control S3 bucket allows public ACL Documentation Public Lambda via API Gateway3ef8696c-e4ae-4872-92c7-520bb44dfe77 Medium Access Control Allowing to run lambda function using public API Gateway Documentation IAM Role Policy passRole Allows Alle39bee8c-fe54-4a3f-824d-e5e2d1cca40a Medium Access Control Using the iam:passrole action with wildcards (*) in the resource can be overly permissive because it allows iam:passrole permissions on multiple resources Documentation API Gateway Method Does Not Contains An API Key671211c5-5d2a-4e97-8867-30fc28b02216 Medium Access Control An API Key should be required on a method request. Documentation IAM Access Key Is Exposed7081f85c-b94d-40fd-8b45-a4f1cac75e46 Medium Access Control IAM Access Key should not be active for root users Documentation REST API With Vulnerable Policyb161c11b-a59b-4431-9a29-4e19f63e6b27 Medium Access Control REST API policy should avoid wildcard in 'Action' and 'Principal' Documentation Public and Private EC2 Share Rolec53c7a89-f9d7-4c7b-8b66-8a555be99593 Medium Access Control Public and private EC2 istances should not share the same role. Documentation User With Privilege Escalation By Actions 'lambda:UpdateFunctionCode'b69247e5-7e73-464e-ba74-ec9b715c6e12 Medium Access Control User with privilege escalation by actions 'lambda:UpdateFunctionCode' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation Certificate Has Expiredc3831315-5ae6-4fa8-b458-3d4d5ab7a3f6 Medium Access Control Expired SSL/TLS certificates should be removed Documentation Group With Privilege Escalation By Actions 'iam:AttachGroupPolicy'70b42736-efee-4bce-80d5-50358ed94990 Medium Access Control Group with privilege escalation by actions 'iam:AttachGroupPolicy' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation Group With Privilege Escalation By Actions 'iam:CreateLoginProfile'04c686f1-e0cd-4812-88e1-4e038410074c Medium Access Control Group with privilege escalation by actions 'iam:CreateLoginProfile' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation API Gateway Without Configured Authorizered35928e-195c-4405-a252-98ccb664ab7C Medium Access Control API Gateway REST API should have an API Gateway Authorizer Documentation Glue With Vulnerable Policyd25edb51-07fb-4a73-97d4-41cecdc53a22 Medium Access Control Glue policy should avoid wildcard in 'principals' and 'actions' Documentation Role With Privilege Escalation By Actions 'iam:UpdateAssumeRolePolicy' And 'sts:AssumeRole'f1173d8c-3264-4148-9fdb-61181e031b51 Medium Access Control Role with privilege escalation by actions 'iam:UpdateAssumeRolePolicy' and 'sts:AssumeRole' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation User With Privilege Escalation By Actions 'ec2:RunInstances' And 'iam:PassRole'89561b03-cb35-44a9-a7e9-8356e71606f4 Medium Access Control User with privilege escalation by actions 'ec2:RunInstances' and 'iam:PassRole' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation Group With Privilege Escalation By Actions 'iam:PutUserPolicy'60263b4a-6801-4587-911d-919c37ed733b Medium Access Control Group with privilege escalation by actions 'iam:PutUserPolicy' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation User With Privilege Escalation By Actions 'iam:PutUserPolicy'0c10d7da-85c4-4d62-b2a8-d6c104f1bd77 Medium Access Control User with privilege escalation by actions 'iam:PutUserPolicy' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation Role With Privilege Escalation By Actions 'iam:AttachRolePolicy'f465fff1-0a0f-457d-aa4d-1bddb6f204ff Medium Access Control Role with privilege escalation by actions 'iam:AttachRolePolicy' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation Group With Privilege Escalation By Actions 'iam:UpdateAssumeRolePolicy' And 'sts:AssumeRole'78f1ec6f-5659-41ea-bd48-d0a142dce4f2 Medium Access Control Group with privilege escalation by actions 'iam:UpdateAssumeRolePolicy' and 'sts:AssumeRole' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation Group With Privilege Escalation By Actions 'cloudformation:CreateStack' And 'iam:PassRole'9b0ffadc-a61f-4c2a-b1e6-68fab60f6267 Medium Access Control Group with privilege escalation by actions 'cloudformation:CreateStack' and 'iam:PassRole' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation Role With Privilege Escalation By Actions 'glue:CreateDevEndpoint' And 'iam:PassRole'0a592060-8166-49f5-8e65-99ac6dce9871 Medium Access Control Role with privilege escalation by actions 'glue:CreateDevEndpoint' and 'iam:PassRole' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation Neptune Cluster With IAM Database Authentication Disabledc91d7ea0-d4d1-403b-8fe1-c9961ac082c5 Medium Access Control Neptune Cluster should have IAM Database Authentication enabled Documentation Role With Privilege Escalation By Actions 'iam:PutGroupPolicy'd6047119-a0b2-4b59-a4f2-127a36fb685b Medium Access Control Role with privilege escalation by actions 'iam:PutGroupPolicy' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation Group With Privilege Escalation By Actions 'lambda:UpdateFunctionCode'571254d8-aa6a-432e-9725-535d3ef04d69 Medium Access Control Group with privilege escalation by actions 'lambda:UpdateFunctionCode' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation Role With Privilege Escalation By Actions 'glue:UpdateDevEndpoint'eda48c88-2b7d-4e34-b6ca-04c0194aee17 Medium Access Control Role with privilege escalation by actions 'glue:UpdateDevEndpoint' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation User With Privilege Escalation By Actions 'iam:CreatePolicyVersion'1743f5f1-0bb0-4934-acef-c80baa5dadfa Medium Access Control User with privilege escalation by actions 'iam:CreatePolicyVersion' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation SSO Permission With Inadequate User Session Durationce9dfce0-5fc8-433b-944a-3b16153111a8 Medium Access Control SSO permissions should be configured to limit user sessions to no longer than 1 hour. Allowing longer sessions can increase the risk of unauthorized access or session hijacking. This is a best practice for security and should be implemented in SSO permission settings. Documentation Role With Privilege Escalation By Actions 'cloudformation:CreateStack' And 'iam:PassRole'be2aa235-bd93-4b68-978a-1cc65d49082f Medium Access Control Role with privilege escalation by actions 'cloudformation:CreateStack' and 'iam:PassRole' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation Role With Privilege Escalation By Actions 'iam:AttachUserPolicy'7c96920c-6fd0-449d-9a52-0aa431b6beaf Medium Access Control Role with privilege escalation by actions 'iam:AttachUserPolicy' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation Role With Privilege Escalation By Actions 'iam:SetDefaultPolicyVersion'118281d0-6471-422e-a7c5-051bc667926e Medium Access Control Role with privilege escalation by actions 'iam:SetDefaultPolicyVersion' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation SES Policy With Allowed IAM Actions34b921bd-90a0-402e-a0a5-dc73371fd963 Medium Access Control SES policy should not allow IAM actions to all principals Documentation User With Privilege Escalation By Actions 'iam:CreateLoginProfile'0fd7d920-4711-46bd-aff2-d307d82cd8b7 Medium Access Control User with privilege escalation by actions 'iam:CreateLoginProfile' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation Group With Privilege Escalation By Actions 'iam:CreateAccessKey'846646e3-2af1-428c-ac5d-271eccfa6faf Medium Access Control Group with privilege escalation by actions 'iam:CreateAccessKey' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation Role With Privilege Escalation By Actions 'ec2:RunInstances' And 'iam:PassRole'30b88745-eebe-4ecb-a3a9-5cf886e96204 Medium Access Control Role with privilege escalation by actions 'ec2:RunInstances' and 'iam:PassRole' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation User With Privilege Escalation By Actions 'iam:AddUserToGroup'bf9d42c7-c2f9-4dfe-942c-c8cc8249a081 Medium Access Control User with privilege escalation by actions 'iam:AddUserToGroup' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation Lambda Permission Principal Is Wildcarde08ed7eb-f3ef-494d-9d22-2e3db756a347 Medium Access Control Lambda Permission Principal should not contain a wildcard. Documentation Role With Privilege Escalation By Actions 'iam:UpdateLoginProfile'35ccf766-0e4d-41ed-9ec4-2dab155082b4 Medium Access Control Role with privilege escalation by actions 'iam:UpdateLoginProfile' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation Group With Privilege Escalation By Actions 'iam:SetDefaultPolicyVersion'7782d4b3-e23e-432b-9742-d9528432e771 Medium Access Control Group with privilege escalation by actions 'iam:SetDefaultPolicyVersion' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation User With Privilege Escalation By Actions 'iam:CreateAccessKey'113208f2-a886-4526-9ecc-f3218600e12c Medium Access Control User with privilege escalation by actions 'iam:CreateAccessKey' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation IAM Policies Attached To Userb4378389-a9aa-44ee-91e7-ef183f11079e Medium Access Control IAM policies should be attached only to groups or roles Documentation Group With Privilege Escalation By Actions 'iam:PutRolePolicy'c0c1e744-0f37-445e-924a-1846f0839f69 Medium Access Control Group with privilege escalation by actions 'iam:PutRolePolicy' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation SQS Policy With Public Access730675f9-52ed-49b6-8ead-0acb5dd7df7f Medium Access Control Checks for dangerous permissions in Action statements in an SQS Queue Policy. This is deemed a potential security risk as it would allow various attacks to the queue Documentation Group With Privilege Escalation By Actions 'iam:CreatePolicyVersion'ec49cbfd-fae4-45f3-81b1-860526d66e3f Medium Access Control Group with privilege escalation by actions 'iam:CreatePolicyVersion' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation Group With Privilege Escalation By Actions 'lambda:CreateFunction' And 'iam:PassRole' And 'lambda:InvokeFunction'034d0aee-620f-4bf7-b7fb-efdf661fdb9e Medium Access Control Group with privilege escalation by actions 'lambda:CreateFunction' and 'iam:PassRole' and 'lambda:InvokeFunction' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation User With Privilege Escalation By Actions 'lambda:CreateFunction' And 'iam:PassRole' And 'lambda:InvokeFunction'8055dec2-efb8-4fe6-8837-d9bed6ff202a Medium Access Control User with privilege escalation by actions 'lambda:CreateFunction' and 'iam:PassRole' and 'lambda:InvokeFunction' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation AMI Shared With Multiple Accountsba4e0031-3e9d-4d7d-b0d6-bd8f003f8698 Medium Access Control Limits access to AWS AMIs by checking if more than one account is using the same image Documentation Group With Privilege Escalation By Actions 'iam:AttachRolePolicy'3dd96caa-0b5f-4a85-b929-acfac4646cc2 Medium Access Control Group with privilege escalation by actions 'iam:AttachRolePolicy' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation Role With Privilege Escalation By Actions 'iam:PutUserPolicy'8f75840d-9ee7-42f3-b203-b40e3979eb12 Medium Access Control Role with privilege escalation by actions 'iam:PutUserPolicy' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation SQS Policy Allows All Actions816ea8cf-d589-442d-a917-2dd0ce0e45e3 Medium Access Control SQS policy allows ALL (*) actions Documentation User With Privilege Escalation By Actions 'glue:UpdateDevEndpoint'9b877bd8-94b4-4c10-a060-8e0436cc09fa Medium Access Control User with privilege escalation by actions 'glue:UpdateDevEndpoint' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation Group With Privilege Escalation By Actions 'glue:CreateDevEndpoint' And 'iam:PassRole'7d544dad-8a6c-431c-84c1-5f07fe9afc0e Medium Access Control Group with privilege escalation by actions 'glue:CreateDevEndpoint' and 'iam:PassRole' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation Role With Privilege Escalation By Actions 'iam:AttachGroupPolicy'f906113d-cdc0-415a-ba60-609cc6daaf4d Medium Access Control Role with privilege escalation by actions 'iam:AttachGroupPolicy' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation Role With Privilege Escalation By Actions 'lambda:CreateFunction' And 'iam:PassRole' And 'lambda:InvokeFunction'fa62ac4f-f5b9-45b9-97c1-625c8b6253ca Medium Access Control Role with privilege escalation by actions 'lambda:CreateFunction' and 'iam:PassRole' and 'lambda:InvokeFunction' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation Group With Privilege Escalation By Actions 'iam:AttachUserPolicy'db78d14b-10e5-4e6e-84b1-dace6327b1ec Medium Access Control Group with privilege escalation by actions 'iam:AttachUserPolicy' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation Role With Privilege Escalation By Actions 'iam:PutRolePolicy'eb64f1e9-f67d-4e35-8a3c-3d6a2f9efea7 Medium Access Control Role with privilege escalation by actions 'iam:PutRolePolicy' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation User With Privilege Escalation By Actions 'iam:PutRolePolicy'eeb4d37a-3c59-4789-a00c-1509bc3af1e5 Medium Access Control User with privilege escalation by actions 'iam:PutRolePolicy' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation SNS Topic Publicity Has Allow and NotAction Simultaneously5ea624e4-c8b1-4bb3-87a4-4235a776adcc Medium Access Control SNS topic Publicity should not have 'Effect: Allow' and argument 'NotAction' at the same time. If it has 'Effect: Allow', the argument stated should be 'Action'. Documentation User With Privilege Escalation By Actions 'iam:AttachRolePolicy'e227091e-2228-4b40-b046-fc13650d8e88 Medium Access Control User with privilege escalation by actions 'iam:AttachRolePolicy' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation Role With Privilege Escalation By Actions 'iam:CreateAccessKey'5b4d4aee-ac94-4810-9611-833636e5916d Medium Access Control Role with privilege escalation by actions 'iam:CreateAccessKey' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation CloudWatch Logs Destination With Vulnerable Policydb0ec4c4-852c-46a2-b4f3-7ec13cdb12a8 Medium Access Control CloudWatch Logs destination policy should avoid wildcard in 'principals' and 'actions' Documentation Secrets Manager With Vulnerable Policyfa00ce45-386d-4718-8392-fb485e1f3c5b Medium Access Control Secrets Manager policy should avoid wildcard in 'Principal' and 'Action' Documentation User With Privilege Escalation By Actions 'iam:UpdateAssumeRolePolicy' And 'sts:AssumeRole'33627268-1445-4385-988a-318fd9d1a512 Medium Access Control User with privilege escalation by actions 'iam:UpdateAssumeRolePolicy' and 'sts:AssumeRole' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation Role With Privilege Escalation By Actions 'iam:AddUserToGroup'b8a31292-509d-4b61-bc40-13b167db7e9c Medium Access Control Role with privilege escalation by actions 'iam:AddUserToGroup' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/. Documentation Auto Scaling Group With No Associated ELB8e94dced-9bcc-4203-8eb7-7e41202b2505 Medium Availability AWS Auto Scaling Groups must have associated ELBs to ensure high availability and improve application performance. This means the attribute 'load_balancers' must be defined and not empty. Documentation ECS Service Without Running Tasks91f16d09-689e-4926-aca7-155157f634ed Medium Availability ECS Service should have at least 1 task running Documentation ElastiCache Nodes Not Created Across Multi AZ6db03a91-f933-4f13-ab38-a8b87a7de54d Medium Availability ElastiCache Nodes should be created across multi az, which means 'az_mode' should be set to 'cross-az' in multi nodes cluster Documentation CMK Is Unusable7350fa23-dcf7-4938-916d-6a60b0c73b50 Medium Availability AWS Key Management Service (KMS) must only possess usable Customer Master Keys (CMK), which means the CMKs must have the attribute 'is_enabled' set to true Documentation RDS With Backup Disabled1dc73fb4-5b51-430c-8c5f-25dcf9090b02 Medium Backup Make sure the AWS RDS configuration has automatic backup configured. If the retention period is equal to 0 there is no backup Documentation Stack Retention Disabled6e0e2f68-3fd9-4cd8-a5e4-e2213ef0df97 Medium Backup Make sure that retain_stack is enabled to keep the Stack and it's associated resources during resource destruction Documentation ElastiCache Redis Cluster Without Backup8fdb08a0-a868-4fdf-9c27-ccab0237f1ab Medium Backup ElastiCache Redis cluster should have 'snapshot_retention_limit' higher than 0 Documentation IAM Password Without Uppercase Letterc5ff7bc9-d8ea-46dd-81cb-8286f3222249 Medium Best Practices IAM password should have at least one uppercase letter Documentation ALB Not Dropping Invalid Headers6e3fd2ed-5c83-4c68-9679-7700d224d379 Medium Best Practices It's considered a best practice when using Application Load Balancers to drop invalid header fields Documentation Misconfigured Password Policy Expirationce60d060-efb8-4bfd-9cf7-ff8945d00d90 Medium Best Practices No password expiration policy Documentation Password Without Reuse Prevention89806cdc-9c2e-4bd1-a0dc-53f339bcfb2a Medium Best Practices Check if IAM account password has the reuse password configured with 24 Documentation IAM Password Without Lowercase Letterbbc7c137-6c7b-4fc4-984a-0c88e91fcaf9 Medium Best Practices IAM Password should have at least one lowercase letter Documentation RDS Cluster With Backup Disablede542bd46-58c4-4e0f-a52a-1fb4f9548e02 Medium Best Practices RDS Cluster backup retention period should be specifically defined Documentation Cognito UserPool Without MFAec28bf61-a474-4dbe-b414-6dd3a067d6f0 Medium Best Practices AWS Cognito UserPool should have MFA (Multi-Factor Authentication) defined to users Documentation IAM Password Without Symbol7a70eed6-de3a-4da2-94da-a2bbc8fe2a48 Medium Best Practices IAM password should have the required symbols Documentation IAM Password Without Minimum Length1bc1c685-e593-450e-88fb-19db4c82aa1d Medium Best Practices IAM password should have the required minimum length Documentation Stack Without Template91bea7b8-0c31-4863-adc9-93f6177266c4 Medium Build Process AWS CloudFormation should have a template defined through the attribute template_url or attribute template_body Documentation ElastiCache Replication Group Not Encrypted At Rest76976de7-c7b1-4f64-a94f-90c1345914c2 Medium Encryption ElastiCache Replication Group encryption should be enabled at Rest Documentation API Gateway With Invalid Compressioned35928e-195c-4405-a252-98ccb664ab7b Medium Encryption API Gateway should have valid compression, which means attribute 'minimum_compression_size' should be set and its value should be greater than -1 and smaller than 10485760. Documentation DOCDB Cluster Encrypted With AWS Managed Key2134641d-30a4-4b16-8ffc-2cd4c4ffd15d Medium Encryption DOCDB Cluster should be encrypted with customer-managed KMS keys instead of AWS managed keys Documentation Neptune Database Cluster Encryption Disabled98d59056-f745-4ef5-8613-32bca8d40b7e Medium Encryption Neptune database cluster storage should have encryption enabled Documentation ElastiCache Replication Group Not Encrypted At Transit1afbb3fa-cf6c-4a3d-b730-95e9f4df343e Medium Encryption ElastiCache Replication Group encryption should be enabled at Transit Documentation Config Rule For Encrypted Volumes Disabledabdb29d4-5ca1-4e91-800b-b3569bbd788c Medium Encryption Check if AWS config rules do not identify Encrypted Volumes as a source. Documentation ElasticSearch Not Encrypted At Rest24e16922-4330-4e9d-be8a-caa90299466a Medium Encryption Check if ElasticSearch encryption is disabled at Rest Documentation ElasticSearch Encryption With KMS Disabled7af2f4a3-00d9-47f3-8d15-ca0888f4e5b2 Medium Encryption Check if any ElasticSearch domain isn't encrypted with KMS. Documentation Unscanned ECR Image9630336b-3fed-4096-8173-b9afdfe346a7 Medium Encryption Checks if the ECR Image has been scanned Documentation Redis Disabled4bd15dd9-8d5e-4008-8532-27eb0c3706d3 Medium Encryption ElastiCache should have Redis enabled, since it covers Compliance Certifications such as FedRAMP, HIPAA, and PCI DSS. For more information, take a look at 'https://docs.aws.amazon.com/AmazonElastiCache/latest/mem-ug/SelectEngine.html' Documentation CloudWatch Log Group Without KMS0afbcfe9-d341-4b92-a64c-7e6de0543879 Medium Encryption AWS CloudWatch Log groups should be encrypted using KMS Documentation SNS Topic Not Encrypted28545147-2fc6-42d5-a1f9-cf226658e591 Medium Encryption SNS (Simple Notification Service) Topic should be encrypted Documentation S3 Bucket Policy Accepts HTTP Requests4bc4dd4c-7d8d-405e-a0fb-57fa4c31b4d9 Medium Encryption S3 Bucket policy should not accept HTTP Requests Documentation AmazonMQ Broker Encryption Disabled3db3f534-e3a3-487f-88c7-0a9fbf64b702 Medium Encryption AmazonMQ Broker should have Encryption Options defined Documentation Secretsmanager Secret Encrypted With AWS Managed Keyb0d3ef3f-845d-4b1b-83d6-63a5a380375f Medium Encryption Secrets Manager secret should be encrypted with customer-managed KMS keys instead of AWS managed keys Documentation DynamoDB Table Not Encryptedce089fd4-1406-47bd-8aad-c259772bb294 Medium Encryption AWS DynamoDB Tables should have server-side encryption Documentation Secretsmanager Secret Without KMSa2f548f2-188c-4fff-b172-e9a6acb216bd Medium Encryption AWS Secretmanager should use AWS KMS customer master key (CMK) to encrypt the secret values in the versions stored in the secret Documentation EBS Volume Encryption Disabledcc997676-481b-4e93-aa81-d19f8c5e9b12 Medium Encryption EBS volumes should be encrypted Documentation SNS Topic Encrypted With AWS Managed Keyb1a72f66-2236-4f3b-87ba-0da1b366956f Medium Encryption SNS (Simple Notification Service) Topic should be encrypted with customer-managed KMS keys instead of AWS managed keys Documentation SQS With SSE Disabled6e8849c1-3aa7-40e3-9063-b85ee300f29f Medium Encryption Amazon Simple Queue Service (SQS) queue should protect the contents of their messages using Server-Side Encryption (SSE) Documentation Elasticsearch Domain Not Encrypted Node To Node967eb3e6-26fc-497d-8895-6428beb6e8e2 Medium Encryption Elasticsearch Domain encryption should be enabled node to node Documentation SSM Session Transit Encryption Disabledce60cc6b-6831-4bd7-84a2-cc7f8ee71433 Medium Encryption SSM Session should be encrypted in transit Documentation ECR Image Tag Not Immutabled1846b12-20c5-4d45-8798-fc35b79268eb Medium Insecure Configurations ECR should have an image tag be immutable. This prevents image tags from being overwritten. Documentation IAM User Has Too Many Access Keys3561130e-9c5f-485b-9e16-2764c82763e5 Medium Insecure Configurations Any IAM User should not have more than one access key since it increases the risk of unauthorized access and compromise credentials Documentation API Gateway With Open Access15ccec05-5476-4890-ad19-53991eba1db8 Medium Insecure Configurations API Gateway Method should restrict the authorization type, except for the HTTP OPTIONS method. Documentation Instance With No VPCa31a5a29-718a-4ff4-8001-a69e5e4d029e Medium Insecure Configurations EC2 Instances should be configured under a VPC network. AWS VPCs provide the controls to facilitate a formal process for approving and testing all network connections and changes to the firewall and router configurations. Documentation Service Control Policies Disabled5ba6229c-8057-433e-91d0-21cf13569ca9 Medium Insecure Configurations Check if the Amazon Organizations ensure that all features are enabled to achieve full control over the use of AWS services and actions across multiple AWS accounts using Service Control Policies (SCPs). Documentation AWS Password Policy With Unchangeable Passwords9ef7d25d-9764-4224-9968-fa321c56ef76 Medium Insecure Configurations Unchangeable passwords in AWS password policy Documentation Certificate RSA Key Bytes Lower Than 256874d68a3-bfbe-4a4b-aaa0-9e74d7da634b Medium Insecure Configurations The certificate should use a RSA key with a length equal to or higher than 256 bytes Documentation API Gateway Without SSL Certificate0b4869fc-a842-4597-aa00-1294df425440 Medium Insecure Configurations SSL Client Certificate should be enabled Documentation MQ Broker Is Publicly Accessible4eb5f791-c861-4afd-9f94-f2a6a3fe49cb Medium Insecure Configurations Check if any MQ Broker is not publicly accessible Documentation EKS Cluster Has Public Access42f4b905-3736-4213-bfe9-c0660518cda8 Medium Insecure Configurations Amazon EKS public endpoint shoud be set to false Documentation Redshift Cluster Without VPC0a494a6a-ebe2-48a0-9d77-cf9d5125e1b3 Medium Insecure Configurations Redshift Cluster should be configured in VPC (Virtual Private Cloud) Documentation SQL Analysis Services Port 2383 (TCP) Is Publicly Accessible54c417bf-c762-48b9-9d31-b3d87047e3f0 Medium Networking and Firewall Check if port 2383 on TCP is publicly accessible by checking the CIDR block range that can access it. Documentation API Gateway without WAFa186e82c-1078-4a7b-85d8-579561fde884 Medium Networking and Firewall API Gateway should have WAF (Web Application Firewall) enabled Documentation VPC Without Network Firewallfd632aaf-b8a1-424d-a4d1-0de22fd3247a Medium Networking and Firewall VPC should have a Network Firewall associated Documentation SQS VPC Endpoint Without DNS Resolutione9b7acf9-9ba0-4837-a744-31e7df1e434d Medium Networking and Firewall SQS VPC Endpoint should have DNS resolution enabled Documentation Sensitive Port Is Exposed To Small Public Networke35c16a2-d54e-419d-8546-a804d8e024d0 Medium Networking and Firewall A sensitive port, such as port 23 or port 110, is open for a small public network in either TCP or UDP protocol Documentation API Gateway Endpoint Config is Not Private6b2739db-9c49-4db7-b980-7816e0c248c1 Medium Networking and Firewall The API Endpoint type in API Gateway should be set to PRIVATE so it's not exposed to the public internet Documentation Dynamodb VPC Endpoint Without Route Table Association0bc534c5-13d1-4353-a7fe-b8665d5c1d7d Medium Networking and Firewall Dynamodb VPC Endpoint should be associated with Route Table Association Documentation VPC Subnet Assigns Public IP52f04a44-6bfa-4c41-b1d3-4ae99a2de05c Medium Networking and Firewall VPC Subnet should not assign public IP Documentation Sensitive Port Is Exposed To Wide Private Network92fe237e-074c-4262-81a4-2077acb928c1 Medium Networking and Firewall A sensitive port, such as port 23 or port 110, is open for a wide private network in either TCP or UDP protocol Documentation ALB Is Not Integrated With WAF0afa6ab8-a047-48cf-be07-93a2f8c34cf7 Medium Networking and Firewall All Application Load Balancers (ALB) must be protected with Web Application Firewall (WAF) service Documentation API Gateway With CloudWatch Logging Disabled982aa526-6970-4c59-8b9b-2ce7e019fe36 Medium Observability AWS CloudWatch Logs for APIs should be enabled and using the naming convention described in documentation Documentation API Gateway Deployment Without Access Log Setting625abc0e-f980-4ac9-a775-f7519ee34296 Medium Observability API Gateway Deployment should have access log setting defined when connected to an API Gateway Stage. Documentation CloudWatch Disabling Or Scheduled Deletion Of Customer Created CMK Alarm Missing56a585f5-555c-48b2-8395-e64e4740a9cf Medium Observability Ensure a log metric filter and alarm exist for disabling or scheduled deletion of customer created CMK Documentation API Gateway Access Logging Disabled1b6799eb-4a7a-4b04-9001-8cceb9999326 Medium Observability API Gateway should have Access Log Settings defined Documentation Stack Notifications Disabledb72d0026-f649-4c91-a9ea-15d8f681ac09 Medium Observability AWS CloudFormation should have stack notifications enabled to be notified when an event occurs Documentation ELB Access Log Disabled20018359-6fd7-4d05-ab26-d4dffccbdf79 Medium Observability ELB should have logging enabled to help on error investigation Documentation CloudWatch S3 policy Change Alarm Missing27c6a499-895a-4dc7-9617-5c485218db13 Medium Observability Ensure a log metric filter and alarm exist for S3 bucket policy changes Documentation API Gateway X-Ray Disabled5813ef56-fa94-406a-b35d-977d4a56ff2b Medium Observability API Gateway should have X-Ray Tracing enabled Documentation Cloudwatch Security Group Changes Alarm Missing4beaf898-9f8b-4237-89e2-5ffdc7ee6006 Medium Observability Ensure a log metric filter and alarm exist for security group changes Documentation MSK Cluster Logging Disabled2f56b7ab-7fba-4e93-82f0-247e5ddeb239 Medium Observability Ensure MSK Cluster Logging is enabled Documentation CloudWatch Logging Disabled7dbba512-e244-42dc-98bb-422339827967 Medium Observability Check if CloudWatch logging is disabled for Route53 hosted zones Documentation CloudTrail Not Integrated With CloudWatch17b30f8f-8dfb-4597-adf6-57600b6cf25e Medium Observability CloudTrail should be integrated with CloudWatch Documentation Configuration Aggregator to All Regions Disabledac5a0bc0-a54c-45aa-90c3-15f7703b9132 Medium Observability AWS Config Configuration Aggregator All Regions must be set to True Documentation Default VPC Exists96ed3526-0179-4c73-b1b2-372fde2e0d13 Medium Observability It isn't recommended to use resources in default VPC Documentation CloudWatch Metrics Disabled081069cb-588b-4ce1-884c-2a1ce3029fe5 Medium Observability Checks if CloudWatch Metrics is Enabled Documentation S3 Bucket Logging Disabledf861041c-8c9f-4156-acfc-5e6e524f5884 Medium Observability Server Access Logging should be enabled on S3 Buckets so that all changes are logged and trackable Documentation S3 Bucket Without Versioning568a4d22-3517-44a6-a7ad-6a7eed88722c Medium Observability S3 bucket should have versioning enabled Documentation CloudWatch AWS Organizations Changes Missing Alarm38b85c45-e772-4de8-a247-69619ca137b3 Medium Observability Ensure a log metric filter and alarm exist for AWS organizations changes Documentation Redshift Cluster Logging Disabled15ffbacc-fa42-4f6f-a57d-2feac7365caa Medium Observability Make sure Logging is enabled for Redshift Cluster Documentation Cloudwatch Cloudtrail Configuration Changes Alarm Missing0f6cbf69-41bb-47dc-93f3-3844640bf480 Medium Observability Ensure a log metric filter and alarm exist for CloudTrail configuration changes Documentation S3 Bucket Object Level CloudTrail Logging Disableda8fc2180-b3ac-4c93-bd0d-a55b974e4b07 Medium Observability S3 Bucket object-level CloudTrail logging should be enabled for read and write events Documentation CloudTrail Multi Region Disabled8173d5eb-96b5-4aa6-a71b-ecfa153c123d Medium Observability CloudTrail multi region should be enabled, which means attributes 'is_multi_region_trail' and 'include_global_service_events' should be enabled Documentation CloudWatch Management Console Auth Failed Alarm Missing5864d189-ee9a-4009-ac0c-8a582e6b7919 Medium Observability Ensure a log metric filter and alarm exist for AWS Management Console authentication failures Documentation MQ Broker Logging Disabled31245f98-a6a9-4182-9fc1-45482b9d030a Medium Observability Check if MQ Brokers don't have logging enabled in any of the two options possible (audit and general). Documentation CloudFront Logging Disabled94690d79-b3b0-43de-b656-84ebef5753e5 Medium Observability AWS CloudFront distributions should have logging enabled to collect all viewer requests, which means the attribute 'logging_config' should be defined Documentation CloudWatch Without Retention Period Specifiedef0b316a-211e-42f1-888e-64efe172b755 Medium Observability AWS CloudWatch Log groups should have retention days specified Documentation Elasticsearch Log Disabledacb6b4e2-a086-4f35-aefd-4db6ea51ada2 Medium Observability AWS Elasticsearch should have logs enabled Documentation CloudTrail SNS Topic Name Undefined482b7d26-0bdb-4b5f-bf6f-545826c0a3dd Medium Observability Check if SNS topic name is set for CloudTrail Documentation GuardDuty Detector Disabled704dadd3-54fc-48ac-b6a0-02f170011473 Medium Observability Make sure that Amazon GuardDuty is Enabled Documentation ElasticSearch Without Slow Logse979fcbc-df6c-422d-9458-c33d65e71c45 Medium Observability Ensure that AWS Elasticsearch enables support for slow logs Documentation No Stack Policy2f01fb2d-828a-499d-b98e-b83747305052 Medium Resource Management AWS CloudFormation Stack should have a stack policy in order to protect stack resources from update actions Documentation Hardcoded AWS Access Key In Lambda1402afd8-a95c-4e84-8b0b-6fb43758e6ce Medium Secret Management Lambda access/secret keys should not be hardcoded Documentation Hardcoded AWS Access Keyd7b9d850-3e06-4a75-852f-c46c2e92240b Medium Secret Management AWS Access Key should not be hardcoded Documentation IAM Group Without Usersfc101ca7-c9dd-4198-a1eb-0fbe92e80044 Low Access Control IAM Group should have at least one user associated Documentation SSO Identity User Unsafe Creation4003118b-046b-4640-b200-b8c7a4c8b89f Low Access Control The use of AWS SSO for creating users may pose a security risk as it does not synchronize with external Identity Providers (IdP) or Active Directory (AD). This can lead to inconsistencies and potential unauthorized access to resources. It is recommended to review and update user creation processes to ensure proper security protocols are in place. Documentation S3 Bucket Public ACL Overridden By Public Access Blockbf878b1a-7418-4de3-b13c-3a86cf894920 Low Access Control S3 bucket public access is overridden by S3 bucket Public Access Block when the following attributes are set to true - 'block_public_acls', 'block_public_policy', 'ignore_public_acls', and 'restrict_public_buckets' Documentation EC2 Instance Using API Keys0b93729a-d882-4803-bdc3-ac429a21f158 Low Access Control EC2 instances should use roles to be granted access to other AWS services Documentation IAM Policy Grants 'AssumeRole' Permission Across All Servicesbcdcbdc6-a350-4855-ae7c-d1e6436f7c97 Low Access Control IAM Policy should not grant 'AssumeRole' permission across all services. Documentation EC2 Instance Using Default Security Groupf1adc521-f79a-4d71-b55b-a68294687432 Low Access Control EC2 instances should not use default security group(s) Documentation IAM Role Allows All Principals To Assume12b7e704-37f0-4d1e-911a-44bf60c48c21 Low Access Control IAM role allows all services or principals to assume it Documentation Autoscaling Groups Supply Tagsba48df05-eaa1-4d64-905e-4a4b051e7587 Low Availability Autoscaling groups should supply tags to configurate Documentation IAM Access Analyzer Not Enablede592a0c5-5bdb-414c-9066-5dba7cdea370 Low Best Practices IAM Access Analyzer should be enabled and configured to continuously monitor resource permissions Documentation Automatic Minor Upgrades Disabled3b6d777b-76e3-4133-80a3-0d6f667ade7f Low Best Practices RDS instance should have automatic minor upgrades enabled, which means the attribute 'auto_minor_version_upgrade' must be set to true. Documentation CDN Configuration Is Missing1bc367f6-901d-4870-ad0c-71d79762ef52 Low Best Practices Content Delivery Network (CDN) service is used within an AWS account to secure and accelerate the delivery of websites. The use of a CDN can provide a layer of security between your origin content and the destination. Documentation Lambda IAM InvokeFunction Misconfigured0ca1017d-3b80-423e-bb9c-6cd5898d34bd Low Best Practices Lambda permission may be misconfigured if the action field is not filled in by 'lambda:InvokeFunction' Documentation ECR Repository Without Policy69e7c320-b65d-41bb-be02-d63ecc0bcc9d Low Best Practices ECR Repository should have Policies attached to it Documentation Lambda Permission Misconfigured75ec6890-83af-4bf1-9f16-e83726df0bd0 Low Best Practices Lambda permission may be misconfigured if the action field is not filled in by 'lambda:InvokeFunction' Documentation CloudTrail Log Files Not Encrypted With KMS5d9e3164-9265-470c-9a10-57ae454ac0c7 Low Encryption Logs delivered by CloudTrail should be encrypted using KMS to increase security of your CloudTrail Documentation ECR Repository Not Encrypted With CMK0e32d561-4b5a-4664-a6e3-a3fa85649157 Low Encryption ECR repositories should be encrypted with customer-managed keys to meet stricter security and compliance requirements on access control, monitoring, and key rotation Documentation S3 Bucket Without Ignore Public ACL4fa66806-0dd9-4f8d-9480-3174d39c7c91 Low Insecure Configurations S3 bucket without ignore public ACL Documentation ALB Deletion Protection Disabledafecd1f1-6378-4f7e-bb3b-60c35801fdd4 Low Insecure Configurations Application Load Balancer should have deletion protection enabled Documentation RDS Using Default Portbca7cc4d-b3a4-4345-9461-eb69c68fcd26 Low Networking and Firewall RDS should not use the default port (an attacker can easily guess the port). For engines related to Aurora, MariaDB or MySQL, the default port is 3306. PostgreSQL default port is 5432, Oracle default port is 1521 and SQL Server default port is 1433 Documentation EMR Without VPC2b3c8a6d-9856-43e6-ab1d-d651094f03b4 Low Networking and Firewall Elastic MapReduce Cluster (EMR) should be launched in a Virtual Private Cloud (VPC) Documentation ElastiCache Without VPC8c849af7-a399-46f7-a34c-32d3dc96f1fc Low Networking and Firewall ElastiCache should be launched in a Virtual Private Cloud (VPC) Documentation CloudFront Without WAF1419b4c6-6d5c-4534-9cf6-6a5266085333 Low Networking and Firewall All AWS CloudFront distributions should be integrated with the Web Application Firewall (AWS WAF) service Documentation ElastiCache Using Default Port5d89db57-8b51-4b38-bb76-b9bd42bd40f0 Low Networking and Firewall ElastiCache should not use the default port (an attacker can easily guess the port). For engine set to Redis, the default port is 6379. The Memcached default port is 11211 Documentation EC2 Instance Using Default VPC7e4a6e76-568d-43ef-8c4e-36dea481bff1 Low Networking and Firewall EC2 Instances should not be configured under a default VPC network Documentation Redshift Using Default Port41abc6cc-dde1-4217-83d3-fb5f0cc09d8f Low Networking and Firewall Redshift should not use the default port (5439) because an attacker can easily guess the port Documentation Shield Advanced Not In Use084c6686-2a70-4710-91b1-000393e54c12 Low Networking and Firewall AWS Shield Advanced should be used for Amazon Route 53 hosted zone, AWS Global Accelerator accelerator, Elastic IP Address, Elastic Load Balancing, and Amazon CloudFront Distribution to protect these resources against robust DDoS attacks Documentation DocDB Logging Is Disabled56f6a008-1b14-4af4-b9b2-ab7cf7e27641 Low Observability DocDB logging should be enabled Documentation EKS cluster logging is not enabled37304d3f-f852-40b8-ae3f-725e87a7cedf Low Observability Amazon EKS control plane logging is not enabled Documentation CloudWatch Network Gateways Changes Alarm Missing6b6874fe-4c2f-4eea-8b90-7cceaa4a125e Low Observability Ensure a log metric filter and alarm exist for network gateways changes Documentation CloudTrail Log File Validation Disabled52ffcfa6-6c70-4ea6-8376-d828d3961669 Low Observability CloudTrail log file validation should be enabled to determine whether a log file has not been tampered Documentation CloudWatch Changes To NACL Alarm Missing0a8e8dc5-b6fc-44fc-b5a1-969ec950f9b0 Low Observability Ensure a log metric filter and alarm exist for changes to NACL Documentation API Gateway Deployment Without API Gateway UsagePlan Associatedb3a59b8e-94a3-403e-b6e2-527abaf12034 Low Observability API Gateway Deployment should have API Gateway UsagePlan defined and associated. Documentation CloudWatch Route Table Changes Alarm Missing2285e608-ddbc-47f3-ba54-ce7121e31216 Low Observability Ensure a log metric filter and alarm exist for route table changes Documentation VPC FlowLogs Disabledf83121ea-03da-434f-9277-9cd247ab3047 Low Observability Every VPC resource should have an associated Flow Log Documentation Missing Cluster Log Types66f130d9-b81d-4e8e-9b08-da74b9c891df Low Observability Amazon EKS control plane logging don't enabled for all log types Documentation Lambda Functions Without X-Ray Tracing8152e0cf-d2f0-47ad-96d5-d003a76eabd1 Low Observability AWS Lambda functions should have TracingConfig enabled. For this, property 'tracing_Config.mode' should have the value 'Active' Documentation CloudWatch AWS Config Configuration Changes Alarm Missing5b8d7527-de8e-4114-b9dd-9d988f1f418f Low Observability Ensure a log metric filter and alarm exist for AWS Config configuration changes Documentation ECS Cluster with Container Insights Disabled97cb0688-369a-4d26-b1f7-86c4c91231bc Low Observability ECS Cluster should enable container insights Documentation CloudWatch VPC Changes Alarm Missing9d0d4512-1959-43a2-a17f-72360ff06d1b Low Observability Ensure a log metric filter and alarm exist for VPC changes Documentation Global Accelerator Flow Logs Disabled96e8183b-e985-457b-90cd-61c0503a3369 Low Observability Global Accelerator should have flow logs enabled Documentation API Gateway Stage Without API Gateway UsagePlan Associatedc999cf62-0920-40f8-8dda-0caccd66ed7e Low Resource Management API Gateway Stage should have API Gateway UsagePlan defined and associated. Documentation Security Group Not Used4849211b-ac39-479e-ae78-5694d506cb24 Info Access Control Security group must be used or not declared Documentation Resource Not Using Tagse38a8e0a-b88b-4902-b3fe-b0fcb17d5c10 Info Best Practices AWS services resource tags are an essential part of managing components. As a best practice, the field 'tags' should have additional tags defined other than 'Name' Documentation Security Group Rule Without Description68eb4bf3-f9bf-463d-b5cf-e029bb446d2e Info Best Practices It's considered a best practice for all rules in AWS Security Group to have a description Documentation Security Group Rule Without Descriptioncb3f5ed6-0d18-40de-a93d-b3538db31e8c Info Best Practices It's considered a best practice for AWS Security Group to have a description Documentation EC2 Not EBS Optimized60224630-175a-472a-9e23-133827040766 Info Best Practices It's considered a best practice for an EC2 instance to use an EBS optimized instance. This provides the best performance for your EBS volumes by minimizing contention between Amazon EBS I/O and other traffic from your instance Documentation DynamoDB Table Point In Time Recovery Disabled741f1291-47ac-4a85-a07b-3d32a9d6bd3e Info Best Practices It's considered a best practice to have point in time recovery enabled for DynamoDB Table Documentation EC2 Instance Monitoring Disabled23b70e32-032e-4fa6-ba5c-82f56b9980e6 Info Observability EC2 Instance should have detailed monitoring enabled. With detailed monitoring enabled data is available in 1-minute periods Documentation Neptune Logging Is Disabled45cff7b6-3b80-40c1-ba7b-2cf480678bb8 Info Observability Neptune logging should be enabled Documentation RDS Without Logging8d7f7b8c-6c7c-40f8-baa6-62006c6c7b56 Info Observability RDS does not have any kind of logger Documentation"},{"location":"queries/terraform-queries/#github","title":"GITHUB","text":"<p>Bellow are listed queries related with Terraform GITHUB:</p> Query Severity Category Description Help Github Organization Webhook With SSL Disabledce7c874e-1b88-450b-a5e4-cb76ada3c8a9 Medium Encryption Check if insecure SSL is being used in the GitHub organization webhooks Documentation GitHub Repository Set To Public15d8a7fd-465a-4d15-a868-add86552f17b Medium Insecure Configurations Repositories must be set to private, which means the attribute 'visibility' must be set to 'private' and/or the attribute 'private' must be set to true (the attribute 'visibility' overrides 'private') Documentation"},{"location":"queries/terraform-queries/#shared_v2v3","title":"SHARED (V2/V3)","text":"<p>Bellow are listed queries related with Terraform SHARED (V2/V3):</p> Query Severity Category Description Help Output Without Description59312e8a-a64e-41e7-a252-618533dd1ea8 Info Best Practices All outputs should contain a valid description. Documentation Variable Without Typefc5109bf-01fd-49fb-8bde-4492b543c34a Info Best Practices All variables should contain a valid type. Documentation Variable Without Description2a153952-2544-4687-bcc9-cc8fea814a9b Info Best Practices All variables should contain a valid description. Documentation Generic Git Module Without Revision3a81fc06-566f-492a-91dd-7448e409e2cd Info Best Practices All generic git repositories should reference a revision. Documentation Name Is Not Snake Case1e434b25-8763-4b00-a5ca-ca03b7abbb66 Info Best Practices All names should follow snake case pattern. Documentation"},{"location":"queries/terraform-queries/#kubernetes","title":"KUBERNETES","text":"<p>Bellow are listed queries related with Terraform KUBERNETES:</p> Query Severity Category Description Help Cluster Allows Unsafe Sysctlsa9174d31-d526-4ad9-ace4-ce7ddbf52e03 High Insecure Configurations A Kubernetes Cluster must not allow unsafe sysctls, to prevent a pod from having any influence on any other pod on the node, harming the node's health or gaining CPU or memory resources outside of the resource limits of a pod. This means the 'spec.security_context.sysctl' must not have an unsafe sysctls and that the attribute 'allowed_unsafe_sysctls' must be undefined. Documentation Tiller (Helm v2) Is Deployedca2fba76-c1a7-4afd-be67-5249f861cb0e High Insecure Configurations Check if Tiller is deployed. Documentation PSP Allows Containers To Share The Host Network Namespace4950837c-0ce5-4e42-9bee-a25eae73740b High Insecure Configurations Check if Pod Security Policies allow containers to share the host network namespace. Documentation Not Limited Capabilities For Pod Security Policy2acb555f-f4ad-4b1b-b984-84e6588f4b05 High Insecure Configurations Limit capabilities for a Pod Security Policy Documentation Container Is Privileged87065ef8-de9b-40d8-9753-f4a4303e27a4 High Insecure Configurations Privileged containers lack essential security restrictions and should be avoided by removing the 'privileged' flag or by changing its value to false Documentation Privilege Escalation Allowedc878abb4-cca5-4724-92b9-289be68bd47c High Insecure Configurations Containers should not run with allowPrivilegeEscalation in order to prevent them from gaining more privileges than their parent process Documentation Role Binding To Default Service Account3360c01e-c8c0-4812-96a2-a6329b9b7f9f High Insecure Defaults No role nor cluster role should bind to a default service account Documentation Permissive Access to Create Pods522d4a64-4dc9-44bd-9240-7d8a0d5cb5ba Medium Access Control The permission to create pods in a cluster should be restricted because it allows privilege escalation. Documentation Non Kube System Pod With Host Mount86a947ea-f577-4efb-a8b0-5fc00257d521 Medium Access Control A non kube-system workload should not have hostPath mounted Documentation RBAC Roles with Read Secrets Permissions826abb30-3cd5-4e0b-a93b-67729b4f7e63 Medium Access Control Roles and ClusterRoles with get/watch/list RBAC permissions on Kubernetes secrets are dangerous and should be avoided. In case of compromise, attackers could abuse these roles to access sensitive data, such as passwords, tokens and keys Documentation Readiness Probe Is Not Configured8657197e-3f87-4694-892b-8144701d83c1 Medium Availability Check if Readiness Probe is not configured. Documentation Root Containers Admitted4c415497-7410-4559-90e8-f2c8ac64ee38 Medium Best Practices Containers must not be allowed to run with root privileges, which means the attributes 'privileged' and 'allow_privilege_escalation' must be set to false, 'run_as_user.rule' must be set to 'MustRunAsNonRoot', and adding the root group must be forbidden Documentation Incorrect Volume Claim Access Mode ReadWriteOnce26b047a9-0329-48fd-8fb7-05bbe5ba80ee Medium Build Process Kubernetes Stateful Sets must have one Volume Claim template with the access mode 'ReadWriteOnce' Documentation PSP Allows Privilege Escalation2bff9906-4e9b-4f71-9346-8ebedfdf43ef Medium Insecure Configurations PodSecurityPolicy should not allow privilege escalation Documentation Containers With Added Capabilitiesfe771ff7-ba15-4f8f-ad7a-8aa232b49a28 Medium Insecure Configurations Containers should not have extra capabilities allowed Documentation Containers With Sys Admin Capabilities3f55386d-75cd-4e9a-ac47-167b26c04724 Medium Insecure Configurations Containers should not have CAP_SYS_ADMIN Linux capability Documentation NET_RAW Capabilities Disabled for PSP9aa32890-ac1a-45ee-81ca-5164e2098556 Medium Insecure Configurations Containers need to have NET_RAW or All as drop capabilities Documentation Container Resources Limits Undefined60af03ff-a421-45c8-b214-6741035476fa Medium Insecure Configurations Kubernetes container should have resource limitations defined such as CPU and memory Documentation Workload Mounting With Sensitive OS Directorya737be28-37d8-4bff-aa6d-1be8aa0a0015 Medium Insecure Configurations Workload is mounting a volume with sensitive OS Directory Documentation Container Host Pid Is True587d5d82-70cf-449b-9817-f60f9bccb88c Medium Insecure Configurations Minimize the admission of containers wishing to share the host process ID namespace Documentation Seccomp Profile Is Not Configured455f2e0c-686d-4fcb-8b5f-3f953f12c43c Medium Insecure Configurations Containers should be configured with a secure Seccomp profile to restrict potentially dangerous syscalls Documentation PSP Set To Privilegeda6a4d4fc-4e8f-47d1-969f-e9d4a084f3b9 Medium Insecure Configurations Do not allow pod to request execution as privileged. Documentation NET_RAW Capabilities Not Being Droppede5587d53-a673-4a6b-b3f2-ba07ec274def Medium Insecure Configurations Containers should drop 'ALL' or at least 'NET_RAW' capabilities Documentation Ingress Controller Exposes Workloade2c83c1f-84d7-4467-966c-ed41fd015bb9 Medium Insecure Configurations Ingress Controllers should not expose workload in order to avoid vulnerabilities and DoS attacks Documentation PSP With Added Capabilities48388bd2-7201-4dcc-b56d-e8a9efa58fad Medium Insecure Configurations PodSecurityPolicy should not have added capabilities Documentation Using Default Namespaceabcb818b-5af7-4d72-aba9-6dd84956b451 Medium Insecure Configurations The default namespace should not be used Documentation Container Runs Unmasked0ad60203-c050-4115-83b6-b94bde92541d Medium Insecure Configurations Check if a container has full access (unmasked) to the host\u2019s /proc command, which would allow to retrieve sensitive information and possibly change the kernel parameters in runtime. Documentation PSP Allows Sharing Host IPC51bed0ac-a8ae-407a-895e-90c6cb0610ce Medium Insecure Configurations Pod Security Policy allows containers to share the host IPC namespace Documentation Default Service Account In Use737a0dd9-0aaa-4145-8118-f01778262b8a Medium Insecure Configurations Default service accounts should not be actively used Documentation Service Account Token Automount Not Disableda9a13d4f-f17a-491b-b074-f54bffffcb4a Medium Insecure Defaults Service Account Tokens are automatically mounted even if not necessary Documentation Service Account Name Undefined Or Empty24b132df-5cc7-4823-8029-f898e1c50b72 Medium Insecure Defaults A Kubernetes Pod should have a Service Account defined so to restrict Kubernetes API access, which means the attribute 'service_account_name' should be defined and not empty. Documentation Service With External Load Balancer2a52567c-abb8-4651-a038-52fa27c77aed Medium Networking and Firewall Service has an external load balancer, which may cause accessibility from other networks and the Internet Documentation Network Policy Is Not Targeting Any Podb80b14c6-aaa2-4876-b651-8a48b6c32fbf Medium Networking and Firewall Check if any network policy is not targeting any pod. Documentation Memory Limits Not Definedfd097ed0-7fe6-4f58-8b71-fef9f0820a21 Medium Resource Management Memory limits should be defined for each container. This prevents potential resource exhaustion by ensuring that containers consume not more than the designated amount of memory Documentation CPU Limits Not Set5f4735ce-b9ba-4d95-a089-a37a767b716f Medium Resource Management CPU limits should be set because if the system has CPU time free, a container is guaranteed to be allocated as much CPU as it requests Documentation Memory Requests Not Defined21719347-d02b-497d-bda4-04a03c8e5b61 Medium Resource Management Memory requests should be defined for each container. This allows the kubelet to reserve the requested amount of system resources and prevents over-provisioning on individual nodes Documentation Shared Host Network Namespaceac1564a3-c324-4747-9fa1-9dfc234dace0 Medium Resource Management Container should not share the host network namespace Documentation Volume Mount With OS Directory Write Permissionsa62a99d1-8196-432f-8f80-3c100b05d62a Medium Resource Management Containers can mount sensitive folders from the hosts, giving them potentially dangerous access to critical host configurations and binaries. Documentation Shared Host IPC Namespacee94d3121-c2d1-4e34-a295-139bfeb73ea3 Medium Resource Management Container should not share the host IPC namespace Documentation CPU Requests Not Set577ac19c-6a77-46d7-9f14-e049cdd15ec2 Medium Resource Management CPU requests should be set to ensure the sum of the resource requests of the scheduled Containers is less than the capacity of the node Documentation Shared Service Accountf74b9c43-161a-4799-bc95-0b0ec81801b9 Medium Secret Management A Service Account token is shared between workloads Documentation Service Account Allows Access Secrets07fc3413-e572-42f7-9877-5c8fc6fccfb5 Medium Secret Management Kubernetes_role and Kubernetes_cluster_role when binded, should not use get, list or watch as verbs Documentation Docker Daemon Socket is Exposed to Containers4e203a65-c8d8-49a2-b749-b124d43c9dc1 Low Access Control Sees if Docker Daemon Socket is not exposed to Containers Documentation Missing App Armor Configbd6bd46c-57db-4887-956d-d372f21291b6 Low Access Control Containers should be configured with AppArmor for any application to reduce its potential attack Documentation Cluster Admin Rolebinding With Superuser Permissions17172bc2-56fb-4f17-916f-a014147706cd Low Access Control Ensure that the cluster-admin role is only used where required (RBAC) Documentation HPA Targets Invalid Object17e52ca3-ddd0-4610-9d56-ce107442e110 Low Availability The Horizontal Pod Autoscaler must target a valid object Documentation Deployment Without PodDisruptionBudgeta05331ee-1653-45cb-91e6-13637a76e4f0 Low Availability Deployments should be assigned with a PodDisruptionBudget to ensure high availability Documentation Liveness Probe Is Not Defined5b6d53dd-3ba3-4269-b4d7-f82e880e43c3 Low Availability In case of an unresponsive container, a Liveness Probe can help your application become more available since it restarts the container. However, it can lead to cascading failures. Define one if you really need it Documentation StatefulSet Without PodDisruptionBudget7249e3b0-9231-4af3-bc5f-5daf4988ecbf Low Availability StatefulSets should be assigned with a PodDisruptionBudget to ensure high availability Documentation StatefulSet Without Service Name420e6360-47bb-46f6-9072-b20ed22c842d Low Availability StatefulSets should have an existing headless 'serviceName'. The headless service labels should also be implemented on StatefulSets labels. Documentation Metadata Label Is Invalidbc3dabb6-fd50-40f8-b9ba-7429c9f1fb0e Low Best Practices Check if any label in the metadata is invalid. Documentation No Drop Capabilities for Containers21cef75f-289f-470e-8038-c7cee0664164 Low Best Practices Sees if Kubernetes Drop Capabilities exists to ensure containers security context Documentation Root Container Not Mounted As Read-onlyd532566b-8d9d-4f3b-80bd-361fe802f9c2 Low Build Process Check if the root container filesystem is not being mounted as read-only. Documentation StatefulSet Requests Storagefcc2612a-1dfe-46e4-8ce6-0320959f0040 Low Build Process A StatefulSet requests volume storage. Documentation Image Pull Policy Of The Container Is Not Set To Alwaysaa737abf-6b1d-4aba-95aa-5c160bd7f96e Low Insecure Configurations Image Pull Policy of the container must be defined and set to Always Documentation Pod or Container Without Security Contextad69e38a-d92e-4357-a8da-f2f29d545883 Low Insecure Configurations A security context defines privilege and access control settings for a Pod or Container Documentation Image Without Digest228c4c19-feeb-4c18-848c-800ac70fdfb7 Low Insecure Configurations Images should be specified together with their digests to ensure integrity Documentation Workload Host Port Not Specified4e74cf4f-ff65-4c1a-885c-67ab608206ce Low Networking and Firewall Verifies if Kubernetes workload's host port is specified Documentation Service Type is NodePort5c281bf8-d9bb-47f2-b909-3f6bb11874ad Low Networking and Firewall Service type should not be NodePort Documentation CronJob Deadline Not Configured58876b44-a690-4e9f-9214-7735fa0dd15d Low Resource Management Cronjobs must have a configured deadline, which means the attribute 'starting_deadline_seconds' must be defined Documentation Deployment Has No PodAntiAffinity461ed7e4-f8d5-4bc1-b3c6-64ddb4fd00a3 Low Resource Management Check if Deployment resources don't have a podAntiAffinity policy, which prevents multiple pods from being scheduled on the same node. Documentation Secrets As Environment Variables6d8f1a10-b6cd-48f0-b960-f7c535d5cdb8 Low Secret Management Container should not use secrets as environment variables Documentation Invalid Imagee76cca7c-c3f9-4fc9-884c-b2831168ebd8 Low Supply-Chain Image must be defined and not be empty or equal to latest. Documentation"},{"location":"queries/terraform-queries/#alicloud","title":"ALICLOUD","text":"<p>Bellow are listed queries related with Terraform ALICLOUD:</p> Query Severity Category Description Help OSS Bucket Allows List Action From All Principals88541597-6f88-42c8-bac6-7e0b855e8ff6 High Access Control OSS Bucket should not allow list action from all principals, as to prevent leaking private information to the entire internet or allow unauthorized data tampering/deletion. This means the 'Effect' must not be 'Allow' when the 'Action' contains 'List', for all Principals. Documentation OSS Bucket Allows Put Action From All Principalsfe286195-e75c-4359-bd58-00847c4f855a High Access Control OSS Bucket should not allow put action from all principals, as to prevent leaking private information to the entire internet or allow unauthorized data tampering/deletion. This means the 'Effect' must not be 'Allow' when the 'Action' contains 'Put', for all Principals. Documentation OSS Bucket Public Access Enabled62232513-b16f-4010-83d7-51d0e1d45426 High Access Control OSS Bucket should have public access disabled Documentation OSS Bucket Allows Delete Action From All Principals8c0695d8-2378-4cd6-8243-7fd5894fa574 High Access Control OSS Bucket should not allow delete action from all principals, as to prevent leaking private information to the entire internet or allow unauthorized data tampering/deletion. This means the 'Effect' must not be 'Allow' when the 'Action' is DeleteBucket, for all Principals. Documentation OSS Bucket Allows All Actions From All Principalsec62a32c-a297-41ca-a850-cab40b42094a High Access Control OSS Buckets should not allow all actions (wildcard) from all principals, as to prevent leaking private information to the entire internet or allow unauthorized data tampering/deletion. This means the 'Effect' must not be 'Allow' when the 'Action' is *, for all Principals. Documentation Ram Policy Admin Access Not Attached to Users Groups Rolese8e62026-da63-4904-b402-65adfe3ca975 High Access Control Ram policies with admin access should not be associated to users, groups or roles Documentation RAM Security Preference Not Enforce MFA Logindcda2d32-e482-43ee-a926-75eaabeaa4e0 High Access Control RAM Security preferences should enforce MFA login for RAM users Documentation NAS File System Not Encrypted67bfdff1-31ce-4525-b564-e94368735360 High Encryption NAS File System must be encrypted Documentation Ecs Data Disk Kms Key Id Undefinedf262118c-1ac6-4bb3-8495-cc48f1775b85 High Encryption Ecs Data Disk Kms Key Id should be set Documentation NAS File System Without KMS5f670f9d-b1b4-4c90-8618-2288f1ab9676 High Encryption NAS File System should have encryption provided by user KMS Documentation Launch Template Is Not Encrypted1455cb21-1d48-46d6-8ae3-cef911b71fd5 High Encryption ECS Launch Template should have the data in the disk encrypted. To encrypt the data, the 'encrypted' argument should be set to true. Documentation RDS Instance TDE Status Disabled44d434ca-a9bf-4203-8828-4c81a8d5a598 High Encryption tde_status parameter should be Enabled for supported RDS instances Documentation DB Instance Publicly Accessiblefaaefc15-51a5-419e-bb5e-51a4b5ab3485 High Insecure Configurations The field 'address' should not be set to '0.0.0.0/0' Documentation RDS DB Instance Publicly Accessible1b4565c0-4877-49ac-ab03-adebbccd42ae High Insecure Configurations '0.0.0.0' or '0.0.0.0/0' should not be in 'security_ips' list Documentation OSS Bucket Has Static Website2b13c6ff-b87a-484d-86fd-21ef6e97d426 High Insecure Configurations Checks if any static websties are hosted on buckets. Be aware of any website you are running. Documentation API Gateway API Protocol Not HTTPS1bcdf9f0-b1aa-40a4-b8c6-cd7785836843 High Networking and Firewall API Gateway API protocol should be set to HTTPS Documentation OSS Bucket Ip Restriction Disabled6107c530-7178-464a-88bc-df9cdd364ac8 High Networking and Firewall OSS Bucket should have ip restricted access Documentation ALB Listening on HTTPee3b1557-9fb5-4685-a95d-93f1edf2a0d7 High Networking and Firewall Application Load Balancer (alb) Listener should not listen on HTTP Documentation Public Security Group Rule Sensitive Port2ae9d554-23fb-4065-bfd1-fe43d5f7c419 High Networking and Firewall A sensitive port, such as port 23 or port 110, is open to the public in either TCP or UDP protocol Documentation Public Security Group Rule All Ports or Protocols60587dbd-6b67-432e-90f7-a8cf1892d968 High Networking and Firewall Alicloud Security Group Rule should not allow all ports or all protocols to the public Documentation OSS Buckets Secure Transport Disabledc01d10de-c468-4790-b3a0-fc887a56f289 High Networking and Firewall OSS Buckets should have secure transport enabled Documentation RDS Instance Events Not Loggedb9c524a4-fe76-4021-a6a2-cb978fb4fde1 High Observability All RDS Instance events trackers should be 'true' Documentation ActionTrail Trail OSS Bucket is Publicly Accessible69b5d7da-a5db-4db9-a42e-90b65d0efb0b High Observability ActionTrail Trail OSS Bucket should not be publicly accessible Documentation Ram Account Password Policy Max Login Attempts Unrecommendede76fd7ab-7333-40c6-a2d8-ea28af4a319e High Secret Management Ram Account Password Policy should have 'max_login_attempts' to a maximum of 5 incorrect login attempts Documentation Ram Account Password Policy Not Required Minimum Lengtha9dfec39-a740-4105-bbd6-721ba163c053 High Secret Management Ram Account Password Policy should have 'minimum_password_length' defined and set to 14 or above Documentation Ram Policy Attached to User66505003-7aba-45a1-8d83-5162d5706ef5 Medium Access Control Ram policies should not be attached to users Documentation CMK Is Unusableed6e3ba0-278f-47b6-a1f5-173576b40b7e Medium Availability Alicloud KMS must only possess usable Customer Master Keys (CMK), which means the CMKs must have the attribute 'is_enabled' set to true Documentation OSS Bucket Versioning Disabled70919c0b-2548-4e6b-8d7a-3d84ab6dabba Medium Backup OSS Bucket should have versioning enabled Documentation ROS Stack Retention Disabled4bb06fa1-2114-4a00-b7b5-6aeab8b896f0 Medium Backup The retain_stacks should be enabled to keep the Stack upon deleting the stack instance from the stack group Documentation ROS Stack Without Template92d65c51-5d82-4507-a2a1-d252e9706855 Medium Build Process Alicloud ROS Stack should have a template defined through the attribute template_url or attribute template_body Documentation OSS Bucket Encryption Using CMK Disabledf20e97f9-4919-43f1-9be9-f203cd339cdd Medium Encryption OSS Bucket should have encryption enabled using Customer Master Key Documentation SLB Policy With Insecure TLS Version In Usedbfc834a-56e5-4750-b5da-73fda8e73f70 Medium Encryption SLB Policy should not support insecure versions of TLS protocol Documentation Disk Encryption Disabled39750e32-3fe9-453b-8c33-dd277acdb2cc Medium Encryption Disks should have encryption enabled Documentation CS Kubernetes Node Pool Auto Repair Disabled81ce9394-013d-4731-8fcc-9d229b474073 Medium Insecure Configurations Verifies if Alicloud Container Service Node Pool Auto Repair is Enabled. This service periodically checks for failing nodes and repairs them to ensure a smooth running state. Documentation Public Security Group Rule Unknown Portdd706080-b7a8-47dc-81fb-3e8184430ec0 Medium Networking and Firewall A unknown port, such as port 24 or port 111, is open to the public in either TCP or UDP or ALL protocol/protocols mentioned Documentation Kubernetes Cluster Without Terway as CNI Network Pluginb9b7ada8-3868-4a35-854e-6100a2bb863d Medium Networking and Firewall Kubernetes Cluster should have Terway as CNI Network Plugin to configure network policies Documentation RDS Instance Retention Period Not Recommendeddc158941-28ce-481d-a7fa-dc80761edf46 Medium Observability RDS Instance SQL Retention Period should be greater than 180 Documentation Log Retention Is Not Greater Than 90 Daysed6cf6ff-9a1f-491c-9f88-e03c0807f390 Medium Observability OSS Log Store should have logging enabled for longer than 90 days, for better visibility of resources and objects. Documentation ROS Stack Notifications Disabled9ef08939-ea40-489c-8851-667870b2ef50 Medium Observability The ROS Stack Notifications should be defined and populated to receive stack related events Documentation Action Trail Logging For All Regions Disabledc065b98e-1515-4991-9dca-b602bd6a2fbb Medium Observability Action Trail Logging for all regions should be enabled Documentation OSS Bucket Logging Disabled05db341e-de7d-4972-a106-3e2bd5ee53e1 Medium Observability OSS Bucket should have logging enabled, for better visibility of resources and objects. Documentation No ROS Stack Policy72ceb736-0aee-43ea-a191-3a69ab135681 Medium Resource Management ROS Stack should have a stack policy in order to protect stack resources from and during update actions Documentation Ram Account Password Policy Not Required Numbers063234c0-91c0-4ab5-bbd0-47ddb5f23786 Medium Secret Management Ram Account Password Policy should have 'require_numbers' set to true Documentation Ram Account Password Policy Max Password Age Unrecommended2bb13841-7575-439e-8e0a-cccd9ede2fa8 Medium Secret Management Ram Account Password Policy Password 'max_password_age' should be higher than 0 and lower than 91 Documentation RAM Account Password Policy without Reuse Preventiona8128dd2-89b0-464b-98e9-5d629041dfe0 Medium Secret Management RAM Account Password Policy 'password_reuse_prevention' should be defined and set to 24 or less Documentation Ram Account Password Policy Not Require At Least one Lowercase Character89143358-cec6-49f5-9392-920c591c669c Medium Secret Management Ram Account Password Policy should have 'require_lowercase_characters' set to true Documentation RAM Account Password Policy Not Require at Least one Uppercase Character5e0fb613-ba9b-44c3-88f0-b44188466bfd Medium Secret Management Ram Account Password Policy should have 'require_uppercase_characters' set to true Documentation High KMS Key Rotation Periodcb319d87-b90f-485e-a7e7-f2408380f309 Medium Secret Management KMS Key should have automatic rotation enabled and the rotation period should not be higher than a year Documentation RAM Account Password Policy Not Required Symbols41a38329-d81b-4be4-aef4-55b2615d3282 Medium Secret Management RAM account password security should require at least one symbol Documentation OSS Bucket Transfer Acceleration Disabled8f98334a-99aa-4d85-b72a-1399ca010413 Low Availability OSS Bucket should have transfer acceleration enabled Documentation OSS Bucket Lifecycle Rule Disabled7db8bd7e-9772-478c-9ec5-4bc202c5686f Low Backup OSS Bucket should have lifecycle rule enabled and set to true Documentation VPC Flow Logs Disabledd2731f3d-a992-44ed-812e-f4f1c2747d71 Low Observability Every VPC resource should have an associated Flow Log Documentation RDS Instance Log Disconnections Disabledd53f4123-f8d8-4224-8cb3-f920b151cc98 Low Observability log_disconnections parameter should be set to ON for RDS instances Documentation RDS Instance Log Duration Disableda597e05a-c065-44e7-9cc8-742f572a504a Low Observability log_duration parameter should be set to ON for RDS instances Documentation RDS Instance Log Connections Disabled140869ea-25f2-40d4-a595-0c0da135114e Low Observability 'log_connections' parameter should be set to ON for RDS instances Documentation"},{"location":"queries/terraform-queries/#gcp_bom","title":"GCP_BOM","text":"<p>Bellow are listed queries related with Terraform GCP_BOM:</p> Query Severity Category Description Help BOM - GCP PDdd7d70aa-a6ec-460d-b5d2-38b40253b16f Trace Bill Of Materials A list of Persistent Disk resources found. Persistent Disk is Google's local durable storage service, fully integrated with Google Cloud products, Compute Engine and Google Kubernetes Engine. Documentation BOM - GCP PST4b82202a-b18e-4891-a1eb-a0989850bbb3 Trace Bill Of Materials A list of Pub/Sub Topic resources found. Cloud Pub/Sub is designed to provide reliable, many-to-many, asynchronous messaging between applications. Publisher applications can send messages to a 'topic' and other applications can subscribe to that topic to receive the messages. Documentation BOM - GCP SB2f06d22c-56bd-4f73-8a51-db001fcf2150 Trace Bill Of Materials A list of Storage Bucket resources found. Buckets are the basic containers that hold your data. Everything that you store in Cloud Storage must be contained in a bucket. Documentation BOM - GCP FIc9d81239-c818-4869-9917-1570c62b81fd Trace Bill Of Materials A list of Filestore Instance resources found. Filestore instances are fully managed file servers on Google Cloud that can be connected to Compute Engine VMs, GKE clusters, and your on-premises machines. Once provisioned, you can scale the capacity of your instances according to need without any downtime. Documentation BOM - GCP Redisbc75ce52-a60a-4660-b533-bce837a5019b Trace Bill Of Materials A list of Redis Instance resources found. Memorystore for Redis is a fully managed Redis service for Google Cloud. Applications running on Google Cloud can achieve extreme performance by leveraging the highly scalable, available, secure Redis service without the burden of managing complex Redis deployments. Documentation BOM - GCP Dataflow895ed0d9-6fec-4567-8614-d7a74b599a53 Trace Bill Of Materials A list of Dataflow resources found. Unified stream and batch data processing that's serverless, fast, and cost-effective. Documentation"},{"location":"queries/terraform-queries/#aws_bom","title":"AWS_BOM","text":"<p>Bellow are listed queries related with Terraform AWS_BOM:</p> Query Severity Category Description Help BOM - AWS DynamoDB23edf35f-7c22-4ff9-87e6-0ca74261cfbf Trace Bill Of Materials A list of DynamoDB resources found. Amazon DynamoDB is a fully managed, serverless, key-value NoSQL database designed to run high-performance applications at any scale. Documentation BOM - AWS MQfcb1b388-f558-4b7f-9b6e-f4e98abb7380 Trace Bill Of Materials A list of MQ resources found. Amazon MQ is a managed message broker service for Apache ActiveMQ and RabbitMQ that makes it easy to set up and operate message brokers on AWS. Documentation BOM - AWS RDS12933609-c5bf-44b4-9a41-a6467c3b685b Trace Bill Of Materials A list of RDS resources found. Amazon Relational Database Service (Amazon RDS) is a collection of managed services that makes it simple to set up, operate, and scale databases in the cloud. Documentation BOM - AWS Elasticache54229498-850b-4f78-b3a7-218d24ef2c37 Trace Bill Of Materials A list of Elasticache resources found. Amazon ElastiCache is a fully managed, in-memory caching service supporting flexible, real-time use cases. You can use ElastiCache for caching, which accelerates application and database performance, or as a primary data store for use cases that don't require durability like session stores, gaming leaderboards, streaming, and analytics. ElastiCache is compatible with Redis and Memcached. Documentation BOM - AWS SNSeccc4d59-74b9-4974-86f1-74386e0c7f33 Trace Bill Of Materials A list of SNS resources specified. Amazon Simple Notification Service (Amazon SNS) is a fully managed messaging service for both application-to-application (A2A) and application-to-person (A2P) communication. Documentation BOM - AWS EFSf53f16d6-46a9-4277-9fbe-617b1e24cdca Trace Bill Of Materials A list of EFS resources found. Amazon Elastic File System (Amazon EFS) automatically grows and shrinks as you add and remove files with no need for management or provisioning. Documentation BOM - AWS Kinesis0e59d33e-bba2-4037-8f88-9765647ca7ad Trace Bill Of Materials A list of Kinesis resources found. Amazon Kinesis is a real-time streaming service that provides collection, processing, and analysis of video and data streams in real-time Documentation BOM - AWS MSK051f2063-2517-4295-ad8e-ba88c1bf5cfc Trace Bill Of Materials A list of MSK resources specified. Amazon Managed Streaming for Apache Kafka (Amazon MSK) is a fully managed service that enables you to build and run applications that use Apache Kafka to process streaming data. Documentation BOM - AWS EBS86571149-eef3-4280-a645-01e60df854b0 Trace Bill Of Materials A list of EBS resources found. Amazon Elastic Block Store (Amazon EBS) is an easy-to-use, scalable, high-performance block-storage service designed for Amazon Elastic Compute Cloud (Amazon EC2). Documentation BOM - AWS S3 Buckets2d16c3fb-35ba-4ec0-b4e4-06ee3cbd4045 Trace Bill Of Materials A list of S3 resources found. Amazon Simple Storage Service (Amazon S3) is an object storage service that offers industry-leading scalability, data availability, security, and performance. Documentation BOM - AWS SQSbaecd2da-492a-4d59-b9dc-29540a1398e0 Trace Bill Of Materials A list of SQS resources specified. Amazon Simple Queue Service (SQS) is a fully managed message queuing service that enables you to decouple and scale microservices, distributed systems, and serverless applications. Documentation"},{"location":"queries/terraform-queries/#gcp","title":"GCP","text":"<p>Bellow are listed queries related with Terraform GCP:</p> Query Severity Category Description Help OSLogin Disabled32ecd6eb-0711-421f-9627-1a28d9eff217 High Access Control Verifies that the OSLogin is enabled Documentation VM With Full Cloud Accessbc280331-27b9-4acb-a010-018e8098aa5d High Access Control A VM instance is configured to use the default service account with full access to all Cloud APIs Documentation BigQuery Dataset Is Publice576ce44-dd03-4022-a8c0-3906acca2ab4 High Access Control BigQuery dataset is anonymously or publicly accessible Documentation Cloud Storage Anonymous or Publicly Accessiblea6cd52a1-3056-4910-96a5-894de9f3f3b3 High Access Control Cloud Storage Buckets must not be anonymously or publicly accessible, which means the attribute 'members' must not possess 'allUsers' or 'allAuthenticatedUsers' Documentation Cloud Storage Bucket Is Publicly Accessiblec010082c-76e0-4b91-91d9-6e8439e455dd High Access Control Cloud Storage Bucket is anonymously or publicly accessible Documentation SQL DB Instance Backup Disabledcf3c7631-cd1e-42f3-8801-a561214a6e79 High Backup Checks if backup configuration is enabled for all Cloud SQL Database instances Documentation KMS Crypto Key is Publicly Accessible16cc87d1-dd47-4f46-b3ce-4dfcac8fd2f5 High Encryption KMS Crypto Key should not be publicly accessible. In other words, the KMS Crypto Key policy should not set 'allUsers' or 'allAuthenticatedUsers' in the attribute 'member'/'members' Documentation DNSSEC Using RSASHA1ccc3100c-0fdd-4a5e-9908-c10107291860 High Encryption DNSSEC should not use the RSASHA1 algorithm, which means if, within the 'dnssec_config' block, the 'default_key_specs' block exists with the 'algorithm' field is 'rsasha1' which is bad. Documentation SQL DB Instance With SSL Disabled02474449-71aa-40a1-87ae-e14497747b00 High Encryption Cloud SQL Database Instance should have SLL enabled Documentation SQL DB Instance Publicly Accessibleb187edca-b81e-4fdc-aff4-aab57db45edb High Insecure Configurations Cloud SQL instances should not be publicly accessible. Documentation Pod Security Policy Disabled9192e0f9-eca5-4056-9282-ae2a736a4088 High Insecure Configurations Kubernetes Clusters must have Pod Security Policy controller enabled, which means there must be a 'pod_security_policy_config' with the 'enabled' attribute equal to true Documentation Cluster Labels Disabled65c1bc7a-4835-4ac4-a2b6-13d310b0648d High Insecure Configurations Kubernetes Clusters must be configured with labels, which means the attribute 'resource_labels' must be defined Documentation Cluster Master Authentication Disabled1baba08e-3c8a-4be7-95eb-dced5833de21 High Insecure Configurations Kubernetes Engine Clusters must have Master Authentication set to enabled, which means the attribute 'master_auth' must have the subattributes 'username' and 'password' defined and not empty Documentation IP Aliasing Disabledc606ba1d-d736-43eb-ac24-e16108f3a9e0 High Insecure Configurations Kubernetes Clusters must be created with Alias IP ranges enabled, which means the attribut 'ip_allocation_policy' must be defined and, if defined, the attribute 'networking_mode' must be VPC_NATIVE Documentation Not Proper Email Account In Use9356962e-4a4f-4d06-ac59-dc8008775eaa High Insecure Configurations Gmail accounts are being used instead of corporate credentials Documentation GKE Basic Authentication Enabled70cdf849-b7d9-4569-b87d-5d82ffd44719 High Insecure Configurations GCP - Google Kubernetes Engine (GKE) Basic Authentication must be disabled, which means the username and password provided in the master_auth block must be empty Documentation Network Policy Disabled11e7550e-c4b6-472e-adff-c698f157cdd7 High Insecure Configurations Kubernetes Engine Clusters must have Network Policy enabled, meaning that the attribute 'network_policy.enabled' must be true and the attribute 'addons_config.network_policy_config.disabled' must be false Documentation Private Cluster Disabled6ccb85d7-0420-4907-9380-50313f80946b High Insecure Configurations Kubernetes Clusters must be created with Private Clusters enabled, meaning the 'private_cluster_config' must be defined and the attributes 'enable_private_nodes' and 'enable_private_endpoint' must be true Documentation GKE Legacy Authorization Enabled5baa92d2-d8ee-4c75-88a4-52d9d8bb8067 High Insecure Configurations Kubernetes Engine Clusters must have Legacy Authorization set to disabled, which means the attribute 'enable_legacy_abac' must not be true Documentation Client Certificate Disabled73fb21a1-b19a-45b1-b648-b47b1678681e High Insecure Configurations Kubernetes Clusters must be created with Client Certificate enabled, which means 'master_auth' must have 'client_certificate_config' with the attribute 'issue_client_certificate' equal to true Documentation Cloud Storage Bucket Logging Not Enabledd6cabc3a-d57e-48c2-b341-bf3dd4f4a120 High Observability Cloud storage bucket should have logging enabled Documentation Stackdriver Monitoring Disabled30e8dfd2-3591-4d19-8d11-79e93106c93d High Observability Kubernetes Engine Clusters must have Stackdriver Monitoring enabled, which means the attribute 'monitoring_service' must be defined and different than 'none' Documentation IAM Audit Not Properly Configured89fe890f-b480-460c-8b6b-7d8b1468adb4 High Observability Audit Logging Configuration is defective Documentation Stackdriver Logging Disabled4c7ebcb2-eae2-461e-bc83-456ee2d4f694 High Observability Kubernetes Engine Clusters must have Stackdriver Logging enabled, which means the attribute 'logging_service' must be defined and different from 'none' Documentation Cloud Storage Bucket Versioning Disablede7e961ac-d17e-4413-84bc-8a1fbe242944 High Observability Cloud Storage Bucket should have versioning enabled Documentation Node Auto Upgrade Disabledb139213e-7d24-49c2-8025-c18faa21ecaa High Resource Management Kubernetes nodes must have auto upgrades set to true, which means Node 'auto_upgrade' should be enabled for Kubernetes Clusters Documentation KMS Admin and CryptoKey Roles In Use92e4464a-4139-4d57-8742-b5acc0347680 Medium Access Control Google Project IAM Policy should not assign a KMS admin role and CryptoKey role to the same member Documentation Google Project IAM Binding Service Account has Token Creator or Account User Role617ef6ff-711e-4bd7-94ae-e965911b1b40 Medium Access Control Verifies if Google Project IAM Binding Service Account doesn't have an Account User or Token Creator Role associated Documentation Google Project IAM Member Service Account has Token Creator or Account User Rolec68b4e6d-4e01-4ca1-b256-1e18e875785c Medium Access Control Verifies if Google Poject IAM Member Service Account doesn't have a Account User or Token Creator associated Documentation Google Project IAM Member Service Account Has Admin Role84d36481-fd63-48cb-838e-635c44806ec2 Medium Access Control Verifies that Google Project IAM Member Service Account doesn't have an Admin Role associated Documentation Google Compute SSL Policy Weak Cipher In Use14a457f0-473d-4d1d-9e37-6d99b355b336 Medium Encryption This query confirms if Google Compute SSL Policy Weak Chyper Suits is Enabled, to do so we need to check if TLS is TLS_1_2, because other version have Weak Chypers Documentation Disk Encryption Disabledb1d51728-7270-4991-ac2f-fc26e2695b38 Medium Encryption VM disks for critical VMs must be encrypted with Customer Supplied Encryption Keys (CSEK) or with Customer-managed encryption keys (CMEK), which means the attribute 'disk_encryption_key' must be defined and its sub attributes 'raw_key' or 'kms_key_self_link' must also be defined Documentation Google Container Node Pool Auto Repair Disabledacfdbec6-4a17-471f-b412-169d77553332 Medium Insecure Configurations Google Container Node Pool Auto Repair should be enabled. This service periodically checks for failing nodes and repairs them to ensure a smooth running state. Documentation Google Project Auto Create Network Disabled59571246-3f62-4965-a96f-c7d97e269351 Medium Insecure Configurations Verifies if the Google Project Auto Create Network is Disabled Documentation Cloud DNS Without DNSSEC5ef61c88-bbb4-4725-b1df-55d23c9676bb Medium Insecure Configurations DNSSEC must be enabled for Cloud DNS Documentation OSLogin Is Disabled For VM Instanced0b4d550-c001-46c3-bbdb-d5d75d33f05f Medium Insecure Configurations Check if any VM instance disables OSLogin Documentation COS Node Image Not Used8a893e46-e267-485a-8690-51f39951de58 Medium Insecure Configurations The node image should be Container-Optimized OS(COS) Documentation Google Storage Bucket Level Access Disabledbb0db090-5509-4853-a827-75ced0b3caa0 Medium Insecure Configurations Google Storage Bucket Level Access should be enabled Documentation Shielded VM Disabled1b44e234-3d73-41a8-9954-0b154135280e Medium Insecure Configurations Compute instances must be launched with Shielded VM enabled, which means the attribute 'shielded_instance_config' must be defined and its sub attributes 'enable_secure_boot', 'enable_vtpm' and 'enable_integrity_monitoring' must be set to true Documentation GKE Using Default Service Account1c8eef02-17b1-4a3e-b01d-dcc3292d2c38 Medium Insecure Defaults Kubernetes Engine Clusters should not be configured to use the default service account Documentation Using Default Service Account3cb4af0b-056d-4fb1-8b95-fdc4593625ff Medium Insecure Defaults Instances should not be configured to use the Default Service Account, that has full access to all Cloud APIs, which means the attribute 'service_account' and its sub attribute 'email' must be defined. Additionally, 'email' must not be empty and must also not be a default Google Compute Engine service account. Documentation SSH Access Is Not Restrictedc4dcdcdf-10dd-4bf4-b4a0-8f6239e6aaa0 Medium Networking and Firewall Google Firewall should not allow SSH access (port 22) from the Internet (public CIDR block) to ensure the principle of least privileges Documentation RDP Access Is Not Restricted678fd659-96f2-454a-a2a0-c2571f83a4a3 Medium Networking and Firewall Check if the Google compute firewall allows unrestricted RDP access. Allowed ports should not contain RDP port 3389 Documentation Google Compute Network Using Default Firewall Rule40abce54-95b1-478c-8e5f-ea0bf0bb0e33 Medium Networking and Firewall Google Compute Network should not use default firewall rule Documentation Serial Ports Are Enabled For VM Instances97fa667a-d05b-4f16-9071-58b939f34751 Medium Networking and Firewall Google Compute Engine VM instances should not enable serial ports. When enabled, anyone can access your VM, if they know the username, project ID, SSH key, instance name and zone Documentation IP Forwarding Enabledf34c0c25-47b4-41eb-9c79-249b4dd47b89 Medium Networking and Firewall Instances must not have IP forwarding enabled, which means the attribute 'can_ip_forward' must not be true Documentation Google Compute Network Using Firewall Rule that Allows All Ports22ef1d26-80f8-4a6c-8c15-f35aab3cac78 Medium Networking and Firewall Google Compute Network should not use a firewall rule that allows all ports Documentation Google Compute Subnetwork Logging Disabled40430747-442d-450a-a34f-dc57149f4609 Medium Observability This query checks if logs are enabled for a Google Compute Subnetwork resource. Documentation Service Account with Improper Privilegescefdad16-0dd5-4ac5-8ed2-a37502c78672 Medium Resource Management Service account should not have improper privileges like admin, editor, owner, or write roles Documentation Project-wide SSH Keys Are Enabled In VM Instances3e4d5ce6-3280-4027-8010-c26eeea1ec01 Medium Secret Management VM Instance should block project-wide SSH keys Documentation High Google KMS Crypto Key Rotation Periodd8c57c4e-bf6f-4e32-a2bf-8643532de77b Medium Secret Management KMS encryption keys should be rotated every 90 days or less. A short lifetime of encryption keys reduces the potential blast radius in case of compromise. Documentation User with IAM Role704fcc44-a58f-4af5-82e2-93f2a58ef918 Low Best Practices As a best practice, it is better to assign an IAM Role to a group than to a user Documentation Google Compute Network Using Firewall Rule that Allows Port Rangee6f61c37-106b-449f-a5bb-81bfcaceb8b4 Low Networking and Firewall Google Compute Network should not use a firewall rule that allows port range Documentation Google Compute Subnetwork with Private Google Access Disabledee7b93c1-b3f8-4a3b-9588-146d481814f5 Low Networking and Firewall Google Compute Subnetwork should have Private Google Access enabled, which means 'private_ip_google_access' should be set to true Documentation"},{"location":"queries/terraform-queries/#azure","title":"AZURE","text":"<p>Bellow are listed queries related with Terraform AZURE:</p> Query Severity Category Description Help Role Assignment Of Guest Users2bc626a8-0751-446f-975d-8139214fc790 High Access Control There is a role assignment for guest user Documentation Public Storage Account17f75827-0684-48f4-8747-61129c7e4198 High Access Control Storage Account should not be public to grant the principle of least privileges Documentation Function App Authentication Disablede65a0733-94a0-4826-82f4-df529f4c593f High Access Control Azure Function App authentication settings should be enabled Documentation Storage Container Is Publicly Accessibledd5230f8-a577-4bbb-b7ac-f2c2fe7d5299 High Access Control Anonymous, public read access to a container and its blobs are enabled in Azure Blob Storage Documentation Role Assignment Not Limit Guest User Permissions8e75e431-449f-49e9-b56a-c8f1378025cf High Access Control Role Assignment should limit guest user permissions Documentation Admin User Enabled For Container Registryb897dfbf-322c-45a8-b67c-1e698beeaa51 High Access Control Admin user is enabled for Container Registry Documentation Geo Redundancy Is Disabled8b042c30-e441-453f-b162-7696982ebc58 High Backup Make sure that on PostgreSQL Geo Redundant Backups is enabled Documentation App Service Not Using Latest TLS Encryption Versionb7b9d1c7-2d3b-49b4-b867-ebbe68d0b643 High Encryption Ensure App Service is using the latest version of TLS encryption Documentation MySQL SSL Connection Disabled73e42469-3a86-4f39-ad78-098f325b4e9f High Encryption Make sure that for MySQL Database Server, 'Enforce SSL connection' is enabled Documentation Function App Not Using Latest TLS Encryption Version45fc717a-bd86-415c-bdd8-677901be1aa6 High Encryption Ensure Function App is using the latest version of TLS encryption Documentation Storage Account Not Forcing HTTPS12944ec4-1fa0-47be-8b17-42a034f937c2 High Encryption Storage Accounts should enforce the use of HTTPS Documentation SSL Enforce Disabled0437633b-daa6-4bbc-8526-c0d2443b946e High Encryption Make sure that for PosgreSQL, the 'Enforce SSL connection' is set to 'ENABLED' Documentation Network Watcher Flow Disabledb90842e5-6779-44d4-9760-972f4c03ba1c High Insecure Configurations Check if enable field in the resource azurerm_network_watcher_flow_log is false. Documentation Azure Container Registry With No Locksa187ac47-8163-42ce-8a63-c115236be6fb High Insecure Configurations Azurerm Container Registry should contain associated locks, which means 'azurerm_management_lock.scope' should be associated with 'azurerm_container_registry' Documentation AKS Private Cluster Disabled599318f2-6653-4569-9e21-041d06c63a89 High Insecure Configurations Azure Kubernetes Service (AKS) API should not be exposed to the internet Documentation Azure App Service Client Certificate Disableda81573f9-3691-4d83-88a0-7d4af63e17a3 High Insecure Configurations Azure App Service client certificate should be enabled Documentation Redis Not Updated Regularlyb947809d-dd2f-4de9-b724-04d101c515aa High Insecure Configurations Redis Cache is not configured to be updated regularly with security and operational updates Documentation AD Admin Not Configured For SQL Servera3a055d2-9a2e-4cc9-b9fb-12850a1a3a4b High Insecure Configurations The Active Directory Administrator is not configured for a SQL server Documentation VM Not Attached To Networkbbf6b3df-4b65-4f87-82cc-da9f30f8c033 High Insecure Configurations No Network Security Group is attached to the Virtual Machine Documentation Function App FTPS Enforce Disabled9dab0179-433d-4dff-af8f-0091025691df High Insecure Configurations Azure Function App should only enforce FTPS when 'ftps_state' is enabled Documentation Web App Accepting Traffic Other Than HTTPS11e9a948-c6c3-4a0f-8dcf-b5cf1763cdbe High Insecure Configurations Web app should only accept HTTPS traffic in Azure Web App Service. Documentation App Service FTPS Enforce Disabled85da374f-b00f-4832-9d44-84a1ca1e89f8 High Insecure Configurations Azure App Service should only enforce FTPS when 'ftps_state' is enabled Documentation CosmosDB Account IP Range Filter Not Setc2a3efb6-8a58-481c-82f2-bfddf34bb4b7 High Networking and Firewall The IP range filter should be defined to secure the data stored Documentation MSSQL Server Public Network Access Enabledade36cf4-329f-4830-a83d-9db72c800507 High Networking and Firewall MSSQL Server public network access should be disabled Documentation Redis Publicly Accessible5089d055-53ff-421b-9482-a5267bdce629 High Networking and Firewall Firewall rule allowing unrestricted access to Redis from other Azure sources Documentation SSH Is Exposed To The Internet3e3c175e-aadf-4e2b-a464-3fdac5748d24 High Networking and Firewall Port 22 (SSH) is exposed to the internet Documentation RDP Is Exposed To The Internetefbf6449-5ec5-4cfe-8f15-acc51e0d787c High Networking and Firewall Port 3389 (Remote Desktop) is exposed to the internet Documentation SQLServer Ingress From Any IP25c0ea09-f1c5-4380-b055-3b83863f2bb8 High Networking and Firewall Check if all IPs are allowed, check from start 0.0.0.0 to end 255.255.255.255. Documentation Redis Entirely Accessiblefd8da341-6760-4450-b26c-9f6d8850575e High Networking and Firewall Firewall rule allowing unrestricted access to Redis from the Internet Documentation MySQL Server Public Access Enabledf118890b-2468-42b1-9ce9-af35146b425b High Networking and Firewall MySQL Server public access should be disabled Documentation Sensitive Port Is Exposed To Entire Network594c198b-4d79-41b8-9b36-fde13348b619 High Networking and Firewall A sensitive port, such as port 23 or port 110, is open for the whole network in either TCP or UDP protocol Documentation Trusted Microsoft Services Not Enabled5400f379-a347-4bdd-a032-446465fdcc6f High Networking and Firewall Trusted Microsoft Services should be enabled for Storage Account access Documentation Vault Auditing Disabled38c71c00-c177-4cd7-8d36-cd1007cdb190 High Observability Ensure that logging for Azure KeyVault is 'Enabled' Documentation App Service Managed Identity Disabledb61cce4b-0cc4-472b-8096-15617a6d769b High Resource Management Azure App Service should have managed identity enabled Documentation PostgreSQL Server Threat Detection Policy Disabledc407c3cf-c409-4b29-b590-db5f4138d332 High Resource Management PostgreSQL Server Threat Detection Policy should be enabled Documentation SQL Database Audit Disabled83a229ba-483e-47c6-8db7-dc96969bce5a High Resource Management Ensure that 'Threat Detection' is enabled for Azure SQL Database Documentation Key Expiration Not Set4d080822-5ee2-49a4-8984-68f3d4c890fc High Secret Management Make sure that for all keys the expiration date is set Documentation Secret Expiration Not Setdfa20ffa-f476-428f-a490-424b41e91c7f High Secret Management Make sure that for all secrets the expiration date is set Documentation AKS RBAC Disabled86f92117-eed8-4614-9c6c-b26da20ff37f Medium Access Control Azure Container Service (AKS) instance should have role-based access control (RBAC) enabled Documentation Role Definition Allows Custom Role Creation3fa5900f-9aac-4982-96b2-a6143d9c99fb Medium Access Control Role Definition should not allow custom role creation (Microsoft.Authorization/roleDefinitions/write) Documentation Storage Table Allows All ACL Permissions3ac3e75c-6374-4a32-8ba0-6ed69bda404e Medium Access Control Azure Storage Table should not allow all ACL (Access Control List) permissions - r (read), w (write), d (delete), and l (list). Documentation Storage Share File Allows All ACL Permissions48bbe0fd-57e4-4678-a4a1-119e79c90fc3 Medium Access Control Azure Storage Share File should not allow all ACL (Access Control List) permissions - r (read), w (write), d (delete), and l (list). Documentation Virtual Network with DDoS Protection Plan disabledb4cc2c52-34a6-4b43-b57c-4bdeb4514a5a Medium Availability Virtual Network should have DDoS Protection Plan enabled Documentation SQL Server Predictable Admin Account Name2ab6de9a-0136-415c-be92-79d2e4fd750f Medium Best Practices Azure SQL Server's Admin account login must avoid using names like 'Admin', that are too predictable, which means the attribute 'administrator_login' must be set to a name that is not easy to predict Documentation SQL Server Predictable Active Directory Account Namebcd3fc01-5902-4f2a-b05a-227f9bbf5450 Medium Best Practices Azure SQL Server must avoid using predictable Active Directory Administrator Account names, like 'Admin', which means the attribute 'login' must be set to a name that is not easy to predict Documentation Security Contact Email34664094-59e0-4524-b69f-deaa1a68cce3 Medium Best Practices Security Contact Email should be defined Documentation Cosmos DB Account Without Tags56dad03e-e94f-4dd6-93a4-c253a03ff7a0 Medium Build Process Cosmos DB Account must have a mapping of tags. Documentation Storage Account Not Using Latest TLS Encryption Version8263f146-5e03-43e0-9cfe-db960d56d1e7 Medium Encryption Ensure Storage Account is using the latest version of TLS encryption Documentation AKS Disk Encryption Set ID Undefinedb17d8bb8-4c08-4785-867e-cb9e62a622aa Medium Encryption Azure Container Service (AKS) should use Disk Encryption Set ID in supported types of disk Documentation Encryption On Managed Disk Disableda99130ab-4c0e-43aa-97f8-78d4fcb30024 Medium Encryption Ensure that the encryption is active on the disk Documentation Redis Cache Allows Non SSL Connectionse29a75e6-aba3-4896-b42d-b87818c16b58 Medium Insecure Configurations Redis Cache resources should not allow non-SSL connections Documentation Function App Client Certificates Unrequired9bb3c639-5edf-458c-8ee5-30c17c7d671d Medium Insecure Configurations Azure Function App should have 'client_cert_mode' set to required Documentation AKS Network Policy Misconfiguredf5342045-b935-402d-adf1-8dbbd09c0eef Medium Insecure Configurations Azure Kubernetes Service should have the proper network policy configuration to ensure the principle of least privileges, which means that 'network_profile.network_policy' should be defined Documentation Security Group is Not Configured5c822443-e1ea-46b8-84eb-758ec602e844 Medium Insecure Configurations Azure Virtual Network subnet must be configured with a Network Security Group, which means the attribute 'security_group' must be defined and not empty Documentation Small Flow Logs Retention Period7750fcca-dd03-4d38-b663-4b70289bcfd4 Medium Insecure Configurations Flow logs enable capturing information about IP traffic flowing in and out of the network security groups. Network Security Group Flow Logs must be enabled with retention period greater than or equal to 90 days. This is important, because these logs are used to check for anomalies and give information of suspected breaches Documentation Security Center Pricing Tier Is Not Standard819d50fd-1cdf-45c3-9936-be408aaad93e Medium Insecure Configurations Make sure that the 'Standard' pricing tiers were selected. Documentation Function App Managed Identity Disabledc87749b3-ff10-41f5-9df2-c421e8151759 Medium Insecure Configurations Azure Function App should have managed identity enabled Documentation Default Network Access is Allowed9be09caf-2ba4-4fa9-9787-a670dc32c639 Medium Insecure Defaults Default Network Access rule for Storage Accounts must be set to deny, which means the attribute 'default_action' must be 'Deny' Documentation Default Azure Storage Account Network Access Is Too Permissivea5613650-32ec-4975-a305-31af783153ea Medium Insecure Defaults Default Azure Storage Account network access should be set to Deny Documentation WAF Is Disabled For Azure Application Gateway2e48d91c-50e4-45c8-9312-27b625868a72 Medium Networking and Firewall Check if Web Application Firewall is disabled or not configured for Azure's Application Gateway. Documentation Network Interfaces IP Forwarding Enabled4216ebac-d74c-4423-b437-35025cb88af5 Medium Networking and Firewall Network Interfaces IP Forwarding should be disabled Documentation Network Interfaces With Public IPc1573577-e494-4417-8854-7e119368dc8b Medium Networking and Firewall Network Interfaces should not be exposed with a public IP address. If configured, additional security baselines should be followed (https://docs.microsoft.com/en-us/security/benchmark/azure/baselines/virtual-network-security-baseline, https://docs.microsoft.com/en-us/security/benchmark/azure/baselines/public-ip-security-baseline) Documentation MariaDB Server Public Network Access Enabled7f0a8696-7159-4337-ad0d-8a3ab4a78195 Medium Networking and Firewall MariaDB Server Public Network Access should be disabled Documentation Sensitive Port Is Exposed To Small Public Networke9dee01f-2505-4df2-b9bf-7804d1fd9082 Medium Networking and Firewall A sensitive port, such as port 23 or port 110, is open for small public network in either TCP or UDP protocol Documentation Unrestricted SQL Server Accessd7ba74da-2da0-4d4b-83c8-2fd72a3f6c28 Medium Networking and Firewall Azure SQL Server Accessibility should be set to a minimal address range to grant the principle of least privileges, which means the difference between the values of the 'end_ip_address' and 'start_ip_address' must be less than 256. Additionally, both ips must be different from '0.0.0.0'. Documentation Azure Cognitive Search Public Network Access Enabled4a9e0f00-0765-4f72-a0d4-d31110b78279 Medium Networking and Firewall Public Network Access should be disabled for Azure Cognitive Search Documentation Sensitive Port Is Exposed To Wide Private Networkc6c7b33d-d7f6-4ab8-8c82-ca0431ecdb7e Medium Networking and Firewall A sensitive port, such as port 23 or port 110, is open for wide private network in either TCP or UDP protocol Documentation Firewall Rule Allows Too Many Hosts To Access Redis Cachea829b715-cf75-4e92-b645-54c9b739edfb Medium Networking and Firewall Check if any firewall rule allows too many hosts to access Redis Cache Documentation Small Activity Log Retention Period2b856bf9-8e8c-4005-875f-303a8cba3918 Medium Observability Ensure that Activity Log Retention is set 365 days or greater Documentation PostgreSQL Log Disconnections Not Set07f7134f-9f37-476e-8664-670c218e4702 Medium Observability Make sure that for PostgreSQL Database, server parameter 'log_disconnections' is set to 'ON' Documentation Email Alerts Disabled9db38e87-f6aa-4b5e-a1ec-7266df259409 Medium Observability Make sure that alerts notifications are set to 'On' in the Azure Security Center Contact Documentation PostgreSQL Log Checkpoints Disabled3790d386-be81-4dcf-9850-eaa7df6c10d9 Medium Observability Make sure that for Postgre SQL Database Server, parameter 'log_checkpoints' is set to 'ON' Documentation Small MSSQL Audit Retention Period9c301481-e6ec-44f7-8a49-8ec63e2969ea Medium Observability Make sure that for MSSQL Server, the Auditing Retention is greater than 90 days Documentation Small MSSQL Server Audit Retention59acb56b-2b10-4c2c-ba38-f2223c3f5cfc Medium Observability Make sure for SQL Servers that Auditing Retention is greater than 90 days Documentation Log Retention Is Not Setffb02aca-0d12-475e-b77c-a726f7aeff4b Medium Observability Make sure that for PostgreSQL Database, server parameter 'log_retention' is set to 'ON' Documentation Small PostgreSQL DB Server Log Retention Period261a83f8-dd72-4e8c-b5e1-ebf06e8fe606 Medium Observability Check if PostgreSQL Database Server retains logs for less than 3 Days Documentation PostgreSQL Server Without Connection Throttling2b3c671f-1b76-4741-8789-ed1fe0785dc4 Medium Observability Ensure that Connection Throttling is set for the PostgreSQL server Documentation MSSQL Server Auditing Disabled609839ae-bd81-4375-9910-5bce72ae7b92 Medium Observability Make sure that for MSSQL Servers, that 'Auditing' is set to 'On' Documentation SQL Server Auditing Disabledf7e296b0-6660-4bc5-8f87-22ac4a815edf Medium Observability Make sure that for SQL Servers, 'Auditing' is set to 'On' Documentation PostgreSQL Log Connections Not Setc640d783-10c5-4071-b6c1-23507300d333 Medium Observability Make sure that for PostgreSQL Database, server parameter 'log_connections' is set to 'ON' Documentation PostgreSQL Log Duration Not Set16e0879a-c4ae-4ff8-a67d-a2eed5d67b8f Medium Observability Make sure that for PostgreSQL Database, server parameter 'log_duration' is set to 'ON' Documentation Azure Active Directory Authenticationa21c8da9-41bf-40cf-941d-330cf0d11fc7 Low Access Control Azure Active Directory must be used for authentication for Service Fabric Documentation MariaDB Server Geo-redundant Backup Disabled0a70d5f3-1ecd-4c8e-9292-928fc9a8c4f1 Low Backup MariaDB Server Geo-redundant Backup should be enabled Documentation Key Vault Secrets Content Type Undefinedf8e08a38-fc6e-4915-abbe-a7aadf1d59ef Low Best Practices Key Vault Secrets should have set Content Type Documentation AKS Uses Azure Policies Add-On Disabled43789711-161b-4708-b5bb-9d1c626f7492 Low Best Practices Azure Container Service (AKS) should use Azure Policies Add-On Documentation App Service Without Latest PHP Version96fe318e-d631-4156-99fa-9080d57280ae Low Best Practices Periodically newer versions are released for PHP software either due to security flaws or to include additional functionality. Using the latest PHP version for web apps is recommended in order to take advantage of security fixes, if any, and/or additional functionalities of the newer version. Documentation App Service Without Latest Python Versioncc4aaa9d-1070-461a-b519-04e00f42db8a Low Best Practices Periodically, newer versions are released for Python software either due to security flaws or to include additional functionality. Using the latest full Python version for web apps is recommended in order to take advantage of security fixes, if any, and/or additional functionalities of the newer version. Documentation PostgreSQL Server Infrastructure Encryption Disabled6425c98b-ca4e-41fe-896a-c78772c131f8 Low Encryption PostgreSQL Server Infrastructure Encryption should be enabled Documentation App Service HTTP2 Disabled525b53be-62ed-4244-b4df-41aecfcb4071 Low Insecure Configurations App Service should have 'http2_enabled' enabled Documentation Function App HTTP2 Disabledace823d1-4432-4dee-945b-cdf11a5a6bd0 Low Insecure Configurations Function App should have 'http2_enabled' enabled Documentation Dashboard Is Enabled61c3cb8b-0715-47e4-b788-86dde40dd2db Low Insecure Configurations Check if the Kubernetes Dashboard is enabled. Documentation Azure Front Door WAF Disabled835a4f2f-df43-437d-9943-545ccfc55961 Low Networking and Firewall Azure Front Door WAF should be enabled Documentation App Service Authentication Disabledc7fc1481-2899-4490-bbd8-544a3a61a2f3 Info Access Control Azure App Service authentication settings should be enabled Documentation SQL Server Alert Email Disabled55975007-f6e7-4134-83c3-298f1fe4b519 Info Best Practices SQL Server alert email should be enabled Documentation"}]}